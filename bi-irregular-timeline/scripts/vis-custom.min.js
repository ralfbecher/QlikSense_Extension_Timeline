(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.vis=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";exports.util=require("./lib/util");exports.DOMutil=require("./lib/DOMutil");exports.DataSet=require("./lib/DataSet");exports.DataView=require("./lib/DataView");exports.Queue=require("./lib/Queue");exports.Graph3d=require("./lib/graph3d/Graph3d");exports.graph3d={Camera:require("./lib/graph3d/Camera"),Filter:require("./lib/graph3d/Filter"),Point2d:require("./lib/graph3d/Point2d"),Point3d:require("./lib/graph3d/Point3d"),Slider:require("./lib/graph3d/Slider"),StepNumber:require("./lib/graph3d/StepNumber")};exports.moment=require("./lib/module/moment");exports.Hammer=require("./lib/module/hammer");exports.keycharm=require("keycharm")},{"./lib/DOMutil":5,"./lib/DataSet":6,"./lib/DataView":7,"./lib/Queue":8,"./lib/graph3d/Camera":9,"./lib/graph3d/Filter":10,"./lib/graph3d/Graph3d":11,"./lib/graph3d/Point2d":12,"./lib/graph3d/Point3d":13,"./lib/graph3d/Slider":16,"./lib/graph3d/StepNumber":17,"./lib/module/hammer":19,"./lib/module/moment":20,"./lib/util":116,keycharm:223}],2:[function(require,module,exports){"use strict";exports.util=require("./lib/util");exports.DOMutil=require("./lib/DOMutil");exports.DataSet=require("./lib/DataSet");exports.DataView=require("./lib/DataView");exports.Queue=require("./lib/Queue");exports.Network=require("./lib/network/Network");exports.network={Images:require("./lib/network/Images"),dotparser:require("./lib/network/dotparser"),gephiParser:require("./lib/network/gephiParser"),allOptions:require("./lib/network/options")};exports.network.convertDot=function(input){return exports.network.dotparser.DOTToGraph(input)};exports.network.convertGephi=function(input,options){return exports.network.gephiParser.parseGephi(input,options)};exports.moment=require("./lib/module/moment");exports.Hammer=require("./lib/module/hammer");exports.keycharm=require("keycharm")},{"./lib/DOMutil":5,"./lib/DataSet":6,"./lib/DataView":7,"./lib/Queue":8,"./lib/module/hammer":19,"./lib/module/moment":20,"./lib/network/Images":22,"./lib/network/Network":23,"./lib/network/dotparser":25,"./lib/network/gephiParser":26,"./lib/network/options":79,"./lib/util":116,keycharm:223}],3:[function(require,module,exports){"use strict";exports.util=require("./lib/util");exports.DOMutil=require("./lib/DOMutil");exports.DataSet=require("./lib/DataSet");exports.DataView=require("./lib/DataView");exports.Queue=require("./lib/Queue");exports.Timeline=require("./lib/timeline/Timeline");exports.Graph2d=require("./lib/timeline/Graph2d");exports.timeline={Core:require("./lib/timeline/Core"),DateUtil:require("./lib/timeline/DateUtil"),Range:require("./lib/timeline/Range"),stack:require("./lib/timeline/Stack"),TimeStep:require("./lib/timeline/TimeStep"),components:{items:{Item:require("./lib/timeline/component/item/Item"),BackgroundItem:require("./lib/timeline/component/item/BackgroundItem"),BoxItem:require("./lib/timeline/component/item/BoxItem"),PointItem:require("./lib/timeline/component/item/PointItem"),RangeItem:require("./lib/timeline/component/item/RangeItem")},BackgroundGroup:require("./lib/timeline/component/BackgroundGroup"),Component:require("./lib/timeline/component/Component"),CurrentTime:require("./lib/timeline/component/CurrentTime"),CustomTime:require("./lib/timeline/component/CustomTime"),DataAxis:require("./lib/timeline/component/DataAxis"),DataScale:require("./lib/timeline/component/DataScale"),GraphGroup:require("./lib/timeline/component/GraphGroup"),Group:require("./lib/timeline/component/Group"),ItemSet:require("./lib/timeline/component/ItemSet"),Legend:require("./lib/timeline/component/Legend"),LineGraph:require("./lib/timeline/component/LineGraph"),TimeAxis:require("./lib/timeline/component/TimeAxis")}};exports.moment=require("./lib/module/moment");exports.Hammer=require("./lib/module/hammer");exports.keycharm=require("keycharm")},{"./lib/DOMutil":5,"./lib/DataSet":6,"./lib/DataView":7,"./lib/Queue":8,"./lib/module/hammer":19,"./lib/module/moment":20,"./lib/timeline/Core":86,"./lib/timeline/DateUtil":87,"./lib/timeline/Graph2d":88,"./lib/timeline/Range":89,"./lib/timeline/Stack":90,"./lib/timeline/TimeStep":91,"./lib/timeline/Timeline":92,"./lib/timeline/component/BackgroundGroup":93,"./lib/timeline/component/Component":94,"./lib/timeline/component/CurrentTime":95,"./lib/timeline/component/CustomTime":96,"./lib/timeline/component/DataAxis":97,"./lib/timeline/component/DataScale":98,"./lib/timeline/component/GraphGroup":99,"./lib/timeline/component/Group":100,"./lib/timeline/component/ItemSet":101,"./lib/timeline/component/Legend":102,"./lib/timeline/component/LineGraph":103,"./lib/timeline/component/TimeAxis":104,"./lib/timeline/component/item/BackgroundItem":108,"./lib/timeline/component/item/BoxItem":109,"./lib/timeline/component/item/Item":110,"./lib/timeline/component/item/PointItem":111,"./lib/timeline/component/item/RangeItem":112,"./lib/util":116,keycharm:223}],4:[function(require,module,exports){"use strict";var util=require("./lib/util");util.extend(exports,require("./index-graph3d"));util.extend(exports,require("./index-timeline-graph2d"));util.extend(exports,require("./index-network"))},{"./index-graph3d":1,"./index-network":2,"./index-timeline-graph2d":3,"./lib/util":116}],5:[function(require,module,exports){"use strict";exports.prepareElements=function(JSONcontainer){for(var elementType in JSONcontainer){if(JSONcontainer.hasOwnProperty(elementType)){JSONcontainer[elementType].redundant=JSONcontainer[elementType].used;JSONcontainer[elementType].used=[]}}};exports.cleanupElements=function(JSONcontainer){for(var elementType in JSONcontainer){if(JSONcontainer.hasOwnProperty(elementType)){if(JSONcontainer[elementType].redundant){for(var i=0;i<JSONcontainer[elementType].redundant.length;i++){JSONcontainer[elementType].redundant[i].parentNode.removeChild(JSONcontainer[elementType].redundant[i])}JSONcontainer[elementType].redundant=[]}}}};exports.resetElements=function(JSONcontainer){exports.prepareElements(JSONcontainer);exports.cleanupElements(JSONcontainer);exports.prepareElements(JSONcontainer)};exports.getSVGElement=function(elementType,JSONcontainer,svgContainer){var element;if(JSONcontainer.hasOwnProperty(elementType)){if(JSONcontainer[elementType].redundant.length>0){element=JSONcontainer[elementType].redundant[0];JSONcontainer[elementType].redundant.shift()}else{element=document.createElementNS("http://www.w3.org/2000/svg",elementType);svgContainer.appendChild(element)}}else{element=document.createElementNS("http://www.w3.org/2000/svg",elementType);JSONcontainer[elementType]={used:[],redundant:[]};svgContainer.appendChild(element)}JSONcontainer[elementType].used.push(element);return element};exports.getDOMElement=function(elementType,JSONcontainer,DOMContainer,insertBefore){var element;if(JSONcontainer.hasOwnProperty(elementType)){if(JSONcontainer[elementType].redundant.length>0){element=JSONcontainer[elementType].redundant[0];JSONcontainer[elementType].redundant.shift()}else{element=document.createElement(elementType);if(insertBefore!==undefined){DOMContainer.insertBefore(element,insertBefore)}else{DOMContainer.appendChild(element)}}}else{element=document.createElement(elementType);JSONcontainer[elementType]={used:[],redundant:[]};if(insertBefore!==undefined){DOMContainer.insertBefore(element,insertBefore)}else{DOMContainer.appendChild(element)}}JSONcontainer[elementType].used.push(element);return element};exports.drawPoint=function(x,y,groupTemplate,JSONcontainer,svgContainer,labelObj){var point;if(groupTemplate.style=="circle"){point=exports.getSVGElement("circle",JSONcontainer,svgContainer);point.setAttributeNS(null,"cx",x);point.setAttributeNS(null,"cy",y);point.setAttributeNS(null,"r",.5*groupTemplate.size)}else{point=exports.getSVGElement("rect",JSONcontainer,svgContainer);point.setAttributeNS(null,"x",x-.5*groupTemplate.size);point.setAttributeNS(null,"y",y-.5*groupTemplate.size);point.setAttributeNS(null,"width",groupTemplate.size);point.setAttributeNS(null,"height",groupTemplate.size)}if(groupTemplate.styles!==undefined){point.setAttributeNS(null,"style",groupTemplate.styles)}point.setAttributeNS(null,"class",groupTemplate.className+" vis-point");if(labelObj){var label=exports.getSVGElement("text",JSONcontainer,svgContainer);if(labelObj.xOffset){x=x+labelObj.xOffset}if(labelObj.yOffset){y=y+labelObj.yOffset}if(labelObj.content){label.textContent=labelObj.content}if(labelObj.className){label.setAttributeNS(null,"class",labelObj.className+" vis-label")}label.setAttributeNS(null,"x",x);label.setAttributeNS(null,"y",y)}return point};exports.drawBar=function(x,y,width,height,className,JSONcontainer,svgContainer,style){if(height!=0){if(height<0){height*=-1;y-=height}var rect=exports.getSVGElement("rect",JSONcontainer,svgContainer);rect.setAttributeNS(null,"x",x-.5*width);rect.setAttributeNS(null,"y",y);rect.setAttributeNS(null,"width",width);rect.setAttributeNS(null,"height",height);rect.setAttributeNS(null,"class",className);if(style){rect.setAttributeNS(null,"style",style)}}}},{}],6:[function(require,module,exports){"use strict";var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("./util");var Queue=require("./Queue");function DataSet(data,options){if(data&&!Array.isArray(data)){options=data;data=null}this._options=options||{};this._data={};this.length=0;this._fieldId=this._options.fieldId||"id";this._type={};if(this._options.type){var fields=(0,_keys2["default"])(this._options.type);for(var i=0,len=fields.length;i<len;i++){var field=fields[i];var value=this._options.type[field];if(value=="Date"||value=="ISODate"||value=="ASPDate"){this._type[field]="Date"}else{this._type[field]=value}}}if(this._options.convert){throw new Error('Option "convert" is deprecated. Use "type" instead.')}this._subscribers={};if(data){this.add(data)}this.setOptions(options)}DataSet.prototype.setOptions=function(options){if(options&&options.queue!==undefined){if(options.queue===false){if(this._queue){this._queue.destroy();delete this._queue}}else{if(!this._queue){this._queue=Queue.extend(this,{replace:["add","update","remove"]})}if((0,_typeof3["default"])(options.queue)==="object"){this._queue.setOptions(options.queue)}}}};DataSet.prototype.on=function(event,callback){var subscribers=this._subscribers[event];if(!subscribers){subscribers=[];this._subscribers[event]=subscribers}subscribers.push({callback:callback})};DataSet.prototype.subscribe=function(){throw new Error("DataSet.subscribe is deprecated. Use DataSet.on instead.")};DataSet.prototype.off=function(event,callback){var subscribers=this._subscribers[event];if(subscribers){this._subscribers[event]=subscribers.filter(function(listener){return listener.callback!=callback})}};DataSet.prototype.unsubscribe=function(){throw new Error("DataSet.unsubscribe is deprecated. Use DataSet.off instead.")};DataSet.prototype._trigger=function(event,params,senderId){if(event=="*"){throw new Error("Cannot trigger event *")}var subscribers=[];if(event in this._subscribers){subscribers=subscribers.concat(this._subscribers[event])}if("*"in this._subscribers){subscribers=subscribers.concat(this._subscribers["*"])}for(var i=0,len=subscribers.length;i<len;i++){var subscriber=subscribers[i];if(subscriber.callback){subscriber.callback(event,params,senderId||null)}}};DataSet.prototype.add=function(data,senderId){var addedIds=[],id,me=this;if(Array.isArray(data)){for(var i=0,len=data.length;i<len;i++){id=me._addItem(data[i]);addedIds.push(id)}}else if(data instanceof Object){id=me._addItem(data);addedIds.push(id)}else{throw new Error("Unknown dataType")}if(addedIds.length){this._trigger("add",{items:addedIds},senderId)}return addedIds};DataSet.prototype.update=function(data,senderId){var addedIds=[];var updatedIds=[];var oldData=[];var updatedData=[];var me=this;var fieldId=me._fieldId;var addOrUpdate=function addOrUpdate(item){var id=item[fieldId];if(me._data[id]){var oldItem=util.extend({},me._data[id]);id=me._updateItem(item);updatedIds.push(id);updatedData.push(item);oldData.push(oldItem)}else{id=me._addItem(item);addedIds.push(id)}};if(Array.isArray(data)){for(var i=0,len=data.length;i<len;i++){if(data[i]instanceof Object){addOrUpdate(data[i])}else{console.warn("Ignoring input item, which is not an object at index "+i)}}}else if(data instanceof Object){addOrUpdate(data)}else{throw new Error("Unknown dataType")}if(addedIds.length){this._trigger("add",{items:addedIds},senderId)}if(updatedIds.length){var props={items:updatedIds,oldData:oldData,data:updatedData};this._trigger("update",props,senderId)}return addedIds.concat(updatedIds)};DataSet.prototype.get=function(args){var me=this;var id,ids,options;var firstType=util.getType(arguments[0]);if(firstType=="String"||firstType=="Number"){id=arguments[0];options=arguments[1]}else if(firstType=="Array"){ids=arguments[0];options=arguments[1]}else{options=arguments[0]}var returnType;if(options&&options.returnType){var allowedValues=["Array","Object"];returnType=allowedValues.indexOf(options.returnType)==-1?"Array":options.returnType}else{returnType="Array"}var type=options&&options.type||this._options.type;var filter=options&&options.filter;var items=[],item,itemIds,itemId,i,len;if(id!=undefined){item=me._getItem(id,type);if(item&&filter&&!filter(item)){item=null}}else if(ids!=undefined){for(i=0,len=ids.length;i<len;i++){item=me._getItem(ids[i],type);if(!filter||filter(item)){items.push(item)}}}else{itemIds=(0,_keys2["default"])(this._data);for(i=0,len=itemIds.length;i<len;i++){itemId=itemIds[i];item=me._getItem(itemId,type);if(!filter||filter(item)){items.push(item)}}}if(options&&options.order&&id==undefined){this._sort(items,options.order)}if(options&&options.fields){var fields=options.fields;if(id!=undefined){item=this._filterFields(item,fields)}else{for(i=0,len=items.length;i<len;i++){items[i]=this._filterFields(items[i],fields)}}}if(returnType=="Object"){var result={},resultant;for(i=0,len=items.length;i<len;i++){resultant=items[i];result[resultant.id]=resultant}return result}else{if(id!=undefined){return item}else{return items}}};DataSet.prototype.getIds=function(options){var data=this._data,filter=options&&options.filter,order=options&&options.order,type=options&&options.type||this._options.type,itemIds=(0,_keys2["default"])(data),i,len,id,item,items,ids=[];if(filter){if(order){items=[];for(i=0,len=itemIds.length;i<len;i++){id=itemIds[i];item=this._getItem(id,type);if(filter(item)){items.push(item)}}this._sort(items,order);for(i=0,len=items.length;i<len;i++){ids.push(items[i][this._fieldId])}}else{for(i=0,len=itemIds.length;i<len;i++){id=itemIds[i];item=this._getItem(id,type);if(filter(item)){ids.push(item[this._fieldId])}}}}else{if(order){items=[];for(i=0,len=itemIds.length;i<len;i++){id=itemIds[i];items.push(data[id])}this._sort(items,order);for(i=0,len=items.length;i<len;i++){ids.push(items[i][this._fieldId])}}else{for(i=0,len=itemIds.length;i<len;i++){id=itemIds[i];item=data[id];ids.push(item[this._fieldId])}}}return ids};DataSet.prototype.getDataSet=function(){return this};DataSet.prototype.forEach=function(callback,options){var filter=options&&options.filter,type=options&&options.type||this._options.type,data=this._data,itemIds=(0,_keys2["default"])(data),i,len,item,id;if(options&&options.order){var items=this.get(options);for(i=0,len=items.length;i<len;i++){item=items[i];id=item[this._fieldId];callback(item,id)}}else{for(i=0,len=itemIds.length;i<len;i++){id=itemIds[i];item=this._getItem(id,type);if(!filter||filter(item)){callback(item,id)}}}};DataSet.prototype.map=function(callback,options){var filter=options&&options.filter,type=options&&options.type||this._options.type,mappedItems=[],data=this._data,itemIds=(0,_keys2["default"])(data),i,len,id,item;for(i=0,len=itemIds.length;i<len;i++){id=itemIds[i];item=this._getItem(id,type);if(!filter||filter(item)){mappedItems.push(callback(item,id))}}if(options&&options.order){this._sort(mappedItems,options.order)}return mappedItems};DataSet.prototype._filterFields=function(item,fields){if(!item){return item}var filteredItem={},itemFields=(0,_keys2["default"])(item),len=itemFields.length,i,field;if(Array.isArray(fields)){for(i=0;i<len;i++){field=itemFields[i];if(fields.indexOf(field)!=-1){filteredItem[field]=item[field]}}}else{for(i=0;i<len;i++){field=itemFields[i];if(fields.hasOwnProperty(field)){filteredItem[fields[field]]=item[field]}}}return filteredItem};DataSet.prototype._sort=function(items,order){if(util.isString(order)){var name=order;items.sort(function(a,b){var av=a[name];var bv=b[name];return av>bv?1:av<bv?-1:0})}else if(typeof order==="function"){items.sort(order)}else{throw new TypeError("Order must be a function or a string")}};DataSet.prototype.remove=function(id,senderId){var removedIds=[],removedItems=[],ids=[],i,len,itemId,item;ids=Array.isArray(id)?id:[id];for(i=0,len=ids.length;i<len;i++){item=this._remove(ids[i]);if(item){itemId=item[this._fieldId];if(itemId!=undefined){removedIds.push(itemId);removedItems.push(item)}}}if(removedIds.length){this._trigger("remove",{items:removedIds,oldData:removedItems},senderId)}return removedIds};DataSet.prototype._remove=function(id){var item,ident;if(util.isNumber(id)||util.isString(id)){ident=id}else if(id instanceof Object){ident=id[this._fieldId]}if(ident!==undefined&&this._data[ident]){item=this._data[ident];delete this._data[ident];this.length--;return item}return null};DataSet.prototype.clear=function(senderId){var i,len;var ids=(0,_keys2["default"])(this._data);var items=[];for(i=0,len=ids.length;i<len;i++){items.push(this._data[ids[i]])}this._data={};this.length=0;this._trigger("remove",{items:ids,oldData:items},senderId);return ids};DataSet.prototype.max=function(field){var data=this._data,itemIds=(0,_keys2["default"])(data),max=null,maxField=null,i,len;for(i=0,len=itemIds.length;i<len;i++){var id=itemIds[i];var item=data[id];var itemField=item[field];if(itemField!=null&&(!max||itemField>maxField)){max=item;maxField=itemField}}return max};DataSet.prototype.min=function(field){var data=this._data,itemIds=(0,_keys2["default"])(data),min=null,minField=null,i,len;for(i=0,len=itemIds.length;i<len;i++){var id=itemIds[i];var item=data[id];var itemField=item[field];if(itemField!=null&&(!min||itemField<minField)){min=item;minField=itemField}}return min};DataSet.prototype.distinct=function(field){var data=this._data;var itemIds=(0,_keys2["default"])(data);var values=[];var fieldType=this._options.type&&this._options.type[field]||null;var count=0;var i,j,len;for(i=0,len=itemIds.length;i<len;i++){var id=itemIds[i];var item=data[id];var value=item[field];var exists=false;for(j=0;j<count;j++){if(values[j]==value){exists=true;break}}if(!exists&&value!==undefined){values[count]=value;count++}}if(fieldType){for(i=0,len=values.length;i<len;i++){values[i]=util.convert(values[i],fieldType)}}return values};DataSet.prototype._addItem=function(item){var id=item[this._fieldId];if(id!=undefined){if(this._data[id]){throw new Error("Cannot add item: item with id "+id+" already exists")}}else{id=util.randomUUID();item[this._fieldId]=id}var d={},fields=(0,_keys2["default"])(item),i,len;for(i=0,len=fields.length;i<len;i++){var field=fields[i];var fieldType=this._type[field];d[field]=util.convert(item[field],fieldType)}this._data[id]=d;this.length++;return id};DataSet.prototype._getItem=function(id,types){var field,value,i,len;var raw=this._data[id];if(!raw){return null}var converted={},fields=(0,_keys2["default"])(raw);if(types){for(i=0,len=fields.length;i<len;i++){field=fields[i];value=raw[field];converted[field]=util.convert(value,types[field])}}else{for(i=0,len=fields.length;i<len;i++){field=fields[i];value=raw[field];converted[field]=value}}if(!converted[this._fieldId]){converted[this._fieldId]=raw.id}return converted};DataSet.prototype._updateItem=function(item){var id=item[this._fieldId];if(id==undefined){throw new Error("Cannot update item: item has no id (item: "+(0,_stringify2["default"])(item)+")")}var d=this._data[id];if(!d){throw new Error("Cannot update item: no item with id "+id+" found")}var fields=(0,_keys2["default"])(item);for(var i=0,len=fields.length;i<len;i++){var field=fields[i];var fieldType=this._type[field];d[field]=util.convert(item[field],fieldType)}return id};module.exports=DataSet},{"./Queue":8,"./util":116,"babel-runtime/core-js/json/stringify":119,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/typeof":133}],7:[function(require,module,exports){"use strict";var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("./util");var DataSet=require("./DataSet");function DataView(data,options){this._data=null;this._ids={};this.length=0;this._options=options||{};this._fieldId="id";this._subscribers={};var me=this;this.listener=function(){me._onEvent.apply(me,arguments)};this.setData(data)}DataView.prototype.setData=function(data){var ids,id,i,len,items;if(this._data){if(this._data.off){this._data.off("*",this.listener)}ids=this._data.getIds({filter:this._options&&this._options.filter});items=[];for(i=0,len=ids.length;i<len;i++){items.push(this._data._data[ids[i]])}this._ids={};this.length=0;this._trigger("remove",{items:ids,oldData:items})}this._data=data;if(this._data){this._fieldId=this._options.fieldId||this._data&&this._data.options&&this._data.options.fieldId||"id";ids=this._data.getIds({filter:this._options&&this._options.filter});for(i=0,len=ids.length;i<len;i++){id=ids[i];this._ids[id]=true}this.length=ids.length;this._trigger("add",{items:ids});if(this._data.on){this._data.on("*",this.listener)}}};DataView.prototype.refresh=function(){var id,i,len;var ids=this._data.getIds({filter:this._options&&this._options.filter}),oldIds=(0,_keys2["default"])(this._ids),newIds={},addedIds=[],removedIds=[],removedItems=[];for(i=0,len=ids.length;i<len;i++){id=ids[i];newIds[id]=true;if(!this._ids[id]){addedIds.push(id);this._ids[id]=true}}for(i=0,len=oldIds.length;i<len;i++){id=oldIds[i];if(!newIds[id]){removedIds.push(id);removedItems.push(this._data._data[id]);delete this._ids[id]}}this.length+=addedIds.length-removedIds.length;if(addedIds.length){this._trigger("add",{items:addedIds})}if(removedIds.length){this._trigger("remove",{items:removedIds,oldData:removedItems})}};DataView.prototype.get=function(args){var me=this;var ids,options,data;var firstType=util.getType(arguments[0]);if(firstType=="String"||firstType=="Number"||firstType=="Array"){ids=arguments[0];options=arguments[1];data=arguments[2]}else{options=arguments[0];data=arguments[1]}var viewOptions=util.extend({},this._options,options);if(this._options.filter&&options&&options.filter){viewOptions.filter=function(item){return me._options.filter(item)&&options.filter(item)}}var getArguments=[];if(ids!=undefined){getArguments.push(ids)}getArguments.push(viewOptions);getArguments.push(data);return this._data&&this._data.get.apply(this._data,getArguments)};DataView.prototype.getIds=function(options){var ids;if(this._data){var defaultFilter=this._options.filter;var filter;if(options&&options.filter){if(defaultFilter){filter=function filter(item){return defaultFilter(item)&&options.filter(item)}}else{filter=options.filter}}else{filter=defaultFilter}ids=this._data.getIds({filter:filter,order:options&&options.order})}else{ids=[]}return ids};DataView.prototype.map=function(callback,options){var mappedItems=[];if(this._data){var defaultFilter=this._options.filter;var filter;if(options&&options.filter){if(defaultFilter){filter=function filter(item){return defaultFilter(item)&&options.filter(item)}}else{filter=options.filter}}else{filter=defaultFilter}mappedItems=this._data.map(callback,{filter:filter,order:options&&options.order})}else{mappedItems=[]}return mappedItems};DataView.prototype.getDataSet=function(){var dataSet=this;while(dataSet instanceof DataView){dataSet=dataSet._data}return dataSet||null};DataView.prototype._onEvent=function(event,params,senderId){var i,len,id,item;var ids=params&&params.items;var addedIds=[],updatedIds=[],removedIds=[],oldItems=[],updatedItems=[],removedItems=[];if(ids&&this._data){switch(event){case"add":for(i=0,len=ids.length;i<len;i++){id=ids[i];item=this.get(id);if(item){this._ids[id]=true;addedIds.push(id)}}break;case"update":for(i=0,len=ids.length;i<len;i++){id=ids[i];item=this.get(id);if(item){if(this._ids[id]){updatedIds.push(id);updatedItems.push(params.data[i]);oldItems.push(params.oldData[i])}else{this._ids[id]=true;addedIds.push(id)}}else{if(this._ids[id]){delete this._ids[id];removedIds.push(id);removedItems.push(params.oldData[i])}else{}}}break;case"remove":for(i=0,len=ids.length;i<len;i++){id=ids[i];if(this._ids[id]){delete this._ids[id];removedIds.push(id);removedItems.push(params.oldData[i])}}break}this.length+=addedIds.length-removedIds.length;if(addedIds.length){this._trigger("add",{items:addedIds},senderId)}if(updatedIds.length){this._trigger("update",{items:updatedIds,oldData:oldItems,data:updatedItems},senderId)}if(removedIds.length){this._trigger("remove",{items:removedIds,oldData:removedItems},senderId)}}};DataView.prototype.on=DataSet.prototype.on;DataView.prototype.off=DataSet.prototype.off;DataView.prototype._trigger=DataSet.prototype._trigger;DataView.prototype.subscribe=DataView.prototype.on;DataView.prototype.unsubscribe=DataView.prototype.off;module.exports=DataView},{"./DataSet":6,"./util":116,"babel-runtime/core-js/object/keys":124}],8:[function(require,module,exports){"use strict";function Queue(options){this.delay=null;this.max=Infinity;this._queue=[];this._timeout=null;this._extended=null;this.setOptions(options)}Queue.prototype.setOptions=function(options){if(options&&typeof options.delay!=="undefined"){this.delay=options.delay}if(options&&typeof options.max!=="undefined"){this.max=options.max}this._flushIfNeeded()};Queue.extend=function(object,options){var queue=new Queue(options);if(object.flush!==undefined){throw new Error("Target object already has a property flush")}object.flush=function(){queue.flush()};var methods=[{name:"flush",original:undefined}];if(options&&options.replace){for(var i=0;i<options.replace.length;i++){var name=options.replace[i];methods.push({name:name,original:object[name]});queue.replace(object,name)}}queue._extended={object:object,methods:methods};return queue};Queue.prototype.destroy=function(){this.flush();if(this._extended){var object=this._extended.object;var methods=this._extended.methods;for(var i=0;i<methods.length;i++){var method=methods[i];if(method.original){object[method.name]=method.original}else{delete object[method.name]}}this._extended=null}};Queue.prototype.replace=function(object,method){var me=this;var original=object[method];if(!original){throw new Error("Method "+method+" undefined")}object[method]=function(){var args=[];for(var i=0;i<arguments.length;i++){args[i]=arguments[i]}me.queue({args:args,fn:original,context:this})}};Queue.prototype.queue=function(entry){if(typeof entry==="function"){this._queue.push({fn:entry})}else{this._queue.push(entry)}this._flushIfNeeded()};Queue.prototype._flushIfNeeded=function(){if(this._queue.length>this.max){this.flush()}clearTimeout(this._timeout);if(this.queue.length>0&&typeof this.delay==="number"){var me=this;this._timeout=setTimeout(function(){me.flush()},this.delay)}};Queue.prototype.flush=function(){while(this._queue.length>0){var entry=this._queue.shift();entry.fn.apply(entry.context||entry.fn,entry.args||[])}};module.exports=Queue},{}],9:[function(require,module,exports){"use strict";var _sign=require("babel-runtime/core-js/math/sign");var _sign2=_interopRequireDefault(_sign);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Point3d=require("./Point3d");function Camera(){this.armLocation=new Point3d;this.armRotation={};this.armRotation.horizontal=0;this.armRotation.vertical=0;this.armLength=1.7;this.cameraOffset=new Point3d;this.offsetMultiplier=.6;this.cameraLocation=new Point3d;this.cameraRotation=new Point3d(.5*Math.PI,0,0);this.calculateCameraOrientation()}Camera.prototype.setOffset=function(x,y){var abs=Math.abs,sign=_sign2["default"],mul=this.offsetMultiplier,border=this.armLength*mul;if(abs(x)>border){x=sign(x)*border}if(abs(y)>border){y=sign(y)*border}this.cameraOffset.x=x;this.cameraOffset.y=y;this.calculateCameraOrientation()};Camera.prototype.getOffset=function(x,y){return this.cameraOffset};Camera.prototype.setArmLocation=function(x,y,z){this.armLocation.x=x;this.armLocation.y=y;this.armLocation.z=z;this.calculateCameraOrientation()};Camera.prototype.setArmRotation=function(horizontal,vertical){if(horizontal!==undefined){this.armRotation.horizontal=horizontal}if(vertical!==undefined){this.armRotation.vertical=vertical;if(this.armRotation.vertical<0)this.armRotation.vertical=0;if(this.armRotation.vertical>.5*Math.PI)this.armRotation.vertical=.5*Math.PI}if(horizontal!==undefined||vertical!==undefined){this.calculateCameraOrientation()}};Camera.prototype.getArmRotation=function(){var rot={};rot.horizontal=this.armRotation.horizontal;rot.vertical=this.armRotation.vertical;return rot};Camera.prototype.setArmLength=function(length){if(length===undefined)return;this.armLength=length;if(this.armLength<.71)this.armLength=.71;if(this.armLength>5)this.armLength=5;this.setOffset(this.cameraOffset.x,this.cameraOffset.y);this.calculateCameraOrientation()};Camera.prototype.getArmLength=function(){return this.armLength};Camera.prototype.getCameraLocation=function(){return this.cameraLocation};Camera.prototype.getCameraRotation=function(){return this.cameraRotation};Camera.prototype.calculateCameraOrientation=function(){this.cameraLocation.x=this.armLocation.x-this.armLength*Math.sin(this.armRotation.horizontal)*Math.cos(this.armRotation.vertical);this.cameraLocation.y=this.armLocation.y-this.armLength*Math.cos(this.armRotation.horizontal)*Math.cos(this.armRotation.vertical);this.cameraLocation.z=this.armLocation.z+this.armLength*Math.sin(this.armRotation.vertical);this.cameraRotation.x=Math.PI/2-this.armRotation.vertical;this.cameraRotation.y=0;this.cameraRotation.z=-this.armRotation.horizontal;var xa=this.cameraRotation.x;var ya=this.cameraRotation.y;var za=this.cameraRotation.z;var dx=this.cameraOffset.x;var dy=this.cameraOffset.y;var sin=Math.sin,cos=Math.cos;this.cameraLocation.x=this.cameraLocation.x+dx*cos(za)+dy*-sin(za)*cos(xa);this.cameraLocation.y=this.cameraLocation.y+dx*sin(za)+dy*cos(za)*cos(xa);this.cameraLocation.z=this.cameraLocation.z+dy*sin(xa)};module.exports=Camera},{"./Point3d":13,"babel-runtime/core-js/math/sign":120}],10:[function(require,module,exports){"use strict";var DataView=require("../DataView");function Filter(data,column,graph){this.data=data;this.column=column;this.graph=graph;this.index=undefined;this.value=undefined;this.values=graph.getDistinctValues(data.get(),this.column);this.values.sort(function(a,b){
return a>b?1:a<b?-1:0});if(this.values.length>0){this.selectValue(0)}this.dataPoints=[];this.loaded=false;this.onLoadCallback=undefined;if(graph.animationPreload){this.loaded=false;this.loadInBackground()}else{this.loaded=true}}Filter.prototype.isLoaded=function(){return this.loaded};Filter.prototype.getLoadedProgress=function(){var len=this.values.length;var i=0;while(this.dataPoints[i]){i++}return Math.round(i/len*100)};Filter.prototype.getLabel=function(){return this.graph.filterLabel};Filter.prototype.getColumn=function(){return this.column};Filter.prototype.getSelectedValue=function(){if(this.index===undefined)return undefined;return this.values[this.index]};Filter.prototype.getValues=function(){return this.values};Filter.prototype.getValue=function(index){if(index>=this.values.length)throw new Error("Index out of range");return this.values[index]};Filter.prototype._getDataPoints=function(index){if(index===undefined)index=this.index;if(index===undefined)return[];var dataPoints;if(this.dataPoints[index]){dataPoints=this.dataPoints[index]}else{var f={};f.column=this.column;f.value=this.values[index];var dataView=new DataView(this.data,{filter:function filter(item){return item[f.column]==f.value}}).get();dataPoints=this.graph._getDataPoints(dataView);this.dataPoints[index]=dataPoints}return dataPoints};Filter.prototype.setOnLoadCallback=function(callback){this.onLoadCallback=callback};Filter.prototype.selectValue=function(index){if(index>=this.values.length)throw new Error("Index out of range");this.index=index;this.value=this.values[index]};Filter.prototype.loadInBackground=function(index){if(index===undefined)index=0;var frame=this.graph.frame;if(index<this.values.length){var dataPointsTemp=this._getDataPoints(index);if(frame.progress===undefined){frame.progress=document.createElement("DIV");frame.progress.style.position="absolute";frame.progress.style.color="gray";frame.appendChild(frame.progress)}var progress=this.getLoadedProgress();frame.progress.innerHTML="Loading animation... "+progress+"%";frame.progress.style.bottom=60+"px";frame.progress.style.left=10+"px";var me=this;setTimeout(function(){me.loadInBackground(index+1)},10);this.loaded=false}else{this.loaded=true;if(frame.progress!==undefined){frame.removeChild(frame.progress);frame.progress=undefined}if(this.onLoadCallback)this.onLoadCallback()}};module.exports=Filter},{"../DataView":7}],11:[function(require,module,exports){"use strict";var Emitter=require("emitter-component");var DataSet=require("../DataSet");var DataView=require("../DataView");var util=require("../util");var Point3d=require("./Point3d");var Point2d=require("./Point2d");var Camera=require("./Camera");var Filter=require("./Filter");var Slider=require("./Slider");var StepNumber=require("./StepNumber");var Range=require("./Range");var Settings=require("./Settings");Graph3d.STYLE=Settings.STYLE;var autoByDefault=undefined;var DEFAULTS={width:"400px",height:"400px",filterLabel:"time",legendLabel:"value",xLabel:"x",yLabel:"y",zLabel:"z",xValueLabel:function xValueLabel(v){return v},yValueLabel:function yValueLabel(v){return v},zValueLabel:function zValueLabel(v){return v},showGrid:true,showPerspective:true,showShadow:false,keepAspectRatio:true,verticalRatio:.5,dotSizeRatio:.02,showAnimationControls:autoByDefault,animationInterval:1e3,animationPreload:false,animationAutoStart:autoByDefault,axisColor:"#4D4D4D",gridColor:"#D3D3D3",xCenter:"55%",yCenter:"50%",style:Graph3d.STYLE.DOT,tooltip:false,showLegend:autoByDefault,backgroundColor:autoByDefault,dataColor:{fill:"#7DC1FF",stroke:"#3267D2",strokeWidth:1},cameraPosition:{horizontal:1,vertical:.5,distance:1.7},xBarWidth:autoByDefault,yBarWidth:autoByDefault,valueMin:autoByDefault,valueMax:autoByDefault,xMin:autoByDefault,xMax:autoByDefault,xStep:autoByDefault,yMin:autoByDefault,yMax:autoByDefault,yStep:autoByDefault,zMin:autoByDefault,zMax:autoByDefault,zStep:autoByDefault};function Graph3d(container,data,options){if(!(this instanceof Graph3d)){throw new SyntaxError("Constructor must be called with the new operator")}this.containerElement=container;this.dataTable=null;this.dataPoints=null;this.create();Settings.setDefaults(DEFAULTS,this);this.colX=undefined;this.colY=undefined;this.colZ=undefined;this.colValue=undefined;this.colFilter=undefined;this.setOptions(options);if(data){this.setData(data)}}Emitter(Graph3d.prototype);Graph3d.prototype._setScale=function(){this.scale=new Point3d(1/this.xRange.range(),1/this.yRange.range(),1/this.zRange.range());if(this.keepAspectRatio){if(this.scale.x<this.scale.y){this.scale.y=this.scale.x}else{this.scale.x=this.scale.y}}this.scale.z*=this.verticalRatio;if(this.valueRange!==undefined){this.scale.value=1/this.valueRange.range()}var xCenter=this.xRange.center()*this.scale.x;var yCenter=this.yRange.center()*this.scale.y;var zCenter=this.zRange.center()*this.scale.z;this.camera.setArmLocation(xCenter,yCenter,zCenter)};Graph3d.prototype._convert3Dto2D=function(point3d){var translation=this._convertPointToTranslation(point3d);return this._convertTranslationToScreen(translation)};Graph3d.prototype._convertPointToTranslation=function(point3d){var cameraLocation=this.camera.getCameraLocation(),cameraRotation=this.camera.getCameraRotation(),ax=point3d.x*this.scale.x,ay=point3d.y*this.scale.y,az=point3d.z*this.scale.z,cx=cameraLocation.x,cy=cameraLocation.y,cz=cameraLocation.z,sinTx=Math.sin(cameraRotation.x),cosTx=Math.cos(cameraRotation.x),sinTy=Math.sin(cameraRotation.y),cosTy=Math.cos(cameraRotation.y),sinTz=Math.sin(cameraRotation.z),cosTz=Math.cos(cameraRotation.z),dx=cosTy*(sinTz*(ay-cy)+cosTz*(ax-cx))-sinTy*(az-cz),dy=sinTx*(cosTy*(az-cz)+sinTy*(sinTz*(ay-cy)+cosTz*(ax-cx)))+cosTx*(cosTz*(ay-cy)-sinTz*(ax-cx)),dz=cosTx*(cosTy*(az-cz)+sinTy*(sinTz*(ay-cy)+cosTz*(ax-cx)))-sinTx*(cosTz*(ay-cy)-sinTz*(ax-cx));return new Point3d(dx,dy,dz)};Graph3d.prototype._convertTranslationToScreen=function(translation){var ex=this.eye.x,ey=this.eye.y,ez=this.eye.z,dx=translation.x,dy=translation.y,dz=translation.z;var bx;var by;if(this.showPerspective){bx=(dx-ex)*(ez/dz);by=(dy-ey)*(ez/dz)}else{bx=dx*-(ez/this.camera.getArmLength());by=dy*-(ez/this.camera.getArmLength())}return new Point2d(this.currentXCenter+bx*this.frame.canvas.clientWidth,this.currentYCenter-by*this.frame.canvas.clientWidth)};Graph3d.prototype._calcTranslations=function(points,sort){if(sort===undefined){sort=true}for(var i=0;i<points.length;i++){var point=points[i];point.trans=this._convertPointToTranslation(point.point);point.screen=this._convertTranslationToScreen(point.trans);var transBottom=this._convertPointToTranslation(point.bottom);point.dist=this.showPerspective?transBottom.length():-transBottom.z}if(!sort){return}var sortDepth=function sortDepth(a,b){return b.dist-a.dist};points.sort(sortDepth)};Graph3d.prototype.getNumberOfRows=function(data){return data.length};Graph3d.prototype.getNumberOfColumns=function(data){var counter=0;for(var column in data[0]){if(data[0].hasOwnProperty(column)){counter++}}return counter};Graph3d.prototype.getDistinctValues=function(data,column){var distinctValues=[];for(var i=0;i<data.length;i++){if(distinctValues.indexOf(data[i][column])==-1){distinctValues.push(data[i][column])}}return distinctValues};Graph3d.prototype.getColumnRange=function(data,column){var range=new Range;for(var i=0;i<data.length;i++){var item=data[i][column];range.adjust(item)}return range};Graph3d.prototype._checkValueField=function(data){var hasValueField=this.style===Graph3d.STYLE.BARCOLOR||this.style===Graph3d.STYLE.BARSIZE||this.style===Graph3d.STYLE.DOTCOLOR||this.style===Graph3d.STYLE.DOTSIZE;if(!hasValueField){return}if(this.colValue===undefined){throw new Error("Expected data to have "+" field 'style' "+" for graph style '"+this.style+"'")}if(data[0][this.colValue]===undefined){throw new Error("Expected data to have "+" field '"+this.colValue+"' "+" for graph style '"+this.style+"'")}};Graph3d.prototype._setRangeDefaults=function(range,defaultMin,defaultMax){if(defaultMin!==undefined){range.min=defaultMin}if(defaultMax!==undefined){range.max=defaultMax}if(range.max<=range.min)range.max=range.min+1};Graph3d.prototype._dataInitialize=function(rawData,style){var me=this;if(this.dataSet){this.dataSet.off("*",this._onChange)}if(rawData===undefined)return;if(Array.isArray(rawData)){rawData=new DataSet(rawData)}var data;if(rawData instanceof DataSet||rawData instanceof DataView){data=rawData.get()}else{throw new Error("Array, DataSet, or DataView expected")}if(data.length==0)return;this.dataSet=rawData;this.dataTable=data;this._onChange=function(){me.setData(me.dataSet)};this.dataSet.on("*",this._onChange);this.colX="x";this.colY="y";this.colZ="z";var withBars=this.style==Graph3d.STYLE.BAR||this.style==Graph3d.STYLE.BARCOLOR||this.style==Graph3d.STYLE.BARSIZE;if(withBars){if(this.defaultXBarWidth!==undefined){this.xBarWidth=this.defaultXBarWidth}else{var dataX=this.getDistinctValues(data,this.colX);this.xBarWidth=dataX[1]-dataX[0]||1}if(this.defaultYBarWidth!==undefined){this.yBarWidth=this.defaultYBarWidth}else{var dataY=this.getDistinctValues(data,this.colY);this.yBarWidth=dataY[1]-dataY[0]||1}}var NUMSTEPS=5;var xRange=this.getColumnRange(data,this.colX);if(withBars){xRange.expand(this.xBarWidth/2)}this._setRangeDefaults(xRange,this.defaultXMin,this.defaultXMax);this.xRange=xRange;this.xStep=this.defaultXStep!==undefined?this.defaultXStep:xRange.range()/NUMSTEPS;var yRange=this.getColumnRange(data,this.colY);if(withBars){yRange.expand(this.yBarWidth/2)}this._setRangeDefaults(yRange,this.defaultYMin,this.defaultYMax);this.yRange=yRange;this.yStep=this.defaultYStep!==undefined?this.defaultYStep:yRange.range()/NUMSTEPS;var zRange=this.getColumnRange(data,this.colZ);this._setRangeDefaults(zRange,this.defaultZMin,this.defaultZMax);this.zRange=zRange;this.zStep=this.defaultZStep!==undefined?this.defaultZStep:zRange.range()/NUMSTEPS;if(data[0].hasOwnProperty("style")){this.colValue="style";var valueRange=this.getColumnRange(data,this.colValue);this._setRangeDefaults(valueRange,this.defaultValueMin,this.defaultValueMax);this.valueRange=valueRange}if(data[0].hasOwnProperty("filter")){this.colFilter="filter";if(this.dataFilter===undefined){this.dataFilter=new Filter(rawData,this.colFilter,this);this.dataFilter.setOnLoadCallback(function(){me.redraw()})}}this._setScale()};Graph3d.prototype._getDataPoints=function(data){var x,y,i,z,obj,point;var dataPoints=[];if(this.style===Graph3d.STYLE.GRID||this.style===Graph3d.STYLE.SURFACE){var dataX=[];var dataY=[];for(i=0;i<this.getNumberOfRows(data);i++){x=data[i][this.colX]||0;y=data[i][this.colY]||0;if(dataX.indexOf(x)===-1){dataX.push(x)}if(dataY.indexOf(y)===-1){dataY.push(y)}}var sortNumber=function sortNumber(a,b){return a-b};dataX.sort(sortNumber);dataY.sort(sortNumber);var dataMatrix=[];for(i=0;i<data.length;i++){x=data[i][this.colX]||0;y=data[i][this.colY]||0;z=data[i][this.colZ]||0;var xIndex=dataX.indexOf(x);var yIndex=dataY.indexOf(y);if(dataMatrix[xIndex]===undefined){dataMatrix[xIndex]=[]}var point3d=new Point3d;point3d.x=x;point3d.y=y;point3d.z=z;point3d.data=data[i];obj={};obj.point=point3d;obj.trans=undefined;obj.screen=undefined;obj.bottom=new Point3d(x,y,this.zRange.min);dataMatrix[xIndex][yIndex]=obj;dataPoints.push(obj)}for(x=0;x<dataMatrix.length;x++){for(y=0;y<dataMatrix[x].length;y++){if(dataMatrix[x][y]){dataMatrix[x][y].pointRight=x<dataMatrix.length-1?dataMatrix[x+1][y]:undefined;dataMatrix[x][y].pointTop=y<dataMatrix[x].length-1?dataMatrix[x][y+1]:undefined;dataMatrix[x][y].pointCross=x<dataMatrix.length-1&&y<dataMatrix[x].length-1?dataMatrix[x+1][y+1]:undefined}}}}else{this._checkValueField(data);for(i=0;i<data.length;i++){point=new Point3d;point.x=data[i][this.colX]||0;point.y=data[i][this.colY]||0;point.z=data[i][this.colZ]||0;point.data=data[i];if(this.colValue!==undefined){point.value=data[i][this.colValue]||0}obj={};obj.point=point;obj.bottom=new Point3d(point.x,point.y,this.zRange.min);obj.trans=undefined;obj.screen=undefined;if(this.style===Graph3d.STYLE.LINE){if(i>0){dataPoints[i-1].pointNext=obj}}dataPoints.push(obj)}}return dataPoints};Graph3d.prototype.create=function(){while(this.containerElement.hasChildNodes()){this.containerElement.removeChild(this.containerElement.firstChild)}this.frame=document.createElement("div");this.frame.style.position="relative";this.frame.style.overflow="hidden";this.frame.canvas=document.createElement("canvas");this.frame.canvas.style.position="relative";this.frame.appendChild(this.frame.canvas);{var noCanvas=document.createElement("DIV");noCanvas.style.color="red";noCanvas.style.fontWeight="bold";noCanvas.style.padding="10px";noCanvas.innerHTML="Error: your browser does not support HTML canvas";this.frame.canvas.appendChild(noCanvas)}this.frame.filter=document.createElement("div");this.frame.filter.style.position="absolute";this.frame.filter.style.bottom="0px";this.frame.filter.style.left="0px";this.frame.filter.style.width="100%";this.frame.appendChild(this.frame.filter);var me=this;var onmousedown=function onmousedown(event){me._onMouseDown(event)};var ontouchstart=function ontouchstart(event){me._onTouchStart(event)};var onmousewheel=function onmousewheel(event){me._onWheel(event)};var ontooltip=function ontooltip(event){me._onTooltip(event)};var onclick=function onclick(event){me._onClick(event)};util.addEventListener(this.frame.canvas,"keydown",onkeydown);util.addEventListener(this.frame.canvas,"mousedown",onmousedown);util.addEventListener(this.frame.canvas,"touchstart",ontouchstart);util.addEventListener(this.frame.canvas,"mousewheel",onmousewheel);util.addEventListener(this.frame.canvas,"mousemove",ontooltip);util.addEventListener(this.frame.canvas,"click",onclick);this.containerElement.appendChild(this.frame)};Graph3d.prototype._setSize=function(width,height){this.frame.style.width=width;this.frame.style.height=height;this._resizeCanvas()};Graph3d.prototype._resizeCanvas=function(){this.frame.canvas.style.width="100%";this.frame.canvas.style.height="100%";this.frame.canvas.width=this.frame.canvas.clientWidth;this.frame.canvas.height=this.frame.canvas.clientHeight;this.frame.filter.style.width=this.frame.canvas.clientWidth-2*10+"px"};Graph3d.prototype.animationStart=function(){if(!this.frame.filter||!this.frame.filter.slider)throw new Error("No animation available");this.frame.filter.slider.play()};Graph3d.prototype.animationStop=function(){if(!this.frame.filter||!this.frame.filter.slider)return;this.frame.filter.slider.stop()};Graph3d.prototype._resizeCenter=function(){if(this.xCenter.charAt(this.xCenter.length-1)==="%"){this.currentXCenter=parseFloat(this.xCenter)/100*this.frame.canvas.clientWidth}else{this.currentXCenter=parseFloat(this.xCenter)}if(this.yCenter.charAt(this.yCenter.length-1)==="%"){this.currentYCenter=parseFloat(this.yCenter)/100*(this.frame.canvas.clientHeight-this.frame.filter.clientHeight)}else{this.currentYCenter=parseFloat(this.yCenter)}};Graph3d.prototype.getCameraPosition=function(){var pos=this.camera.getArmRotation();pos.distance=this.camera.getArmLength();return pos};Graph3d.prototype._readData=function(data){this._dataInitialize(data,this.style);if(this.dataFilter){this.dataPoints=this.dataFilter._getDataPoints()}else{this.dataPoints=this._getDataPoints(this.dataTable)}this._redrawFilter()};Graph3d.prototype.setData=function(data){this._readData(data);this.redraw();if(this.animationAutoStart&&this.dataFilter){this.animationStart()}};Graph3d.prototype.setOptions=function(options){var cameraPosition=undefined;this.animationStop();Settings.setOptions(options,this);this.setPointDrawingMethod();this._setSize(this.width,this.height);if(this.dataTable){this.setData(this.dataTable)}if(this.animationAutoStart&&this.dataFilter){this.animationStart()}};Graph3d.prototype.setPointDrawingMethod=function(){var method=undefined;switch(this.style){case Graph3d.STYLE.BAR:method=Graph3d.prototype._redrawBarGraphPoint;break;case Graph3d.STYLE.BARCOLOR:method=Graph3d.prototype._redrawBarColorGraphPoint;break;case Graph3d.STYLE.BARSIZE:method=Graph3d.prototype._redrawBarSizeGraphPoint;break;case Graph3d.STYLE.DOT:method=Graph3d.prototype._redrawDotGraphPoint;break;case Graph3d.STYLE.DOTLINE:method=Graph3d.prototype._redrawDotLineGraphPoint;break;case Graph3d.STYLE.DOTCOLOR:method=Graph3d.prototype._redrawDotColorGraphPoint;break;case Graph3d.STYLE.DOTSIZE:method=Graph3d.prototype._redrawDotSizeGraphPoint;break;case Graph3d.STYLE.SURFACE:method=Graph3d.prototype._redrawSurfaceGraphPoint;break;case Graph3d.STYLE.GRID:method=Graph3d.prototype._redrawGridGraphPoint;break;case Graph3d.STYLE.LINE:method=Graph3d.prototype._redrawLineGraphPoint;break;default:throw new Error("Can not determine point drawing method "+"for graph style '"+this.style+"'");break}this._pointDrawingMethod=method};Graph3d.prototype.redraw=function(){if(this.dataPoints===undefined){throw new Error("Graph data not initialized")}this._resizeCanvas();this._resizeCenter();this._redrawSlider();this._redrawClear();this._redrawAxis();this._redrawDataGraph();this._redrawInfo();this._redrawLegend()};Graph3d.prototype._getContext=function(){var canvas=this.frame.canvas;var ctx=canvas.getContext("2d");ctx.lineJoin="round";ctx.lineCap="round";return ctx};Graph3d.prototype._redrawClear=function(){var canvas=this.frame.canvas;var ctx=canvas.getContext("2d");ctx.clearRect(0,0,canvas.width,canvas.height)};Graph3d.prototype._dotSize=function(){return this.frame.clientWidth*this.dotSizeRatio};Graph3d.prototype._getLegendWidth=function(){var width;if(this.style===Graph3d.STYLE.DOTSIZE){var dotSize=this._dotSize();width=dotSize/2+dotSize*2}else if(this.style===Graph3d.STYLE.BARSIZE){width=this.xBarWidth}else{width=20}return width};Graph3d.prototype._redrawLegend=function(){if(this.showLegend!==true){return}if(this.style===Graph3d.STYLE.LINE||this.style===Graph3d.STYLE.BARSIZE){return}var isSizeLegend=this.style===Graph3d.STYLE.BARSIZE||this.style===Graph3d.STYLE.DOTSIZE;var isValueLegend=this.style===Graph3d.STYLE.DOTSIZE||this.style===Graph3d.STYLE.DOTCOLOR||this.style===Graph3d.STYLE.BARCOLOR;var height=Math.max(this.frame.clientHeight*.25,100);var top=this.margin;var width=this._getLegendWidth();var right=this.frame.clientWidth-this.margin;var left=right-width;var bottom=top+height;var ctx=this._getContext();ctx.lineWidth=1;ctx.font="14px arial";if(isSizeLegend===false){var ymin=0;var ymax=height;var y;for(y=ymin;y<ymax;y++){var f=(y-ymin)/(ymax-ymin);var hue=f*240;var color=this._hsv2rgb(hue,1,1);ctx.strokeStyle=color;ctx.beginPath();ctx.moveTo(left,top+y);ctx.lineTo(right,top+y);ctx.stroke()}ctx.strokeStyle=this.axisColor;ctx.strokeRect(left,top,width,height)}else{var widthMin;if(this.style===Graph3d.STYLE.DOTSIZE){var dotSize=this._dotSize();widthMin=dotSize/2}else if(this.style===Graph3d.STYLE.BARSIZE){}ctx.strokeStyle=this.axisColor;ctx.fillStyle=this.dataColor.fill;ctx.beginPath();ctx.moveTo(left,top);ctx.lineTo(right,top);ctx.lineTo(right-width+widthMin,bottom);ctx.lineTo(left,bottom);ctx.closePath();ctx.fill();ctx.stroke()}var gridLineLen=5;var legendMin=isValueLegend?this.valueRange.min:this.zRange.min;var legendMax=isValueLegend?this.valueRange.max:this.zRange.max;var step=new StepNumber(legendMin,legendMax,(legendMax-legendMin)/5,true);step.start(true);var y;var from;var to;while(!step.end()){y=bottom-(step.getCurrent()-legendMin)/(legendMax-legendMin)*height;from=new Point2d(left-gridLineLen,y);to=new Point2d(left,y);this._line(ctx,from,to);ctx.textAlign="right";ctx.textBaseline="middle";ctx.fillStyle=this.axisColor;ctx.fillText(step.getCurrent(),left-2*gridLineLen,y);step.next()}ctx.textAlign="right";ctx.textBaseline="top";var label=this.legendLabel;ctx.fillText(label,right,bottom+this.margin)};Graph3d.prototype._redrawFilter=function(){this.frame.filter.innerHTML="";if(this.dataFilter){var options={visible:this.showAnimationControls};var slider=new Slider(this.frame.filter,options);this.frame.filter.slider=slider;this.frame.filter.style.padding="10px";slider.setValues(this.dataFilter.values);slider.setPlayInterval(this.animationInterval);var me=this;var onchange=function onchange(){var index=slider.getIndex();me.dataFilter.selectValue(index);me.dataPoints=me.dataFilter._getDataPoints();me.redraw()};slider.setOnChangeCallback(onchange)}else{this.frame.filter.slider=undefined}};Graph3d.prototype._redrawSlider=function(){if(this.frame.filter.slider!==undefined){this.frame.filter.slider.redraw()}};Graph3d.prototype._redrawInfo=function(){if(this.dataFilter){var ctx=this._getContext();ctx.font="14px arial";ctx.lineStyle="gray";ctx.fillStyle="gray";ctx.textAlign="left";ctx.textBaseline="top";var x=this.margin;var y=this.margin;ctx.fillText(this.dataFilter.getLabel()+": "+this.dataFilter.getSelectedValue(),x,y)}};Graph3d.prototype._line=function(ctx,from,to,strokeStyle){if(strokeStyle!==undefined){ctx.strokeStyle=strokeStyle}ctx.beginPath();ctx.moveTo(from.x,from.y);ctx.lineTo(to.x,to.y);ctx.stroke()};Graph3d.prototype.drawAxisLabelX=function(ctx,point3d,text,armAngle,yMargin){if(yMargin===undefined){yMargin=0}var point2d=this._convert3Dto2D(point3d);if(Math.cos(armAngle*2)>0){ctx.textAlign="center";ctx.textBaseline="top";point2d.y+=yMargin}else if(Math.sin(armAngle*2)<0){ctx.textAlign="right";ctx.textBaseline="middle"}else{ctx.textAlign="left";ctx.textBaseline="middle"}ctx.fillStyle=this.axisColor;ctx.fillText(text,point2d.x,point2d.y)};Graph3d.prototype.drawAxisLabelY=function(ctx,point3d,text,armAngle,yMargin){if(yMargin===undefined){yMargin=0}var point2d=this._convert3Dto2D(point3d);if(Math.cos(armAngle*2)<0){ctx.textAlign="center";ctx.textBaseline="top";point2d.y+=yMargin}else if(Math.sin(armAngle*2)>0){ctx.textAlign="right";ctx.textBaseline="middle"}else{ctx.textAlign="left";ctx.textBaseline="middle"}ctx.fillStyle=this.axisColor;ctx.fillText(text,point2d.x,point2d.y)};Graph3d.prototype.drawAxisLabelZ=function(ctx,point3d,text,offset){if(offset===undefined){offset=0}var point2d=this._convert3Dto2D(point3d);ctx.textAlign="right";ctx.textBaseline="middle";ctx.fillStyle=this.axisColor;ctx.fillText(text,point2d.x-offset,point2d.y)};Graph3d.prototype._line3d=function(ctx,from,to,strokeStyle){var from2d=this._convert3Dto2D(from);var to2d=this._convert3Dto2D(to);this._line(ctx,from2d,to2d,strokeStyle)};Graph3d.prototype._redrawAxis=function(){var ctx=this._getContext(),from,to,step,prettyStep,text,xText,yText,zText,offset,xOffset,yOffset;ctx.font=24/this.camera.getArmLength()+"px arial";var gridLenX=.025/this.scale.x;var gridLenY=.025/this.scale.y;var textMargin=5/this.camera.getArmLength();var armAngle=this.camera.getArmRotation().horizontal;var armVector=new Point2d(Math.cos(armAngle),Math.sin(armAngle));var xRange=this.xRange;var yRange=this.yRange;var zRange=this.zRange;ctx.lineWidth=1;prettyStep=this.defaultXStep===undefined;step=new StepNumber(xRange.min,xRange.max,this.xStep,prettyStep);step.start(true);while(!step.end()){var x=step.getCurrent();if(this.showGrid){from=new Point3d(x,yRange.min,zRange.min);to=new Point3d(x,yRange.max,zRange.min);this._line3d(ctx,from,to,this.gridColor)}else{from=new Point3d(x,yRange.min,zRange.min);to=new Point3d(x,yRange.min+gridLenX,zRange.min);this._line3d(ctx,from,to,this.axisColor);from=new Point3d(x,yRange.max,zRange.min);to=new Point3d(x,yRange.max-gridLenX,zRange.min);this._line3d(ctx,from,to,this.axisColor)}yText=armVector.x>0?yRange.min:yRange.max;var point3d=new Point3d(x,yText,zRange.min);var msg="  "+this.xValueLabel(x)+"  ";this.drawAxisLabelX(ctx,point3d,msg,armAngle,textMargin);step.next()}ctx.lineWidth=1;prettyStep=this.defaultYStep===undefined;step=new StepNumber(yRange.min,yRange.max,this.yStep,prettyStep);step.start(true);while(!step.end()){var y=step.getCurrent();if(this.showGrid){from=new Point3d(xRange.min,y,zRange.min);to=new Point3d(xRange.max,y,zRange.min);this._line3d(ctx,from,to,this.gridColor)}else{from=new Point3d(xRange.min,y,zRange.min);to=new Point3d(xRange.min+gridLenY,y,zRange.min);this._line3d(ctx,from,to,this.axisColor);from=new Point3d(xRange.max,y,zRange.min);to=new Point3d(xRange.max-gridLenY,y,zRange.min);this._line3d(ctx,from,to,this.axisColor)}xText=armVector.y>0?xRange.min:xRange.max;point3d=new Point3d(xText,y,zRange.min);var msg="  "+this.yValueLabel(y)+"  ";this.drawAxisLabelY(ctx,point3d,msg,armAngle,textMargin);step.next()}ctx.lineWidth=1;prettyStep=this.defaultZStep===undefined;step=new StepNumber(zRange.min,zRange.max,this.zStep,prettyStep);step.start(true);xText=armVector.x>0?xRange.min:xRange.max;yText=armVector.y<0?yRange.min:yRange.max;while(!step.end()){var z=step.getCurrent();var from3d=new Point3d(xText,yText,z);var from2d=this._convert3Dto2D(from3d);to=new Point2d(from2d.x-textMargin,from2d.y);this._line(ctx,from2d,to,this.axisColor);var msg=this.zValueLabel(z)+" ";this.drawAxisLabelZ(ctx,from3d,msg,5);step.next()}ctx.lineWidth=1;from=new Point3d(xText,yText,zRange.min);to=new Point3d(xText,yText,zRange.max);this._line3d(ctx,from,to,this.axisColor);var xMin2d;var xMax2d;ctx.lineWidth=1;xMin2d=new Point3d(xRange.min,yRange.min,zRange.min);xMax2d=new Point3d(xRange.max,yRange.min,zRange.min);this._line3d(ctx,xMin2d,xMax2d,this.axisColor);xMin2d=new Point3d(xRange.min,yRange.max,zRange.min);xMax2d=new Point3d(xRange.max,yRange.max,zRange.min);this._line3d(ctx,xMin2d,xMax2d,this.axisColor);ctx.lineWidth=1;from=new Point3d(xRange.min,yRange.min,zRange.min);to=new Point3d(xRange.min,yRange.max,zRange.min);this._line3d(ctx,from,to,this.axisColor);from=new Point3d(xRange.max,yRange.min,zRange.min);to=new Point3d(xRange.max,yRange.max,zRange.min);this._line3d(ctx,from,to,this.axisColor);var xLabel=this.xLabel;if(xLabel.length>0){yOffset=.1/this.scale.y;xText=(xRange.max+3*xRange.min)/4;yText=armVector.x>0?yRange.min-yOffset:yRange.max+yOffset;text=new Point3d(xText,yText,zRange.min);this.drawAxisLabelX(ctx,text,xLabel,armAngle)}var yLabel=this.yLabel;if(yLabel.length>0){xOffset=.1/this.scale.x;xText=armVector.y>0?xRange.min-xOffset:xRange.max+xOffset;yText=(yRange.max+3*yRange.min)/4;text=new Point3d(xText,yText,zRange.min);this.drawAxisLabelY(ctx,text,yLabel,armAngle)}var zLabel=this.zLabel;if(zLabel.length>0){offset=30;xText=armVector.x>0?xRange.min:xRange.max;yText=armVector.y<0?yRange.min:yRange.max;zText=(zRange.max+3*zRange.min)/4;text=new Point3d(xText,yText,zText);this.drawAxisLabelZ(ctx,text,zLabel,offset)}};Graph3d.prototype._hsv2rgb=function(H,S,V){var R,G,B,C,Hi,X;C=V*S;Hi=Math.floor(H/60);X=C*(1-Math.abs(H/60%2-1));switch(Hi){case 0:R=C;G=X;B=0;break;case 1:R=X;G=C;B=0;break;case 2:R=0;G=C;B=X;break;case 3:R=0;G=X;B=C;break;case 4:R=X;G=0;B=C;break;case 5:R=C;G=0;B=X;break;default:R=0;G=0;B=0;break}return"RGB("+parseInt(R*255)+","+parseInt(G*255)+","+parseInt(B*255)+")"};Graph3d.prototype._getStrokeWidth=function(point){if(point!==undefined){if(this.showPerspective){return 1/-point.trans.z*this.dataColor.strokeWidth}else{return-(this.eye.z/this.camera.getArmLength())*this.dataColor.strokeWidth}}return this.dataColor.strokeWidth};Graph3d.prototype._redrawBar=function(ctx,point,xWidth,yWidth,color,borderColor){var i,j,surface;var me=this;var point3d=point.point;var zMin=this.zRange.min;var top=[{point:new Point3d(point3d.x-xWidth,point3d.y-yWidth,point3d.z)},{point:new Point3d(point3d.x+xWidth,point3d.y-yWidth,point3d.z)},{point:new Point3d(point3d.x+xWidth,point3d.y+yWidth,point3d.z)},{point:new Point3d(point3d.x-xWidth,point3d.y+yWidth,point3d.z)}];var bottom=[{point:new Point3d(point3d.x-xWidth,point3d.y-yWidth,zMin)},{point:new Point3d(point3d.x+xWidth,point3d.y-yWidth,zMin)},{point:new Point3d(point3d.x+xWidth,point3d.y+yWidth,zMin)},{point:new Point3d(point3d.x-xWidth,point3d.y+yWidth,zMin)}];top.forEach(function(obj){obj.screen=me._convert3Dto2D(obj.point)});bottom.forEach(function(obj){obj.screen=me._convert3Dto2D(obj.point)});var surfaces=[{corners:top,center:Point3d.avg(bottom[0].point,bottom[2].point)},{corners:[top[0],top[1],bottom[1],bottom[0]],center:Point3d.avg(bottom[1].point,bottom[0].point)},{corners:[top[1],top[2],bottom[2],bottom[1]],center:Point3d.avg(bottom[2].point,bottom[1].point)},{corners:[top[2],top[3],bottom[3],bottom[2]],center:Point3d.avg(bottom[3].point,bottom[2].point)},{corners:[top[3],top[0],bottom[0],bottom[3]],center:Point3d.avg(bottom[0].point,bottom[3].point)}];point.surfaces=surfaces;for(j=0;j<surfaces.length;j++){surface=surfaces[j];var transCenter=this._convertPointToTranslation(surface.center);surface.dist=this.showPerspective?transCenter.length():-transCenter.z}surfaces.sort(function(a,b){var diff=b.dist-a.dist;if(diff)return diff;if(a.corners===top)return 1;if(b.corners===top)return-1;return 0});ctx.lineWidth=this._getStrokeWidth(point);ctx.strokeStyle=borderColor;ctx.fillStyle=color;for(j=2;j<surfaces.length;j++){surface=surfaces[j];this._polygon(ctx,surface.corners)}};Graph3d.prototype._polygon=function(ctx,points,fillStyle,strokeStyle){if(points.length<2){return}if(fillStyle!==undefined){ctx.fillStyle=fillStyle}if(strokeStyle!==undefined){ctx.strokeStyle=strokeStyle}ctx.beginPath();ctx.moveTo(points[0].screen.x,points[0].screen.y);for(var i=1;i<points.length;++i){var point=points[i];ctx.lineTo(point.screen.x,point.screen.y)}ctx.closePath();ctx.fill();ctx.stroke()};Graph3d.prototype._drawCircle=function(ctx,point,color,borderColor,size){var radius=this._calcRadius(point,size);ctx.lineWidth=this._getStrokeWidth(point);ctx.strokeStyle=borderColor;ctx.fillStyle=color;ctx.beginPath();ctx.arc(point.screen.x,point.screen.y,radius,0,Math.PI*2,true);ctx.fill();ctx.stroke()};Graph3d.prototype._getColorsRegular=function(point){var hue=(1-(point.point.z-this.zRange.min)*this.scale.z/this.verticalRatio)*240;var color=this._hsv2rgb(hue,1,1);var borderColor=this._hsv2rgb(hue,1,.8);return{fill:color,border:borderColor}};Graph3d.prototype._getColorsColor=function(point){var color,borderColor;if(typeof point.point.value==="string"){color=point.point.value;borderColor=point.point.value}else{var hue=(1-(point.point.value-this.valueRange.min)*this.scale.value)*240;color=this._hsv2rgb(hue,1,1);borderColor=this._hsv2rgb(hue,1,.8)}return{fill:color,border:borderColor}};Graph3d.prototype._getColorsSize=function(){return{fill:this.dataColor.fill,border:this.dataColor.stroke}};Graph3d.prototype._calcRadius=function(point,size){if(size===undefined){size=this._dotSize()}var radius;if(this.showPerspective){radius=size/-point.trans.z}else{radius=size*-(this.eye.z/this.camera.getArmLength())}if(radius<0){radius=0}return radius};Graph3d.prototype._redrawBarGraphPoint=function(ctx,point){var xWidth=this.xBarWidth/2;var yWidth=this.yBarWidth/2;var colors=this._getColorsRegular(point);this._redrawBar(ctx,point,xWidth,yWidth,colors.fill,colors.border)};Graph3d.prototype._redrawBarColorGraphPoint=function(ctx,point){var xWidth=this.xBarWidth/2;var yWidth=this.yBarWidth/2;var colors=this._getColorsColor(point);this._redrawBar(ctx,point,xWidth,yWidth,colors.fill,colors.border)};Graph3d.prototype._redrawBarSizeGraphPoint=function(ctx,point){var fraction=(point.point.value-this.valueRange.min)/this.valueRange.range();var xWidth=this.xBarWidth/2*(fraction*.8+.2);var yWidth=this.yBarWidth/2*(fraction*.8+.2);var colors=this._getColorsSize();this._redrawBar(ctx,point,xWidth,yWidth,colors.fill,colors.border)};Graph3d.prototype._redrawDotGraphPoint=function(ctx,point){var colors=this._getColorsRegular(point);this._drawCircle(ctx,point,colors.fill,colors.border)};Graph3d.prototype._redrawDotLineGraphPoint=function(ctx,point){var from=this._convert3Dto2D(point.bottom);ctx.lineWidth=1;this._line(ctx,from,point.screen,this.gridColor);this._redrawDotGraphPoint(ctx,point)};Graph3d.prototype._redrawDotColorGraphPoint=function(ctx,point){var colors=this._getColorsColor(point);this._drawCircle(ctx,point,colors.fill,colors.border)};Graph3d.prototype._redrawDotSizeGraphPoint=function(ctx,point){var dotSize=this._dotSize();var fraction=(point.point.value-this.valueRange.min)/this.valueRange.range();var size=dotSize/2+2*dotSize*fraction;var colors=this._getColorsSize();
this._drawCircle(ctx,point,colors.fill,colors.border,size)};Graph3d.prototype._redrawSurfaceGraphPoint=function(ctx,point){var right=point.pointRight;var top=point.pointTop;var cross=point.pointCross;if(point===undefined||right===undefined||top===undefined||cross===undefined){return}var topSideVisible=true;var fillStyle;var strokeStyle;var lineWidth;if(this.showGrayBottom||this.showShadow){var aDiff=Point3d.subtract(cross.trans,point.trans);var bDiff=Point3d.subtract(top.trans,right.trans);var crossproduct=Point3d.crossProduct(aDiff,bDiff);var len=crossproduct.length();topSideVisible=crossproduct.z>0}if(topSideVisible){var zAvg=(point.point.z+right.point.z+top.point.z+cross.point.z)/4;var h=(1-(zAvg-this.zRange.min)*this.scale.z/this.verticalRatio)*240;var s=1;var v;if(this.showShadow){v=Math.min(1+crossproduct.x/len/2,1);fillStyle=this._hsv2rgb(h,s,v);strokeStyle=fillStyle}else{v=1;fillStyle=this._hsv2rgb(h,s,v);strokeStyle=this.axisColor}}else{fillStyle="gray";strokeStyle=this.axisColor}ctx.lineWidth=this._getStrokeWidth(point);var points=[point,right,cross,top];this._polygon(ctx,points,fillStyle,strokeStyle)};Graph3d.prototype._drawGridLine=function(ctx,from,to){if(from===undefined||to===undefined){return}var zAvg=(from.point.z+to.point.z)/2;var h=(1-(zAvg-this.zRange.min)*this.scale.z/this.verticalRatio)*240;ctx.lineWidth=this._getStrokeWidth(from)*2;ctx.strokeStyle=this._hsv2rgb(h,1,1);this._line(ctx,from.screen,to.screen)};Graph3d.prototype._redrawGridGraphPoint=function(ctx,point){this._drawGridLine(ctx,point,point.pointRight);this._drawGridLine(ctx,point,point.pointTop)};Graph3d.prototype._redrawLineGraphPoint=function(ctx,point){if(point.pointNext===undefined){return}ctx.lineWidth=this._getStrokeWidth(point);ctx.strokeStyle=this.dataColor.stroke;this._line(ctx,point.screen,point.pointNext.screen)};Graph3d.prototype._redrawDataGraph=function(){var ctx=this._getContext();var i;if(this.dataPoints===undefined||this.dataPoints.length<=0)return;this._calcTranslations(this.dataPoints);for(i=0;i<this.dataPoints.length;i++){var point=this.dataPoints[i];this._pointDrawingMethod.call(this,ctx,point)}};Graph3d.prototype._storeMousePosition=function(event){this.startMouseX=getMouseX(event);this.startMouseY=getMouseY(event);this._startCameraOffset=this.camera.getOffset()};Graph3d.prototype._onMouseDown=function(event){event=event||window.event;if(this.leftButtonDown){this._onMouseUp(event)}this.leftButtonDown=event.which?event.which===1:event.button===1;if(!this.leftButtonDown&&!this.touchDown)return;this._storeMousePosition(event);this.startStart=new Date(this.start);this.startEnd=new Date(this.end);this.startArmRotation=this.camera.getArmRotation();this.frame.style.cursor="move";var me=this;this.onmousemove=function(event){me._onMouseMove(event)};this.onmouseup=function(event){me._onMouseUp(event)};util.addEventListener(document,"mousemove",me.onmousemove);util.addEventListener(document,"mouseup",me.onmouseup);util.preventDefault(event)};Graph3d.prototype._onMouseMove=function(event){this.moving=true;event=event||window.event;var diffX=parseFloat(getMouseX(event))-this.startMouseX;var diffY=parseFloat(getMouseY(event))-this.startMouseY;if(event&&event.ctrlKey===true){var scaleX=this.frame.clientWidth*.5;var scaleY=this.frame.clientHeight*.5;var offXNew=(this._startCameraOffset.x||0)-diffX/scaleX*this.camera.armLength*.8;var offYNew=(this._startCameraOffset.y||0)+diffY/scaleY*this.camera.armLength*.8;this.camera.setOffset(offXNew,offYNew);this._storeMousePosition(event)}else{var horizontalNew=this.startArmRotation.horizontal+diffX/200;var verticalNew=this.startArmRotation.vertical+diffY/200;var snapAngle=4;var snapValue=Math.sin(snapAngle/360*2*Math.PI);if(Math.abs(Math.sin(horizontalNew))<snapValue){horizontalNew=Math.round(horizontalNew/Math.PI)*Math.PI-.001}if(Math.abs(Math.cos(horizontalNew))<snapValue){horizontalNew=(Math.round(horizontalNew/Math.PI-.5)+.5)*Math.PI-.001}if(Math.abs(Math.sin(verticalNew))<snapValue){verticalNew=Math.round(verticalNew/Math.PI)*Math.PI}if(Math.abs(Math.cos(verticalNew))<snapValue){verticalNew=(Math.round(verticalNew/Math.PI-.5)+.5)*Math.PI}this.camera.setArmRotation(horizontalNew,verticalNew)}this.redraw();var parameters=this.getCameraPosition();this.emit("cameraPositionChange",parameters);util.preventDefault(event)};Graph3d.prototype._onMouseUp=function(event){this.frame.style.cursor="auto";this.leftButtonDown=false;util.removeEventListener(document,"mousemove",this.onmousemove);util.removeEventListener(document,"mouseup",this.onmouseup);util.preventDefault(event)};Graph3d.prototype._onClick=function(event){if(!this.onclick_callback)return;if(!this.moving){var boundingRect=this.frame.getBoundingClientRect();var mouseX=getMouseX(event)-boundingRect.left;var mouseY=getMouseY(event)-boundingRect.top;var dataPoint=this._dataPointFromXY(mouseX,mouseY);if(dataPoint)this.onclick_callback(dataPoint.point.data)}else{this.moving=false}util.preventDefault(event)};Graph3d.prototype._onTooltip=function(event){var delay=300;var boundingRect=this.frame.getBoundingClientRect();var mouseX=getMouseX(event)-boundingRect.left;var mouseY=getMouseY(event)-boundingRect.top;if(!this.showTooltip){return}if(this.tooltipTimeout){clearTimeout(this.tooltipTimeout)}if(this.leftButtonDown){this._hideTooltip();return}if(this.tooltip&&this.tooltip.dataPoint){var dataPoint=this._dataPointFromXY(mouseX,mouseY);if(dataPoint!==this.tooltip.dataPoint){if(dataPoint){this._showTooltip(dataPoint)}else{this._hideTooltip()}}}else{var me=this;this.tooltipTimeout=setTimeout(function(){me.tooltipTimeout=null;var dataPoint=me._dataPointFromXY(mouseX,mouseY);if(dataPoint){me._showTooltip(dataPoint)}},delay)}};Graph3d.prototype._onTouchStart=function(event){this.touchDown=true;var me=this;this.ontouchmove=function(event){me._onTouchMove(event)};this.ontouchend=function(event){me._onTouchEnd(event)};util.addEventListener(document,"touchmove",me.ontouchmove);util.addEventListener(document,"touchend",me.ontouchend);this._onMouseDown(event)};Graph3d.prototype._onTouchMove=function(event){this._onMouseMove(event)};Graph3d.prototype._onTouchEnd=function(event){this.touchDown=false;util.removeEventListener(document,"touchmove",this.ontouchmove);util.removeEventListener(document,"touchend",this.ontouchend);this._onMouseUp(event)};Graph3d.prototype._onWheel=function(event){if(!event)event=window.event;var delta=0;if(event.wheelDelta){delta=event.wheelDelta/120}else if(event.detail){delta=-event.detail/3}if(delta){var oldLength=this.camera.getArmLength();var newLength=oldLength*(1-delta/10);this.camera.setArmLength(newLength);this.redraw();this._hideTooltip()}var parameters=this.getCameraPosition();this.emit("cameraPositionChange",parameters);util.preventDefault(event)};Graph3d.prototype._insideTriangle=function(point,triangle){var a=triangle[0],b=triangle[1],c=triangle[2];function sign(x){return x>0?1:x<0?-1:0}var as=sign((b.x-a.x)*(point.y-a.y)-(b.y-a.y)*(point.x-a.x));var bs=sign((c.x-b.x)*(point.y-b.y)-(c.y-b.y)*(point.x-b.x));var cs=sign((a.x-c.x)*(point.y-c.y)-(a.y-c.y)*(point.x-c.x));return(as==0||bs==0||as==bs)&&(bs==0||cs==0||bs==cs)&&(as==0||cs==0||as==cs)};Graph3d.prototype._dataPointFromXY=function(x,y){var i,distMax=100,dataPoint=null,closestDataPoint=null,closestDist=null,center=new Point2d(x,y);if(this.style===Graph3d.STYLE.BAR||this.style===Graph3d.STYLE.BARCOLOR||this.style===Graph3d.STYLE.BARSIZE){for(i=this.dataPoints.length-1;i>=0;i--){dataPoint=this.dataPoints[i];var surfaces=dataPoint.surfaces;if(surfaces){for(var s=surfaces.length-1;s>=0;s--){var surface=surfaces[s];var corners=surface.corners;var triangle1=[corners[0].screen,corners[1].screen,corners[2].screen];var triangle2=[corners[2].screen,corners[3].screen,corners[0].screen];if(this._insideTriangle(center,triangle1)||this._insideTriangle(center,triangle2)){return dataPoint}}}}}else{for(i=0;i<this.dataPoints.length;i++){dataPoint=this.dataPoints[i];var point=dataPoint.screen;if(point){var distX=Math.abs(x-point.x);var distY=Math.abs(y-point.y);var dist=Math.sqrt(distX*distX+distY*distY);if((closestDist===null||dist<closestDist)&&dist<distMax){closestDist=dist;closestDataPoint=dataPoint}}}}return closestDataPoint};Graph3d.prototype._showTooltip=function(dataPoint){var content,line,dot;if(!this.tooltip){content=document.createElement("div");content.style.position="absolute";content.style.padding="10px";content.style.border="1px solid #4d4d4d";content.style.color="#1a1a1a";content.style.background="rgba(255,255,255,0.7)";content.style.borderRadius="2px";content.style.boxShadow="5px 5px 10px rgba(128,128,128,0.5)";line=document.createElement("div");line.style.position="absolute";line.style.height="40px";line.style.width="0";line.style.borderLeft="1px solid #4d4d4d";dot=document.createElement("div");dot.style.position="absolute";dot.style.height="0";dot.style.width="0";dot.style.border="5px solid #4d4d4d";dot.style.borderRadius="5px";this.tooltip={dataPoint:null,dom:{content:content,line:line,dot:dot}}}else{content=this.tooltip.dom.content;line=this.tooltip.dom.line;dot=this.tooltip.dom.dot}this._hideTooltip();this.tooltip.dataPoint=dataPoint;if(typeof this.showTooltip==="function"){content.innerHTML=this.showTooltip(dataPoint.point)}else{content.innerHTML="<table>"+"<tr><td>"+this.xLabel+":</td><td>"+dataPoint.point.x+"</td></tr>"+"<tr><td>"+this.yLabel+":</td><td>"+dataPoint.point.y+"</td></tr>"+"<tr><td>"+this.zLabel+":</td><td>"+dataPoint.point.z+"</td></tr>"+"</table>"}content.style.left="0";content.style.top="0";this.frame.appendChild(content);this.frame.appendChild(line);this.frame.appendChild(dot);var contentWidth=content.offsetWidth;var contentHeight=content.offsetHeight;var lineHeight=line.offsetHeight;var dotWidth=dot.offsetWidth;var dotHeight=dot.offsetHeight;var left=dataPoint.screen.x-contentWidth/2;left=Math.min(Math.max(left,10),this.frame.clientWidth-10-contentWidth);line.style.left=dataPoint.screen.x+"px";line.style.top=dataPoint.screen.y-lineHeight+"px";content.style.left=left+"px";content.style.top=dataPoint.screen.y-lineHeight-contentHeight+"px";dot.style.left=dataPoint.screen.x-dotWidth/2+"px";dot.style.top=dataPoint.screen.y-dotHeight/2+"px"};Graph3d.prototype._hideTooltip=function(){if(this.tooltip){this.tooltip.dataPoint=null;for(var prop in this.tooltip.dom){if(this.tooltip.dom.hasOwnProperty(prop)){var elem=this.tooltip.dom[prop];if(elem&&elem.parentNode){elem.parentNode.removeChild(elem)}}}}};function getMouseX(event){if("clientX"in event)return event.clientX;return event.targetTouches[0]&&event.targetTouches[0].clientX||0}function getMouseY(event){if("clientY"in event)return event.clientY;return event.targetTouches[0]&&event.targetTouches[0].clientY||0}Graph3d.prototype.setCameraPosition=function(pos){Settings.setCameraPosition(pos,this);this.redraw()};Graph3d.prototype.setSize=function(width,height){this._setSize(width,height);this.redraw()};module.exports=Graph3d},{"../DataSet":6,"../DataView":7,"../util":116,"./Camera":9,"./Filter":10,"./Point2d":12,"./Point3d":13,"./Range":14,"./Settings":15,"./Slider":16,"./StepNumber":17,"emitter-component":221}],12:[function(require,module,exports){"use strict";function Point2d(x,y){this.x=x!==undefined?x:0;this.y=y!==undefined?y:0}module.exports=Point2d},{}],13:[function(require,module,exports){"use strict";function Point3d(x,y,z){this.x=x!==undefined?x:0;this.y=y!==undefined?y:0;this.z=z!==undefined?z:0}Point3d.subtract=function(a,b){var sub=new Point3d;sub.x=a.x-b.x;sub.y=a.y-b.y;sub.z=a.z-b.z;return sub};Point3d.add=function(a,b){var sum=new Point3d;sum.x=a.x+b.x;sum.y=a.y+b.y;sum.z=a.z+b.z;return sum};Point3d.avg=function(a,b){return new Point3d((a.x+b.x)/2,(a.y+b.y)/2,(a.z+b.z)/2)};Point3d.crossProduct=function(a,b){var crossproduct=new Point3d;crossproduct.x=a.y*b.z-a.z*b.y;crossproduct.y=a.z*b.x-a.x*b.z;crossproduct.z=a.x*b.y-a.y*b.x;return crossproduct};Point3d.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};module.exports=Point3d},{}],14:[function(require,module,exports){"use strict";function Range(){this.min=undefined;this.max=undefined}Range.prototype.adjust=function(value){if(value===undefined)return;if(this.min===undefined||this.min>value){this.min=value}if(this.max===undefined||this.max<value){this.max=value}};Range.prototype.combine=function(range){this.add(range.min);this.add(range.max)};Range.prototype.expand=function(val){if(val===undefined){return}var newMin=this.min-val;var newMax=this.max+val;if(newMin>newMax){throw new Error("Passed expansion value makes range invalid")}this.min=newMin;this.max=newMax};Range.prototype.range=function(){return this.max-this.min};Range.prototype.center=function(){return(this.min+this.max)/2};module.exports=Range},{}],15:[function(require,module,exports){"use strict";var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Camera=require("./Camera");var Point3d=require("./Point3d");var STYLE={BAR:0,BARCOLOR:1,BARSIZE:2,DOT:3,DOTLINE:4,DOTCOLOR:5,DOTSIZE:6,GRID:7,LINE:8,SURFACE:9};var STYLENAME={dot:STYLE.DOT,"dot-line":STYLE.DOTLINE,"dot-color":STYLE.DOTCOLOR,"dot-size":STYLE.DOTSIZE,line:STYLE.LINE,grid:STYLE.GRID,surface:STYLE.SURFACE,bar:STYLE.BAR,"bar-color":STYLE.BARCOLOR,"bar-size":STYLE.BARSIZE};var OPTIONKEYS=["width","height","filterLabel","legendLabel","xLabel","yLabel","zLabel","xValueLabel","yValueLabel","zValueLabel","showGrid","showPerspective","showShadow","keepAspectRatio","verticalRatio","dotSizeRatio","showAnimationControls","animationInterval","animationPreload","animationAutoStart","axisColor","gridColor","xCenter","yCenter"];var PREFIXEDOPTIONKEYS=["xBarWidth","yBarWidth","valueMin","valueMax","xMin","xMax","xStep","yMin","yMax","yStep","zMin","zMax","zStep"];var DEFAULTS=undefined;function isEmpty(obj){for(var prop in obj){if(obj.hasOwnProperty(prop))return false}return true}function capitalize(str){if(str===undefined||str===""||typeof str!="string"){return str}return str.charAt(0).toUpperCase()+str.slice(1)}function prefixFieldName(prefix,fieldName){if(prefix===undefined||prefix===""){return fieldName}return prefix+capitalize(fieldName)}function forceCopy(src,dst,fields,prefix){var srcKey;var dstKey;for(var i in fields){srcKey=fields[i];dstKey=prefixFieldName(prefix,srcKey);dst[dstKey]=src[srcKey]}}function safeCopy(src,dst,fields,prefix){var srcKey;var dstKey;for(var i in fields){srcKey=fields[i];if(src[srcKey]===undefined)continue;dstKey=prefixFieldName(prefix,srcKey);dst[dstKey]=src[srcKey]}}function setDefaults(src,dst){if(src===undefined||isEmpty(src)){throw new Error("No DEFAULTS passed")}if(dst===undefined){throw new Error("No dst passed")}DEFAULTS=src;forceCopy(src,dst,OPTIONKEYS);forceCopy(src,dst,PREFIXEDOPTIONKEYS,"default");setSpecialSettings(src,dst);dst.margin=10;dst.showGrayBottom=false;dst.showTooltip=false;dst.onclick_callback=null;dst.eye=new Point3d(0,0,-1)}function setOptions(options,dst){if(options===undefined){return}if(dst===undefined){throw new Error("No dst passed")}if(DEFAULTS===undefined||isEmpty(DEFAULTS)){throw new Error("DEFAULTS not set for module Settings")}safeCopy(options,dst,OPTIONKEYS);safeCopy(options,dst,PREFIXEDOPTIONKEYS,"default");setSpecialSettings(options,dst)}function setSpecialSettings(src,dst){if(src.backgroundColor!==undefined){setBackgroundColor(src.backgroundColor,dst)}setDataColor(src.dataColor,dst);setStyle(src.style,dst);setShowLegend(src.showLegend,dst);setCameraPosition(src.cameraPosition,dst);if(src.tooltip!==undefined){dst.showTooltip=src.tooltip}if(src.onclick!=undefined){dst.onclick_callback=src.onclick}}function setShowLegend(showLegend,dst){if(showLegend===undefined){var isAutoByDefault=DEFAULTS.showLegend===undefined;if(isAutoByDefault){var isLegendGraphStyle=dst.style===STYLE.DOTCOLOR||dst.style===STYLE.DOTSIZE;dst.showLegend=isLegendGraphStyle}else{}}else{dst.showLegend=showLegend}}function getStyleNumberByName(styleName){var number=STYLENAME[styleName];if(number===undefined){return-1}return number}function checkStyleNumber(style){var valid=false;for(var n in STYLE){if(STYLE[n]===style){valid=true;break}}return valid}function setStyle(style,dst){if(style===undefined){return}var styleNumber;if(typeof style==="string"){styleNumber=getStyleNumberByName(style);if(styleNumber===-1){throw new Error("Style '"+style+"' is invalid")}}else{if(!checkStyleNumber(style)){throw new Error("Style '"+style+"' is invalid")}styleNumber=style}dst.style=styleNumber}function setBackgroundColor(backgroundColor,dst){var fill="white";var stroke="gray";var strokeWidth=1;if(typeof backgroundColor==="string"){fill=backgroundColor;stroke="none";strokeWidth=0}else if((typeof backgroundColor==="undefined"?"undefined":(0,_typeof3["default"])(backgroundColor))==="object"){if(backgroundColor.fill!==undefined)fill=backgroundColor.fill;if(backgroundColor.stroke!==undefined)stroke=backgroundColor.stroke;if(backgroundColor.strokeWidth!==undefined)strokeWidth=backgroundColor.strokeWidth}else{throw new Error("Unsupported type of backgroundColor")}dst.frame.style.backgroundColor=fill;dst.frame.style.borderColor=stroke;dst.frame.style.borderWidth=strokeWidth+"px";dst.frame.style.borderStyle="solid"}function setDataColor(dataColor,dst){if(dataColor===undefined){return}if(dst.dataColor===undefined){dst.dataColor={}}if(typeof dataColor==="string"){dst.dataColor.fill=dataColor;dst.dataColor.stroke=dataColor}else{if(dataColor.fill){dst.dataColor.fill=dataColor.fill}if(dataColor.stroke){dst.dataColor.stroke=dataColor.stroke}if(dataColor.strokeWidth!==undefined){dst.dataColor.strokeWidth=dataColor.strokeWidth}}}function setCameraPosition(cameraPosition,dst){var camPos=cameraPosition;if(camPos===undefined){return}if(dst.camera===undefined){dst.camera=new Camera}dst.camera.setArmRotation(camPos.horizontal,camPos.vertical);dst.camera.setArmLength(camPos.distance)}module.exports.STYLE=STYLE;module.exports.setDefaults=setDefaults;module.exports.setOptions=setOptions;module.exports.setCameraPosition=setCameraPosition},{"./Camera":9,"./Point3d":13,"babel-runtime/helpers/typeof":133}],16:[function(require,module,exports){"use strict";var util=require("../util");function Slider(container,options){if(container===undefined){throw new Error("No container element defined")}this.container=container;this.visible=options&&options.visible!=undefined?options.visible:true;if(this.visible){this.frame=document.createElement("DIV");this.frame.style.width="100%";this.frame.style.position="relative";this.container.appendChild(this.frame);this.frame.prev=document.createElement("INPUT");this.frame.prev.type="BUTTON";this.frame.prev.value="Prev";this.frame.appendChild(this.frame.prev);this.frame.play=document.createElement("INPUT");this.frame.play.type="BUTTON";this.frame.play.value="Play";this.frame.appendChild(this.frame.play);this.frame.next=document.createElement("INPUT");this.frame.next.type="BUTTON";this.frame.next.value="Next";this.frame.appendChild(this.frame.next);this.frame.bar=document.createElement("INPUT");this.frame.bar.type="BUTTON";this.frame.bar.style.position="absolute";this.frame.bar.style.border="1px solid red";this.frame.bar.style.width="100px";this.frame.bar.style.height="6px";this.frame.bar.style.borderRadius="2px";this.frame.bar.style.MozBorderRadius="2px";this.frame.bar.style.border="1px solid #7F7F7F";this.frame.bar.style.backgroundColor="#E5E5E5";this.frame.appendChild(this.frame.bar);this.frame.slide=document.createElement("INPUT");this.frame.slide.type="BUTTON";this.frame.slide.style.margin="0px";this.frame.slide.value=" ";this.frame.slide.style.position="relative";this.frame.slide.style.left="-100px";this.frame.appendChild(this.frame.slide);var me=this;this.frame.slide.onmousedown=function(event){me._onMouseDown(event)};this.frame.prev.onclick=function(event){me.prev(event)};this.frame.play.onclick=function(event){me.togglePlay(event)};this.frame.next.onclick=function(event){me.next(event)}}this.onChangeCallback=undefined;this.values=[];this.index=undefined;this.playTimeout=undefined;this.playInterval=1e3;this.playLoop=true}Slider.prototype.prev=function(){var index=this.getIndex();if(index>0){index--;this.setIndex(index)}};Slider.prototype.next=function(){var index=this.getIndex();if(index<this.values.length-1){index++;this.setIndex(index)}};Slider.prototype.playNext=function(){var start=new Date;var index=this.getIndex();if(index<this.values.length-1){index++;this.setIndex(index)}else if(this.playLoop){index=0;this.setIndex(index)}var end=new Date;var diff=end-start;var interval=Math.max(this.playInterval-diff,0);var me=this;this.playTimeout=setTimeout(function(){me.playNext()},interval)};Slider.prototype.togglePlay=function(){if(this.playTimeout===undefined){this.play()}else{this.stop()}};Slider.prototype.play=function(){if(this.playTimeout)return;this.playNext();if(this.frame){this.frame.play.value="Stop"}};Slider.prototype.stop=function(){clearInterval(this.playTimeout);this.playTimeout=undefined;if(this.frame){this.frame.play.value="Play"}};Slider.prototype.setOnChangeCallback=function(callback){this.onChangeCallback=callback};Slider.prototype.setPlayInterval=function(interval){this.playInterval=interval};Slider.prototype.getPlayInterval=function(interval){return this.playInterval};Slider.prototype.setPlayLoop=function(doLoop){this.playLoop=doLoop};Slider.prototype.onChange=function(){if(this.onChangeCallback!==undefined){this.onChangeCallback()}};Slider.prototype.redraw=function(){if(this.frame){this.frame.bar.style.top=this.frame.clientHeight/2-this.frame.bar.offsetHeight/2+"px";this.frame.bar.style.width=this.frame.clientWidth-this.frame.prev.clientWidth-this.frame.play.clientWidth-this.frame.next.clientWidth-30+"px";var left=this.indexToLeft(this.index);this.frame.slide.style.left=left+"px"}};Slider.prototype.setValues=function(values){this.values=values;if(this.values.length>0)this.setIndex(0);else this.index=undefined};Slider.prototype.setIndex=function(index){if(index<this.values.length){this.index=index;this.redraw();this.onChange()}else{throw new Error("Index out of range")}};Slider.prototype.getIndex=function(){return this.index};Slider.prototype.get=function(){return this.values[this.index]};Slider.prototype._onMouseDown=function(event){var leftButtonDown=event.which?event.which===1:event.button===1;if(!leftButtonDown)return;this.startClientX=event.clientX;this.startSlideX=parseFloat(this.frame.slide.style.left);this.frame.style.cursor="move";var me=this;this.onmousemove=function(event){me._onMouseMove(event)};this.onmouseup=function(event){me._onMouseUp(event)};util.addEventListener(document,"mousemove",this.onmousemove);util.addEventListener(document,"mouseup",this.onmouseup);util.preventDefault(event)};Slider.prototype.leftToIndex=function(left){var width=parseFloat(this.frame.bar.style.width)-this.frame.slide.clientWidth-10;var x=left-3;var index=Math.round(x/width*(this.values.length-1));if(index<0)index=0;if(index>this.values.length-1)index=this.values.length-1;return index};Slider.prototype.indexToLeft=function(index){var width=parseFloat(this.frame.bar.style.width)-this.frame.slide.clientWidth-10;var x=index/(this.values.length-1)*width;var left=x+3;return left};Slider.prototype._onMouseMove=function(event){var diff=event.clientX-this.startClientX;var x=this.startSlideX+diff;var index=this.leftToIndex(x);this.setIndex(index);util.preventDefault()};Slider.prototype._onMouseUp=function(event){this.frame.style.cursor="auto";util.removeEventListener(document,"mousemove",this.onmousemove);util.removeEventListener(document,"mouseup",this.onmouseup);util.preventDefault()};module.exports=Slider},{"../util":116}],17:[function(require,module,exports){"use strict";function StepNumber(start,end,step,prettyStep){this._start=0;this._end=0;this._step=1;this.prettyStep=true;this.precision=5;this._current=0;this.setRange(start,end,step,prettyStep)}StepNumber.prototype.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};StepNumber.prototype.setRange=function(start,end,step,prettyStep){if(!this.isNumeric(start)){throw new Error("Parameter 'start' is not numeric; value: "+start)}if(!this.isNumeric(end)){throw new Error("Parameter 'end' is not numeric; value: "+start)}if(!this.isNumeric(step)){throw new Error("Parameter 'step' is not numeric; value: "+start)}this._start=start?start:0;this._end=end?end:0;this.setStep(step,prettyStep)};StepNumber.prototype.setStep=function(step,prettyStep){if(step===undefined||step<=0)return;if(prettyStep!==undefined)this.prettyStep=prettyStep;if(this.prettyStep===true)this._step=StepNumber.calculatePrettyStep(step);else this._step=step};StepNumber.calculatePrettyStep=function(step){var log10=function log10(x){return Math.log(x)/Math.LN10};var step1=Math.pow(10,Math.round(log10(step))),step2=2*Math.pow(10,Math.round(log10(step/2))),step5=5*Math.pow(10,Math.round(log10(step/5)));var prettyStep=step1;if(Math.abs(step2-step)<=Math.abs(prettyStep-step))prettyStep=step2;if(Math.abs(step5-step)<=Math.abs(prettyStep-step))prettyStep=step5;if(prettyStep<=0){prettyStep=1}return prettyStep};StepNumber.prototype.getCurrent=function(){return parseFloat(this._current.toPrecision(this.precision))};StepNumber.prototype.getStep=function(){return this._step};StepNumber.prototype.start=function(checkFirst){if(checkFirst===undefined){checkFirst=false}this._current=this._start-this._start%this._step;if(checkFirst){if(this.getCurrent()<this._start){this.next()}}};StepNumber.prototype.next=function(){this._current+=this._step};StepNumber.prototype.end=function(){return this._current>this._end};module.exports=StepNumber},{}],18:[function(require,module,exports){"use strict";var Hammer=require("./module/hammer");exports.onTouch=function(hammer,callback){callback.inputHandler=function(event){if(event.isFirst){callback(event)}};hammer.on("hammer.input",callback.inputHandler)};exports.onRelease=function(hammer,callback){callback.inputHandler=function(event){if(event.isFinal){callback(event)}};return hammer.on("hammer.input",callback.inputHandler)};exports.offTouch=function(hammer,callback){hammer.off("hammer.input",callback.inputHandler)};exports.offRelease=exports.offTouch;exports.disablePreventDefaultVertically=function(pinchRecognizer){var TOUCH_ACTION_PAN_Y="pan-y";pinchRecognizer.getTouchAction=function(){return[TOUCH_ACTION_PAN_Y]};return pinchRecognizer}},{"./module/hammer":19}],19:[function(require,module,exports){"use strict";if(typeof window!=="undefined"){var propagating=require("propagating-hammerjs");var Hammer=window["Hammer"]||require("hammerjs");module.exports=propagating(Hammer,{preventDefault:"mouse"})}else{module.exports=function(){throw Error("hammer.js is only available in a browser, not in node.js.")}}},{hammerjs:222,"propagating-hammerjs":224}],20:[function(require,module,exports){"use strict";module.exports=require("moment")},{moment:"moment"}],21:[function(require,module,exports){(function(global){"use strict";var _rng;var globalVar=typeof window!=="undefined"?window:typeof global!=="undefined"?global:null;if(globalVar&&globalVar.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);_rng=function whatwgRNG(){crypto.getRandomValues(_rnds8);return _rnds8}}if(!_rng){var _rnds=new Array(16);_rng=function _rng(){for(var i=0,r;i<16;i++){if((i&3)===0)r=Math.random()*4294967296;_rnds[i]=r>>>((i&3)<<3)&255}return _rnds}}var _byteToHex=[];var _hexToByte={};for(var i=0;i<256;i++){_byteToHex[i]=(i+256).toString(16).substr(1);_hexToByte[_byteToHex[i]]=i}function parse(s,buf,offset){var i=buf&&offset||0,ii=0;buf=buf||[];s.toLowerCase().replace(/[0-9a-f]{2}/g,function(oct){if(ii<16){buf[i+ii++]=_hexToByte[oct]}});while(ii<16){buf[i+ii++]=0}return buf}function unparse(buf,offset){var i=offset||0,bth=_byteToHex;return bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]}var _seedBytes=_rng();var _nodeId=[_seedBytes[0]|1,_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]];var _clockseq=(_seedBytes[6]<<8|_seedBytes[7])&16383;var _lastMSecs=0,_lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0;var b=buf||[];options=options||{};var clockseq=options.clockseq!==undefined?options.clockseq:_clockseq;var msecs=options.msecs!==undefined?options.msecs:(new Date).getTime();var nsecs=options.nsecs!==undefined?options.nsecs:_lastNSecs+1;var dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&options.clockseq===undefined){clockseq=clockseq+1&16383}if((dt<0||msecs>_lastMSecs)&&options.nsecs===undefined){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}_lastMSecs=msecs;_lastNSecs=nsecs;_clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;var node=options.node||_nodeId;for(var n=0;n<6;n++){b[i+n]=node[n]}return buf?buf:unparse(b)}function v4(options,buf,offset){var i=buf&&offset||0;if(typeof options=="string"){buf=options=="binary"?new Array(16):null;options=null}options=options||{};var rnds=options.random||(options.rng||_rng)();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){for(var ii=0;ii<16;ii++){buf[i+ii]=rnds[ii]}}return buf||unparse(rnds)}var uuid=v4;uuid.v1=v1;uuid.v4=v4;uuid.parse=parse;uuid.unparse=unparse;module.exports=uuid}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Images=function(){function Images(callback){(0,_classCallCheck3["default"])(this,Images);this.images={};this.imageBroken={};this.callback=callback}(0,_createClass3["default"])(Images,[{key:"_addImageToCache",value:function _addImageToCache(url,imageToCache){if(imageToCache.width===0){document.body.appendChild(imageToCache);imageToCache.width=imageToCache.offsetWidth;imageToCache.height=imageToCache.offsetHeight;document.body.removeChild(imageToCache)}this.images[url]=imageToCache}},{key:"_tryloadBrokenUrl",value:function _tryloadBrokenUrl(url,brokenUrl,imageToLoadBrokenUrlOn){var _this=this;if(url===undefined||brokenUrl===undefined||imageToLoadBrokenUrlOn===undefined)return;imageToLoadBrokenUrlOn.onerror=function(){console.error("Could not load brokenImage:",brokenUrl);_this._addImageToCache(url,new Image)};imageToLoadBrokenUrlOn.src=brokenUrl}},{key:"_redrawWithImage",value:function _redrawWithImage(imageToRedrawWith){if(this.callback){this.callback(imageToRedrawWith)}}},{key:"load",value:function load(url,brokenUrl,id){var _this2=this;var cachedImage=this.images[url];if(cachedImage)return cachedImage;var img=new Image;img.onload=function(){_this2._addImageToCache(url,img);_this2._redrawWithImage(img)};img.onerror=function(){console.error("Could not load image:",url);_this2._tryloadBrokenUrl(url,brokenUrl,img)};img.src=url;return img}}]);return Images}();exports["default"]=Images},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],23:[function(require,module,exports){"use strict";var _Images=require("./Images");var _Images2=_interopRequireDefault(_Images);var _Groups=require("./modules/Groups");var _Groups2=_interopRequireDefault(_Groups);var _NodesHandler=require("./modules/NodesHandler");
var _NodesHandler2=_interopRequireDefault(_NodesHandler);var _EdgesHandler=require("./modules/EdgesHandler");var _EdgesHandler2=_interopRequireDefault(_EdgesHandler);var _PhysicsEngine=require("./modules/PhysicsEngine");var _PhysicsEngine2=_interopRequireDefault(_PhysicsEngine);var _Clustering=require("./modules/Clustering");var _Clustering2=_interopRequireDefault(_Clustering);var _CanvasRenderer=require("./modules/CanvasRenderer");var _CanvasRenderer2=_interopRequireDefault(_CanvasRenderer);var _Canvas=require("./modules/Canvas");var _Canvas2=_interopRequireDefault(_Canvas);var _View=require("./modules/View");var _View2=_interopRequireDefault(_View);var _InteractionHandler=require("./modules/InteractionHandler");var _InteractionHandler2=_interopRequireDefault(_InteractionHandler);var _SelectionHandler=require("./modules/SelectionHandler");var _SelectionHandler2=_interopRequireDefault(_SelectionHandler);var _LayoutEngine=require("./modules/LayoutEngine");var _LayoutEngine2=_interopRequireDefault(_LayoutEngine);var _ManipulationSystem=require("./modules/ManipulationSystem");var _ManipulationSystem2=_interopRequireDefault(_ManipulationSystem);var _Configurator=require("./../shared/Configurator");var _Configurator2=_interopRequireDefault(_Configurator);var _Validator=require("./../shared/Validator");var _Validator2=_interopRequireDefault(_Validator);var _options=require("./options.js");var _KamadaKawai=require("./modules/KamadaKawai.js");var _KamadaKawai2=_interopRequireDefault(_KamadaKawai);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}require("./shapes");var Emitter=require("emitter-component");var util=require("../util");var DataSet=require("../DataSet");var DataView=require("../DataView");var dotparser=require("./dotparser");var gephiParser=require("./gephiParser");var Activator=require("../shared/Activator");var locales=require("./locales");function Network(container,data,options){var _this=this;if(!(this instanceof Network)){throw new SyntaxError("Constructor must be called with the new operator")}this.options={};this.defaultOptions={locale:"en",locales:locales,clickToUse:false};util.extend(this.options,this.defaultOptions);this.body={container:container,nodes:{},nodeIndices:[],edges:{},edgeIndices:[],emitter:{on:this.on.bind(this),off:this.off.bind(this),emit:this.emit.bind(this),once:this.once.bind(this)},eventListeners:{onTap:function onTap(){},onTouch:function onTouch(){},onDoubleTap:function onDoubleTap(){},onHold:function onHold(){},onDragStart:function onDragStart(){},onDrag:function onDrag(){},onDragEnd:function onDragEnd(){},onMouseWheel:function onMouseWheel(){},onPinch:function onPinch(){},onMouseMove:function onMouseMove(){},onRelease:function onRelease(){},onContext:function onContext(){}},data:{nodes:null,edges:null},functions:{createNode:function createNode(){},createEdge:function createEdge(){},getPointer:function getPointer(){}},modules:{},view:{scale:1,translation:{x:0,y:0}}};this.bindEventListeners();this.images=new _Images2["default"](function(){return _this.body.emitter.emit("_requestRedraw")});this.groups=new _Groups2["default"];this.canvas=new _Canvas2["default"](this.body);this.selectionHandler=new _SelectionHandler2["default"](this.body,this.canvas);this.interactionHandler=new _InteractionHandler2["default"](this.body,this.canvas,this.selectionHandler);this.view=new _View2["default"](this.body,this.canvas);this.renderer=new _CanvasRenderer2["default"](this.body,this.canvas);this.physics=new _PhysicsEngine2["default"](this.body);this.layoutEngine=new _LayoutEngine2["default"](this.body);this.clustering=new _Clustering2["default"](this.body);this.manipulation=new _ManipulationSystem2["default"](this.body,this.canvas,this.selectionHandler);this.nodesHandler=new _NodesHandler2["default"](this.body,this.images,this.groups,this.layoutEngine);this.edgesHandler=new _EdgesHandler2["default"](this.body,this.images,this.groups);this.body.modules["kamadaKawai"]=new _KamadaKawai2["default"](this.body,150,.05);this.body.modules["clustering"]=this.clustering;this.canvas._create();this.setOptions(options);this.setData(data)}Emitter(Network.prototype);Network.prototype.setOptions=function(options){var _this2=this;if(options!==undefined){var errorFound=_Validator2["default"].validate(options,_options.allOptions);if(errorFound===true){console.log("%cErrors have been found in the supplied options object.",_Validator.printStyle)}var fields=["locale","locales","clickToUse"];util.selectiveDeepExtend(fields,this.options,options);options=this.layoutEngine.setOptions(options.layout,options);this.canvas.setOptions(options);this.groups.setOptions(options.groups);this.nodesHandler.setOptions(options.nodes);this.edgesHandler.setOptions(options.edges);this.physics.setOptions(options.physics);this.manipulation.setOptions(options.manipulation,options,this.options);this.interactionHandler.setOptions(options.interaction);this.renderer.setOptions(options.interaction);this.selectionHandler.setOptions(options.interaction);if(options.groups!==undefined){this.body.emitter.emit("refreshNodes")}if("configure"in options){if(!this.configurator){this.configurator=new _Configurator2["default"](this,this.body.container,_options.configureOptions,this.canvas.pixelRatio)}this.configurator.setOptions(options.configure)}if(this.configurator&&this.configurator.options.enabled===true){var networkOptions={nodes:{},edges:{},layout:{},interaction:{},manipulation:{},physics:{},global:{}};util.deepExtend(networkOptions.nodes,this.nodesHandler.options);util.deepExtend(networkOptions.edges,this.edgesHandler.options);util.deepExtend(networkOptions.layout,this.layoutEngine.options);util.deepExtend(networkOptions.interaction,this.selectionHandler.options);util.deepExtend(networkOptions.interaction,this.renderer.options);util.deepExtend(networkOptions.interaction,this.interactionHandler.options);util.deepExtend(networkOptions.manipulation,this.manipulation.options);util.deepExtend(networkOptions.physics,this.physics.options);util.deepExtend(networkOptions.global,this.canvas.options);util.deepExtend(networkOptions.global,this.options);this.configurator.setModuleOptions(networkOptions)}if(options.clickToUse!==undefined){if(options.clickToUse===true){if(this.activator===undefined){this.activator=new Activator(this.canvas.frame);this.activator.on("change",function(){_this2.body.emitter.emit("activate")})}}else{if(this.activator!==undefined){this.activator.destroy();delete this.activator}this.body.emitter.emit("activate")}}else{this.body.emitter.emit("activate")}this.canvas.setSize();this.body.emitter.emit("startSimulation")}};Network.prototype._updateVisibleIndices=function(){var nodes=this.body.nodes;var edges=this.body.edges;this.body.nodeIndices=[];this.body.edgeIndices=[];for(var nodeId in nodes){if(nodes.hasOwnProperty(nodeId)){if(nodes[nodeId].options.hidden===false){this.body.nodeIndices.push(nodes[nodeId].id)}}}for(var edgeId in edges){if(edges.hasOwnProperty(edgeId)){if(edges[edgeId].options.hidden===false){this.body.edgeIndices.push(edges[edgeId].id)}}}};Network.prototype.bindEventListeners=function(){var _this3=this;this.body.emitter.on("_dataChanged",function(){_this3._updateVisibleIndices();_this3.body.emitter.emit("_requestRedraw");_this3.body.emitter.emit("_dataUpdated")});this.body.emitter.on("_dataUpdated",function(){_this3._updateValueRange(_this3.body.nodes);_this3._updateValueRange(_this3.body.edges);_this3.body.emitter.emit("startSimulation");_this3.body.emitter.emit("_requestRedraw")})};Network.prototype.setData=function(data){this.body.emitter.emit("resetPhysics");this.body.emitter.emit("_resetData");this.selectionHandler.unselectAll();if(data&&data.dot&&(data.nodes||data.edges)){throw new SyntaxError('Data must contain either parameter "dot" or '+' parameter pair "nodes" and "edges", but not both.')}this.setOptions(data&&data.options);if(data&&data.dot){console.log("The dot property has been deprecated. Please use the static convertDot method to convert DOT into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertDot(dotString);");var dotData=dotparser.DOTToGraph(data.dot);this.setData(dotData);return}else if(data&&data.gephi){console.log("The gephi property has been deprecated. Please use the static convertGephi method to convert gephi into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertGephi(gephiJson);");var gephiData=gephiParser.parseGephi(data.gephi);this.setData(gephiData);return}else{this.nodesHandler.setData(data&&data.nodes,true);this.edgesHandler.setData(data&&data.edges,true)}this.body.emitter.emit("_dataChanged");this.body.emitter.emit("_dataLoaded");this.body.emitter.emit("initPhysics")};Network.prototype.destroy=function(){this.body.emitter.emit("destroy");this.body.emitter.off();this.off();delete this.groups;delete this.canvas;delete this.selectionHandler;delete this.interactionHandler;delete this.view;delete this.renderer;delete this.physics;delete this.layoutEngine;delete this.clustering;delete this.manipulation;delete this.nodesHandler;delete this.edgesHandler;delete this.configurator;delete this.images;for(var nodeId in this.body.nodes){delete this.body.nodes[nodeId]}for(var edgeId in this.body.edges){delete this.body.edges[edgeId]}util.recursiveDOMDelete(this.body.container)};Network.prototype._updateValueRange=function(obj){var id;var valueMin=undefined;var valueMax=undefined;var valueTotal=0;for(id in obj){if(obj.hasOwnProperty(id)){var value=obj[id].getValue();if(value!==undefined){valueMin=valueMin===undefined?value:Math.min(value,valueMin);valueMax=valueMax===undefined?value:Math.max(value,valueMax);valueTotal+=value}}}if(valueMin!==undefined&&valueMax!==undefined){for(id in obj){if(obj.hasOwnProperty(id)){obj[id].setValueRange(valueMin,valueMax,valueTotal)}}}};Network.prototype.isActive=function(){return!this.activator||this.activator.active};Network.prototype.setSize=function(){return this.canvas.setSize.apply(this.canvas,arguments)};Network.prototype.canvasToDOM=function(){return this.canvas.canvasToDOM.apply(this.canvas,arguments)};Network.prototype.DOMtoCanvas=function(){return this.canvas.DOMtoCanvas.apply(this.canvas,arguments)};Network.prototype.findNode=function(){return this.clustering.findNode.apply(this.clustering,arguments)};Network.prototype.isCluster=function(){return this.clustering.isCluster.apply(this.clustering,arguments)};Network.prototype.openCluster=function(){return this.clustering.openCluster.apply(this.clustering,arguments)};Network.prototype.cluster=function(){return this.clustering.cluster.apply(this.clustering,arguments)};Network.prototype.getNodesInCluster=function(){return this.clustering.getNodesInCluster.apply(this.clustering,arguments)};Network.prototype.clusterByConnection=function(){return this.clustering.clusterByConnection.apply(this.clustering,arguments)};Network.prototype.clusterByHubsize=function(){return this.clustering.clusterByHubsize.apply(this.clustering,arguments)};Network.prototype.clusterOutliers=function(){return this.clustering.clusterOutliers.apply(this.clustering,arguments)};Network.prototype.getSeed=function(){return this.layoutEngine.getSeed.apply(this.layoutEngine,arguments)};Network.prototype.enableEditMode=function(){return this.manipulation.enableEditMode.apply(this.manipulation,arguments)};Network.prototype.disableEditMode=function(){return this.manipulation.disableEditMode.apply(this.manipulation,arguments)};Network.prototype.addNodeMode=function(){return this.manipulation.addNodeMode.apply(this.manipulation,arguments)};Network.prototype.editNode=function(){return this.manipulation.editNode.apply(this.manipulation,arguments)};Network.prototype.editNodeMode=function(){console.log("Deprecated: Please use editNode instead of editNodeMode.");return this.manipulation.editNode.apply(this.manipulation,arguments)};Network.prototype.addEdgeMode=function(){return this.manipulation.addEdgeMode.apply(this.manipulation,arguments)};Network.prototype.editEdgeMode=function(){return this.manipulation.editEdgeMode.apply(this.manipulation,arguments)};Network.prototype.deleteSelected=function(){return this.manipulation.deleteSelected.apply(this.manipulation,arguments)};Network.prototype.getPositions=function(){return this.nodesHandler.getPositions.apply(this.nodesHandler,arguments)};Network.prototype.storePositions=function(){return this.nodesHandler.storePositions.apply(this.nodesHandler,arguments)};Network.prototype.moveNode=function(){return this.nodesHandler.moveNode.apply(this.nodesHandler,arguments)};Network.prototype.getBoundingBox=function(){return this.nodesHandler.getBoundingBox.apply(this.nodesHandler,arguments)};Network.prototype.getConnectedNodes=function(objectId){if(this.body.nodes[objectId]!==undefined){return this.nodesHandler.getConnectedNodes.apply(this.nodesHandler,arguments)}else{return this.edgesHandler.getConnectedNodes.apply(this.edgesHandler,arguments)}};Network.prototype.getConnectedEdges=function(){return this.nodesHandler.getConnectedEdges.apply(this.nodesHandler,arguments)};Network.prototype.startSimulation=function(){return this.physics.startSimulation.apply(this.physics,arguments)};Network.prototype.stopSimulation=function(){return this.physics.stopSimulation.apply(this.physics,arguments)};Network.prototype.stabilize=function(){return this.physics.stabilize.apply(this.physics,arguments)};Network.prototype.getSelection=function(){return this.selectionHandler.getSelection.apply(this.selectionHandler,arguments)};Network.prototype.setSelection=function(){return this.selectionHandler.setSelection.apply(this.selectionHandler,arguments)};Network.prototype.getSelectedNodes=function(){return this.selectionHandler.getSelectedNodes.apply(this.selectionHandler,arguments)};Network.prototype.getSelectedEdges=function(){return this.selectionHandler.getSelectedEdges.apply(this.selectionHandler,arguments)};Network.prototype.getNodeAt=function(){var node=this.selectionHandler.getNodeAt.apply(this.selectionHandler,arguments);if(node!==undefined&&node.id!==undefined){return node.id}return node};Network.prototype.getEdgeAt=function(){var edge=this.selectionHandler.getEdgeAt.apply(this.selectionHandler,arguments);if(edge!==undefined&&edge.id!==undefined){return edge.id}return edge};Network.prototype.selectNodes=function(){return this.selectionHandler.selectNodes.apply(this.selectionHandler,arguments)};Network.prototype.selectEdges=function(){return this.selectionHandler.selectEdges.apply(this.selectionHandler,arguments)};Network.prototype.unselectAll=function(){this.selectionHandler.unselectAll.apply(this.selectionHandler,arguments);this.redraw()};Network.prototype.redraw=function(){return this.renderer.redraw.apply(this.renderer,arguments)};Network.prototype.getScale=function(){return this.view.getScale.apply(this.view,arguments)};Network.prototype.getViewPosition=function(){return this.view.getViewPosition.apply(this.view,arguments)};Network.prototype.fit=function(){return this.view.fit.apply(this.view,arguments)};Network.prototype.moveTo=function(){return this.view.moveTo.apply(this.view,arguments)};Network.prototype.focus=function(){return this.view.focus.apply(this.view,arguments)};Network.prototype.releaseNode=function(){return this.view.releaseNode.apply(this.view,arguments)};Network.prototype.getOptionsFromConfigurator=function(){var options={};if(this.configurator){options=this.configurator.getOptions.apply(this.configurator)}return options};module.exports=Network},{"../DataSet":6,"../DataView":7,"../shared/Activator":81,"../util":116,"./../shared/Configurator":83,"./../shared/Validator":85,"./Images":22,"./dotparser":25,"./gephiParser":26,"./locales":27,"./modules/Canvas":28,"./modules/CanvasRenderer":29,"./modules/Clustering":30,"./modules/EdgesHandler":31,"./modules/Groups":32,"./modules/InteractionHandler":33,"./modules/KamadaKawai.js":34,"./modules/LayoutEngine":35,"./modules/ManipulationSystem":36,"./modules/NodesHandler":37,"./modules/PhysicsEngine":38,"./modules/SelectionHandler":39,"./modules/View":40,"./options.js":79,"./shapes":80,"emitter-component":221}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../util");var NetworkUtil=function(){function NetworkUtil(){(0,_classCallCheck3["default"])(this,NetworkUtil)}(0,_createClass3["default"])(NetworkUtil,null,[{key:"getRange",value:function getRange(allNodes){var specificNodes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var minY=1e9,maxY=-1e9,minX=1e9,maxX=-1e9,node;if(specificNodes.length>0){for(var i=0;i<specificNodes.length;i++){node=allNodes[specificNodes[i]];if(minX>node.shape.boundingBox.left){minX=node.shape.boundingBox.left}if(maxX<node.shape.boundingBox.right){maxX=node.shape.boundingBox.right}if(minY>node.shape.boundingBox.top){minY=node.shape.boundingBox.top}if(maxY<node.shape.boundingBox.bottom){maxY=node.shape.boundingBox.bottom}}}if(minX===1e9&&maxX===-1e9&&minY===1e9&&maxY===-1e9){minY=0,maxY=0,minX=0,maxX=0}return{minX:minX,maxX:maxX,minY:minY,maxY:maxY}}},{key:"getRangeCore",value:function getRangeCore(allNodes){var specificNodes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var minY=1e9,maxY=-1e9,minX=1e9,maxX=-1e9,node;if(specificNodes.length>0){for(var i=0;i<specificNodes.length;i++){node=allNodes[specificNodes[i]];if(minX>node.x){minX=node.x}if(maxX<node.x){maxX=node.x}if(minY>node.y){minY=node.y}if(maxY<node.y){maxY=node.y}}}if(minX===1e9&&maxX===-1e9&&minY===1e9&&maxY===-1e9){minY=0,maxY=0,minX=0,maxX=0}return{minX:minX,maxX:maxX,minY:minY,maxY:maxY}}},{key:"findCenter",value:function findCenter(range){return{x:.5*(range.maxX+range.minX),y:.5*(range.maxY+range.minY)}}},{key:"cloneOptions",value:function cloneOptions(item,type){var clonedOptions={};if(type===undefined||type==="node"){util.deepExtend(clonedOptions,item.options,true);clonedOptions.x=item.x;clonedOptions.y=item.y;clonedOptions.amountOfConnections=item.edges.length}else{util.deepExtend(clonedOptions,item.options,true)}return clonedOptions}}]);return NetworkUtil}();exports["default"]=NetworkUtil},{"../util":116,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],25:[function(require,module,exports){"use strict";var _create=require("babel-runtime/core-js/object/create");var _create2=_interopRequireDefault(_create);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function parseDOT(data){dot=data;return parseGraph()}var NODE_ATTR_MAPPING={fontsize:"font.size",fontcolor:"font.color",labelfontcolor:"font.color",fontname:"font.face",color:["color.border","color.background"],fillcolor:"color.background",tooltip:"title",labeltooltip:"title"};var EDGE_ATTR_MAPPING=(0,_create2["default"])(NODE_ATTR_MAPPING);EDGE_ATTR_MAPPING.color="color.color";var TOKENTYPE={NULL:0,DELIMITER:1,IDENTIFIER:2,UNKNOWN:3};var DELIMITERS={"{":true,"}":true,"[":true,"]":true,";":true,"=":true,",":true,"->":true,"--":true};var dot="";var index=0;var c="";var token="";var tokenType=TOKENTYPE.NULL;function first(){index=0;c=dot.charAt(0)}function next(){index++;c=dot.charAt(index)}function nextPreview(){return dot.charAt(index+1)}var regexAlphaNumeric=/[a-zA-Z_0-9.:#]/;function isAlphaNumeric(c){return regexAlphaNumeric.test(c)}function merge(a,b){if(!a){a={}}if(b){for(var name in b){if(b.hasOwnProperty(name)){a[name]=b[name]}}}return a}function setValue(obj,path,value){var keys=path.split(".");var o=obj;while(keys.length){var key=keys.shift();if(keys.length){if(!o[key]){o[key]={}}o=o[key]}else{o[key]=value}}}function addNode(graph,node){var i,len;var current=null;var graphs=[graph];var root=graph;while(root.parent){graphs.push(root.parent);root=root.parent}if(root.nodes){for(i=0,len=root.nodes.length;i<len;i++){if(node.id===root.nodes[i].id){current=root.nodes[i];break}}}if(!current){current={id:node.id};if(graph.node){current.attr=merge(current.attr,graph.node)}}for(i=graphs.length-1;i>=0;i--){var g=graphs[i];if(!g.nodes){g.nodes=[]}if(g.nodes.indexOf(current)===-1){g.nodes.push(current)}}if(node.attr){current.attr=merge(current.attr,node.attr)}}function addEdge(graph,edge){if(!graph.edges){graph.edges=[]}graph.edges.push(edge);if(graph.edge){var attr=merge({},graph.edge);edge.attr=merge(attr,edge.attr)}}function createEdge(graph,from,to,type,attr){var edge={from:from,to:to,type:type};if(graph.edge){edge.attr=merge({},graph.edge)}edge.attr=merge(edge.attr||{},attr);return edge}function getToken(){tokenType=TOKENTYPE.NULL;token="";while(c===" "||c==="\t"||c==="\n"||c==="\r"){next()}do{var isComment=false;if(c==="#"){var i=index-1;while(dot.charAt(i)===" "||dot.charAt(i)==="\t"){i--}if(dot.charAt(i)==="\n"||dot.charAt(i)===""){while(c!=""&&c!="\n"){next()}isComment=true}}if(c==="/"&&nextPreview()==="/"){while(c!=""&&c!="\n"){next()}isComment=true}if(c==="/"&&nextPreview()==="*"){while(c!=""){if(c==="*"&&nextPreview()==="/"){next();next();break}else{next()}}isComment=true}while(c===" "||c==="\t"||c==="\n"||c==="\r"){next()}}while(isComment);if(c===""){tokenType=TOKENTYPE.DELIMITER;return}var c2=c+nextPreview();if(DELIMITERS[c2]){tokenType=TOKENTYPE.DELIMITER;token=c2;next();next();return}if(DELIMITERS[c]){tokenType=TOKENTYPE.DELIMITER;token=c;next();return}if(isAlphaNumeric(c)||c==="-"){token+=c;next();while(isAlphaNumeric(c)){token+=c;next()}if(token==="false"){token=false}else if(token==="true"){token=true}else if(!isNaN(Number(token))){token=Number(token)}tokenType=TOKENTYPE.IDENTIFIER;return}if(c==='"'){next();while(c!=""&&(c!='"'||c==='"'&&nextPreview()==='"')){token+=c;if(c==='"'){next()}next()}if(c!='"'){throw newSyntaxError('End of string " expected')}next();tokenType=TOKENTYPE.IDENTIFIER;return}tokenType=TOKENTYPE.UNKNOWN;while(c!=""){token+=c;next()}throw new SyntaxError('Syntax error in part "'+chop(token,30)+'"')}function parseGraph(){var graph={};first();getToken();if(token==="strict"){graph.strict=true;getToken()}if(token==="graph"||token==="digraph"){graph.type=token;getToken()}if(tokenType===TOKENTYPE.IDENTIFIER){graph.id=token;getToken()}if(token!="{"){throw newSyntaxError("Angle bracket { expected")}getToken();parseStatements(graph);if(token!="}"){throw newSyntaxError("Angle bracket } expected")}getToken();if(token!==""){throw newSyntaxError("End of file expected")}getToken();delete graph.node;delete graph.edge;delete graph.graph;return graph}function parseStatements(graph){while(token!==""&&token!="}"){parseStatement(graph);if(token===";"){getToken()}}}function parseStatement(graph){var subgraph=parseSubgraph(graph);if(subgraph){parseEdge(graph,subgraph);return}var attr=parseAttributeStatement(graph);if(attr){return}if(tokenType!=TOKENTYPE.IDENTIFIER){throw newSyntaxError("Identifier expected")}var id=token;getToken();if(token==="="){getToken();if(tokenType!=TOKENTYPE.IDENTIFIER){throw newSyntaxError("Identifier expected")}graph[id]=token;getToken()}else{parseNodeStatement(graph,id)}}function parseSubgraph(graph){var subgraph=null;if(token==="subgraph"){subgraph={};subgraph.type="subgraph";getToken();if(tokenType===TOKENTYPE.IDENTIFIER){subgraph.id=token;getToken()}}if(token==="{"){getToken();if(!subgraph){subgraph={}}subgraph.parent=graph;subgraph.node=graph.node;subgraph.edge=graph.edge;subgraph.graph=graph.graph;parseStatements(subgraph);if(token!="}"){throw newSyntaxError("Angle bracket } expected")}getToken();delete subgraph.node;delete subgraph.edge;delete subgraph.graph;delete subgraph.parent;if(!graph.subgraphs){graph.subgraphs=[]}graph.subgraphs.push(subgraph)}return subgraph}function parseAttributeStatement(graph){if(token==="node"){getToken();graph.node=parseAttributeList();return"node"}else if(token==="edge"){getToken();graph.edge=parseAttributeList();return"edge"}else if(token==="graph"){getToken();graph.graph=parseAttributeList();return"graph"}return null}function parseNodeStatement(graph,id){var node={id:id};var attr=parseAttributeList();if(attr){node.attr=attr}addNode(graph,node);parseEdge(graph,id)}function parseEdge(graph,from){while(token==="->"||token==="--"){var to;var type=token;getToken();var subgraph=parseSubgraph(graph);if(subgraph){to=subgraph}else{if(tokenType!=TOKENTYPE.IDENTIFIER){throw newSyntaxError("Identifier or subgraph expected")}to=token;addNode(graph,{id:to});getToken()}var attr=parseAttributeList();var edge=createEdge(graph,from,to,type,attr);addEdge(graph,edge);from=to}}function parseAttributeList(){var attr=null;while(token==="["){getToken();attr={};while(token!==""&&token!="]"){if(tokenType!=TOKENTYPE.IDENTIFIER){throw newSyntaxError("Attribute name expected")}var name=token;getToken();if(token!="="){throw newSyntaxError("Equal sign = expected")}getToken();if(tokenType!=TOKENTYPE.IDENTIFIER){throw newSyntaxError("Attribute value expected")}var value=token;setValue(attr,name,value);getToken();if(token==","){getToken()}}if(token!="]"){throw newSyntaxError("Bracket ] expected")}getToken()}return attr}function newSyntaxError(message){return new SyntaxError(message+', got "'+chop(token,30)+'" (char '+index+")")}function chop(text,maxLength){return text.length<=maxLength?text:text.substr(0,27)+"..."}function forEach2(array1,array2,fn){if(Array.isArray(array1)){array1.forEach(function(elem1){if(Array.isArray(array2)){array2.forEach(function(elem2){fn(elem1,elem2)})}else{fn(elem1,array2)}})}else{if(Array.isArray(array2)){array2.forEach(function(elem2){fn(array1,elem2)})}else{fn(array1,array2)}}}function setProp(object,path,value){var names=path.split(".");var prop=names.pop();var obj=object;for(var i=0;i<names.length;i++){var name=names[i];if(!(name in obj)){obj[name]={}}obj=obj[name]}obj[prop]=value;return object}function convertAttr(attr,mapping){var converted={};for(var prop in attr){if(attr.hasOwnProperty(prop)){var visProp=mapping[prop];if(Array.isArray(visProp)){visProp.forEach(function(visPropI){setProp(converted,visPropI,attr[prop])})}else if(typeof visProp==="string"){setProp(converted,visProp,attr[prop])}else{setProp(converted,prop,attr[prop])}}}return converted}function DOTToGraph(data){var dotData=parseDOT(data);var graphData={nodes:[],edges:[],options:{}};if(dotData.nodes){dotData.nodes.forEach(function(dotNode){var graphNode={id:dotNode.id,label:String(dotNode.label||dotNode.id)};merge(graphNode,convertAttr(dotNode.attr,NODE_ATTR_MAPPING));if(graphNode.image){graphNode.shape="image"}graphData.nodes.push(graphNode)})}if(dotData.edges){var convertEdge=function convertEdge(dotEdge){var graphEdge={from:dotEdge.from,to:dotEdge.to};merge(graphEdge,convertAttr(dotEdge.attr,EDGE_ATTR_MAPPING));graphEdge.arrows=dotEdge.type==="->"?"to":undefined;return graphEdge};dotData.edges.forEach(function(dotEdge){var from,to;if(dotEdge.from instanceof Object){from=dotEdge.from.nodes}else{from={id:dotEdge.from}}if(dotEdge.to instanceof Object){to=dotEdge.to.nodes}else{to={id:dotEdge.to}}if(dotEdge.from instanceof Object&&dotEdge.from.edges){dotEdge.from.edges.forEach(function(subEdge){var graphEdge=convertEdge(subEdge);graphData.edges.push(graphEdge)})}forEach2(from,to,function(from,to){var subEdge=createEdge(graphData,from.id,to.id,dotEdge.type,dotEdge.attr);var graphEdge=convertEdge(subEdge);graphData.edges.push(graphEdge)});if(dotEdge.to instanceof Object&&dotEdge.to.edges){dotEdge.to.edges.forEach(function(subEdge){var graphEdge=convertEdge(subEdge);graphData.edges.push(graphEdge)})}})}if(dotData.attr){graphData.options=dotData.attr}return graphData}exports.parseDOT=parseDOT;exports.DOTToGraph=DOTToGraph},{"babel-runtime/core-js/object/create":121}],26:[function(require,module,exports){"use strict";function parseGephi(gephiJSON,optionsObj){var edges=[];var nodes=[];var options={edges:{inheritColor:false},nodes:{fixed:false,parseColor:false}};if(optionsObj!==undefined){if(optionsObj.fixed!==undefined){options.nodes.fixed=optionsObj.fixed}if(optionsObj.parseColor!==undefined){options.nodes.parseColor=optionsObj.parseColor}if(optionsObj.inheritColor!==undefined){options.edges.inheritColor=optionsObj.inheritColor}}var gEdges=gephiJSON.edges;var gNodes=gephiJSON.nodes;for(var i=0;i<gEdges.length;i++){var edge={};var gEdge=gEdges[i];edge["id"]=gEdge.id;edge["from"]=gEdge.source;edge["to"]=gEdge.target;edge["attributes"]=gEdge.attributes;edge["label"]=gEdge.label;edge["title"]=gEdge.attributes!==undefined?gEdge.attributes.title:undefined;if(gEdge["type"]==="Directed"){edge["arrows"]="to"}if(gEdge.color&&options.inheritColor===false){edge["color"]=gEdge.color}edges.push(edge)}for(var i=0;i<gNodes.length;i++){var node={};var gNode=gNodes[i];node["id"]=gNode.id;node["attributes"]=gNode.attributes;node["title"]=gNode.title;node["x"]=gNode.x;node["y"]=gNode.y;node["label"]=gNode.label;node["title"]=gNode.attributes!==undefined?gNode.attributes.title:undefined;if(options.nodes.parseColor===true){node["color"]=gNode.color}else{node["color"]=gNode.color!==undefined?{background:gNode.color,border:gNode.color,highlight:{background:gNode.color,border:gNode.color},hover:{background:gNode.color,border:gNode.color}}:undefined}node["size"]=gNode.size;node["fixed"]=options.nodes.fixed&&gNode.x!==undefined&&gNode.y!==undefined;nodes.push(node)}return{nodes:nodes,edges:edges}}exports.parseGephi=parseGephi},{}],27:[function(require,module,exports){"use strict";exports["en"]={edit:"Edit",del:"Delete selected",back:"Back",addNode:"Add Node",addEdge:"Add Edge",editNode:"Edit Node",editEdge:"Edit Edge",addDescription:"Click in an empty space to place a new node.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",createEdgeError:"Cannot link edges to a cluster.",deleteClusterError:"Clusters cannot be deleted.",editClusterError:"Clusters cannot be edited."};exports["en_EN"]=exports["en"];exports["en_US"]=exports["en"];exports["de"]={edit:"Editieren",del:"Lsche Auswahl",back:"Zurck",addNode:"Knoten hinzufgen",addEdge:"Kante hinzufgen",editNode:"Knoten editieren",editEdge:"Kante editieren",addDescription:"Klicke auf eine freie Stelle, um einen neuen Knoten zu plazieren.",edgeDescription:"Klicke auf einen Knoten und ziehe die Kante zu einem anderen Knoten, um diese zu verbinden.",editEdgeDescription:"Klicke auf die Verbindungspunkte und ziehe diese auf einen Knoten, um sie zu verbinden.",createEdgeError:"Es ist nicht mglich, Kanten mit Clustern zu verbinden.",deleteClusterError:"Cluster knnen nicht gelscht werden.",editClusterError:"Cluster knnen nicht editiert werden."};exports["de_DE"]=exports["de"];exports["es"]={edit:"Editar",del:"Eliminar seleccin",back:"tras",addNode:"Aadir nodo",addEdge:"Aadir arista",editNode:"Editar nodo",editEdge:"Editar arista",addDescription:"Haga clic en un lugar vaco para colocar un nuevo nodo.",edgeDescription:"Haga clic en un nodo y arrastre la arista hacia otro nodo para conectarlos.",editEdgeDescription:"Haga clic en un punto de control y arrastrelo a un nodo para conectarlo.",createEdgeError:"No se puede conectar una arista a un grupo.",deleteClusterError:"No es posible eliminar grupos.",editClusterError:"No es posible editar grupos."};exports["es_ES"]=exports["es"];exports["it"]={edit:"Modifica",del:"Cancella la selezione",back:"Indietro",addNode:"Aggiungi un nodo",addEdge:"Aggiungi un vertice",editNode:"Modifica il nodo",editEdge:"Modifica il vertice",addDescription:"Clicca per aggiungere un nuovo nodo",edgeDescription:"Clicca su un nodo e trascinalo ad un altro nodo per connetterli.",editEdgeDescription:"Clicca sui Punti di controllo e trascinali ad un nodo per connetterli.",
createEdgeError:"Non si possono collegare vertici ad un cluster",deleteClusterError:"I cluster non possono essere cancellati",editClusterError:"I clusters non possono essere modificati."};exports["it_IT"]=exports["it"];exports["nl"]={edit:"Wijzigen",del:"Selectie verwijderen",back:"Terug",addNode:"Node toevoegen",addEdge:"Link toevoegen",editNode:"Node wijzigen",editEdge:"Link wijzigen",addDescription:"Klik op een leeg gebied om een nieuwe node te maken.",edgeDescription:"Klik op een node en sleep de link naar een andere node om ze te verbinden.",editEdgeDescription:"Klik op de verbindingspunten en sleep ze naar een node om daarmee te verbinden.",createEdgeError:"Kan geen link maken naar een cluster.",deleteClusterError:"Clusters kunnen niet worden verwijderd.",editClusterError:"Clusters kunnen niet worden aangepast."};exports["nl_NL"]=exports["nl"];exports["nl_BE"]=exports["nl"];exports["pt-br"]={edit:"Editar",del:"Remover selecionado",back:"Voltar",addNode:"Adicionar n",addEdge:"Adicionar aresta",editNode:"Editar n",editEdge:"Editar aresta",addDescription:"Clique em um espao em branco para adicionar um novo n",edgeDescription:"Clique em um n e arraste a aresta at outro n para conect-los",editEdgeDescription:"Clique nos pontos de controle e os arraste para um n para conect-los",createEdgeError:"No foi possvel linkar arestas a um cluster.",deleteClusterError:"Clusters no puderam ser removidos.",editClusterError:"Clusters no puderam ser editados."};exports["pt-BR"]=exports["pt-br"];exports["pt_BR"]=exports["pt-br"];exports["pt_br"]=exports["pt-br"];exports["ru"]={edit:"",del:" ",back:"",addNode:" ",addEdge:" ",editNode:" ",editEdge:" ",addDescription:"   ,    .",edgeDescription:"        ,   .",editEdgeDescription:"        ,    .",createEdgeError:"    .",deleteClusterError:"    ",editClusterError:"   ."};exports["ru_RU"]=exports["ru"]},{}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Hammer=require("../../module/hammer");var hammerUtil=require("../../hammerUtil");var util=require("../../util");var Canvas=function(){function Canvas(body){(0,_classCallCheck3["default"])(this,Canvas);this.body=body;this.pixelRatio=1;this.resizeTimer=undefined;this.resizeFunction=this._onResize.bind(this);this.cameraState={};this.initialized=false;this.canvasViewCenter={};this.options={};this.defaultOptions={autoResize:true,height:"100%",width:"100%"};util.extend(this.options,this.defaultOptions);this.bindEventListeners()}(0,_createClass3["default"])(Canvas,[{key:"bindEventListeners",value:function bindEventListeners(){var _this=this;this.body.emitter.once("resize",function(obj){if(obj.width!==0){_this.body.view.translation.x=obj.width*.5}if(obj.height!==0){_this.body.view.translation.y=obj.height*.5}});this.body.emitter.on("setSize",this.setSize.bind(this));this.body.emitter.on("destroy",function(){_this.hammerFrame.destroy();_this.hammer.destroy();_this._cleanUp()})}},{key:"setOptions",value:function setOptions(options){var _this2=this;if(options!==undefined){var fields=["width","height","autoResize"];util.selectiveDeepExtend(fields,this.options,options)}if(this.options.autoResize===true){this._cleanUp();this.resizeTimer=setInterval(function(){var changed=_this2.setSize();if(changed===true){_this2.body.emitter.emit("_requestRedraw")}},1e3);this.resizeFunction=this._onResize.bind(this);util.addEventListener(window,"resize",this.resizeFunction)}}},{key:"_cleanUp",value:function _cleanUp(){if(this.resizeTimer!==undefined){clearInterval(this.resizeTimer)}util.removeEventListener(window,"resize",this.resizeFunction);this.resizeFunction=undefined}},{key:"_onResize",value:function _onResize(){this.setSize();this.body.emitter.emit("_redraw")}},{key:"_getCameraState",value:function _getCameraState(){var pixelRatio=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.pixelRatio;if(this.initialized===true){this.cameraState.previousWidth=this.frame.canvas.width/pixelRatio;this.cameraState.previousHeight=this.frame.canvas.height/pixelRatio;this.cameraState.scale=this.body.view.scale;this.cameraState.position=this.DOMtoCanvas({x:.5*this.frame.canvas.width/pixelRatio,y:.5*this.frame.canvas.height/pixelRatio})}}},{key:"_setCameraState",value:function _setCameraState(){if(this.cameraState.scale!==undefined&&this.frame.canvas.clientWidth!==0&&this.frame.canvas.clientHeight!==0&&this.pixelRatio!==0&&this.cameraState.previousWidth>0){var widthRatio=this.frame.canvas.width/this.pixelRatio/this.cameraState.previousWidth;var heightRatio=this.frame.canvas.height/this.pixelRatio/this.cameraState.previousHeight;var newScale=this.cameraState.scale;if(widthRatio!=1&&heightRatio!=1){newScale=this.cameraState.scale*.5*(widthRatio+heightRatio)}else if(widthRatio!=1){newScale=this.cameraState.scale*widthRatio}else if(heightRatio!=1){newScale=this.cameraState.scale*heightRatio}this.body.view.scale=newScale;var currentViewCenter=this.DOMtoCanvas({x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight});var distanceFromCenter={x:currentViewCenter.x-this.cameraState.position.x,y:currentViewCenter.y-this.cameraState.position.y};this.body.view.translation.x+=distanceFromCenter.x*this.body.view.scale;this.body.view.translation.y+=distanceFromCenter.y*this.body.view.scale}}},{key:"_prepareValue",value:function _prepareValue(value){if(typeof value==="number"){return value+"px"}else if(typeof value==="string"){if(value.indexOf("%")!==-1||value.indexOf("px")!==-1){return value}else if(value.indexOf("%")===-1){return value+"px"}}throw new Error("Could not use the value supplied for width or height:"+value)}},{key:"_create",value:function _create(){while(this.body.container.hasChildNodes()){this.body.container.removeChild(this.body.container.firstChild)}this.frame=document.createElement("div");this.frame.className="vis-network";this.frame.style.position="relative";this.frame.style.overflow="hidden";this.frame.tabIndex=900;this.frame.canvas=document.createElement("canvas");this.frame.canvas.style.position="relative";this.frame.appendChild(this.frame.canvas);if(!this.frame.canvas.getContext){var noCanvas=document.createElement("DIV");noCanvas.style.color="red";noCanvas.style.fontWeight="bold";noCanvas.style.padding="10px";noCanvas.innerHTML="Error: your browser does not support HTML canvas";this.frame.canvas.appendChild(noCanvas)}else{var ctx=this.frame.canvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1);this.frame.canvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}this.body.container.appendChild(this.frame);this.body.view.scale=1;this.body.view.translation={x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight};this._bindHammer()}},{key:"_bindHammer",value:function _bindHammer(){var _this3=this;if(this.hammer!==undefined){this.hammer.destroy()}this.drag={};this.pinch={};this.hammer=new Hammer(this.frame.canvas);this.hammer.get("pinch").set({enable:true});this.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_ALL});hammerUtil.onTouch(this.hammer,function(event){_this3.body.eventListeners.onTouch(event)});this.hammer.on("tap",function(event){_this3.body.eventListeners.onTap(event)});this.hammer.on("doubletap",function(event){_this3.body.eventListeners.onDoubleTap(event)});this.hammer.on("press",function(event){_this3.body.eventListeners.onHold(event)});this.hammer.on("panstart",function(event){_this3.body.eventListeners.onDragStart(event)});this.hammer.on("panmove",function(event){_this3.body.eventListeners.onDrag(event)});this.hammer.on("panend",function(event){_this3.body.eventListeners.onDragEnd(event)});this.hammer.on("pinch",function(event){_this3.body.eventListeners.onPinch(event)});this.frame.canvas.addEventListener("mousewheel",function(event){_this3.body.eventListeners.onMouseWheel(event)});this.frame.canvas.addEventListener("DOMMouseScroll",function(event){_this3.body.eventListeners.onMouseWheel(event)});this.frame.canvas.addEventListener("mousemove",function(event){_this3.body.eventListeners.onMouseMove(event)});this.frame.canvas.addEventListener("contextmenu",function(event){_this3.body.eventListeners.onContext(event)});this.hammerFrame=new Hammer(this.frame);hammerUtil.onRelease(this.hammerFrame,function(event){_this3.body.eventListeners.onRelease(event)})}},{key:"setSize",value:function setSize(){var width=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.options.width;var height=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.options.height;width=this._prepareValue(width);height=this._prepareValue(height);var emitEvent=false;var oldWidth=this.frame.canvas.width;var oldHeight=this.frame.canvas.height;var ctx=this.frame.canvas.getContext("2d");var previousRatio=this.pixelRatio;this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1);if(width!=this.options.width||height!=this.options.height||this.frame.style.width!=width||this.frame.style.height!=height){this._getCameraState(previousRatio);this.frame.style.width=width;this.frame.style.height=height;this.frame.canvas.style.width="100%";this.frame.canvas.style.height="100%";this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio);this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);this.options.width=width;this.options.height=height;this.canvasViewCenter={x:.5*this.frame.clientWidth,y:.5*this.frame.clientHeight};emitEvent=true}else{if(this.frame.canvas.width!=Math.round(this.frame.canvas.clientWidth*this.pixelRatio)||this.frame.canvas.height!=Math.round(this.frame.canvas.clientHeight*this.pixelRatio)){this._getCameraState(previousRatio)}if(this.frame.canvas.width!=Math.round(this.frame.canvas.clientWidth*this.pixelRatio)){this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio);emitEvent=true}if(this.frame.canvas.height!=Math.round(this.frame.canvas.clientHeight*this.pixelRatio)){this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);emitEvent=true}}if(emitEvent===true){this.body.emitter.emit("resize",{width:Math.round(this.frame.canvas.width/this.pixelRatio),height:Math.round(this.frame.canvas.height/this.pixelRatio),oldWidth:Math.round(oldWidth/this.pixelRatio),oldHeight:Math.round(oldHeight/this.pixelRatio)});this._setCameraState()}this.initialized=true;return emitEvent}},{key:"_XconvertDOMtoCanvas",value:function _XconvertDOMtoCanvas(x){return(x-this.body.view.translation.x)/this.body.view.scale}},{key:"_XconvertCanvasToDOM",value:function _XconvertCanvasToDOM(x){return x*this.body.view.scale+this.body.view.translation.x}},{key:"_YconvertDOMtoCanvas",value:function _YconvertDOMtoCanvas(y){return(y-this.body.view.translation.y)/this.body.view.scale}},{key:"_YconvertCanvasToDOM",value:function _YconvertCanvasToDOM(y){return y*this.body.view.scale+this.body.view.translation.y}},{key:"canvasToDOM",value:function canvasToDOM(pos){return{x:this._XconvertCanvasToDOM(pos.x),y:this._YconvertCanvasToDOM(pos.y)}}},{key:"DOMtoCanvas",value:function DOMtoCanvas(pos){return{x:this._XconvertDOMtoCanvas(pos.x),y:this._YconvertDOMtoCanvas(pos.y)}}}]);return Canvas}();exports["default"]=Canvas},{"../../hammerUtil":18,"../../module/hammer":19,"../../util":116,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}if(typeof window!=="undefined"){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame}var util=require("../../util");var CanvasRenderer=function(){function CanvasRenderer(body,canvas){(0,_classCallCheck3["default"])(this,CanvasRenderer);this.body=body;this.canvas=canvas;this.redrawRequested=false;this.renderTimer=undefined;this.requiresTimeout=true;this.renderingActive=false;this.renderRequests=0;this.pixelRatio=undefined;this.allowRedraw=true;this.dragging=false;this.options={};this.defaultOptions={hideEdgesOnDrag:false,hideNodesOnDrag:false};util.extend(this.options,this.defaultOptions);this._determineBrowserMethod();this.bindEventListeners()}(0,_createClass3["default"])(CanvasRenderer,[{key:"bindEventListeners",value:function bindEventListeners(){var _this=this;this.body.emitter.on("dragStart",function(){_this.dragging=true});this.body.emitter.on("dragEnd",function(){_this.dragging=false});this.body.emitter.on("_resizeNodes",function(){_this._resizeNodes()});this.body.emitter.on("_redraw",function(){if(_this.renderingActive===false){_this._redraw()}});this.body.emitter.on("_blockRedraw",function(){_this.allowRedraw=false});this.body.emitter.on("_allowRedraw",function(){_this.allowRedraw=true;_this.redrawRequested=false});this.body.emitter.on("_requestRedraw",this._requestRedraw.bind(this));this.body.emitter.on("_startRendering",function(){_this.renderRequests+=1;_this.renderingActive=true;_this._startRendering()});this.body.emitter.on("_stopRendering",function(){_this.renderRequests-=1;_this.renderingActive=_this.renderRequests>0;_this.renderTimer=undefined});this.body.emitter.on("destroy",function(){_this.renderRequests=0;_this.allowRedraw=false;_this.renderingActive=false;if(_this.requiresTimeout===true){clearTimeout(_this.renderTimer)}else{cancelAnimationFrame(_this.renderTimer)}_this.body.emitter.off()})}},{key:"setOptions",value:function setOptions(options){if(options!==undefined){var fields=["hideEdgesOnDrag","hideNodesOnDrag"];util.selectiveDeepExtend(fields,this.options,options)}}},{key:"_startRendering",value:function _startRendering(){if(this.renderingActive===true){if(this.renderTimer===undefined){if(this.requiresTimeout===true){this.renderTimer=window.setTimeout(this._renderStep.bind(this),this.simulationInterval)}else{this.renderTimer=window.requestAnimationFrame(this._renderStep.bind(this))}}}}},{key:"_renderStep",value:function _renderStep(){if(this.renderingActive===true){this.renderTimer=undefined;if(this.requiresTimeout===true){this._startRendering()}this._redraw();if(this.requiresTimeout===false){this._startRendering()}}}},{key:"redraw",value:function redraw(){this.body.emitter.emit("setSize");this._redraw()}},{key:"_requestRedraw",value:function _requestRedraw(){var _this2=this;if(this.redrawRequested!==true&&this.renderingActive===false&&this.allowRedraw===true){this.redrawRequested=true;if(this.requiresTimeout===true){window.setTimeout(function(){_this2._redraw(false)},0)}else{window.requestAnimationFrame(function(){_this2._redraw(false)})}}}},{key:"_redraw",value:function _redraw(){var hidden=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.allowRedraw===true){this.body.emitter.emit("initRedraw");this.redrawRequested=false;var ctx=this.canvas.frame.canvas.getContext("2d");if(this.canvas.frame.canvas.width===0||this.canvas.frame.canvas.height===0){this.canvas.setSize()}this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1);ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var w=this.canvas.frame.canvas.clientWidth;var h=this.canvas.frame.canvas.clientHeight;ctx.clearRect(0,0,w,h);if(this.canvas.frame.clientWidth===0){return}ctx.save();ctx.translate(this.body.view.translation.x,this.body.view.translation.y);ctx.scale(this.body.view.scale,this.body.view.scale);ctx.beginPath();this.body.emitter.emit("beforeDrawing",ctx);ctx.closePath();if(hidden===false){if(this.dragging===false||this.dragging===true&&this.options.hideEdgesOnDrag===false){this._drawEdges(ctx)}}if(this.dragging===false||this.dragging===true&&this.options.hideNodesOnDrag===false){this._drawNodes(ctx,hidden)}ctx.beginPath();this.body.emitter.emit("afterDrawing",ctx);ctx.closePath();ctx.restore();if(hidden===true){ctx.clearRect(0,0,w,h)}}}},{key:"_resizeNodes",value:function _resizeNodes(){var ctx=this.canvas.frame.canvas.getContext("2d");if(this.pixelRatio===undefined){this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1)}ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);ctx.save();ctx.translate(this.body.view.translation.x,this.body.view.translation.y);ctx.scale(this.body.view.scale,this.body.view.scale);var nodes=this.body.nodes;var node=void 0;for(var nodeId in nodes){if(nodes.hasOwnProperty(nodeId)){node=nodes[nodeId];node.resize(ctx);node.updateBoundingBox(ctx,node.selected)}}ctx.restore()}},{key:"_drawNodes",value:function _drawNodes(ctx){var alwaysShow=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var nodes=this.body.nodes;var nodeIndices=this.body.nodeIndices;var node=void 0;var selected=[];var margin=20;var topLeft=this.canvas.DOMtoCanvas({x:-margin,y:-margin});var bottomRight=this.canvas.DOMtoCanvas({x:this.canvas.frame.canvas.clientWidth+margin,y:this.canvas.frame.canvas.clientHeight+margin});var viewableArea={top:topLeft.y,left:topLeft.x,bottom:bottomRight.y,right:bottomRight.x};for(var i=0;i<nodeIndices.length;i++){node=nodes[nodeIndices[i]];if(node.isSelected()){selected.push(nodeIndices[i])}else{if(alwaysShow===true){node.draw(ctx)}else if(node.isBoundingBoxOverlappingWith(viewableArea)===true){node.draw(ctx)}else{node.updateBoundingBox(ctx,node.selected)}}}for(var _i=0;_i<selected.length;_i++){node=nodes[selected[_i]];node.draw(ctx)}}},{key:"_drawEdges",value:function _drawEdges(ctx){var edges=this.body.edges;var edgeIndices=this.body.edgeIndices;var edge=void 0;for(var i=0;i<edgeIndices.length;i++){edge=edges[edgeIndices[i]];if(edge.connected===true){edge.draw(ctx)}}}},{key:"_determineBrowserMethod",value:function _determineBrowserMethod(){if(typeof window!=="undefined"){var browserType=navigator.userAgent.toLowerCase();this.requiresTimeout=false;if(browserType.indexOf("msie 9.0")!=-1){this.requiresTimeout=true}else if(browserType.indexOf("safari")!=-1){if(browserType.indexOf("chrome")<=-1){this.requiresTimeout=true}}}else{this.requiresTimeout=true}}}]);return CanvasRenderer}();exports["default"]=CanvasRenderer},{"../../util":116,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _NetworkUtil=require("../NetworkUtil");var _NetworkUtil2=_interopRequireDefault(_NetworkUtil);var _Cluster=require("./components/nodes/Cluster");var _Cluster2=_interopRequireDefault(_Cluster);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var ClusterEngine=function(){function ClusterEngine(body){var _this=this;(0,_classCallCheck3["default"])(this,ClusterEngine);this.body=body;this.clusteredNodes={};this.clusteredEdges={};this.options={};this.defaultOptions={};util.extend(this.options,this.defaultOptions);this.body.emitter.on("_resetData",function(){_this.clusteredNodes={};_this.clusteredEdges={}})}(0,_createClass3["default"])(ClusterEngine,[{key:"clusterByHubsize",value:function clusterByHubsize(hubsize,options){if(hubsize===undefined){hubsize=this._getHubSize()}else if((typeof hubsize==="undefined"?"undefined":(0,_typeof3["default"])(hubsize))==="object"){options=this._checkOptions(hubsize);hubsize=this._getHubSize()}var nodesToCluster=[];for(var i=0;i<this.body.nodeIndices.length;i++){var node=this.body.nodes[this.body.nodeIndices[i]];if(node.edges.length>=hubsize){nodesToCluster.push(node.id)}}for(var _i=0;_i<nodesToCluster.length;_i++){this.clusterByConnection(nodesToCluster[_i],options,true)}this.body.emitter.emit("_dataChanged")}},{key:"cluster",value:function cluster(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var refreshData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(options.joinCondition===undefined){throw new Error("Cannot call clusterByNodeData without a joinCondition function in the options.")}options=this._checkOptions(options);var childNodesObj={};var childEdgesObj={};for(var i=0;i<this.body.nodeIndices.length;i++){var nodeId=this.body.nodeIndices[i];var node=this.body.nodes[nodeId];var clonedOptions=_NetworkUtil2["default"].cloneOptions(node);if(options.joinCondition(clonedOptions)===true){childNodesObj[nodeId]=this.body.nodes[nodeId];for(var _i2=0;_i2<node.edges.length;_i2++){var edge=node.edges[_i2];if(this.clusteredEdges[edge.id]===undefined){childEdgesObj[edge.id]=edge}}}}this._cluster(childNodesObj,childEdgesObj,options,refreshData)}},{key:"clusterByEdgeCount",value:function clusterByEdgeCount(edgeCount,options){var refreshData=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;options=this._checkOptions(options);var clusters=[];var usedNodes={};var edge=void 0,edges=void 0,node=void 0,nodeId=void 0,relevantEdgeCount=void 0;for(var i=0;i<this.body.nodeIndices.length;i++){var childNodesObj={};var childEdgesObj={};nodeId=this.body.nodeIndices[i];if(usedNodes[nodeId]===undefined){relevantEdgeCount=0;node=this.body.nodes[nodeId];edges=[];for(var j=0;j<node.edges.length;j++){edge=node.edges[j];if(this.clusteredEdges[edge.id]===undefined){if(edge.toId!==edge.fromId){relevantEdgeCount++}edges.push(edge)}}if(relevantEdgeCount===edgeCount){var gatheringSuccessful=true;for(var _j=0;_j<edges.length;_j++){edge=edges[_j];var childNodeId=this._getConnectedId(edge,nodeId);if(options.joinCondition===undefined){childEdgesObj[edge.id]=edge;childNodesObj[nodeId]=this.body.nodes[nodeId];childNodesObj[childNodeId]=this.body.nodes[childNodeId];usedNodes[nodeId]=true}else{var clonedOptions=_NetworkUtil2["default"].cloneOptions(this.body.nodes[nodeId]);if(options.joinCondition(clonedOptions)===true){childEdgesObj[edge.id]=edge;childNodesObj[nodeId]=this.body.nodes[nodeId];usedNodes[nodeId]=true}else{gatheringSuccessful=false;break}}}if((0,_keys2["default"])(childNodesObj).length>0&&(0,_keys2["default"])(childEdgesObj).length>0&&gatheringSuccessful===true){clusters.push({nodes:childNodesObj,edges:childEdgesObj})}}}}for(var _i3=0;_i3<clusters.length;_i3++){this._cluster(clusters[_i3].nodes,clusters[_i3].edges,options,false)}if(refreshData===true){this.body.emitter.emit("_dataChanged")}}},{key:"clusterOutliers",value:function clusterOutliers(options){var refreshData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.clusterByEdgeCount(1,options,refreshData)}},{key:"clusterBridges",value:function clusterBridges(options){var refreshData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.clusterByEdgeCount(2,options,refreshData)}},{key:"clusterByConnection",value:function clusterByConnection(nodeId,options){var refreshData=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(nodeId===undefined){throw new Error("No nodeId supplied to clusterByConnection!")}if(this.body.nodes[nodeId]===undefined){throw new Error("The nodeId given to clusterByConnection does not exist!")}var node=this.body.nodes[nodeId];options=this._checkOptions(options,node);if(options.clusterNodeProperties.x===undefined){options.clusterNodeProperties.x=node.x}if(options.clusterNodeProperties.y===undefined){options.clusterNodeProperties.y=node.y}if(options.clusterNodeProperties.fixed===undefined){options.clusterNodeProperties.fixed={};options.clusterNodeProperties.fixed.x=node.options.fixed.x;options.clusterNodeProperties.fixed.y=node.options.fixed.y}var childNodesObj={};var childEdgesObj={};var parentNodeId=node.id;var parentClonedOptions=_NetworkUtil2["default"].cloneOptions(node);childNodesObj[parentNodeId]=node;for(var i=0;i<node.edges.length;i++){var edge=node.edges[i];if(this.clusteredEdges[edge.id]===undefined){var childNodeId=this._getConnectedId(edge,parentNodeId);if(this.clusteredNodes[childNodeId]===undefined){if(childNodeId!==parentNodeId){if(options.joinCondition===undefined){childEdgesObj[edge.id]=edge;childNodesObj[childNodeId]=this.body.nodes[childNodeId]}else{var childClonedOptions=_NetworkUtil2["default"].cloneOptions(this.body.nodes[childNodeId]);if(options.joinCondition(parentClonedOptions,childClonedOptions)===true){childEdgesObj[edge.id]=edge;childNodesObj[childNodeId]=this.body.nodes[childNodeId]}}}else{childEdgesObj[edge.id]=edge}}}}var childNodeIDs=(0,_keys2["default"])(childNodesObj).map(function(childNode){return childNodesObj[childNode].id});for(childNode in childNodesObj){var childNode=childNodesObj[childNode];for(var y=0;y<childNode.edges.length;y++){var childEdge=childNode.edges[y];if(childNodeIDs.indexOf(this._getConnectedId(childEdge,childNode.id))>-1){childEdgesObj[childEdge.id]=childEdge}}}this._cluster(childNodesObj,childEdgesObj,options,refreshData)}},{key:"_createClusterEdges",value:function _createClusterEdges(childNodesObj,childEdgesObj,clusterNodeProperties,clusterEdgeProperties){var edge=void 0,childNodeId=void 0,childNode=void 0,toId=void 0,fromId=void 0,otherNodeId=void 0;var childKeys=(0,_keys2["default"])(childNodesObj);var createEdges=[];for(var i=0;i<childKeys.length;i++){childNodeId=childKeys[i];childNode=childNodesObj[childNodeId];for(var j=0;j<childNode.edges.length;j++){edge=childNode.edges[j];if(this.clusteredEdges[edge.id]===undefined){if(edge.toId==edge.fromId){childEdgesObj[edge.id]=edge}else{if(edge.toId==childNodeId){toId=clusterNodeProperties.id;fromId=edge.fromId;otherNodeId=fromId}else{toId=edge.toId;fromId=clusterNodeProperties.id;otherNodeId=toId}}if(childNodesObj[otherNodeId]===undefined){createEdges.push({edge:edge,fromId:fromId,toId:toId})}}}}for(var _j2=0;_j2<createEdges.length;_j2++){var _edge=createEdges[_j2].edge;var clonedOptions=_NetworkUtil2["default"].cloneOptions(_edge,"edge");util.deepExtend(clonedOptions,clusterEdgeProperties);clonedOptions.from=createEdges[_j2].fromId;clonedOptions.to=createEdges[_j2].toId;clonedOptions.id="clusterEdge:"+util.randomUUID();var newEdge=this.body.functions.createEdge(clonedOptions);newEdge.clusteringEdgeReplacingId=_edge.id;this.body.edges[_edge.id].edgeReplacedById=newEdge.id;this.body.edges[newEdge.id]=newEdge;newEdge.connect();this._backupEdgeOptions(_edge);_edge.setOptions({physics:false,hidden:true})}}},{key:"_checkOptions",value:function _checkOptions(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(options.clusterEdgeProperties===undefined){options.clusterEdgeProperties={}}if(options.clusterNodeProperties===undefined){options.clusterNodeProperties={}}return options}},{key:"_cluster",value:function _cluster(childNodesObj,childEdgesObj,options){var refreshData=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;if((0,_keys2["default"])(childNodesObj).length==0){return}if((0,_keys2["default"])(childNodesObj).length==1&&options.clusterNodeProperties.allowSingleNodeCluster!=true){return}for(var nodeId in childNodesObj){if(childNodesObj.hasOwnProperty(nodeId)){if(this.clusteredNodes[nodeId]!==undefined){return}}}var clusterNodeProperties=util.deepExtend({},options.clusterNodeProperties);if(options.processProperties!==undefined){var childNodesOptions=[];for(var _nodeId in childNodesObj){if(childNodesObj.hasOwnProperty(_nodeId)){var clonedOptions=_NetworkUtil2["default"].cloneOptions(childNodesObj[_nodeId]);childNodesOptions.push(clonedOptions)}}var childEdgesOptions=[];for(var edgeId in childEdgesObj){if(childEdgesObj.hasOwnProperty(edgeId)){if(edgeId.substr(0,12)!=="clusterEdge:"){var _clonedOptions=_NetworkUtil2["default"].cloneOptions(childEdgesObj[edgeId],"edge");childEdgesOptions.push(_clonedOptions)}}}clusterNodeProperties=options.processProperties(clusterNodeProperties,childNodesOptions,childEdgesOptions);if(!clusterNodeProperties){throw new Error("The processProperties function does not return properties!")}}if(clusterNodeProperties.id===undefined){clusterNodeProperties.id="cluster:"+util.randomUUID()}var clusterId=clusterNodeProperties.id;if(clusterNodeProperties.label===undefined){clusterNodeProperties.label="cluster"}var pos=undefined;if(clusterNodeProperties.x===undefined){pos=this._getClusterPosition(childNodesObj);clusterNodeProperties.x=pos.x}if(clusterNodeProperties.y===undefined){if(pos===undefined){pos=this._getClusterPosition(childNodesObj)}clusterNodeProperties.y=pos.y}clusterNodeProperties.id=clusterId;var clusterNode=this.body.functions.createNode(clusterNodeProperties,_Cluster2["default"]);clusterNode.isCluster=true;clusterNode.containedNodes=childNodesObj;clusterNode.containedEdges=childEdgesObj;clusterNode.clusterEdgeProperties=options.clusterEdgeProperties;this.body.nodes[clusterNodeProperties.id]=clusterNode;this._createClusterEdges(childNodesObj,childEdgesObj,clusterNodeProperties,options.clusterEdgeProperties);for(var _edgeId in childEdgesObj){if(childEdgesObj.hasOwnProperty(_edgeId)){if(this.body.edges[_edgeId]!==undefined){var edge=this.body.edges[_edgeId];this._backupEdgeOptions(edge);edge.setOptions({physics:false,hidden:true})}}}for(var _nodeId2 in childNodesObj){if(childNodesObj.hasOwnProperty(_nodeId2)){this.clusteredNodes[_nodeId2]={clusterId:clusterNodeProperties.id,node:this.body.nodes[_nodeId2]};this.body.nodes[_nodeId2].setOptions({hidden:true,physics:false})}}clusterNodeProperties.id=undefined;if(refreshData===true){this.body.emitter.emit("_dataChanged")}}},{key:"_backupEdgeOptions",value:function _backupEdgeOptions(edge){if(this.clusteredEdges[edge.id]===undefined){this.clusteredEdges[edge.id]={physics:edge.options.physics,hidden:edge.options.hidden}}}},{key:"_restoreEdge",value:function _restoreEdge(edge){var originalOptions=this.clusteredEdges[edge.id];if(originalOptions!==undefined){edge.setOptions({physics:originalOptions.physics,hidden:originalOptions.hidden});delete this.clusteredEdges[edge.id]}}},{key:"isCluster",value:function isCluster(nodeId){if(this.body.nodes[nodeId]!==undefined){return this.body.nodes[nodeId].isCluster===true}else{console.log("Node does not exist.");return false}}},{key:"_getClusterPosition",value:function _getClusterPosition(childNodesObj){var childKeys=(0,_keys2["default"])(childNodesObj);var minX=childNodesObj[childKeys[0]].x;var maxX=childNodesObj[childKeys[0]].x;var minY=childNodesObj[childKeys[0]].y;
var maxY=childNodesObj[childKeys[0]].y;var node=void 0;for(var i=1;i<childKeys.length;i++){node=childNodesObj[childKeys[i]];minX=node.x<minX?node.x:minX;maxX=node.x>maxX?node.x:maxX;minY=node.y<minY?node.y:minY;maxY=node.y>maxY?node.y:maxY}return{x:.5*(minX+maxX),y:.5*(minY+maxY)}}},{key:"openCluster",value:function openCluster(clusterNodeId,options){var refreshData=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(clusterNodeId===undefined){throw new Error("No clusterNodeId supplied to openCluster.")}if(this.body.nodes[clusterNodeId]===undefined){throw new Error("The clusterNodeId supplied to openCluster does not exist.")}if(this.body.nodes[clusterNodeId].containedNodes===undefined){console.log("The node:"+clusterNodeId+" is not a cluster.");return}var clusterNode=this.body.nodes[clusterNodeId];var containedNodes=clusterNode.containedNodes;var containedEdges=clusterNode.containedEdges;if(options!==undefined&&options.releaseFunction!==undefined&&typeof options.releaseFunction==="function"){var positions={};var clusterPosition={x:clusterNode.x,y:clusterNode.y};for(var nodeId in containedNodes){if(containedNodes.hasOwnProperty(nodeId)){var containedNode=this.body.nodes[nodeId];positions[nodeId]={x:containedNode.x,y:containedNode.y}}}var newPositions=options.releaseFunction(clusterPosition,positions);for(var _nodeId3 in containedNodes){if(containedNodes.hasOwnProperty(_nodeId3)){var _containedNode=this.body.nodes[_nodeId3];if(newPositions[_nodeId3]!==undefined){_containedNode.x=newPositions[_nodeId3].x===undefined?clusterNode.x:newPositions[_nodeId3].x;_containedNode.y=newPositions[_nodeId3].y===undefined?clusterNode.y:newPositions[_nodeId3].y}}}}else{for(var _nodeId4 in containedNodes){if(containedNodes.hasOwnProperty(_nodeId4)){var _containedNode2=this.body.nodes[_nodeId4];_containedNode2=containedNodes[_nodeId4];if(_containedNode2.options.fixed.x===false){_containedNode2.x=clusterNode.x}if(_containedNode2.options.fixed.y===false){_containedNode2.y=clusterNode.y}}}}for(var _nodeId5 in containedNodes){if(containedNodes.hasOwnProperty(_nodeId5)){var _containedNode3=this.body.nodes[_nodeId5];_containedNode3.vx=clusterNode.vx;_containedNode3.vy=clusterNode.vy;_containedNode3.setOptions({hidden:false,physics:true});delete this.clusteredNodes[_nodeId5]}}var edgesToBeDeleted=[];for(var i=0;i<clusterNode.edges.length;i++){edgesToBeDeleted.push(clusterNode.edges[i])}for(var _i4=0;_i4<edgesToBeDeleted.length;_i4++){var edge=edgesToBeDeleted[_i4];var otherNodeId=this._getConnectedId(edge,clusterNodeId);if(this.clusteredNodes[otherNodeId]!==undefined){var otherCluster=this.body.nodes[this.clusteredNodes[otherNodeId].clusterId];var transferEdge=this.body.edges[edge.clusteringEdgeReplacingId];if(transferEdge!==undefined){otherCluster.containedEdges[transferEdge.id]=transferEdge;delete containedEdges[transferEdge.id];var fromId=transferEdge.fromId;var toId=transferEdge.toId;if(transferEdge.toId==otherNodeId){toId=this.clusteredNodes[otherNodeId].clusterId}else{fromId=this.clusteredNodes[otherNodeId].clusterId}var clonedOptions=_NetworkUtil2["default"].cloneOptions(transferEdge,"edge");util.deepExtend(clonedOptions,otherCluster.clusterEdgeProperties);var id="clusterEdge:"+util.randomUUID();util.deepExtend(clonedOptions,{from:fromId,to:toId,hidden:false,physics:true,id:id});var newEdge=this.body.functions.createEdge(clonedOptions);newEdge.clusteringEdgeReplacingId=transferEdge.id;this.body.edges[id]=newEdge;this.body.edges[id].connect()}}else{var replacedEdge=this.body.edges[edge.clusteringEdgeReplacingId];if(replacedEdge!==undefined){this._restoreEdge(replacedEdge)}}edge.cleanup();edge.disconnect();delete this.body.edges[edge.id]}for(var edgeId in containedEdges){if(containedEdges.hasOwnProperty(edgeId)){this._restoreEdge(containedEdges[edgeId])}}delete this.body.nodes[clusterNodeId];if(refreshData===true){this.body.emitter.emit("_dataChanged")}}},{key:"getNodesInCluster",value:function getNodesInCluster(clusterId){var nodesArray=[];if(this.isCluster(clusterId)===true){var containedNodes=this.body.nodes[clusterId].containedNodes;for(var nodeId in containedNodes){if(containedNodes.hasOwnProperty(nodeId)){nodesArray.push(this.body.nodes[nodeId].id)}}}return nodesArray}},{key:"findNode",value:function findNode(nodeId){var stack=[];var max=100;var counter=0;while(this.clusteredNodes[nodeId]!==undefined&&counter<max){stack.push(this.body.nodes[nodeId].id);nodeId=this.clusteredNodes[nodeId].clusterId;counter++}stack.push(this.body.nodes[nodeId].id);stack.reverse();return stack}},{key:"updateClusteredNode",value:function updateClusteredNode(clusteredNodeId,newOptions){if(clusteredNodeId===undefined){throw new Error("No clusteredNodeId supplied to updateClusteredNode.")}if(newOptions===undefined){throw new Error("No newOptions supplied to updateClusteredNode.")}if(this.body.nodes[clusteredNodeId]===undefined){throw new Error("The clusteredNodeId supplied to updateClusteredNode does not exist.")}this.body.nodes[clusteredNodeId].setOptions(newOptions);this.body.emitter.emit("_dataChanged")}},{key:"updateEdge",value:function updateEdge(startEdgeId,newOptions){if(startEdgeId===undefined){throw new Error("No startEdgeId supplied to updateEdge.")}if(newOptions===undefined){throw new Error("No newOptions supplied to updateEdge.")}if(this.body.edges[startEdgeId]===undefined){throw new Error("The startEdgeId supplied to updateEdge does not exist.")}var allEdgeIds=this.getClusteredEdges(startEdgeId);for(var i=0;i<allEdgeIds.length;i++){var edge=this.body.edges[allEdgeIds[i]];edge.setOptions(newOptions)}this.body.emitter.emit("_dataChanged")}},{key:"getClusteredEdges",value:function getClusteredEdges(edgeId){var stack=[];var max=100;var counter=0;while(edgeId!==undefined&&this.body.edges[edgeId]!==undefined&&counter<max){stack.push(this.body.edges[edgeId].id);edgeId=this.body.edges[edgeId].edgeReplacedById;counter++}stack.reverse();return stack}},{key:"getBaseEdge",value:function getBaseEdge(clusteredEdgeId){var baseEdgeId=clusteredEdgeId;var max=100;var counter=0;while(clusteredEdgeId!==undefined&&this.body.edges[clusteredEdgeId]!==undefined&&counter<max){clusteredEdgeId=this.body.edges[clusteredEdgeId].clusteringEdgeReplacingId;counter++;if(clusteredEdgeId!==undefined){baseEdgeId=clusteredEdgeId}}return baseEdgeId}},{key:"_getConnectedId",value:function _getConnectedId(edge,nodeId){if(edge.toId!=nodeId){return edge.toId}else if(edge.fromId!=nodeId){return edge.fromId}else{return edge.fromId}}},{key:"_getHubSize",value:function _getHubSize(){var average=0;var averageSquared=0;var hubCounter=0;var largestHub=0;for(var i=0;i<this.body.nodeIndices.length;i++){var node=this.body.nodes[this.body.nodeIndices[i]];if(node.edges.length>largestHub){largestHub=node.edges.length}average+=node.edges.length;averageSquared+=Math.pow(node.edges.length,2);hubCounter+=1}average=average/hubCounter;averageSquared=averageSquared/hubCounter;var variance=averageSquared-Math.pow(average,2);var standardDeviation=Math.sqrt(variance);var hubThreshold=Math.floor(average+2*standardDeviation);if(hubThreshold>largestHub){hubThreshold=largestHub}return hubThreshold}}]);return ClusterEngine}();exports["default"]=ClusterEngine},{"../../util":116,"../NetworkUtil":24,"./components/nodes/Cluster":52,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _Edge=require("./components/Edge");var _Edge2=_interopRequireDefault(_Edge);var _Label=require("./components/shared/Label");var _Label2=_interopRequireDefault(_Label);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var DataSet=require("../../DataSet");var DataView=require("../../DataView");var EdgesHandler=function(){function EdgesHandler(body,images,groups){var _this=this;(0,_classCallCheck3["default"])(this,EdgesHandler);this.body=body;this.images=images;this.groups=groups;this.body.functions.createEdge=this.create.bind(this);this.edgesListeners={add:function add(event,params){_this.add(params.items)},update:function update(event,params){_this.update(params.items)},remove:function remove(event,params){_this.remove(params.items)}};this.options={};this.defaultOptions={arrows:{to:{enabled:false,scaleFactor:1,type:"arrow"},middle:{enabled:false,scaleFactor:1,type:"arrow"},from:{enabled:false,scaleFactor:1,type:"arrow"}},arrowStrikethrough:true,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},dashes:false,font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:2,strokeColor:"#ffffff",align:"horizontal",multi:false,vadjust:0,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},hidden:false,hoverWidth:1.5,label:undefined,labelHighlightBold:true,length:undefined,physics:true,scaling:{min:1,max:15,label:{enabled:true,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function customScalingFunction(min,max,total,value){if(max===min){return.5}else{var scale=1/(max-min);return Math.max(0,(value-min)*scale)}}},selectionWidth:1.5,selfReferenceSize:20,shadow:{enabled:false,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},smooth:{enabled:true,type:"dynamic",forceDirection:"none",roundness:.5},title:undefined,width:1,value:undefined};util.extend(this.options,this.defaultOptions);this.bindEventListeners()}(0,_createClass3["default"])(EdgesHandler,[{key:"bindEventListeners",value:function bindEventListeners(){var _this2=this;this.body.emitter.on("_forceDisableDynamicCurves",function(type){if(type==="dynamic"){type="continuous"}var emitChange=false;for(var edgeId in _this2.body.edges){if(_this2.body.edges.hasOwnProperty(edgeId)){var edge=_this2.body.edges[edgeId];var edgeData=_this2.body.data.edges._data[edgeId];if(edgeData!==undefined){var edgeOptions=edgeData.smooth;if(edgeOptions!==undefined){if(edgeOptions.enabled===true&&edgeOptions.type==="dynamic"){if(type===undefined){edge.setOptions({smooth:false})}else{edge.setOptions({smooth:{type:type}})}emitChange=true}}}}}if(emitChange===true){_this2.body.emitter.emit("_dataChanged")}});this.body.emitter.on("_dataUpdated",function(){_this2.reconnectEdges()});this.body.emitter.on("refreshEdges",this.refresh.bind(this));this.body.emitter.on("refresh",this.refresh.bind(this));this.body.emitter.on("destroy",function(){util.forEach(_this2.edgesListeners,function(callback,event){if(_this2.body.data.edges)_this2.body.data.edges.off(event,callback)});delete _this2.body.functions.createEdge;delete _this2.edgesListeners.add;delete _this2.edgesListeners.update;delete _this2.edgesListeners.remove;delete _this2.edgesListeners})}},{key:"setOptions",value:function setOptions(options){this.edgeOptions=options;if(options!==undefined){_Edge2["default"].parseOptions(this.options,options);var dataChanged=false;if(options.smooth!==undefined){for(var edgeId in this.body.edges){if(this.body.edges.hasOwnProperty(edgeId)){dataChanged=this.body.edges[edgeId].updateEdgeType()||dataChanged}}}if(options.font!==undefined){_Label2["default"].parseOptions(this.options.font,options);for(var _edgeId in this.body.edges){if(this.body.edges.hasOwnProperty(_edgeId)){this.body.edges[_edgeId].updateLabelModule()}}}if(options.hidden!==undefined||options.physics!==undefined||dataChanged===true){this.body.emitter.emit("_dataChanged")}}}},{key:"setData",value:function setData(edges){var _this3=this;var doNotEmit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var oldEdgesData=this.body.data.edges;if(edges instanceof DataSet||edges instanceof DataView){this.body.data.edges=edges}else if(Array.isArray(edges)){this.body.data.edges=new DataSet;this.body.data.edges.add(edges)}else if(!edges){this.body.data.edges=new DataSet}else{throw new TypeError("Array or DataSet expected")}if(oldEdgesData){util.forEach(this.edgesListeners,function(callback,event){oldEdgesData.off(event,callback)})}this.body.edges={};if(this.body.data.edges){util.forEach(this.edgesListeners,function(callback,event){_this3.body.data.edges.on(event,callback)});var ids=this.body.data.edges.getIds();this.add(ids,true)}if(doNotEmit===false){this.body.emitter.emit("_dataChanged")}}},{key:"add",value:function add(ids){var doNotEmit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var edges=this.body.edges;var edgesData=this.body.data.edges;for(var i=0;i<ids.length;i++){var id=ids[i];var oldEdge=edges[id];if(oldEdge){oldEdge.disconnect()}var data=edgesData.get(id,{showInternalIds:true});edges[id]=this.create(data)}if(doNotEmit===false){this.body.emitter.emit("_dataChanged")}}},{key:"update",value:function update(ids){var edges=this.body.edges;var edgesData=this.body.data.edges;var dataChanged=false;for(var i=0;i<ids.length;i++){var id=ids[i];var data=edgesData.get(id);var edge=edges[id];if(edge!==undefined){edge.disconnect();dataChanged=edge.setOptions(data)||dataChanged;edge.connect()}else{this.body.edges[id]=this.create(data);dataChanged=true}}if(dataChanged===true){this.body.emitter.emit("_dataChanged")}else{this.body.emitter.emit("_dataUpdated")}}},{key:"remove",value:function remove(ids){var edges=this.body.edges;for(var i=0;i<ids.length;i++){var id=ids[i];var edge=edges[id];if(edge!==undefined){edge.cleanup();edge.disconnect();delete edges[id]}}this.body.emitter.emit("_dataChanged")}},{key:"refresh",value:function refresh(){var edges=this.body.edges;for(var edgeId in edges){var edge=undefined;if(edges.hasOwnProperty(edgeId)){edge=edges[edgeId]}var data=this.body.data.edges._data[edgeId];if(edge!==undefined&&data!==undefined){edge.setOptions(data)}}}},{key:"create",value:function create(properties){return new _Edge2["default"](properties,this.body,this.options,this.defaultOptions,this.edgeOptions)}},{key:"reconnectEdges",value:function reconnectEdges(){var id;var nodes=this.body.nodes;var edges=this.body.edges;for(id in nodes){if(nodes.hasOwnProperty(id)){nodes[id].edges=[]}}for(id in edges){if(edges.hasOwnProperty(id)){var edge=edges[id];edge.from=null;edge.to=null;edge.connect()}}}},{key:"getConnectedNodes",value:function getConnectedNodes(edgeId){var nodeList=[];if(this.body.edges[edgeId]!==undefined){var edge=this.body.edges[edgeId];if(edge.fromId){nodeList.push(edge.fromId)}if(edge.toId){nodeList.push(edge.toId)}}return nodeList}}]);return EdgesHandler}();exports["default"]=EdgesHandler},{"../../DataSet":6,"../../DataView":7,"../../util":116,"./components/Edge":41,"./components/shared/Label":78,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var Groups=function(){function Groups(){(0,_classCallCheck3["default"])(this,Groups);this.clear();this.defaultIndex=0;this.groupsArray=[];this.groupIndex=0;this.defaultGroups=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}},{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}},{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}},{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}},{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}},{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}},{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}},{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}},{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}},{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}},{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}},{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}];this.options={};this.defaultOptions={useDefaultGroups:true};util.extend(this.options,this.defaultOptions)}(0,_createClass3["default"])(Groups,[{key:"setOptions",value:function setOptions(options){var optionFields=["useDefaultGroups"];if(options!==undefined){for(var groupName in options){if(options.hasOwnProperty(groupName)){if(optionFields.indexOf(groupName)===-1){var group=options[groupName];this.add(groupName,group)}}}}}},{key:"clear",value:function clear(){this.groups={};this.groupsArray=[]}},{key:"get",value:function get(groupname){var group=this.groups[groupname];if(group===undefined){if(this.options.useDefaultGroups===false&&this.groupsArray.length>0){var index=this.groupIndex%this.groupsArray.length;this.groupIndex++;group={};group.color=this.groups[this.groupsArray[index]];this.groups[groupname]=group}else{var _index=this.defaultIndex%this.defaultGroups.length;this.defaultIndex++;group={};group.color=this.defaultGroups[_index];this.groups[groupname]=group}}return group}},{key:"add",value:function add(groupName,style){this.groups[groupName]=style;this.groupsArray.push(groupName);return style}}]);return Groups}();exports["default"]=Groups},{"../../util":116,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _NavigationHandler=require("./components/NavigationHandler");var _NavigationHandler2=_interopRequireDefault(_NavigationHandler);var _Popup=require("./../../shared/Popup");var _Popup2=_interopRequireDefault(_Popup);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var InteractionHandler=function(){function InteractionHandler(body,canvas,selectionHandler){(0,_classCallCheck3["default"])(this,InteractionHandler);this.body=body;this.canvas=canvas;this.selectionHandler=selectionHandler;this.navigationHandler=new _NavigationHandler2["default"](body,canvas);this.body.eventListeners.onTap=this.onTap.bind(this);this.body.eventListeners.onTouch=this.onTouch.bind(this);this.body.eventListeners.onDoubleTap=this.onDoubleTap.bind(this);this.body.eventListeners.onHold=this.onHold.bind(this);this.body.eventListeners.onDragStart=this.onDragStart.bind(this);this.body.eventListeners.onDrag=this.onDrag.bind(this);this.body.eventListeners.onDragEnd=this.onDragEnd.bind(this);this.body.eventListeners.onMouseWheel=this.onMouseWheel.bind(this);this.body.eventListeners.onPinch=this.onPinch.bind(this);this.body.eventListeners.onMouseMove=this.onMouseMove.bind(this);this.body.eventListeners.onRelease=this.onRelease.bind(this);this.body.eventListeners.onContext=this.onContext.bind(this);this.touchTime=0;this.drag={};this.pinch={};this.popup=undefined;this.popupObj=undefined;this.popupTimer=undefined;this.body.functions.getPointer=this.getPointer.bind(this);this.options={};this.defaultOptions={dragNodes:true,dragView:true,hover:false,keyboard:{enabled:false,speed:{x:10,y:10,zoom:.02},bindToWindow:true},navigationButtons:false,tooltipDelay:300,zoomView:true};util.extend(this.options,this.defaultOptions);this.bindEventListeners()}(0,_createClass3["default"])(InteractionHandler,[{key:"bindEventListeners",value:function bindEventListeners(){var _this=this;this.body.emitter.on("destroy",function(){clearTimeout(_this.popupTimer);delete _this.body.functions.getPointer})}},{key:"setOptions",value:function setOptions(options){if(options!==undefined){var fields=["hideEdgesOnDrag","hideNodesOnDrag","keyboard","multiselect","selectable","selectConnectedEdges"];util.selectiveNotDeepExtend(fields,this.options,options);util.mergeOptions(this.options,options,"keyboard");if(options.tooltip){util.extend(this.options.tooltip,options.tooltip);if(options.tooltip.color){this.options.tooltip.color=util.parseColor(options.tooltip.color)}}}this.navigationHandler.setOptions(this.options)}},{key:"getPointer",value:function getPointer(touch){return{x:touch.x-util.getAbsoluteLeft(this.canvas.frame.canvas),y:touch.y-util.getAbsoluteTop(this.canvas.frame.canvas)}}},{key:"onTouch",value:function onTouch(event){if((new Date).valueOf()-this.touchTime>50){this.drag.pointer=this.getPointer(event.center);this.drag.pinched=false;this.pinch.scale=this.body.view.scale;this.touchTime=(new Date).valueOf()}}},{key:"onTap",value:function onTap(event){var pointer=this.getPointer(event.center);var multiselect=this.selectionHandler.options.multiselect&&(event.changedPointers[0].ctrlKey||event.changedPointers[0].metaKey);this.checkSelectionChanges(pointer,event,multiselect);this.selectionHandler._generateClickEvent("click",event,pointer)}},{key:"onDoubleTap",value:function onDoubleTap(event){var pointer=this.getPointer(event.center);this.selectionHandler._generateClickEvent("doubleClick",event,pointer)}},{key:"onHold",value:function onHold(event){var pointer=this.getPointer(event.center);var multiselect=this.selectionHandler.options.multiselect;this.checkSelectionChanges(pointer,event,multiselect);this.selectionHandler._generateClickEvent("click",event,pointer);this.selectionHandler._generateClickEvent("hold",event,pointer)}},{key:"onRelease",value:function onRelease(event){if((new Date).valueOf()-this.touchTime>10){var pointer=this.getPointer(event.center);this.selectionHandler._generateClickEvent("release",event,pointer);this.touchTime=(new Date).valueOf()}}},{key:"onContext",value:function onContext(event){var pointer=this.getPointer({x:event.clientX,y:event.clientY});this.selectionHandler._generateClickEvent("oncontext",event,pointer)}},{key:"checkSelectionChanges",value:function checkSelectionChanges(pointer,event){var add=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var previouslySelectedEdgeCount=this.selectionHandler._getSelectedEdgeCount();var previouslySelectedNodeCount=this.selectionHandler._getSelectedNodeCount();var previousSelection=this.selectionHandler.getSelection();var selected=void 0;if(add===true){selected=this.selectionHandler.selectAdditionalOnPoint(pointer)}else{selected=this.selectionHandler.selectOnPoint(pointer)}var selectedEdgesCount=this.selectionHandler._getSelectedEdgeCount();var selectedNodesCount=this.selectionHandler._getSelectedNodeCount();var currentSelection=this.selectionHandler.getSelection();var _determineIfDifferent2=this._determineIfDifferent(previousSelection,currentSelection),nodesChanged=_determineIfDifferent2.nodesChanged,edgesChanged=_determineIfDifferent2.edgesChanged;var nodeSelected=false;if(selectedNodesCount-previouslySelectedNodeCount>0){this.selectionHandler._generateClickEvent("selectNode",event,pointer);selected=true;nodeSelected=true}else if(nodesChanged===true&&selectedNodesCount>0){this.selectionHandler._generateClickEvent("deselectNode",event,pointer,previousSelection);this.selectionHandler._generateClickEvent("selectNode",event,pointer);nodeSelected=true;selected=true}else if(selectedNodesCount-previouslySelectedNodeCount<0){this.selectionHandler._generateClickEvent("deselectNode",event,pointer,previousSelection);selected=true}if(selectedEdgesCount-previouslySelectedEdgeCount>0&&nodeSelected===false){this.selectionHandler._generateClickEvent("selectEdge",event,pointer);selected=true}else if(selectedEdgesCount>0&&edgesChanged===true){this.selectionHandler._generateClickEvent("deselectEdge",event,pointer,previousSelection);this.selectionHandler._generateClickEvent("selectEdge",event,pointer);selected=true}else if(selectedEdgesCount-previouslySelectedEdgeCount<0){this.selectionHandler._generateClickEvent("deselectEdge",event,pointer,previousSelection);selected=true}if(selected===true){this.selectionHandler._generateClickEvent("select",event,pointer)}}},{key:"_determineIfDifferent",value:function _determineIfDifferent(previousSelection,currentSelection){var nodesChanged=false;var edgesChanged=false;for(var i=0;i<previousSelection.nodes.length;i++){if(currentSelection.nodes.indexOf(previousSelection.nodes[i])===-1){nodesChanged=true}}for(var _i=0;_i<currentSelection.nodes.length;_i++){if(previousSelection.nodes.indexOf(previousSelection.nodes[_i])===-1){nodesChanged=true}}for(var _i2=0;_i2<previousSelection.edges.length;_i2++){if(currentSelection.edges.indexOf(previousSelection.edges[_i2])===-1){edgesChanged=true}}for(var _i3=0;_i3<currentSelection.edges.length;_i3++){if(previousSelection.edges.indexOf(previousSelection.edges[_i3])===-1){edgesChanged=true}}return{nodesChanged:nodesChanged,edgesChanged:edgesChanged}}},{key:"onDragStart",value:function onDragStart(event){if(this.drag.pointer===undefined){this.onTouch(event)}var node=this.selectionHandler.getNodeAt(this.drag.pointer);this.drag.dragging=true;this.drag.selection=[];this.drag.translation=util.extend({},this.body.view.translation);this.drag.nodeId=undefined;if(node!==undefined&&this.options.dragNodes===true){this.drag.nodeId=node.id;if(node.isSelected()===false){this.selectionHandler.unselectAll();this.selectionHandler.selectObject(node)}this.selectionHandler._generateClickEvent("dragStart",event,this.drag.pointer);var selection=this.selectionHandler.selectionObj.nodes;for(var nodeId in selection){if(selection.hasOwnProperty(nodeId)){var object=selection[nodeId];var s={id:object.id,node:object,x:object.x,y:object.y,xFixed:object.options.fixed.x,yFixed:object.options.fixed.y};object.options.fixed.x=true;object.options.fixed.y=true;this.drag.selection.push(s)}}}else{this.selectionHandler._generateClickEvent("dragStart",event,this.drag.pointer,undefined,true)}}},{key:"onDrag",value:function onDrag(event){var _this2=this;if(this.drag.pinched===true){return}this.body.emitter.emit("unlockNode");var pointer=this.getPointer(event.center);var selection=this.drag.selection;if(selection&&selection.length&&this.options.dragNodes===true){(function(){_this2.selectionHandler._generateClickEvent("dragging",event,pointer);var deltaX=pointer.x-_this2.drag.pointer.x;var deltaY=pointer.y-_this2.drag.pointer.y;selection.forEach(function(selection){var node=selection.node;if(selection.xFixed===false){node.x=_this2.canvas._XconvertDOMtoCanvas(_this2.canvas._XconvertCanvasToDOM(selection.x)+deltaX)}if(selection.yFixed===false){node.y=_this2.canvas._YconvertDOMtoCanvas(_this2.canvas._YconvertCanvasToDOM(selection.y)+deltaY)}});_this2.body.emitter.emit("startSimulation")})()}else{if(this.options.dragView===true){this.selectionHandler._generateClickEvent("dragging",event,pointer,undefined,true);if(this.drag.pointer===undefined){this.onDragStart(event);return}var diffX=pointer.x-this.drag.pointer.x;var diffY=pointer.y-this.drag.pointer.y;this.body.view.translation={x:this.drag.translation.x+diffX,y:this.drag.translation.y+diffY};this.body.emitter.emit("_redraw")}}}},{key:"onDragEnd",value:function onDragEnd(event){this.drag.dragging=false;var selection=this.drag.selection;if(selection&&selection.length){selection.forEach(function(s){s.node.options.fixed.x=s.xFixed;s.node.options.fixed.y=s.yFixed});this.selectionHandler._generateClickEvent("dragEnd",event,this.getPointer(event.center));this.body.emitter.emit("startSimulation")}else{this.selectionHandler._generateClickEvent("dragEnd",event,this.getPointer(event.center),undefined,true);this.body.emitter.emit("_requestRedraw")}}},{key:"onPinch",value:function onPinch(event){var pointer=this.getPointer(event.center);this.drag.pinched=true;if(this.pinch["scale"]===undefined){this.pinch.scale=1}var scale=this.pinch.scale*event.scale;this.zoom(scale,pointer)}},{key:"zoom",value:function zoom(scale,pointer){if(this.options.zoomView===true){var scaleOld=this.body.view.scale;if(scale<1e-5){scale=1e-5}if(scale>10){scale=10}var preScaleDragPointer=undefined;if(this.drag!==undefined){if(this.drag.dragging===true){preScaleDragPointer=this.canvas.DOMtoCanvas(this.drag.pointer)}}var translation=this.body.view.translation;var scaleFrac=scale/scaleOld;var tx=(1-scaleFrac)*pointer.x+translation.x*scaleFrac;var ty=(1-scaleFrac)*pointer.y+translation.y*scaleFrac;this.body.view.scale=scale;this.body.view.translation={x:tx,y:ty};if(preScaleDragPointer!=undefined){var postScaleDragPointer=this.canvas.canvasToDOM(preScaleDragPointer);this.drag.pointer.x=postScaleDragPointer.x;this.drag.pointer.y=postScaleDragPointer.y}this.body.emitter.emit("_requestRedraw");if(scaleOld<scale){this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:pointer})}else{this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:pointer})}}}},{key:"onMouseWheel",value:function onMouseWheel(event){if(this.options.zoomView===true){var delta=0;if(event.wheelDelta){delta=event.wheelDelta/120}else if(event.detail){delta=-event.detail/3}if(delta!==0){var scale=this.body.view.scale;var zoom=delta/10;if(delta<0){zoom=zoom/(1-zoom)}scale*=1+zoom;var pointer=this.getPointer({x:event.clientX,y:event.clientY});this.zoom(scale,pointer)}event.preventDefault()}}},{key:"onMouseMove",value:function onMouseMove(event){var _this3=this;var pointer=this.getPointer({x:event.clientX,y:event.clientY});var popupVisible=false;if(this.popup!==undefined){if(this.popup.hidden===false){this._checkHidePopup(pointer)}if(this.popup.hidden===false){popupVisible=true;this.popup.setPosition(pointer.x+3,pointer.y-5);this.popup.show()}}if(this.options.keyboard.bindToWindow===false&&this.options.keyboard.enabled===true){this.canvas.frame.focus()}if(popupVisible===false){if(this.popupTimer!==undefined){
clearInterval(this.popupTimer);this.popupTimer=undefined}if(!this.drag.dragging){this.popupTimer=setTimeout(function(){return _this3._checkShowPopup(pointer)},this.options.tooltipDelay)}}if(this.options.hover===true){var obj=this.selectionHandler.getNodeAt(pointer);if(obj===undefined){obj=this.selectionHandler.getEdgeAt(pointer)}this.selectionHandler.hoverObject(obj)}}},{key:"_checkShowPopup",value:function _checkShowPopup(pointer){var x=this.canvas._XconvertDOMtoCanvas(pointer.x);var y=this.canvas._YconvertDOMtoCanvas(pointer.y);var pointerObj={left:x,top:y,right:x,bottom:y};var previousPopupObjId=this.popupObj===undefined?undefined:this.popupObj.id;var nodeUnderCursor=false;var popupType="node";if(this.popupObj===undefined){var nodeIndices=this.body.nodeIndices;var nodes=this.body.nodes;var node=void 0;var overlappingNodes=[];for(var i=0;i<nodeIndices.length;i++){node=nodes[nodeIndices[i]];if(node.isOverlappingWith(pointerObj)===true){if(node.getTitle()!==undefined){overlappingNodes.push(nodeIndices[i])}}}if(overlappingNodes.length>0){this.popupObj=nodes[overlappingNodes[overlappingNodes.length-1]];nodeUnderCursor=true}}if(this.popupObj===undefined&&nodeUnderCursor===false){var edgeIndices=this.body.edgeIndices;var edges=this.body.edges;var edge=void 0;var overlappingEdges=[];for(var _i4=0;_i4<edgeIndices.length;_i4++){edge=edges[edgeIndices[_i4]];if(edge.isOverlappingWith(pointerObj)===true){if(edge.connected===true&&edge.getTitle()!==undefined){overlappingEdges.push(edgeIndices[_i4])}}}if(overlappingEdges.length>0){this.popupObj=edges[overlappingEdges[overlappingEdges.length-1]];popupType="edge"}}if(this.popupObj!==undefined){if(this.popupObj.id!==previousPopupObjId){if(this.popup===undefined){this.popup=new _Popup2["default"](this.canvas.frame)}this.popup.popupTargetType=popupType;this.popup.popupTargetId=this.popupObj.id;this.popup.setPosition(pointer.x+3,pointer.y-5);this.popup.setText(this.popupObj.getTitle());this.popup.show();this.body.emitter.emit("showPopup",this.popupObj.id)}}else{if(this.popup!==undefined){this.popup.hide();this.body.emitter.emit("hidePopup")}}}},{key:"_checkHidePopup",value:function _checkHidePopup(pointer){var pointerObj=this.selectionHandler._pointerToPositionObject(pointer);var stillOnObj=false;if(this.popup.popupTargetType==="node"){if(this.body.nodes[this.popup.popupTargetId]!==undefined){stillOnObj=this.body.nodes[this.popup.popupTargetId].isOverlappingWith(pointerObj);if(stillOnObj===true){var overNode=this.selectionHandler.getNodeAt(pointer);stillOnObj=overNode===undefined?false:overNode.id===this.popup.popupTargetId}}}else{if(this.selectionHandler.getNodeAt(pointer)===undefined){if(this.body.edges[this.popup.popupTargetId]!==undefined){stillOnObj=this.body.edges[this.popup.popupTargetId].isOverlappingWith(pointerObj)}}}if(stillOnObj===false){this.popupObj=undefined;this.popup.hide();this.body.emitter.emit("hidePopup")}}}]);return InteractionHandler}();exports["default"]=InteractionHandler},{"../../util":116,"./../../shared/Popup":84,"./components/NavigationHandler":42,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _FloydWarshall=require("./components/algorithms/FloydWarshall.js");var _FloydWarshall2=_interopRequireDefault(_FloydWarshall);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var KamadaKawai=function(){function KamadaKawai(body,edgeLength,edgeStrength){(0,_classCallCheck3["default"])(this,KamadaKawai);this.body=body;this.springLength=edgeLength;this.springConstant=edgeStrength;this.distanceSolver=new _FloydWarshall2["default"]}(0,_createClass3["default"])(KamadaKawai,[{key:"setOptions",value:function setOptions(options){if(options){if(options.springLength){this.springLength=options.springLength}if(options.springConstant){this.springConstant=options.springConstant}}}},{key:"solve",value:function solve(nodesArray,edgesArray){var ignoreClusters=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var D_matrix=this.distanceSolver.getDistances(this.body,nodesArray,edgesArray);this._createL_matrix(D_matrix);this._createK_matrix(D_matrix);var threshold=.01;var innerThreshold=1;var iterations=0;var maxIterations=Math.max(1e3,Math.min(10*this.body.nodeIndices.length,6e3));var maxInnerIterations=5;var maxEnergy=1e9;var highE_nodeId=0,dE_dx=0,dE_dy=0,delta_m=0,subIterations=0;while(maxEnergy>threshold&&iterations<maxIterations){iterations+=1;var _getHighestEnergyNode2=this._getHighestEnergyNode(ignoreClusters);var _getHighestEnergyNode3=(0,_slicedToArray3["default"])(_getHighestEnergyNode2,4);highE_nodeId=_getHighestEnergyNode3[0];maxEnergy=_getHighestEnergyNode3[1];dE_dx=_getHighestEnergyNode3[2];dE_dy=_getHighestEnergyNode3[3];delta_m=maxEnergy;subIterations=0;while(delta_m>innerThreshold&&subIterations<maxInnerIterations){subIterations+=1;this._moveNode(highE_nodeId,dE_dx,dE_dy);var _getEnergy2=this._getEnergy(highE_nodeId);var _getEnergy3=(0,_slicedToArray3["default"])(_getEnergy2,3);delta_m=_getEnergy3[0];dE_dx=_getEnergy3[1];dE_dy=_getEnergy3[2]}}}},{key:"_getHighestEnergyNode",value:function _getHighestEnergyNode(ignoreClusters){var nodesArray=this.body.nodeIndices;var nodes=this.body.nodes;var maxEnergy=0;var maxEnergyNodeId=nodesArray[0];var dE_dx_max=0,dE_dy_max=0;for(var nodeIdx=0;nodeIdx<nodesArray.length;nodeIdx++){var m=nodesArray[nodeIdx];if(nodes[m].predefinedPosition===false||nodes[m].isCluster===true&&ignoreClusters===true||nodes[m].options.fixed.x===true||nodes[m].options.fixed.y===true){var _getEnergy4=this._getEnergy(m),_getEnergy5=(0,_slicedToArray3["default"])(_getEnergy4,3),delta_m=_getEnergy5[0],dE_dx=_getEnergy5[1],dE_dy=_getEnergy5[2];if(maxEnergy<delta_m){maxEnergy=delta_m;maxEnergyNodeId=m;dE_dx_max=dE_dx;dE_dy_max=dE_dy}}}return[maxEnergyNodeId,maxEnergy,dE_dx_max,dE_dy_max]}},{key:"_getEnergy",value:function _getEnergy(m){var nodesArray=this.body.nodeIndices;var nodes=this.body.nodes;var x_m=nodes[m].x;var y_m=nodes[m].y;var dE_dx=0;var dE_dy=0;for(var iIdx=0;iIdx<nodesArray.length;iIdx++){var i=nodesArray[iIdx];if(i!==m){var x_i=nodes[i].x;var y_i=nodes[i].y;var denominator=1/Math.sqrt(Math.pow(x_m-x_i,2)+Math.pow(y_m-y_i,2));dE_dx+=this.K_matrix[m][i]*(x_m-x_i-this.L_matrix[m][i]*(x_m-x_i)*denominator);dE_dy+=this.K_matrix[m][i]*(y_m-y_i-this.L_matrix[m][i]*(y_m-y_i)*denominator)}}var delta_m=Math.sqrt(Math.pow(dE_dx,2)+Math.pow(dE_dy,2));return[delta_m,dE_dx,dE_dy]}},{key:"_moveNode",value:function _moveNode(m,dE_dx,dE_dy){var nodesArray=this.body.nodeIndices;var nodes=this.body.nodes;var d2E_dx2=0;var d2E_dxdy=0;var d2E_dy2=0;var x_m=nodes[m].x;var y_m=nodes[m].y;for(var iIdx=0;iIdx<nodesArray.length;iIdx++){var i=nodesArray[iIdx];if(i!==m){var x_i=nodes[i].x;var y_i=nodes[i].y;var denominator=1/Math.pow(Math.pow(x_m-x_i,2)+Math.pow(y_m-y_i,2),1.5);d2E_dx2+=this.K_matrix[m][i]*(1-this.L_matrix[m][i]*Math.pow(y_m-y_i,2)*denominator);d2E_dxdy+=this.K_matrix[m][i]*(this.L_matrix[m][i]*(x_m-x_i)*(y_m-y_i)*denominator);d2E_dy2+=this.K_matrix[m][i]*(1-this.L_matrix[m][i]*Math.pow(x_m-x_i,2)*denominator)}}var A=d2E_dx2,B=d2E_dxdy,C=dE_dx,D=d2E_dy2,E=dE_dy;var dy=(C/A+E/B)/(B/A-D/B);var dx=-(B*dy+C)/A;nodes[m].x+=dx;nodes[m].y+=dy}},{key:"_createL_matrix",value:function _createL_matrix(D_matrix){var nodesArray=this.body.nodeIndices;var edgeLength=this.springLength;this.L_matrix=[];for(var i=0;i<nodesArray.length;i++){this.L_matrix[nodesArray[i]]={};for(var j=0;j<nodesArray.length;j++){this.L_matrix[nodesArray[i]][nodesArray[j]]=edgeLength*D_matrix[nodesArray[i]][nodesArray[j]]}}}},{key:"_createK_matrix",value:function _createK_matrix(D_matrix){var nodesArray=this.body.nodeIndices;var edgeStrength=this.springConstant;this.K_matrix=[];for(var i=0;i<nodesArray.length;i++){this.K_matrix[nodesArray[i]]={};for(var j=0;j<nodesArray.length;j++){this.K_matrix[nodesArray[i]][nodesArray[j]]=edgeStrength*Math.pow(D_matrix[nodesArray[i]][nodesArray[j]],-2)}}}}]);return KamadaKawai}();exports["default"]=KamadaKawai},{"./components/algorithms/FloydWarshall.js":44,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/slicedToArray":132}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _NetworkUtil=require("../NetworkUtil");var _NetworkUtil2=_interopRequireDefault(_NetworkUtil);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var LayoutEngine=function(){function LayoutEngine(body){(0,_classCallCheck3["default"])(this,LayoutEngine);this.body=body;this.initialRandomSeed=Math.round(Math.random()*1e6);this.randomSeed=this.initialRandomSeed;this.setPhysics=false;this.options={};this.optionsBackup={physics:{}};this.defaultOptions={randomSeed:undefined,improvedLayout:true,hierarchical:{enabled:false,levelSeparation:150,nodeSpacing:100,treeSpacing:200,blockShifting:true,edgeMinimization:true,parentCentralization:true,direction:"UD",sortMethod:"hubsize"}};util.extend(this.options,this.defaultOptions);this.bindEventListeners()}(0,_createClass3["default"])(LayoutEngine,[{key:"bindEventListeners",value:function bindEventListeners(){var _this=this;this.body.emitter.on("_dataChanged",function(){_this.setupHierarchicalLayout()});this.body.emitter.on("_dataLoaded",function(){_this.layoutNetwork()});this.body.emitter.on("_resetHierarchicalLayout",function(){_this.setupHierarchicalLayout()})}},{key:"setOptions",value:function setOptions(options,allOptions){if(options!==undefined){var prevHierarchicalState=this.options.hierarchical.enabled;util.selectiveDeepExtend(["randomSeed","improvedLayout"],this.options,options);util.mergeOptions(this.options,options,"hierarchical");if(options.randomSeed!==undefined){this.initialRandomSeed=options.randomSeed}if(this.options.hierarchical.enabled===true){if(prevHierarchicalState===true){this.body.emitter.emit("refresh",true)}if(this.options.hierarchical.direction==="RL"||this.options.hierarchical.direction==="DU"){if(this.options.hierarchical.levelSeparation>0){this.options.hierarchical.levelSeparation*=-1}}else{if(this.options.hierarchical.levelSeparation<0){this.options.hierarchical.levelSeparation*=-1}}this.body.emitter.emit("_resetHierarchicalLayout");return this.adaptAllOptionsForHierarchicalLayout(allOptions)}else{if(prevHierarchicalState===true){this.body.emitter.emit("refresh");return util.deepExtend(allOptions,this.optionsBackup)}}}return allOptions}},{key:"adaptAllOptionsForHierarchicalLayout",value:function adaptAllOptionsForHierarchicalLayout(allOptions){if(this.options.hierarchical.enabled===true){if(allOptions.physics===undefined||allOptions.physics===true){allOptions.physics={enabled:this.optionsBackup.physics.enabled===undefined?true:this.optionsBackup.physics.enabled,solver:"hierarchicalRepulsion"};this.optionsBackup.physics.enabled=this.optionsBackup.physics.enabled===undefined?true:this.optionsBackup.physics.enabled;this.optionsBackup.physics.solver=this.optionsBackup.physics.solver||"barnesHut"}else if((0,_typeof3["default"])(allOptions.physics)==="object"){this.optionsBackup.physics.enabled=allOptions.physics.enabled===undefined?true:allOptions.physics.enabled;this.optionsBackup.physics.solver=allOptions.physics.solver||"barnesHut";allOptions.physics.solver="hierarchicalRepulsion"}else if(allOptions.physics!==false){this.optionsBackup.physics.solver="barnesHut";allOptions.physics={solver:"hierarchicalRepulsion"}}var type="horizontal";if(this.options.hierarchical.direction==="RL"||this.options.hierarchical.direction==="LR"){type="vertical"}if(allOptions.edges===undefined){this.optionsBackup.edges={smooth:{enabled:true,type:"dynamic"}};allOptions.edges={smooth:false}}else if(allOptions.edges.smooth===undefined){this.optionsBackup.edges={smooth:{enabled:true,type:"dynamic"}};allOptions.edges.smooth=false}else{if(typeof allOptions.edges.smooth==="boolean"){this.optionsBackup.edges={smooth:allOptions.edges.smooth};allOptions.edges.smooth={enabled:allOptions.edges.smooth,type:type}}else{if(allOptions.edges.smooth.type!==undefined&&allOptions.edges.smooth.type!=="dynamic"){type=allOptions.edges.smooth.type}this.optionsBackup.edges={smooth:allOptions.edges.smooth.enabled===undefined?true:allOptions.edges.smooth.enabled,type:allOptions.edges.smooth.type===undefined?"dynamic":allOptions.edges.smooth.type,roundness:allOptions.edges.smooth.roundness===undefined?.5:allOptions.edges.smooth.roundness,forceDirection:allOptions.edges.smooth.forceDirection===undefined?false:allOptions.edges.smooth.forceDirection};allOptions.edges.smooth={enabled:allOptions.edges.smooth.enabled===undefined?true:allOptions.edges.smooth.enabled,type:type,roundness:allOptions.edges.smooth.roundness===undefined?.5:allOptions.edges.smooth.roundness,forceDirection:allOptions.edges.smooth.forceDirection===undefined?false:allOptions.edges.smooth.forceDirection}}}this.body.emitter.emit("_forceDisableDynamicCurves",type)}return allOptions}},{key:"seededRandom",value:function seededRandom(){var x=Math.sin(this.randomSeed++)*1e4;return x-Math.floor(x)}},{key:"positionInitially",value:function positionInitially(nodesArray){if(this.options.hierarchical.enabled!==true){this.randomSeed=this.initialRandomSeed;for(var i=0;i<nodesArray.length;i++){var node=nodesArray[i];var radius=10*.1*nodesArray.length+10;var angle=2*Math.PI*this.seededRandom();if(node.x===undefined){node.x=radius*Math.cos(angle)}if(node.y===undefined){node.y=radius*Math.sin(angle)}}}}},{key:"layoutNetwork",value:function layoutNetwork(){if(this.options.hierarchical.enabled!==true&&this.options.improvedLayout===true){var positionDefined=0;for(var i=0;i<this.body.nodeIndices.length;i++){var node=this.body.nodes[this.body.nodeIndices[i]];if(node.predefinedPosition===true){positionDefined+=1}}if(positionDefined<.5*this.body.nodeIndices.length){var MAX_LEVELS=10;var level=0;var clusterThreshold=100;if(this.body.nodeIndices.length>clusterThreshold){var startLength=this.body.nodeIndices.length;while(this.body.nodeIndices.length>clusterThreshold){level+=1;var before=this.body.nodeIndices.length;if(level%3===0){this.body.modules.clustering.clusterBridges()}else{this.body.modules.clustering.clusterOutliers()}var after=this.body.nodeIndices.length;if(before==after&&level%3!==0||level>MAX_LEVELS){this._declusterAll();this.body.emitter.emit("_layoutFailed");console.info("This network could not be positioned by this version of the improved layout algorithm. Please disable improvedLayout for better performance.");return}}this.body.modules.kamadaKawai.setOptions({springLength:Math.max(150,2*startLength)})}this.body.modules.kamadaKawai.solve(this.body.nodeIndices,this.body.edgeIndices,true);this._shiftToCenter();var offset=70;for(var _i=0;_i<this.body.nodeIndices.length;_i++){if(this.body.nodes[this.body.nodeIndices[_i]].predefinedPosition===false){this.body.nodes[this.body.nodeIndices[_i]].x+=(.5-this.seededRandom())*offset;this.body.nodes[this.body.nodeIndices[_i]].y+=(.5-this.seededRandom())*offset}}this._declusterAll();this.body.emitter.emit("_repositionBezierNodes")}}}},{key:"_shiftToCenter",value:function _shiftToCenter(){var range=_NetworkUtil2["default"].getRangeCore(this.body.nodes,this.body.nodeIndices);var center=_NetworkUtil2["default"].findCenter(range);for(var i=0;i<this.body.nodeIndices.length;i++){this.body.nodes[this.body.nodeIndices[i]].x-=center.x;this.body.nodes[this.body.nodeIndices[i]].y-=center.y}}},{key:"_declusterAll",value:function _declusterAll(){var clustersPresent=true;while(clustersPresent===true){clustersPresent=false;for(var i=0;i<this.body.nodeIndices.length;i++){if(this.body.nodes[this.body.nodeIndices[i]].isCluster===true){clustersPresent=true;this.body.modules.clustering.openCluster(this.body.nodeIndices[i],{},false)}}if(clustersPresent===true){this.body.emitter.emit("_dataChanged")}}}},{key:"getSeed",value:function getSeed(){return this.initialRandomSeed}},{key:"setupHierarchicalLayout",value:function setupHierarchicalLayout(){if(this.options.hierarchical.enabled===true&&this.body.nodeIndices.length>0){var node=void 0,nodeId=void 0;var definedLevel=false;var definedPositions=true;var undefinedLevel=false;this.hierarchicalLevels={};this.lastNodeOnLevel={};this.hierarchicalChildrenReference={};this.hierarchicalParentReference={};this.hierarchicalTrees={};this.treeIndex=-1;this.distributionOrdering={};this.distributionIndex={};this.distributionOrderingPresence={};for(nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){node=this.body.nodes[nodeId];if(node.options.x===undefined&&node.options.y===undefined){definedPositions=false}if(node.options.level!==undefined){definedLevel=true;this.hierarchicalLevels[nodeId]=node.options.level}else{undefinedLevel=true}}}if(undefinedLevel===true&&definedLevel===true){throw new Error("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes.");return}else{if(undefinedLevel===true){if(this.options.hierarchical.sortMethod==="hubsize"){this._determineLevelsByHubsize()}else if(this.options.hierarchical.sortMethod==="directed"){this._determineLevelsDirected()}else if(this.options.hierarchical.sortMethod==="custom"){this._determineLevelsCustomCallback()}}for(var _nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(_nodeId)){if(this.hierarchicalLevels[_nodeId]===undefined){this.hierarchicalLevels[_nodeId]=0}}}var distribution=this._getDistribution();this._generateMap();this._placeNodesByHierarchy(distribution);this._condenseHierarchy();this._shiftToCenter()}}}},{key:"_condenseHierarchy",value:function _condenseHierarchy(){var _this2=this;var stillShifting=false;var branches={};var shiftTrees=function shiftTrees(){var treeSizes=getTreeSizes();for(var i=0;i<treeSizes.length-1;i++){var diff=treeSizes[i].max-treeSizes[i+1].min;shiftTree(i+1,diff+_this2.options.hierarchical.treeSpacing)}};var shiftTree=function shiftTree(index,offset){for(var nodeId in _this2.hierarchicalTrees){if(_this2.hierarchicalTrees.hasOwnProperty(nodeId)){if(_this2.hierarchicalTrees[nodeId]===index){var node=_this2.body.nodes[nodeId];var pos=_this2._getPositionForHierarchy(node);_this2._setPositionForHierarchy(node,pos+offset,undefined,true)}}}};var getTreeSize=function getTreeSize(index){var min=1e9;var max=-1e9;for(var nodeId in _this2.hierarchicalTrees){if(_this2.hierarchicalTrees.hasOwnProperty(nodeId)){if(_this2.hierarchicalTrees[nodeId]===index){var pos=_this2._getPositionForHierarchy(_this2.body.nodes[nodeId]);min=Math.min(pos,min);max=Math.max(pos,max)}}}return{min:min,max:max}};var getTreeSizes=function getTreeSizes(){var treeWidths=[];for(var i=0;i<=_this2.treeIndex;i++){treeWidths.push(getTreeSize(i))}return treeWidths};var getBranchNodes=function getBranchNodes(source,map){map[source.id]=true;if(_this2.hierarchicalChildrenReference[source.id]){var children=_this2.hierarchicalChildrenReference[source.id];if(children.length>0){for(var i=0;i<children.length;i++){getBranchNodes(_this2.body.nodes[children[i]],map)}}}};var getBranchBoundary=function getBranchBoundary(branchMap){var maxLevel=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1e9;var minSpace=1e9;var maxSpace=1e9;var min=1e9;var max=-1e9;for(var branchNode in branchMap){if(branchMap.hasOwnProperty(branchNode)){var node=_this2.body.nodes[branchNode];var level=_this2.hierarchicalLevels[node.id];var position=_this2._getPositionForHierarchy(node);var _getSpaceAroundNode2=_this2._getSpaceAroundNode(node,branchMap),_getSpaceAroundNode3=(0,_slicedToArray3["default"])(_getSpaceAroundNode2,2),minSpaceNode=_getSpaceAroundNode3[0],maxSpaceNode=_getSpaceAroundNode3[1];minSpace=Math.min(minSpaceNode,minSpace);maxSpace=Math.min(maxSpaceNode,maxSpace);if(level<=maxLevel){min=Math.min(position,min);max=Math.max(position,max)}}}return[min,max,minSpace,maxSpace]};var getMaxLevel=function getMaxLevel(nodeId){var level=_this2.hierarchicalLevels[nodeId];if(_this2.hierarchicalChildrenReference[nodeId]){var children=_this2.hierarchicalChildrenReference[nodeId];if(children.length>0){for(var i=0;i<children.length;i++){level=Math.max(level,getMaxLevel(children[i]))}}}return level};var getCollisionLevel=function getCollisionLevel(node1,node2){var maxLevel1=getMaxLevel(node1.id);var maxLevel2=getMaxLevel(node2.id);return Math.min(maxLevel1,maxLevel2)};var hasSameParent=function hasSameParent(node1,node2){var parents1=_this2.hierarchicalParentReference[node1.id];var parents2=_this2.hierarchicalParentReference[node2.id];if(parents1===undefined||parents2===undefined){return false}for(var i=0;i<parents1.length;i++){for(var j=0;j<parents2.length;j++){if(parents1[i]==parents2[j]){return true}}}return false};var shiftElementsCloser=function shiftElementsCloser(callback,levels,centerParents){for(var i=0;i<levels.length;i++){var level=levels[i];var levelNodes=_this2.distributionOrdering[level];if(levelNodes.length>1){for(var j=0;j<levelNodes.length-1;j++){if(hasSameParent(levelNodes[j],levelNodes[j+1])===true){if(_this2.hierarchicalTrees[levelNodes[j].id]===_this2.hierarchicalTrees[levelNodes[j+1].id]){callback(levelNodes[j],levelNodes[j+1],centerParents)}}}}}};var branchShiftCallback=function branchShiftCallback(node1,node2){var centerParent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var pos1=_this2._getPositionForHierarchy(node1);var pos2=_this2._getPositionForHierarchy(node2);var diffAbs=Math.abs(pos2-pos1);if(diffAbs>_this2.options.hierarchical.nodeSpacing){var branchNodes1={};branchNodes1[node1.id]=true;var branchNodes2={};branchNodes2[node2.id]=true;getBranchNodes(node1,branchNodes1);getBranchNodes(node2,branchNodes2);var maxLevel=getCollisionLevel(node1,node2);var _getBranchBoundary=getBranchBoundary(branchNodes1,maxLevel),_getBranchBoundary2=(0,_slicedToArray3["default"])(_getBranchBoundary,4),min1=_getBranchBoundary2[0],max1=_getBranchBoundary2[1],minSpace1=_getBranchBoundary2[2],maxSpace1=_getBranchBoundary2[3];var _getBranchBoundary3=getBranchBoundary(branchNodes2,maxLevel),_getBranchBoundary4=(0,_slicedToArray3["default"])(_getBranchBoundary3,4),min2=_getBranchBoundary4[0],max2=_getBranchBoundary4[1],minSpace2=_getBranchBoundary4[2],maxSpace2=_getBranchBoundary4[3];var diffBranch=Math.abs(max1-min2);if(diffBranch>_this2.options.hierarchical.nodeSpacing){var offset=max1-min2+_this2.options.hierarchical.nodeSpacing;if(offset<-minSpace2+_this2.options.hierarchical.nodeSpacing){offset=-minSpace2+_this2.options.hierarchical.nodeSpacing}if(offset<0){_this2._shiftBlock(node2.id,offset);stillShifting=true;if(centerParent===true)_this2._centerParent(node2)}}}};var minimizeEdgeLength=function minimizeEdgeLength(iterations,node){var nodeId=node.id;var allEdges=node.edges;var nodeLevel=_this2.hierarchicalLevels[node.id];var C2=_this2.options.hierarchical.levelSeparation*_this2.options.hierarchical.levelSeparation;var referenceNodes={};var aboveEdges=[];for(var i=0;i<allEdges.length;i++){var edge=allEdges[i];if(edge.toId!=edge.fromId){var otherNode=edge.toId==nodeId?edge.from:edge.to;referenceNodes[allEdges[i].id]=otherNode;if(_this2.hierarchicalLevels[otherNode.id]<nodeLevel){aboveEdges.push(edge)}}}var getFx=function getFx(point,edges){var sum=0;for(var _i2=0;_i2<edges.length;_i2++){if(referenceNodes[edges[_i2].id]!==undefined){var a=_this2._getPositionForHierarchy(referenceNodes[edges[_i2].id])-point;sum+=a/Math.sqrt(a*a+C2)}}return sum};var getDFx=function getDFx(point,edges){var sum=0;for(var _i3=0;_i3<edges.length;_i3++){if(referenceNodes[edges[_i3].id]!==undefined){var a=_this2._getPositionForHierarchy(referenceNodes[edges[_i3].id])-point;sum-=C2*Math.pow(a*a+C2,-1.5)}}return sum};var getGuess=function getGuess(iterations,edges){var guess=_this2._getPositionForHierarchy(node);var guessMap={};for(var _i4=0;_i4<iterations;_i4++){var fx=getFx(guess,edges);var dfx=getDFx(guess,edges);var limit=40;var ratio=Math.max(-limit,Math.min(limit,Math.round(fx/dfx)));guess=guess-ratio;if(guessMap[guess]!==undefined){break}guessMap[guess]=_i4}return guess};var moveBranch=function moveBranch(guess){var nodePosition=_this2._getPositionForHierarchy(node);if(branches[node.id]===undefined){var branchNodes={};branchNodes[node.id]=true;getBranchNodes(node,branchNodes);branches[node.id]=branchNodes}var _getBranchBoundary5=getBranchBoundary(branches[node.id]),_getBranchBoundary6=(0,_slicedToArray3["default"])(_getBranchBoundary5,4),minBranch=_getBranchBoundary6[0],maxBranch=_getBranchBoundary6[1],minSpaceBranch=_getBranchBoundary6[2],maxSpaceBranch=_getBranchBoundary6[3];var diff=guess-nodePosition;var branchOffset=0;if(diff>0){branchOffset=Math.min(diff,maxSpaceBranch-_this2.options.hierarchical.nodeSpacing)}else if(diff<0){branchOffset=-Math.min(-diff,minSpaceBranch-_this2.options.hierarchical.nodeSpacing)}if(branchOffset!=0){_this2._shiftBlock(node.id,branchOffset);stillShifting=true}};var moveNode=function moveNode(guess){var nodePosition=_this2._getPositionForHierarchy(node);var _getSpaceAroundNode4=_this2._getSpaceAroundNode(node),_getSpaceAroundNode5=(0,_slicedToArray3["default"])(_getSpaceAroundNode4,2),minSpace=_getSpaceAroundNode5[0],maxSpace=_getSpaceAroundNode5[1];var diff=guess-nodePosition;var newPosition=nodePosition;if(diff>0){newPosition=Math.min(nodePosition+(maxSpace-_this2.options.hierarchical.nodeSpacing),guess)}else if(diff<0){newPosition=Math.max(nodePosition-(minSpace-_this2.options.hierarchical.nodeSpacing),guess)}if(newPosition!==nodePosition){_this2._setPositionForHierarchy(node,newPosition,undefined,true);stillShifting=true}};var guess=getGuess(iterations,aboveEdges);moveBranch(guess);guess=getGuess(iterations,allEdges);moveNode(guess)};var minimizeEdgeLengthBottomUp=function minimizeEdgeLengthBottomUp(iterations){var levels=(0,_keys2["default"])(_this2.distributionOrdering);levels=levels.reverse();for(var i=0;i<iterations;i++){stillShifting=false;for(var j=0;j<levels.length;j++){var level=levels[j];var levelNodes=_this2.distributionOrdering[level];for(var k=0;k<levelNodes.length;k++){minimizeEdgeLength(1e3,levelNodes[k])}}if(stillShifting!==true){break}}};var shiftBranchesCloserBottomUp=function shiftBranchesCloserBottomUp(iterations){var levels=(0,_keys2["default"])(_this2.distributionOrdering);levels=levels.reverse();for(var i=0;i<iterations;i++){stillShifting=false;shiftElementsCloser(branchShiftCallback,levels,true);if(stillShifting!==true){break}}};var centerAllParents=function centerAllParents(){for(var nodeId in _this2.body.nodes){if(_this2.body.nodes.hasOwnProperty(nodeId))_this2._centerParent(_this2.body.nodes[nodeId])}};var centerAllParentsBottomUp=function centerAllParentsBottomUp(){var levels=(0,_keys2["default"])(_this2.distributionOrdering);levels=levels.reverse();for(var i=0;i<levels.length;i++){var level=levels[i];var levelNodes=_this2.distributionOrdering[level];for(var j=0;j<levelNodes.length;j++){_this2._centerParent(levelNodes[j])}}};if(this.options.hierarchical.blockShifting===true){shiftBranchesCloserBottomUp(5);centerAllParents()}if(this.options.hierarchical.edgeMinimization===true){minimizeEdgeLengthBottomUp(20)}if(this.options.hierarchical.parentCentralization===true){centerAllParentsBottomUp()}shiftTrees()}},{key:"_getSpaceAroundNode",value:function _getSpaceAroundNode(node,map){var useMap=true;if(map===undefined){useMap=false}var level=this.hierarchicalLevels[node.id];if(level!==undefined){var index=this.distributionIndex[node.id];var position=this._getPositionForHierarchy(node);var minSpace=1e9;var maxSpace=1e9;if(index!==0){var prevNode=this.distributionOrdering[level][index-1];if(useMap===true&&map[prevNode.id]===undefined||useMap===false){var prevPos=this._getPositionForHierarchy(prevNode);minSpace=position-prevPos}}if(index!=this.distributionOrdering[level].length-1){var nextNode=this.distributionOrdering[level][index+1];if(useMap===true&&map[nextNode.id]===undefined||useMap===false){var nextPos=this._getPositionForHierarchy(nextNode);maxSpace=Math.min(maxSpace,nextPos-position)}}return[minSpace,maxSpace]}else{return[0,0]}}},{key:"_centerParent",value:function _centerParent(node){if(this.hierarchicalParentReference[node.id]){var parents=this.hierarchicalParentReference[node.id];for(var i=0;i<parents.length;i++){var parentId=parents[i];var parentNode=this.body.nodes[parentId];if(this.hierarchicalChildrenReference[parentId]){var minPos=1e9;var maxPos=-1e9;var children=this.hierarchicalChildrenReference[parentId];if(children.length>0){for(var _i5=0;_i5<children.length;_i5++){var childNode=this.body.nodes[children[_i5]];minPos=Math.min(minPos,this._getPositionForHierarchy(childNode));maxPos=Math.max(maxPos,this._getPositionForHierarchy(childNode))}}var position=this._getPositionForHierarchy(parentNode);var _getSpaceAroundNode6=this._getSpaceAroundNode(parentNode),_getSpaceAroundNode7=(0,_slicedToArray3["default"])(_getSpaceAroundNode6,2),minSpace=_getSpaceAroundNode7[0],maxSpace=_getSpaceAroundNode7[1];var newPosition=.5*(minPos+maxPos);var diff=position-newPosition;if(diff<0&&Math.abs(diff)<maxSpace-this.options.hierarchical.nodeSpacing||diff>0&&Math.abs(diff)<minSpace-this.options.hierarchical.nodeSpacing){this._setPositionForHierarchy(parentNode,newPosition,undefined,true)}}}}}},{key:"_placeNodesByHierarchy",value:function _placeNodesByHierarchy(distribution){this.positionedNodes={};for(var level in distribution){if(distribution.hasOwnProperty(level)){var nodeArray=(0,_keys2["default"])(distribution[level]);nodeArray=this._indexArrayToNodes(nodeArray);this._sortNodeArray(nodeArray);var handledNodeCount=0;for(var i=0;i<nodeArray.length;i++){var node=nodeArray[i];if(this.positionedNodes[node.id]===undefined){var pos=this.options.hierarchical.nodeSpacing*handledNodeCount;if(handledNodeCount>0){pos=this._getPositionForHierarchy(nodeArray[i-1])+this.options.hierarchical.nodeSpacing}this._setPositionForHierarchy(node,pos,level);this._validataPositionAndContinue(node,level,pos);handledNodeCount++}}}}}},{key:"_placeBranchNodes",value:function _placeBranchNodes(parentId,parentLevel){if(this.hierarchicalChildrenReference[parentId]===undefined){return}var childNodes=[];for(var i=0;i<this.hierarchicalChildrenReference[parentId].length;i++){childNodes.push(this.body.nodes[this.hierarchicalChildrenReference[parentId][i]])}this._sortNodeArray(childNodes);for(var _i6=0;_i6<childNodes.length;_i6++){var childNode=childNodes[_i6];var childNodeLevel=this.hierarchicalLevels[childNode.id];if(childNodeLevel>parentLevel&&this.positionedNodes[childNode.id]===undefined){var pos=void 0;if(_i6===0){pos=this._getPositionForHierarchy(this.body.nodes[parentId])}else{pos=this._getPositionForHierarchy(childNodes[_i6-1])+this.options.hierarchical.nodeSpacing}this._setPositionForHierarchy(childNode,pos,childNodeLevel);this._validataPositionAndContinue(childNode,childNodeLevel,pos)}else{return}}var minPos=1e9;var maxPos=-1e9;for(var _i7=0;_i7<childNodes.length;_i7++){var childNodeId=childNodes[_i7].id;minPos=Math.min(minPos,this._getPositionForHierarchy(this.body.nodes[childNodeId]));
maxPos=Math.max(maxPos,this._getPositionForHierarchy(this.body.nodes[childNodeId]))}this._setPositionForHierarchy(this.body.nodes[parentId],.5*(minPos+maxPos),parentLevel)}},{key:"_validataPositionAndContinue",value:function _validataPositionAndContinue(node,level,pos){if(this.lastNodeOnLevel[level]!==undefined){var previousPos=this._getPositionForHierarchy(this.body.nodes[this.lastNodeOnLevel[level]]);if(pos-previousPos<this.options.hierarchical.nodeSpacing){var diff=previousPos+this.options.hierarchical.nodeSpacing-pos;var sharedParent=this._findCommonParent(this.lastNodeOnLevel[level],node.id);this._shiftBlock(sharedParent.withChild,diff)}}this.lastNodeOnLevel[level]=node.id;this.positionedNodes[node.id]=true;this._placeBranchNodes(node.id,level)}},{key:"_indexArrayToNodes",value:function _indexArrayToNodes(idArray){var array=[];for(var i=0;i<idArray.length;i++){array.push(this.body.nodes[idArray[i]])}return array}},{key:"_getDistribution",value:function _getDistribution(){var distribution={};var nodeId=void 0,node=void 0;for(nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){node=this.body.nodes[nodeId];var level=this.hierarchicalLevels[nodeId]===undefined?0:this.hierarchicalLevels[nodeId];if(this.options.hierarchical.direction==="UD"||this.options.hierarchical.direction==="DU"){node.y=this.options.hierarchical.levelSeparation*level;node.options.fixed.y=true}else{node.x=this.options.hierarchical.levelSeparation*level;node.options.fixed.x=true}if(distribution[level]===undefined){distribution[level]={}}distribution[level][nodeId]=node}}return distribution}},{key:"_getHubSize",value:function _getHubSize(){var hubSize=0;for(var nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){var node=this.body.nodes[nodeId];if(this.hierarchicalLevels[nodeId]===undefined){hubSize=node.edges.length<hubSize?hubSize:node.edges.length}}}return hubSize}},{key:"_determineLevelsByHubsize",value:function _determineLevelsByHubsize(){var _this3=this;var hubSize=1;var levelDownstream=function levelDownstream(nodeA,nodeB){if(_this3.hierarchicalLevels[nodeB.id]===undefined){if(_this3.hierarchicalLevels[nodeA.id]===undefined){_this3.hierarchicalLevels[nodeA.id]=0}_this3.hierarchicalLevels[nodeB.id]=_this3.hierarchicalLevels[nodeA.id]+1}};while(hubSize>0){hubSize=this._getHubSize();if(hubSize===0)break;for(var nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){var node=this.body.nodes[nodeId];if(node.edges.length===hubSize){this._crawlNetwork(levelDownstream,nodeId)}}}}}},{key:"_determineLevelsCustomCallback",value:function _determineLevelsCustomCallback(){var _this4=this;var minLevel=1e5;var customCallback=function customCallback(nodeA,nodeB,edge){};var levelByDirection=function levelByDirection(nodeA,nodeB,edge){var levelA=_this4.hierarchicalLevels[nodeA.id];if(levelA===undefined){_this4.hierarchicalLevels[nodeA.id]=minLevel}var diff=customCallback(_NetworkUtil2["default"].cloneOptions(nodeA,"node"),_NetworkUtil2["default"].cloneOptions(nodeB,"node"),_NetworkUtil2["default"].cloneOptions(edge,"edge"));_this4.hierarchicalLevels[nodeB.id]=_this4.hierarchicalLevels[nodeA.id]+diff};this._crawlNetwork(levelByDirection);this._setMinLevelToZero()}},{key:"_determineLevelsDirected",value:function _determineLevelsDirected(){var _this5=this;var minLevel=1e4;var levelByDirection=function levelByDirection(nodeA,nodeB,edge){var levelA=_this5.hierarchicalLevels[nodeA.id];if(levelA===undefined){_this5.hierarchicalLevels[nodeA.id]=minLevel}if(edge.toId==nodeB.id){_this5.hierarchicalLevels[nodeB.id]=_this5.hierarchicalLevels[nodeA.id]+1}else{_this5.hierarchicalLevels[nodeB.id]=_this5.hierarchicalLevels[nodeA.id]-1}};this._crawlNetwork(levelByDirection);this._setMinLevelToZero()}},{key:"_setMinLevelToZero",value:function _setMinLevelToZero(){var minLevel=1e9;for(var nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){if(this.hierarchicalLevels[nodeId]!==undefined){minLevel=Math.min(this.hierarchicalLevels[nodeId],minLevel)}}}for(var _nodeId2 in this.body.nodes){if(this.body.nodes.hasOwnProperty(_nodeId2)){if(this.hierarchicalLevels[_nodeId2]!==undefined){this.hierarchicalLevels[_nodeId2]-=minLevel}}}}},{key:"_generateMap",value:function _generateMap(){var _this6=this;var fillInRelations=function fillInRelations(parentNode,childNode){if(_this6.hierarchicalLevels[childNode.id]>_this6.hierarchicalLevels[parentNode.id]){var parentNodeId=parentNode.id;var childNodeId=childNode.id;if(_this6.hierarchicalChildrenReference[parentNodeId]===undefined){_this6.hierarchicalChildrenReference[parentNodeId]=[]}_this6.hierarchicalChildrenReference[parentNodeId].push(childNodeId);if(_this6.hierarchicalParentReference[childNodeId]===undefined){_this6.hierarchicalParentReference[childNodeId]=[]}_this6.hierarchicalParentReference[childNodeId].push(parentNodeId)}};this._crawlNetwork(fillInRelations)}},{key:"_crawlNetwork",value:function _crawlNetwork(){var _this7=this;var callback=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};var startingNodeId=arguments[1];var progress={};var treeIndex=0;var crawler=function crawler(node,tree){if(progress[node.id]===undefined){if(_this7.hierarchicalTrees[node.id]===undefined){_this7.hierarchicalTrees[node.id]=tree;_this7.treeIndex=Math.max(tree,_this7.treeIndex)}progress[node.id]=true;var childNode=void 0;for(var i=0;i<node.edges.length;i++){if(node.edges[i].connected===true){if(node.edges[i].toId===node.id){childNode=node.edges[i].from}else{childNode=node.edges[i].to}if(node.id!==childNode.id){callback(node,childNode,node.edges[i]);crawler(childNode,tree)}}}}};if(startingNodeId===undefined){for(var i=0;i<this.body.nodeIndices.length;i++){var node=this.body.nodes[this.body.nodeIndices[i]];if(progress[node.id]===undefined){crawler(node,treeIndex);treeIndex+=1}}}else{var _node=this.body.nodes[startingNodeId];if(_node===undefined){console.error("Node not found:",startingNodeId);return}crawler(_node)}}},{key:"_shiftBlock",value:function _shiftBlock(parentId,diff){if(this.options.hierarchical.direction==="UD"||this.options.hierarchical.direction==="DU"){this.body.nodes[parentId].x+=diff}else{this.body.nodes[parentId].y+=diff}if(this.hierarchicalChildrenReference[parentId]!==undefined){for(var i=0;i<this.hierarchicalChildrenReference[parentId].length;i++){this._shiftBlock(this.hierarchicalChildrenReference[parentId][i],diff)}}}},{key:"_findCommonParent",value:function _findCommonParent(childA,childB){var _this8=this;var parents={};var iterateParents=function iterateParents(parents,child){if(_this8.hierarchicalParentReference[child]!==undefined){for(var i=0;i<_this8.hierarchicalParentReference[child].length;i++){var parent=_this8.hierarchicalParentReference[child][i];parents[parent]=true;iterateParents(parents,parent)}}};var findParent=function findParent(parents,child){if(_this8.hierarchicalParentReference[child]!==undefined){for(var i=0;i<_this8.hierarchicalParentReference[child].length;i++){var parent=_this8.hierarchicalParentReference[child][i];if(parents[parent]!==undefined){return{foundParent:parent,withChild:child}}var branch=findParent(parents,parent);if(branch.foundParent!==null){return branch}}}return{foundParent:null,withChild:child}};iterateParents(parents,childA);return findParent(parents,childB)}},{key:"_setPositionForHierarchy",value:function _setPositionForHierarchy(node,position,level){var doNotUpdate=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(doNotUpdate!==true){if(this.distributionOrdering[level]===undefined){this.distributionOrdering[level]=[];this.distributionOrderingPresence[level]={}}if(this.distributionOrderingPresence[level][node.id]===undefined){this.distributionOrdering[level].push(node);this.distributionIndex[node.id]=this.distributionOrdering[level].length-1}this.distributionOrderingPresence[level][node.id]=true}if(this.options.hierarchical.direction==="UD"||this.options.hierarchical.direction==="DU"){node.x=position}else{node.y=position}}},{key:"_getPositionForHierarchy",value:function _getPositionForHierarchy(node){if(this.options.hierarchical.direction==="UD"||this.options.hierarchical.direction==="DU"){return node.x}else{return node.y}}},{key:"_sortNodeArray",value:function _sortNodeArray(nodeArray){if(nodeArray.length>1){if(this.options.hierarchical.direction==="UD"||this.options.hierarchical.direction==="DU"){nodeArray.sort(function(a,b){return a.x-b.x})}else{nodeArray.sort(function(a,b){return a.y-b.y})}}}}]);return LayoutEngine}();exports["default"]=LayoutEngine},{"../../util":116,"../NetworkUtil":24,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/slicedToArray":132,"babel-runtime/helpers/typeof":133}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var Hammer=require("../../module/hammer");var hammerUtil=require("../../hammerUtil");var ManipulationSystem=function(){function ManipulationSystem(body,canvas,selectionHandler){var _this=this;(0,_classCallCheck3["default"])(this,ManipulationSystem);this.body=body;this.canvas=canvas;this.selectionHandler=selectionHandler;this.editMode=false;this.manipulationDiv=undefined;this.editModeDiv=undefined;this.closeDiv=undefined;this.manipulationHammers=[];this.temporaryUIFunctions={};this.temporaryEventFunctions=[];this.touchTime=0;this.temporaryIds={nodes:[],edges:[]};this.guiEnabled=false;this.inMode=false;this.selectedControlNode=undefined;this.options={};this.defaultOptions={enabled:false,initiallyActive:false,addNode:true,addEdge:true,editNode:undefined,editEdge:true,deleteNode:true,deleteEdge:true,controlNodeStyle:{shape:"dot",size:6,color:{background:"#ff0000",border:"#3c3c3c",highlight:{background:"#07f968",border:"#3c3c3c"}},borderWidth:2,borderWidthSelected:2}};util.extend(this.options,this.defaultOptions);this.body.emitter.on("destroy",function(){_this._clean()});this.body.emitter.on("_dataChanged",this._restore.bind(this));this.body.emitter.on("_resetData",this._restore.bind(this))}(0,_createClass3["default"])(ManipulationSystem,[{key:"_restore",value:function _restore(){if(this.inMode!==false){if(this.options.initiallyActive===true){this.enableEditMode()}else{this.disableEditMode()}}}},{key:"setOptions",value:function setOptions(options,allOptions,globalOptions){if(allOptions!==undefined){if(allOptions.locale!==undefined){this.options.locale=allOptions.locale}else{this.options.locale=globalOptions.locale}if(allOptions.locales!==undefined){this.options.locales=allOptions.locales}else{this.options.locales=globalOptions.locales}}if(options!==undefined){if(typeof options==="boolean"){this.options.enabled=options}else{this.options.enabled=true;util.deepExtend(this.options,options)}if(this.options.initiallyActive===true){this.editMode=true}this._setup()}}},{key:"toggleEditMode",value:function toggleEditMode(){if(this.editMode===true){this.disableEditMode()}else{this.enableEditMode()}}},{key:"enableEditMode",value:function enableEditMode(){this.editMode=true;this._clean();if(this.guiEnabled===true){this.manipulationDiv.style.display="block";this.closeDiv.style.display="block";this.editModeDiv.style.display="none";this.showManipulatorToolbar()}}},{key:"disableEditMode",value:function disableEditMode(){this.editMode=false;this._clean();if(this.guiEnabled===true){this.manipulationDiv.style.display="none";this.closeDiv.style.display="none";this.editModeDiv.style.display="block";this._createEditButton()}}},{key:"showManipulatorToolbar",value:function showManipulatorToolbar(){this._clean();this.manipulationDOM={};if(this.guiEnabled===true){this.editMode=true;this.manipulationDiv.style.display="block";this.closeDiv.style.display="block";var selectedNodeCount=this.selectionHandler._getSelectedNodeCount();var selectedEdgeCount=this.selectionHandler._getSelectedEdgeCount();var selectedTotalCount=selectedNodeCount+selectedEdgeCount;var locale=this.options.locales[this.options.locale];var needSeperator=false;if(this.options.addNode!==false){this._createAddNodeButton(locale);needSeperator=true}if(this.options.addEdge!==false){if(needSeperator===true){this._createSeperator(1)}else{needSeperator=true}this._createAddEdgeButton(locale)}if(selectedNodeCount===1&&typeof this.options.editNode==="function"){if(needSeperator===true){this._createSeperator(2)}else{needSeperator=true}this._createEditNodeButton(locale)}else if(selectedEdgeCount===1&&selectedNodeCount===0&&this.options.editEdge!==false){if(needSeperator===true){this._createSeperator(3)}else{needSeperator=true}this._createEditEdgeButton(locale)}if(selectedTotalCount!==0){if(selectedNodeCount>0&&this.options.deleteNode!==false){if(needSeperator===true){this._createSeperator(4)}this._createDeleteButton(locale)}else if(selectedNodeCount===0&&this.options.deleteEdge!==false){if(needSeperator===true){this._createSeperator(4)}this._createDeleteButton(locale)}}this._bindHammerToDiv(this.closeDiv,this.toggleEditMode.bind(this));this._temporaryBindEvent("select",this.showManipulatorToolbar.bind(this))}this.body.emitter.emit("_redraw")}},{key:"addNodeMode",value:function addNodeMode(){if(this.editMode!==true){this.enableEditMode()}this._clean();this.inMode="addNode";if(this.guiEnabled===true){var locale=this.options.locales[this.options.locale];this.manipulationDOM={};this._createBackButton(locale);this._createSeperator();this._createDescription(locale["addDescription"]||this.options.locales["en"]["addDescription"]);this._bindHammerToDiv(this.closeDiv,this.toggleEditMode.bind(this))}this._temporaryBindEvent("click",this._performAddNode.bind(this))}},{key:"editNode",value:function editNode(){var _this2=this;if(this.editMode!==true){this.enableEditMode()}this._clean();var node=this.selectionHandler._getSelectedNode();if(node!==undefined){this.inMode="editNode";if(typeof this.options.editNode==="function"){if(node.isCluster!==true){var data=util.deepExtend({},node.options,false);data.x=node.x;data.y=node.y;if(this.options.editNode.length===2){this.options.editNode(data,function(finalizedData){if(finalizedData!==null&&finalizedData!==undefined&&_this2.inMode==="editNode"){_this2.body.data.nodes.getDataSet().update(finalizedData)}_this2.showManipulatorToolbar()})}else{throw new Error("The function for edit does not support two arguments (data, callback)")}}else{alert(this.options.locales[this.options.locale]["editClusterError"]||this.options.locales["en"]["editClusterError"])}}else{throw new Error("No function has been configured to handle the editing of nodes.")}}else{this.showManipulatorToolbar()}}},{key:"addEdgeMode",value:function addEdgeMode(){if(this.editMode!==true){this.enableEditMode()}this._clean();this.inMode="addEdge";if(this.guiEnabled===true){var locale=this.options.locales[this.options.locale];this.manipulationDOM={};this._createBackButton(locale);this._createSeperator();this._createDescription(locale["edgeDescription"]||this.options.locales["en"]["edgeDescription"]);this._bindHammerToDiv(this.closeDiv,this.toggleEditMode.bind(this))}this._temporaryBindUI("onTouch",this._handleConnect.bind(this));this._temporaryBindUI("onDragEnd",this._finishConnect.bind(this));this._temporaryBindUI("onDrag",this._dragControlNode.bind(this));this._temporaryBindUI("onRelease",this._finishConnect.bind(this));this._temporaryBindUI("onDragStart",function(){});this._temporaryBindUI("onHold",function(){})}},{key:"editEdgeMode",value:function editEdgeMode(){var _this3=this;if(this.editMode!==true){this.enableEditMode()}this._clean();this.inMode="editEdge";if((0,_typeof3["default"])(this.options.editEdge)==="object"&&typeof this.options.editEdge.editWithoutDrag==="function"){this.edgeBeingEditedId=this.selectionHandler.getSelectedEdges()[0];if(this.edgeBeingEditedId!==undefined){var edge=this.body.edges[this.edgeBeingEditedId];this._performEditEdge(edge.from,edge.to);return}}if(this.guiEnabled===true){var locale=this.options.locales[this.options.locale];this.manipulationDOM={};this._createBackButton(locale);this._createSeperator();this._createDescription(locale["editEdgeDescription"]||this.options.locales["en"]["editEdgeDescription"]);this._bindHammerToDiv(this.closeDiv,this.toggleEditMode.bind(this))}this.edgeBeingEditedId=this.selectionHandler.getSelectedEdges()[0];if(this.edgeBeingEditedId!==undefined){(function(){var edge=_this3.body.edges[_this3.edgeBeingEditedId];var controlNodeFrom=_this3._getNewTargetNode(edge.from.x,edge.from.y);var controlNodeTo=_this3._getNewTargetNode(edge.to.x,edge.to.y);_this3.temporaryIds.nodes.push(controlNodeFrom.id);_this3.temporaryIds.nodes.push(controlNodeTo.id);_this3.body.nodes[controlNodeFrom.id]=controlNodeFrom;_this3.body.nodeIndices.push(controlNodeFrom.id);_this3.body.nodes[controlNodeTo.id]=controlNodeTo;_this3.body.nodeIndices.push(controlNodeTo.id);_this3._temporaryBindUI("onTouch",_this3._controlNodeTouch.bind(_this3));_this3._temporaryBindUI("onTap",function(){});_this3._temporaryBindUI("onHold",function(){});_this3._temporaryBindUI("onDragStart",_this3._controlNodeDragStart.bind(_this3));_this3._temporaryBindUI("onDrag",_this3._controlNodeDrag.bind(_this3));_this3._temporaryBindUI("onDragEnd",_this3._controlNodeDragEnd.bind(_this3));_this3._temporaryBindUI("onMouseMove",function(){});_this3._temporaryBindEvent("beforeDrawing",function(ctx){var positions=edge.edgeType.findBorderPositions(ctx);if(controlNodeFrom.selected===false){controlNodeFrom.x=positions.from.x;controlNodeFrom.y=positions.from.y}if(controlNodeTo.selected===false){controlNodeTo.x=positions.to.x;controlNodeTo.y=positions.to.y}});_this3.body.emitter.emit("_redraw")})()}else{this.showManipulatorToolbar()}}},{key:"deleteSelected",value:function deleteSelected(){var _this4=this;if(this.editMode!==true){this.enableEditMode()}this._clean();this.inMode="delete";var selectedNodes=this.selectionHandler.getSelectedNodes();var selectedEdges=this.selectionHandler.getSelectedEdges();var deleteFunction=undefined;if(selectedNodes.length>0){for(var i=0;i<selectedNodes.length;i++){if(this.body.nodes[selectedNodes[i]].isCluster===true){alert(this.options.locales[this.options.locale]["deleteClusterError"]||this.options.locales["en"]["deleteClusterError"]);return}}if(typeof this.options.deleteNode==="function"){deleteFunction=this.options.deleteNode}}else if(selectedEdges.length>0){if(typeof this.options.deleteEdge==="function"){deleteFunction=this.options.deleteEdge}}if(typeof deleteFunction==="function"){var data={nodes:selectedNodes,edges:selectedEdges};if(deleteFunction.length===2){deleteFunction(data,function(finalizedData){if(finalizedData!==null&&finalizedData!==undefined&&_this4.inMode==="delete"){_this4.body.data.edges.getDataSet().remove(finalizedData.edges);_this4.body.data.nodes.getDataSet().remove(finalizedData.nodes);_this4.body.emitter.emit("startSimulation");_this4.showManipulatorToolbar()}else{_this4.body.emitter.emit("startSimulation");_this4.showManipulatorToolbar()}})}else{throw new Error("The function for delete does not support two arguments (data, callback)")}}else{this.body.data.edges.getDataSet().remove(selectedEdges);this.body.data.nodes.getDataSet().remove(selectedNodes);this.body.emitter.emit("startSimulation");this.showManipulatorToolbar()}}},{key:"_setup",value:function _setup(){if(this.options.enabled===true){this.guiEnabled=true;this._createWrappers();if(this.editMode===false){this._createEditButton()}else{this.showManipulatorToolbar()}}else{this._removeManipulationDOM();this.guiEnabled=false}}},{key:"_createWrappers",value:function _createWrappers(){if(this.manipulationDiv===undefined){this.manipulationDiv=document.createElement("div");this.manipulationDiv.className="vis-manipulation";if(this.editMode===true){this.manipulationDiv.style.display="block"}else{this.manipulationDiv.style.display="none"}this.canvas.frame.appendChild(this.manipulationDiv)}if(this.editModeDiv===undefined){this.editModeDiv=document.createElement("div");this.editModeDiv.className="vis-edit-mode";if(this.editMode===true){this.editModeDiv.style.display="none"}else{this.editModeDiv.style.display="block"}this.canvas.frame.appendChild(this.editModeDiv)}if(this.closeDiv===undefined){this.closeDiv=document.createElement("div");this.closeDiv.className="vis-close";this.closeDiv.style.display=this.manipulationDiv.style.display;this.canvas.frame.appendChild(this.closeDiv)}}},{key:"_getNewTargetNode",value:function _getNewTargetNode(x,y){var controlNodeStyle=util.deepExtend({},this.options.controlNodeStyle);controlNodeStyle.id="targetNode"+util.randomUUID();controlNodeStyle.hidden=false;controlNodeStyle.physics=false;controlNodeStyle.x=x;controlNodeStyle.y=y;var node=this.body.functions.createNode(controlNodeStyle);node.shape.boundingBox={left:x,right:x,top:y,bottom:y};return node}},{key:"_createEditButton",value:function _createEditButton(){this._clean();this.manipulationDOM={};util.recursiveDOMDelete(this.editModeDiv);var locale=this.options.locales[this.options.locale];var button=this._createButton("editMode","vis-button vis-edit vis-edit-mode",locale["edit"]||this.options.locales["en"]["edit"]);this.editModeDiv.appendChild(button);this._bindHammerToDiv(button,this.toggleEditMode.bind(this))}},{key:"_clean",value:function _clean(){this.inMode=false;if(this.guiEnabled===true){util.recursiveDOMDelete(this.editModeDiv);util.recursiveDOMDelete(this.manipulationDiv);this._cleanManipulatorHammers()}this._cleanupTemporaryNodesAndEdges();this._unbindTemporaryUIs();this._unbindTemporaryEvents();this.body.emitter.emit("restorePhysics")}},{key:"_cleanManipulatorHammers",value:function _cleanManipulatorHammers(){if(this.manipulationHammers.length!=0){for(var i=0;i<this.manipulationHammers.length;i++){this.manipulationHammers[i].destroy()}this.manipulationHammers=[]}}},{key:"_removeManipulationDOM",value:function _removeManipulationDOM(){this._clean();util.recursiveDOMDelete(this.manipulationDiv);util.recursiveDOMDelete(this.editModeDiv);util.recursiveDOMDelete(this.closeDiv);if(this.manipulationDiv){this.canvas.frame.removeChild(this.manipulationDiv)}if(this.editModeDiv){this.canvas.frame.removeChild(this.editModeDiv)}if(this.closeDiv){this.canvas.frame.removeChild(this.closeDiv)}this.manipulationDiv=undefined;this.editModeDiv=undefined;this.closeDiv=undefined}},{key:"_createSeperator",value:function _createSeperator(){var index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;this.manipulationDOM["seperatorLineDiv"+index]=document.createElement("div");this.manipulationDOM["seperatorLineDiv"+index].className="vis-separator-line";this.manipulationDiv.appendChild(this.manipulationDOM["seperatorLineDiv"+index])}},{key:"_createAddNodeButton",value:function _createAddNodeButton(locale){var button=this._createButton("addNode","vis-button vis-add",locale["addNode"]||this.options.locales["en"]["addNode"]);this.manipulationDiv.appendChild(button);this._bindHammerToDiv(button,this.addNodeMode.bind(this))}},{key:"_createAddEdgeButton",value:function _createAddEdgeButton(locale){var button=this._createButton("addEdge","vis-button vis-connect",locale["addEdge"]||this.options.locales["en"]["addEdge"]);this.manipulationDiv.appendChild(button);this._bindHammerToDiv(button,this.addEdgeMode.bind(this))}},{key:"_createEditNodeButton",value:function _createEditNodeButton(locale){var button=this._createButton("editNode","vis-button vis-edit",locale["editNode"]||this.options.locales["en"]["editNode"]);this.manipulationDiv.appendChild(button);this._bindHammerToDiv(button,this.editNode.bind(this))}},{key:"_createEditEdgeButton",value:function _createEditEdgeButton(locale){var button=this._createButton("editEdge","vis-button vis-edit",locale["editEdge"]||this.options.locales["en"]["editEdge"]);this.manipulationDiv.appendChild(button);this._bindHammerToDiv(button,this.editEdgeMode.bind(this))}},{key:"_createDeleteButton",value:function _createDeleteButton(locale){if(this.options.rtl){var deleteBtnClass="vis-button vis-delete-rtl"}else{var deleteBtnClass="vis-button vis-delete"}var button=this._createButton("delete",deleteBtnClass,locale["del"]||this.options.locales["en"]["del"]);this.manipulationDiv.appendChild(button);this._bindHammerToDiv(button,this.deleteSelected.bind(this))}},{key:"_createBackButton",value:function _createBackButton(locale){var button=this._createButton("back","vis-button vis-back",locale["back"]||this.options.locales["en"]["back"]);this.manipulationDiv.appendChild(button);this._bindHammerToDiv(button,this.showManipulatorToolbar.bind(this))}},{key:"_createButton",value:function _createButton(id,className,label){var labelClassName=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"vis-label";this.manipulationDOM[id+"Div"]=document.createElement("div");this.manipulationDOM[id+"Div"].className=className;this.manipulationDOM[id+"Label"]=document.createElement("div");this.manipulationDOM[id+"Label"].className=labelClassName;this.manipulationDOM[id+"Label"].innerHTML=label;this.manipulationDOM[id+"Div"].appendChild(this.manipulationDOM[id+"Label"]);return this.manipulationDOM[id+"Div"]}},{key:"_createDescription",value:function _createDescription(label){this.manipulationDiv.appendChild(this._createButton("description","vis-button vis-none",label))}},{key:"_temporaryBindEvent",value:function _temporaryBindEvent(event,newFunction){this.temporaryEventFunctions.push({event:event,boundFunction:newFunction});this.body.emitter.on(event,newFunction)}},{key:"_temporaryBindUI",value:function _temporaryBindUI(UIfunctionName,newFunction){if(this.body.eventListeners[UIfunctionName]!==undefined){this.temporaryUIFunctions[UIfunctionName]=this.body.eventListeners[UIfunctionName];this.body.eventListeners[UIfunctionName]=newFunction}else{throw new Error("This UI function does not exist. Typo? You tried: "+UIfunctionName+" possible are: "+(0,_stringify2["default"])((0,_keys2["default"])(this.body.eventListeners)))}}},{key:"_unbindTemporaryUIs",value:function _unbindTemporaryUIs(){for(var functionName in this.temporaryUIFunctions){if(this.temporaryUIFunctions.hasOwnProperty(functionName)){this.body.eventListeners[functionName]=this.temporaryUIFunctions[functionName];delete this.temporaryUIFunctions[functionName]}}this.temporaryUIFunctions={}}},{key:"_unbindTemporaryEvents",value:function _unbindTemporaryEvents(){for(var i=0;i<this.temporaryEventFunctions.length;i++){var eventName=this.temporaryEventFunctions[i].event;var boundFunction=this.temporaryEventFunctions[i].boundFunction;this.body.emitter.off(eventName,boundFunction)}this.temporaryEventFunctions=[]}},{key:"_bindHammerToDiv",value:function _bindHammerToDiv(domElement,boundFunction){var hammer=new Hammer(domElement,{});hammerUtil.onTouch(hammer,boundFunction);this.manipulationHammers.push(hammer)}},{key:"_cleanupTemporaryNodesAndEdges",value:function _cleanupTemporaryNodesAndEdges(){for(var i=0;i<this.temporaryIds.edges.length;i++){this.body.edges[this.temporaryIds.edges[i]].disconnect();delete this.body.edges[this.temporaryIds.edges[i]];var indexTempEdge=this.body.edgeIndices.indexOf(this.temporaryIds.edges[i]);if(indexTempEdge!==-1){this.body.edgeIndices.splice(indexTempEdge,1)}}for(var _i=0;_i<this.temporaryIds.nodes.length;_i++){delete this.body.nodes[this.temporaryIds.nodes[_i]];var indexTempNode=this.body.nodeIndices.indexOf(this.temporaryIds.nodes[_i]);if(indexTempNode!==-1){this.body.nodeIndices.splice(indexTempNode,1)}}this.temporaryIds={nodes:[],edges:[]}}},{key:"_controlNodeTouch",value:function _controlNodeTouch(event){this.selectionHandler.unselectAll();this.lastTouch=this.body.functions.getPointer(event.center);this.lastTouch.translation=util.extend({},this.body.view.translation)}},{key:"_controlNodeDragStart",value:function _controlNodeDragStart(event){var pointer=this.lastTouch;var pointerObj=this.selectionHandler._pointerToPositionObject(pointer);var from=this.body.nodes[this.temporaryIds.nodes[0]];var to=this.body.nodes[this.temporaryIds.nodes[1]];var edge=this.body.edges[this.edgeBeingEditedId];this.selectedControlNode=undefined;var fromSelect=from.isOverlappingWith(pointerObj);var toSelect=to.isOverlappingWith(pointerObj);if(fromSelect===true){this.selectedControlNode=from;edge.edgeType.from=from}else if(toSelect===true){this.selectedControlNode=to;edge.edgeType.to=to}if(this.selectedControlNode!==undefined){this.selectionHandler.selectObject(this.selectedControlNode)}this.body.emitter.emit("_redraw")}},{key:"_controlNodeDrag",value:function _controlNodeDrag(event){this.body.emitter.emit("disablePhysics");var pointer=this.body.functions.getPointer(event.center);var pos=this.canvas.DOMtoCanvas(pointer);if(this.selectedControlNode!==undefined){this.selectedControlNode.x=pos.x;this.selectedControlNode.y=pos.y}else{var diffX=pointer.x-this.lastTouch.x;var diffY=pointer.y-this.lastTouch.y;this.body.view.translation={x:this.lastTouch.translation.x+diffX,y:this.lastTouch.translation.y+diffY}}this.body.emitter.emit("_redraw")}},{key:"_controlNodeDragEnd",value:function _controlNodeDragEnd(event){var pointer=this.body.functions.getPointer(event.center);var pointerObj=this.selectionHandler._pointerToPositionObject(pointer);var edge=this.body.edges[this.edgeBeingEditedId];if(this.selectedControlNode===undefined){return}this.selectionHandler.unselectAll();var overlappingNodeIds=this.selectionHandler._getAllNodesOverlappingWith(pointerObj);var node=undefined;for(var i=overlappingNodeIds.length-1;i>=0;i--){if(overlappingNodeIds[i]!==this.selectedControlNode.id){node=this.body.nodes[overlappingNodeIds[i]];break}}if(node!==undefined&&this.selectedControlNode!==undefined){if(node.isCluster===true){alert(this.options.locales[this.options.locale]["createEdgeError"]||this.options.locales["en"]["createEdgeError"])}else{var from=this.body.nodes[this.temporaryIds.nodes[0]];if(this.selectedControlNode.id===from.id){this._performEditEdge(node.id,edge.to.id)}else{this._performEditEdge(edge.from.id,node.id)}}}else{edge.updateEdgeType();this.body.emitter.emit("restorePhysics")}this.body.emitter.emit("_redraw")}},{key:"_handleConnect",value:function _handleConnect(event){if((new Date).valueOf()-this.touchTime>100){this.lastTouch=this.body.functions.getPointer(event.center);this.lastTouch.translation=util.extend({},this.body.view.translation);var pointer=this.lastTouch;var node=this.selectionHandler.getNodeAt(pointer);if(node!==undefined){if(node.isCluster===true){alert(this.options.locales[this.options.locale]["createEdgeError"]||this.options.locales["en"]["createEdgeError"])}else{var targetNode=this._getNewTargetNode(node.x,node.y);this.body.nodes[targetNode.id]=targetNode;this.body.nodeIndices.push(targetNode.id);var connectionEdge=this.body.functions.createEdge({id:"connectionEdge"+util.randomUUID(),from:node.id,to:targetNode.id,physics:false,smooth:{enabled:true,type:"continuous",roundness:.5}});this.body.edges[connectionEdge.id]=connectionEdge;this.body.edgeIndices.push(connectionEdge.id);this.temporaryIds.nodes.push(targetNode.id);this.temporaryIds.edges.push(connectionEdge.id)}}this.touchTime=(new Date).valueOf()}}},{key:"_dragControlNode",value:function _dragControlNode(event){var pointer=this.body.functions.getPointer(event.center);if(this.temporaryIds.nodes[0]!==undefined){var targetNode=this.body.nodes[this.temporaryIds.nodes[0]];targetNode.x=this.canvas._XconvertDOMtoCanvas(pointer.x);
targetNode.y=this.canvas._YconvertDOMtoCanvas(pointer.y);this.body.emitter.emit("_redraw")}else{var diffX=pointer.x-this.lastTouch.x;var diffY=pointer.y-this.lastTouch.y;this.body.view.translation={x:this.lastTouch.translation.x+diffX,y:this.lastTouch.translation.y+diffY}}}},{key:"_finishConnect",value:function _finishConnect(event){var pointer=this.body.functions.getPointer(event.center);var pointerObj=this.selectionHandler._pointerToPositionObject(pointer);var connectFromId=undefined;if(this.temporaryIds.edges[0]!==undefined){connectFromId=this.body.edges[this.temporaryIds.edges[0]].fromId}var overlappingNodeIds=this.selectionHandler._getAllNodesOverlappingWith(pointerObj);var node=undefined;for(var i=overlappingNodeIds.length-1;i>=0;i--){if(this.temporaryIds.nodes.indexOf(overlappingNodeIds[i])===-1){node=this.body.nodes[overlappingNodeIds[i]];break}}this._cleanupTemporaryNodesAndEdges();if(node!==undefined){if(node.isCluster===true){alert(this.options.locales[this.options.locale]["createEdgeError"]||this.options.locales["en"]["createEdgeError"])}else{if(this.body.nodes[connectFromId]!==undefined&&this.body.nodes[node.id]!==undefined){this._performAddEdge(connectFromId,node.id)}}}this.body.emitter.emit("_redraw")}},{key:"_performAddNode",value:function _performAddNode(clickData){var _this5=this;var defaultData={id:util.randomUUID(),x:clickData.pointer.canvas.x,y:clickData.pointer.canvas.y,label:"new"};if(typeof this.options.addNode==="function"){if(this.options.addNode.length===2){this.options.addNode(defaultData,function(finalizedData){if(finalizedData!==null&&finalizedData!==undefined&&_this5.inMode==="addNode"){_this5.body.data.nodes.getDataSet().add(finalizedData);_this5.showManipulatorToolbar()}})}else{throw new Error("The function for add does not support two arguments (data,callback)");this.showManipulatorToolbar()}}else{this.body.data.nodes.getDataSet().add(defaultData);this.showManipulatorToolbar()}}},{key:"_performAddEdge",value:function _performAddEdge(sourceNodeId,targetNodeId){var _this6=this;var defaultData={from:sourceNodeId,to:targetNodeId};if(typeof this.options.addEdge==="function"){if(this.options.addEdge.length===2){this.options.addEdge(defaultData,function(finalizedData){if(finalizedData!==null&&finalizedData!==undefined&&_this6.inMode==="addEdge"){_this6.body.data.edges.getDataSet().add(finalizedData);_this6.selectionHandler.unselectAll();_this6.showManipulatorToolbar()}})}else{throw new Error("The function for connect does not support two arguments (data,callback)")}}else{this.body.data.edges.getDataSet().add(defaultData);this.selectionHandler.unselectAll();this.showManipulatorToolbar()}}},{key:"_performEditEdge",value:function _performEditEdge(sourceNodeId,targetNodeId){var _this7=this;var defaultData={id:this.edgeBeingEditedId,from:sourceNodeId,to:targetNodeId,label:this.body.data.edges._data[this.edgeBeingEditedId].label};var eeFunct=this.options.editEdge;if((typeof eeFunct==="undefined"?"undefined":(0,_typeof3["default"])(eeFunct))==="object"){eeFunct=eeFunct.editWithoutDrag}if(typeof eeFunct==="function"){if(eeFunct.length===2){eeFunct(defaultData,function(finalizedData){if(finalizedData===null||finalizedData===undefined||_this7.inMode!=="editEdge"){_this7.body.edges[defaultData.id].updateEdgeType();_this7.body.emitter.emit("_redraw");_this7.showManipulatorToolbar()}else{_this7.body.data.edges.getDataSet().update(finalizedData);_this7.selectionHandler.unselectAll();_this7.showManipulatorToolbar()}})}else{throw new Error("The function for edit does not support two arguments (data, callback)")}}else{this.body.data.edges.getDataSet().update(defaultData);this.selectionHandler.unselectAll();this.showManipulatorToolbar()}}}]);return ManipulationSystem}();exports["default"]=ManipulationSystem},{"../../hammerUtil":18,"../../module/hammer":19,"../../util":116,"babel-runtime/core-js/json/stringify":119,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _Node=require("./components/Node");var _Node2=_interopRequireDefault(_Node);var _Label=require("./components/shared/Label");var _Label2=_interopRequireDefault(_Label);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var DataSet=require("../../DataSet");var DataView=require("../../DataView");var NodesHandler=function(){function NodesHandler(body,images,groups,layoutEngine){var _this=this;(0,_classCallCheck3["default"])(this,NodesHandler);this.body=body;this.images=images;this.groups=groups;this.layoutEngine=layoutEngine;this.body.functions.createNode=this.create.bind(this);this.nodesListeners={add:function add(event,params){_this.add(params.items)},update:function update(event,params){_this.update(params.items,params.data)},remove:function remove(event,params){_this.remove(params.items)}};this.options={};this.defaultOptions={borderWidth:1,borderWidthSelected:2,brokenImage:undefined,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},fixed:{x:false,y:false},font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:0,strokeColor:"#ffffff",align:"center",vadjust:0,multi:false,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},group:undefined,hidden:false,icon:{face:"FontAwesome",code:undefined,size:50,color:"#2B7CE9"},image:undefined,label:undefined,labelHighlightBold:true,level:undefined,margin:{top:5,right:5,bottom:5,left:5},mass:1,physics:true,scaling:{min:10,max:30,label:{enabled:false,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function customScalingFunction(min,max,total,value){if(max===min){return.5}else{var scale=1/(max-min);return Math.max(0,(value-min)*scale)}}},shadow:{enabled:false,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},shape:"ellipse",shapeProperties:{borderDashes:false,borderRadius:6,interpolation:true,useImageSize:false,useBorderWithImage:false},size:25,title:undefined,value:undefined,x:undefined,y:undefined};util.extend(this.options,this.defaultOptions);this.bindEventListeners()}(0,_createClass3["default"])(NodesHandler,[{key:"bindEventListeners",value:function bindEventListeners(){var _this2=this;this.body.emitter.on("refreshNodes",this.refresh.bind(this));this.body.emitter.on("refresh",this.refresh.bind(this));this.body.emitter.on("destroy",function(){util.forEach(_this2.nodesListeners,function(callback,event){if(_this2.body.data.nodes)_this2.body.data.nodes.off(event,callback)});delete _this2.body.functions.createNode;delete _this2.nodesListeners.add;delete _this2.nodesListeners.update;delete _this2.nodesListeners.remove;delete _this2.nodesListeners})}},{key:"setOptions",value:function setOptions(options){this.nodeOptions=options;if(options!==undefined){_Node2["default"].parseOptions(this.options,options);if(options.shape!==undefined){for(var nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){this.body.nodes[nodeId].updateShape()}}}if(options.font!==undefined){_Label2["default"].parseOptions(this.options.font,options);for(var _nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(_nodeId)){this.body.nodes[_nodeId].updateLabelModule();this.body.nodes[_nodeId]._reset()}}}if(options.size!==undefined){for(var _nodeId2 in this.body.nodes){if(this.body.nodes.hasOwnProperty(_nodeId2)){this.body.nodes[_nodeId2]._reset()}}}if(options.hidden!==undefined||options.physics!==undefined){this.body.emitter.emit("_dataChanged")}}}},{key:"setData",value:function setData(nodes){var _this3=this;var doNotEmit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var oldNodesData=this.body.data.nodes;if(nodes instanceof DataSet||nodes instanceof DataView){this.body.data.nodes=nodes}else if(Array.isArray(nodes)){this.body.data.nodes=new DataSet;this.body.data.nodes.add(nodes)}else if(!nodes){this.body.data.nodes=new DataSet}else{throw new TypeError("Array or DataSet expected")}if(oldNodesData){util.forEach(this.nodesListeners,function(callback,event){oldNodesData.off(event,callback)})}this.body.nodes={};if(this.body.data.nodes){(function(){var me=_this3;util.forEach(_this3.nodesListeners,function(callback,event){me.body.data.nodes.on(event,callback)});var ids=_this3.body.data.nodes.getIds();_this3.add(ids,true)})()}if(doNotEmit===false){this.body.emitter.emit("_dataChanged")}}},{key:"add",value:function add(ids){var doNotEmit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var id=void 0;var newNodes=[];for(var i=0;i<ids.length;i++){id=ids[i];var properties=this.body.data.nodes.get(id);var node=this.create(properties);newNodes.push(node);this.body.nodes[id]=node}this.layoutEngine.positionInitially(newNodes);if(doNotEmit===false){this.body.emitter.emit("_dataChanged")}}},{key:"update",value:function update(ids,changedData){var nodes=this.body.nodes;var dataChanged=false;for(var i=0;i<ids.length;i++){var id=ids[i];var node=nodes[id];var data=changedData[i];if(node!==undefined){dataChanged=node.setOptions(data)}else{dataChanged=true;node=this.create(data);nodes[id]=node}}if(dataChanged===true){this.body.emitter.emit("_dataChanged")}else{this.body.emitter.emit("_dataUpdated")}}},{key:"remove",value:function remove(ids){var nodes=this.body.nodes;for(var i=0;i<ids.length;i++){var id=ids[i];delete nodes[id]}this.body.emitter.emit("_dataChanged")}},{key:"create",value:function create(properties){var constructorClass=arguments.length>1&&arguments[1]!==undefined?arguments[1]:_Node2["default"];return new constructorClass(properties,this.body,this.images,this.groups,this.options,this.defaultOptions,this.nodeOptions)}},{key:"refresh",value:function refresh(){var clearPositions=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var nodes=this.body.nodes;for(var nodeId in nodes){var node=undefined;if(nodes.hasOwnProperty(nodeId)){node=nodes[nodeId]}var data=this.body.data.nodes._data[nodeId];if(node!==undefined&&data!==undefined){if(clearPositions===true){node.setOptions({x:null,y:null})}node.setOptions({fixed:false});node.setOptions(data)}}}},{key:"getPositions",value:function getPositions(ids){var dataArray={};if(ids!==undefined){if(Array.isArray(ids)===true){for(var i=0;i<ids.length;i++){if(this.body.nodes[ids[i]]!==undefined){var node=this.body.nodes[ids[i]];dataArray[ids[i]]={x:Math.round(node.x),y:Math.round(node.y)}}}}else{if(this.body.nodes[ids]!==undefined){var _node=this.body.nodes[ids];dataArray[ids]={x:Math.round(_node.x),y:Math.round(_node.y)}}}}else{for(var _i=0;_i<this.body.nodeIndices.length;_i++){var _node2=this.body.nodes[this.body.nodeIndices[_i]];dataArray[this.body.nodeIndices[_i]]={x:Math.round(_node2.x),y:Math.round(_node2.y)}}}return dataArray}},{key:"storePositions",value:function storePositions(){var dataArray=[];var dataset=this.body.data.nodes.getDataSet();for(var nodeId in dataset._data){if(dataset._data.hasOwnProperty(nodeId)){var node=this.body.nodes[nodeId];if(dataset._data[nodeId].x!=Math.round(node.x)||dataset._data[nodeId].y!=Math.round(node.y)){dataArray.push({id:node.id,x:Math.round(node.x),y:Math.round(node.y)})}}}dataset.update(dataArray)}},{key:"getBoundingBox",value:function getBoundingBox(nodeId){if(this.body.nodes[nodeId]!==undefined){return this.body.nodes[nodeId].shape.boundingBox}}},{key:"getConnectedNodes",value:function getConnectedNodes(nodeId){var nodeList=[];if(this.body.nodes[nodeId]!==undefined){var node=this.body.nodes[nodeId];var nodeObj={};for(var i=0;i<node.edges.length;i++){var edge=node.edges[i];if(edge.toId==node.id){if(nodeObj[edge.fromId]===undefined){nodeList.push(edge.fromId);nodeObj[edge.fromId]=true}}else if(edge.fromId==node.id){if(nodeObj[edge.toId]===undefined){nodeList.push(edge.toId);nodeObj[edge.toId]=true}}}}return nodeList}},{key:"getConnectedEdges",value:function getConnectedEdges(nodeId){var edgeList=[];if(this.body.nodes[nodeId]!==undefined){var node=this.body.nodes[nodeId];for(var i=0;i<node.edges.length;i++){edgeList.push(node.edges[i].id)}}else{console.log("NodeId provided for getConnectedEdges does not exist. Provided: ",nodeId)}return edgeList}},{key:"moveNode",value:function moveNode(nodeId,x,y){var _this4=this;if(this.body.nodes[nodeId]!==undefined){this.body.nodes[nodeId].x=Number(x);this.body.nodes[nodeId].y=Number(y);setTimeout(function(){_this4.body.emitter.emit("startSimulation")},0)}else{console.log("Node id supplied to moveNode does not exist. Provided: ",nodeId)}}}]);return NodesHandler}();exports["default"]=NodesHandler},{"../../DataSet":6,"../../DataView":7,"../../util":116,"./components/Node":43,"./components/shared/Label":78,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _BarnesHutSolver=require("./components/physics/BarnesHutSolver");var _BarnesHutSolver2=_interopRequireDefault(_BarnesHutSolver);var _RepulsionSolver=require("./components/physics/RepulsionSolver");var _RepulsionSolver2=_interopRequireDefault(_RepulsionSolver);var _HierarchicalRepulsionSolver=require("./components/physics/HierarchicalRepulsionSolver");var _HierarchicalRepulsionSolver2=_interopRequireDefault(_HierarchicalRepulsionSolver);var _SpringSolver=require("./components/physics/SpringSolver");var _SpringSolver2=_interopRequireDefault(_SpringSolver);var _HierarchicalSpringSolver=require("./components/physics/HierarchicalSpringSolver");var _HierarchicalSpringSolver2=_interopRequireDefault(_HierarchicalSpringSolver);var _CentralGravitySolver=require("./components/physics/CentralGravitySolver");var _CentralGravitySolver2=_interopRequireDefault(_CentralGravitySolver);var _FA2BasedRepulsionSolver=require("./components/physics/FA2BasedRepulsionSolver");var _FA2BasedRepulsionSolver2=_interopRequireDefault(_FA2BasedRepulsionSolver);var _FA2BasedCentralGravitySolver=require("./components/physics/FA2BasedCentralGravitySolver");var _FA2BasedCentralGravitySolver2=_interopRequireDefault(_FA2BasedCentralGravitySolver);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var PhysicsEngine=function(){function PhysicsEngine(body){(0,_classCallCheck3["default"])(this,PhysicsEngine);this.body=body;this.physicsBody={physicsNodeIndices:[],physicsEdgeIndices:[],forces:{},velocities:{}};this.physicsEnabled=true;this.simulationInterval=1e3/60;this.requiresTimeout=true;this.previousStates={};this.referenceState={};this.freezeCache={};this.renderTimer=undefined;this.adaptiveTimestep=false;this.adaptiveTimestepEnabled=false;this.adaptiveCounter=0;this.adaptiveInterval=3;this.stabilized=false;this.startedStabilization=false;this.stabilizationIterations=0;this.ready=false;this.options={};this.defaultOptions={enabled:true,barnesHut:{theta:.5,gravitationalConstant:-2e3,centralGravity:.3,springLength:95,springConstant:.04,damping:.09,avoidOverlap:0},forceAtlas2Based:{theta:.5,gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:0},repulsion:{centralGravity:.2,springLength:200,springConstant:.05,nodeDistance:100,damping:.09,avoidOverlap:0},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.75,solver:"barnesHut",stabilization:{enabled:true,iterations:1e3,updateInterval:50,onlyDynamicEdges:false,fit:true},timestep:.5,adaptiveTimestep:true};util.extend(this.options,this.defaultOptions);this.timestep=.5;this.layoutFailed=false;this.bindEventListeners()}(0,_createClass3["default"])(PhysicsEngine,[{key:"bindEventListeners",value:function bindEventListeners(){var _this=this;this.body.emitter.on("initPhysics",function(){_this.initPhysics()});this.body.emitter.on("_layoutFailed",function(){_this.layoutFailed=true});this.body.emitter.on("resetPhysics",function(){_this.stopSimulation();_this.ready=false});this.body.emitter.on("disablePhysics",function(){_this.physicsEnabled=false;_this.stopSimulation()});this.body.emitter.on("restorePhysics",function(){_this.setOptions(_this.options);if(_this.ready===true){_this.startSimulation()}});this.body.emitter.on("startSimulation",function(){if(_this.ready===true){_this.startSimulation()}});this.body.emitter.on("stopSimulation",function(){_this.stopSimulation()});this.body.emitter.on("destroy",function(){_this.stopSimulation(false);_this.body.emitter.off()});this.body.emitter.on("_dataChanged",function(){_this.updatePhysicsData()})}},{key:"setOptions",value:function setOptions(options){if(options!==undefined){if(options===false){this.options.enabled=false;this.physicsEnabled=false;this.stopSimulation()}else{this.physicsEnabled=true;util.selectiveNotDeepExtend(["stabilization"],this.options,options);util.mergeOptions(this.options,options,"stabilization");if(options.enabled===undefined){this.options.enabled=true}if(this.options.enabled===false){this.physicsEnabled=false;this.stopSimulation()}this.timestep=this.options.timestep}}this.init()}},{key:"init",value:function init(){var options;if(this.options.solver==="forceAtlas2Based"){options=this.options.forceAtlas2Based;this.nodesSolver=new _FA2BasedRepulsionSolver2["default"](this.body,this.physicsBody,options);this.edgesSolver=new _SpringSolver2["default"](this.body,this.physicsBody,options);this.gravitySolver=new _FA2BasedCentralGravitySolver2["default"](this.body,this.physicsBody,options)}else if(this.options.solver==="repulsion"){options=this.options.repulsion;this.nodesSolver=new _RepulsionSolver2["default"](this.body,this.physicsBody,options);this.edgesSolver=new _SpringSolver2["default"](this.body,this.physicsBody,options);this.gravitySolver=new _CentralGravitySolver2["default"](this.body,this.physicsBody,options)}else if(this.options.solver==="hierarchicalRepulsion"){options=this.options.hierarchicalRepulsion;this.nodesSolver=new _HierarchicalRepulsionSolver2["default"](this.body,this.physicsBody,options);this.edgesSolver=new _HierarchicalSpringSolver2["default"](this.body,this.physicsBody,options);this.gravitySolver=new _CentralGravitySolver2["default"](this.body,this.physicsBody,options)}else{options=this.options.barnesHut;this.nodesSolver=new _BarnesHutSolver2["default"](this.body,this.physicsBody,options);this.edgesSolver=new _SpringSolver2["default"](this.body,this.physicsBody,options);this.gravitySolver=new _CentralGravitySolver2["default"](this.body,this.physicsBody,options)}this.modelOptions=options}},{key:"initPhysics",value:function initPhysics(){if(this.physicsEnabled===true&&this.options.enabled===true){if(this.options.stabilization.enabled===true){this.stabilize()}else{this.stabilized=false;this.ready=true;this.body.emitter.emit("fit",{},this.layoutFailed);this.startSimulation()}}else{this.ready=true;this.body.emitter.emit("fit")}}},{key:"startSimulation",value:function startSimulation(){if(this.physicsEnabled===true&&this.options.enabled===true){this.stabilized=false;this.adaptiveTimestep=false;this.body.emitter.emit("_resizeNodes");if(this.viewFunction===undefined){this.viewFunction=this.simulationStep.bind(this);this.body.emitter.on("initRedraw",this.viewFunction);this.body.emitter.emit("_startRendering")}}else{this.body.emitter.emit("_redraw")}}},{key:"stopSimulation",value:function stopSimulation(){var emit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.stabilized=true;if(emit===true){this._emitStabilized()}if(this.viewFunction!==undefined){this.body.emitter.off("initRedraw",this.viewFunction);this.viewFunction=undefined;if(emit===true){this.body.emitter.emit("_stopRendering")}}}},{key:"simulationStep",value:function simulationStep(){var startTime=Date.now();this.physicsTick();var physicsTime=Date.now()-startTime;if((physicsTime<.4*this.simulationInterval||this.runDoubleSpeed===true)&&this.stabilized===false){this.physicsTick();this.runDoubleSpeed=true}if(this.stabilized===true){this.stopSimulation()}}},{key:"_emitStabilized",value:function _emitStabilized(){var _this2=this;var amountOfIterations=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.stabilizationIterations;if(this.stabilizationIterations>1||this.startedStabilization===true){setTimeout(function(){_this2.body.emitter.emit("stabilized",{iterations:amountOfIterations});_this2.startedStabilization=false;_this2.stabilizationIterations=0},0)}}},{key:"physicsTick",value:function physicsTick(){if(this.startedStabilization===false){this.body.emitter.emit("startStabilizing");this.startedStabilization=true}if(this.stabilized===false){if(this.adaptiveTimestep===true&&this.adaptiveTimestepEnabled===true){var factor=1.2;if(this.adaptiveCounter%this.adaptiveInterval===0){this.timestep=2*this.timestep;this.calculateForces();this.moveNodes();this.revert();this.timestep=.5*this.timestep;this.calculateForces();this.moveNodes();this.calculateForces();this.moveNodes();if(this._evaluateStepQuality()===true){this.timestep=factor*this.timestep}else{if(this.timestep/factor<this.options.timestep){this.timestep=this.options.timestep}else{this.adaptiveCounter=-1;this.timestep=Math.max(this.options.timestep,this.timestep/factor)}}}else{this.calculateForces();this.moveNodes()}this.adaptiveCounter+=1}else{this.timestep=this.options.timestep;this.calculateForces();this.moveNodes()}if(this.stabilized===true){this.revert()}this.stabilizationIterations++}}},{key:"updatePhysicsData",value:function updatePhysicsData(){this.physicsBody.forces={};this.physicsBody.physicsNodeIndices=[];this.physicsBody.physicsEdgeIndices=[];var nodes=this.body.nodes;var edges=this.body.edges;for(var nodeId in nodes){if(nodes.hasOwnProperty(nodeId)){if(nodes[nodeId].options.physics===true){this.physicsBody.physicsNodeIndices.push(nodes[nodeId].id)}}}for(var edgeId in edges){if(edges.hasOwnProperty(edgeId)){if(edges[edgeId].options.physics===true){this.physicsBody.physicsEdgeIndices.push(edges[edgeId].id)}}}for(var i=0;i<this.physicsBody.physicsNodeIndices.length;i++){var _nodeId=this.physicsBody.physicsNodeIndices[i];this.physicsBody.forces[_nodeId]={x:0,y:0};if(this.physicsBody.velocities[_nodeId]===undefined){this.physicsBody.velocities[_nodeId]={x:0,y:0}}}for(var _nodeId2 in this.physicsBody.velocities){if(nodes[_nodeId2]===undefined){delete this.physicsBody.velocities[_nodeId2]}}}},{key:"revert",value:function revert(){var nodeIds=(0,_keys2["default"])(this.previousStates);var nodes=this.body.nodes;var velocities=this.physicsBody.velocities;this.referenceState={};for(var i=0;i<nodeIds.length;i++){var nodeId=nodeIds[i];if(nodes[nodeId]!==undefined){if(nodes[nodeId].options.physics===true){this.referenceState[nodeId]={positions:{x:nodes[nodeId].x,y:nodes[nodeId].y}};velocities[nodeId].x=this.previousStates[nodeId].vx;velocities[nodeId].y=this.previousStates[nodeId].vy;nodes[nodeId].x=this.previousStates[nodeId].x;nodes[nodeId].y=this.previousStates[nodeId].y}}else{delete this.previousStates[nodeId]}}}},{key:"_evaluateStepQuality",value:function _evaluateStepQuality(){var dx=void 0,dy=void 0,dpos=void 0;var nodes=this.body.nodes;var reference=this.referenceState;var posThreshold=.3;for(var nodeId in this.referenceState){if(this.referenceState.hasOwnProperty(nodeId)&&nodes[nodeId]!==undefined){dx=nodes[nodeId].x-reference[nodeId].positions.x;dy=nodes[nodeId].y-reference[nodeId].positions.y;dpos=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2));if(dpos>posThreshold){return false}}}return true}},{key:"moveNodes",value:function moveNodes(){var nodeIndices=this.physicsBody.physicsNodeIndices;var maxVelocity=this.options.maxVelocity?this.options.maxVelocity:1e9;var maxNodeVelocity=0;var averageNodeVelocity=0;var velocityAdaptiveThreshold=5;for(var i=0;i<nodeIndices.length;i++){var nodeId=nodeIndices[i];var nodeVelocity=this._performStep(nodeId,maxVelocity);maxNodeVelocity=Math.max(maxNodeVelocity,nodeVelocity);averageNodeVelocity+=nodeVelocity}this.adaptiveTimestepEnabled=averageNodeVelocity/nodeIndices.length<velocityAdaptiveThreshold;this.stabilized=maxNodeVelocity<this.options.minVelocity}},{key:"_performStep",value:function _performStep(nodeId,maxVelocity){var node=this.body.nodes[nodeId];var timestep=this.timestep;var forces=this.physicsBody.forces;var velocities=this.physicsBody.velocities;this.previousStates[nodeId]={x:node.x,y:node.y,vx:velocities[nodeId].x,vy:velocities[nodeId].y};if(node.options.fixed.x===false){var dx=this.modelOptions.damping*velocities[nodeId].x;var ax=(forces[nodeId].x-dx)/node.options.mass;velocities[nodeId].x+=ax*timestep;velocities[nodeId].x=Math.abs(velocities[nodeId].x)>maxVelocity?velocities[nodeId].x>0?maxVelocity:-maxVelocity:velocities[nodeId].x;node.x+=velocities[nodeId].x*timestep}else{forces[nodeId].x=0;velocities[nodeId].x=0}if(node.options.fixed.y===false){var dy=this.modelOptions.damping*velocities[nodeId].y;var ay=(forces[nodeId].y-dy)/node.options.mass;velocities[nodeId].y+=ay*timestep;velocities[nodeId].y=Math.abs(velocities[nodeId].y)>maxVelocity?velocities[nodeId].y>0?maxVelocity:-maxVelocity:velocities[nodeId].y;node.y+=velocities[nodeId].y*timestep}else{forces[nodeId].y=0;velocities[nodeId].y=0}var totalVelocity=Math.sqrt(Math.pow(velocities[nodeId].x,2)+Math.pow(velocities[nodeId].y,2));return totalVelocity}},{key:"calculateForces",value:function calculateForces(){this.gravitySolver.solve();this.nodesSolver.solve();this.edgesSolver.solve()}},{key:"_freezeNodes",value:function _freezeNodes(){var nodes=this.body.nodes;for(var id in nodes){if(nodes.hasOwnProperty(id)){if(nodes[id].x&&nodes[id].y){this.freezeCache[id]={x:nodes[id].options.fixed.x,y:nodes[id].options.fixed.y};nodes[id].options.fixed.x=true;nodes[id].options.fixed.y=true}}}}},{key:"_restoreFrozenNodes",value:function _restoreFrozenNodes(){var nodes=this.body.nodes;for(var id in nodes){if(nodes.hasOwnProperty(id)){if(this.freezeCache[id]!==undefined){nodes[id].options.fixed.x=this.freezeCache[id].x;nodes[id].options.fixed.y=this.freezeCache[id].y}}}this.freezeCache={}}},{key:"stabilize",value:function stabilize(){var _this3=this;var iterations=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.options.stabilization.iterations;if(typeof iterations!=="number"){console.log("The stabilize method needs a numeric amount of iterations. Switching to default: ",this.options.stabilization.iterations);iterations=this.options.stabilization.iterations}if(this.physicsBody.physicsNodeIndices.length===0){this.ready=true;return}this.adaptiveTimestep=true&&this.options.adaptiveTimestep;this.body.emitter.emit("_resizeNodes");this.stopSimulation();this.stabilized=false;this.body.emitter.emit("_blockRedraw");this.targetIterations=iterations;if(this.options.stabilization.onlyDynamicEdges===true){this._freezeNodes()}this.stabilizationIterations=0;setTimeout(function(){return _this3._stabilizationBatch()},0)}},{key:"_stabilizationBatch",value:function _stabilizationBatch(){if(this.startedStabilization===false){this.body.emitter.emit("startStabilizing");this.startedStabilization=true}var count=0;while(this.stabilized===false&&count<this.options.stabilization.updateInterval&&this.stabilizationIterations<this.targetIterations){this.physicsTick();count++}if(this.stabilized===false&&this.stabilizationIterations<this.targetIterations){this.body.emitter.emit("stabilizationProgress",{iterations:this.stabilizationIterations,total:this.targetIterations});setTimeout(this._stabilizationBatch.bind(this),0)}else{this._finalizeStabilization()}}},{key:"_finalizeStabilization",value:function _finalizeStabilization(){this.body.emitter.emit("_allowRedraw");if(this.options.stabilization.fit===true){this.body.emitter.emit("fit")}if(this.options.stabilization.onlyDynamicEdges===true){this._restoreFrozenNodes()}this.body.emitter.emit("stabilizationIterationsDone");this.body.emitter.emit("_requestRedraw");if(this.stabilized===true){this._emitStabilized()}else{this.startSimulation()}this.ready=true}},{key:"_drawForces",value:function _drawForces(ctx){for(var i=0;i<this.physicsBody.physicsNodeIndices.length;i++){var node=this.body.nodes[this.physicsBody.physicsNodeIndices[i]];var force=this.physicsBody.forces[this.physicsBody.physicsNodeIndices[i]];var factor=20;var colorFactor=.03;var forceSize=Math.sqrt(Math.pow(force.x,2)+Math.pow(force.x,2));var size=Math.min(Math.max(5,forceSize),15);var arrowSize=3*size;var color=util.HSVToHex((180-Math.min(1,Math.max(0,colorFactor*forceSize))*180)/360,1,1);ctx.lineWidth=size;ctx.strokeStyle=color;ctx.beginPath();ctx.moveTo(node.x,node.y);ctx.lineTo(node.x+factor*force.x,node.y+factor*force.y);ctx.stroke();var angle=Math.atan2(force.y,force.x);ctx.fillStyle=color;ctx.arrowEndpoint(node.x+factor*force.x+Math.cos(angle)*arrowSize,node.y+factor*force.y+Math.sin(angle)*arrowSize,angle,arrowSize);ctx.fill()}}}]);return PhysicsEngine}();exports["default"]=PhysicsEngine},{"../../util":116,"./components/physics/BarnesHutSolver":70,"./components/physics/CentralGravitySolver":71,"./components/physics/FA2BasedCentralGravitySolver":72,"./components/physics/FA2BasedRepulsionSolver":73,"./components/physics/HierarchicalRepulsionSolver":74,"./components/physics/HierarchicalSpringSolver":75,"./components/physics/RepulsionSolver":76,"./components/physics/SpringSolver":77,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _Node=require("./components/Node");var _Node2=_interopRequireDefault(_Node);var _Edge=require("./components/Edge");var _Edge2=_interopRequireDefault(_Edge);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var SelectionHandler=function(){function SelectionHandler(body,canvas){var _this=this;(0,_classCallCheck3["default"])(this,SelectionHandler);this.body=body;this.canvas=canvas;this.selectionObj={nodes:[],edges:[]};this.hoverObj={nodes:{},edges:{}};this.options={};this.defaultOptions={multiselect:false,selectable:true,selectConnectedEdges:true,hoverConnectedEdges:true};util.extend(this.options,this.defaultOptions);this.body.emitter.on("_dataChanged",function(){_this.updateSelection()})}(0,_createClass3["default"])(SelectionHandler,[{key:"setOptions",value:function setOptions(options){if(options!==undefined){var fields=["multiselect","hoverConnectedEdges","selectable","selectConnectedEdges"];util.selectiveDeepExtend(fields,this.options,options)}}},{key:"selectOnPoint",value:function selectOnPoint(pointer){var selected=false;if(this.options.selectable===true){var obj=this.getNodeAt(pointer)||this.getEdgeAt(pointer);this.unselectAll();if(obj!==undefined){selected=this.selectObject(obj)}this.body.emitter.emit("_requestRedraw")}return selected}},{key:"selectAdditionalOnPoint",value:function selectAdditionalOnPoint(pointer){var selectionChanged=false;if(this.options.selectable===true){var obj=this.getNodeAt(pointer)||this.getEdgeAt(pointer);
if(obj!==undefined){selectionChanged=true;if(obj.isSelected()===true){this.deselectObject(obj)}else{this.selectObject(obj)}this.body.emitter.emit("_requestRedraw")}}return selectionChanged}},{key:"_generateClickEvent",value:function _generateClickEvent(eventType,event,pointer,oldSelection){var emptySelection=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var properties=void 0;if(emptySelection===true){properties={nodes:[],edges:[]}}else{properties=this.getSelection()}properties["pointer"]={DOM:{x:pointer.x,y:pointer.y},canvas:this.canvas.DOMtoCanvas(pointer)};properties["event"]=event;if(oldSelection!==undefined){properties["previousSelection"]=oldSelection}this.body.emitter.emit(eventType,properties)}},{key:"selectObject",value:function selectObject(obj){var highlightEdges=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.options.selectConnectedEdges;if(obj!==undefined){if(obj instanceof _Node2["default"]){if(highlightEdges===true){this._selectConnectedEdges(obj)}}obj.select();this._addToSelection(obj);return true}return false}},{key:"deselectObject",value:function deselectObject(obj){if(obj.isSelected()===true){obj.selected=false;this._removeFromSelection(obj)}}},{key:"_getAllNodesOverlappingWith",value:function _getAllNodesOverlappingWith(object){var overlappingNodes=[];var nodes=this.body.nodes;for(var i=0;i<this.body.nodeIndices.length;i++){var nodeId=this.body.nodeIndices[i];if(nodes[nodeId].isOverlappingWith(object)){overlappingNodes.push(nodeId)}}return overlappingNodes}},{key:"_pointerToPositionObject",value:function _pointerToPositionObject(pointer){var canvasPos=this.canvas.DOMtoCanvas(pointer);return{left:canvasPos.x-1,top:canvasPos.y+1,right:canvasPos.x+1,bottom:canvasPos.y-1}}},{key:"getNodeAt",value:function getNodeAt(pointer){var returnNode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var positionObject=this._pointerToPositionObject(pointer);var overlappingNodes=this._getAllNodesOverlappingWith(positionObject);if(overlappingNodes.length>0){if(returnNode===true){return this.body.nodes[overlappingNodes[overlappingNodes.length-1]]}else{return overlappingNodes[overlappingNodes.length-1]}}else{return undefined}}},{key:"_getEdgesOverlappingWith",value:function _getEdgesOverlappingWith(object,overlappingEdges){var edges=this.body.edges;for(var i=0;i<this.body.edgeIndices.length;i++){var edgeId=this.body.edgeIndices[i];if(edges[edgeId].isOverlappingWith(object)){overlappingEdges.push(edgeId)}}}},{key:"_getAllEdgesOverlappingWith",value:function _getAllEdgesOverlappingWith(object){var overlappingEdges=[];this._getEdgesOverlappingWith(object,overlappingEdges);return overlappingEdges}},{key:"getEdgeAt",value:function getEdgeAt(pointer){var returnEdge=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var canvasPos=this.canvas.DOMtoCanvas(pointer);var mindist=10;var overlappingEdge=null;var edges=this.body.edges;for(var i=0;i<this.body.edgeIndices.length;i++){var edgeId=this.body.edgeIndices[i];var edge=edges[edgeId];if(edge.connected){var xFrom=edge.from.x;var yFrom=edge.from.y;var xTo=edge.to.x;var yTo=edge.to.y;var dist=edge.edgeType.getDistanceToEdge(xFrom,yFrom,xTo,yTo,canvasPos.x,canvasPos.y);if(dist<mindist){overlappingEdge=edgeId;mindist=dist}}}if(overlappingEdge){if(returnEdge===true){return this.body.edges[overlappingEdge]}else{return overlappingEdge}}else{return undefined}}},{key:"_addToSelection",value:function _addToSelection(obj){if(obj instanceof _Node2["default"]){this.selectionObj.nodes[obj.id]=obj}else{this.selectionObj.edges[obj.id]=obj}}},{key:"_addToHover",value:function _addToHover(obj){if(obj instanceof _Node2["default"]){this.hoverObj.nodes[obj.id]=obj}else{this.hoverObj.edges[obj.id]=obj}}},{key:"_removeFromSelection",value:function _removeFromSelection(obj){if(obj instanceof _Node2["default"]){delete this.selectionObj.nodes[obj.id];this._unselectConnectedEdges(obj)}else{delete this.selectionObj.edges[obj.id]}}},{key:"unselectAll",value:function unselectAll(){for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){this.selectionObj.nodes[nodeId].unselect()}}for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){this.selectionObj.edges[edgeId].unselect()}}this.selectionObj={nodes:{},edges:{}}}},{key:"_getSelectedNodeCount",value:function _getSelectedNodeCount(){var count=0;for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){count+=1}}return count}},{key:"_getSelectedNode",value:function _getSelectedNode(){for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){return this.selectionObj.nodes[nodeId]}}return undefined}},{key:"_getSelectedEdge",value:function _getSelectedEdge(){for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){return this.selectionObj.edges[edgeId]}}return undefined}},{key:"_getSelectedEdgeCount",value:function _getSelectedEdgeCount(){var count=0;for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){count+=1}}return count}},{key:"_getSelectedObjectCount",value:function _getSelectedObjectCount(){var count=0;for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){count+=1}}for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){count+=1}}return count}},{key:"_selectionIsEmpty",value:function _selectionIsEmpty(){for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){return false}}for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){return false}}return true}},{key:"_clusterInSelection",value:function _clusterInSelection(){for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){if(this.selectionObj.nodes[nodeId].clusterSize>1){return true}}}return false}},{key:"_selectConnectedEdges",value:function _selectConnectedEdges(node){for(var i=0;i<node.edges.length;i++){var edge=node.edges[i];edge.select();this._addToSelection(edge)}}},{key:"_hoverConnectedEdges",value:function _hoverConnectedEdges(node){for(var i=0;i<node.edges.length;i++){var edge=node.edges[i];edge.hover=true;this._addToHover(edge)}}},{key:"_unselectConnectedEdges",value:function _unselectConnectedEdges(node){for(var i=0;i<node.edges.length;i++){var edge=node.edges[i];edge.unselect();this._removeFromSelection(edge)}}},{key:"blurObject",value:function blurObject(object){if(object.hover===true){object.hover=false;if(object instanceof _Node2["default"]){this.body.emitter.emit("blurNode",{node:object.id})}else{this.body.emitter.emit("blurEdge",{edge:object.id})}}}},{key:"hoverObject",value:function hoverObject(object){var hoverChanged=false;for(var nodeId in this.hoverObj.nodes){if(this.hoverObj.nodes.hasOwnProperty(nodeId)){if(object===undefined||object instanceof _Node2["default"]&&object.id!=nodeId||object instanceof _Edge2["default"]){this.blurObject(this.hoverObj.nodes[nodeId]);delete this.hoverObj.nodes[nodeId];hoverChanged=true}}}for(var edgeId in this.hoverObj.edges){if(this.hoverObj.edges.hasOwnProperty(edgeId)){if(hoverChanged===true){this.hoverObj.edges[edgeId].hover=false;delete this.hoverObj.edges[edgeId]}else if(object===undefined||object instanceof _Edge2["default"]&&object.id!=edgeId||object instanceof _Node2["default"]&&!object.hover){this.blurObject(this.hoverObj.edges[edgeId]);delete this.hoverObj.edges[edgeId];hoverChanged=true}}}if(object!==undefined){if(object.hover===false){object.hover=true;this._addToHover(object);hoverChanged=true;if(object instanceof _Node2["default"]){this.body.emitter.emit("hoverNode",{node:object.id})}else{this.body.emitter.emit("hoverEdge",{edge:object.id})}}if(object instanceof _Node2["default"]&&this.options.hoverConnectedEdges===true){this._hoverConnectedEdges(object)}}if(hoverChanged===true){this.body.emitter.emit("_requestRedraw")}}},{key:"getSelection",value:function getSelection(){var nodeIds=this.getSelectedNodes();var edgeIds=this.getSelectedEdges();return{nodes:nodeIds,edges:edgeIds}}},{key:"getSelectedNodes",value:function getSelectedNodes(){var idArray=[];if(this.options.selectable===true){for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){idArray.push(this.selectionObj.nodes[nodeId].id)}}}return idArray}},{key:"getSelectedEdges",value:function getSelectedEdges(){var idArray=[];if(this.options.selectable===true){for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){idArray.push(this.selectionObj.edges[edgeId].id)}}}return idArray}},{key:"setSelection",value:function setSelection(selection){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=void 0,id=void 0;if(!selection||!selection.nodes&&!selection.edges)throw"Selection must be an object with nodes and/or edges properties";if(options.unselectAll||options.unselectAll===undefined){this.unselectAll()}if(selection.nodes){for(i=0;i<selection.nodes.length;i++){id=selection.nodes[i];var node=this.body.nodes[id];if(!node){throw new RangeError('Node with id "'+id+'" not found')}this.selectObject(node,options.highlightEdges)}}if(selection.edges){for(i=0;i<selection.edges.length;i++){id=selection.edges[i];var edge=this.body.edges[id];if(!edge){throw new RangeError('Edge with id "'+id+'" not found')}this.selectObject(edge)}}this.body.emitter.emit("_requestRedraw")}},{key:"selectNodes",value:function selectNodes(selection){var highlightEdges=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!selection||selection.length===undefined)throw"Selection must be an array with ids";this.setSelection({nodes:selection},{highlightEdges:highlightEdges})}},{key:"selectEdges",value:function selectEdges(selection){if(!selection||selection.length===undefined)throw"Selection must be an array with ids";this.setSelection({edges:selection})}},{key:"updateSelection",value:function updateSelection(){for(var nodeId in this.selectionObj.nodes){if(this.selectionObj.nodes.hasOwnProperty(nodeId)){if(!this.body.nodes.hasOwnProperty(nodeId)){delete this.selectionObj.nodes[nodeId]}}}for(var edgeId in this.selectionObj.edges){if(this.selectionObj.edges.hasOwnProperty(edgeId)){if(!this.body.edges.hasOwnProperty(edgeId)){delete this.selectionObj.edges[edgeId]}}}}}]);return SelectionHandler}();exports["default"]=SelectionHandler},{"../../util":116,"./components/Edge":41,"./components/Node":43,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _NetworkUtil=require("../NetworkUtil");var _NetworkUtil2=_interopRequireDefault(_NetworkUtil);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var View=function(){function View(body,canvas){var _this=this;(0,_classCallCheck3["default"])(this,View);this.body=body;this.canvas=canvas;this.animationSpeed=1/this.renderRefreshRate;this.animationEasingFunction="easeInOutQuint";this.easingTime=0;this.sourceScale=0;this.targetScale=0;this.sourceTranslation=0;this.targetTranslation=0;this.lockedOnNodeId=undefined;this.lockedOnNodeOffset=undefined;this.touchTime=0;this.viewFunction=undefined;this.body.emitter.on("fit",this.fit.bind(this));this.body.emitter.on("animationFinished",function(){_this.body.emitter.emit("_stopRendering")});this.body.emitter.on("unlockNode",this.releaseNode.bind(this))}(0,_createClass3["default"])(View,[{key:"setOptions",value:function setOptions(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.options=options}},{key:"fit",value:function fit(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{nodes:[]};var initialZoom=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var range=void 0;var zoomLevel=void 0;if(options.nodes===undefined||options.nodes.length===0){options.nodes=this.body.nodeIndices}if(initialZoom===true){var positionDefined=0;for(var nodeId in this.body.nodes){if(this.body.nodes.hasOwnProperty(nodeId)){var node=this.body.nodes[nodeId];if(node.predefinedPosition===true){positionDefined+=1}}}if(positionDefined>.5*this.body.nodeIndices.length){this.fit(options,false);return}range=_NetworkUtil2["default"].getRange(this.body.nodes,options.nodes);var numberOfNodes=this.body.nodeIndices.length;zoomLevel=12.662/(numberOfNodes+7.4147)+.0964822;var factor=Math.min(this.canvas.frame.canvas.clientWidth/600,this.canvas.frame.canvas.clientHeight/600);zoomLevel*=factor}else{this.body.emitter.emit("_resizeNodes");range=_NetworkUtil2["default"].getRange(this.body.nodes,options.nodes);var xDistance=Math.abs(range.maxX-range.minX)*1.1;var yDistance=Math.abs(range.maxY-range.minY)*1.1;var xZoomLevel=this.canvas.frame.canvas.clientWidth/xDistance;var yZoomLevel=this.canvas.frame.canvas.clientHeight/yDistance;zoomLevel=xZoomLevel<=yZoomLevel?xZoomLevel:yZoomLevel}if(zoomLevel>1){zoomLevel=1}else if(zoomLevel===0){zoomLevel=1}var center=_NetworkUtil2["default"].findCenter(range);var animationOptions={position:center,scale:zoomLevel,animation:options.animation};this.moveTo(animationOptions)}},{key:"focus",value:function focus(nodeId){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(this.body.nodes[nodeId]!==undefined){var nodePosition={x:this.body.nodes[nodeId].x,y:this.body.nodes[nodeId].y};options.position=nodePosition;options.lockedOnNode=nodeId;this.moveTo(options)}else{console.log("Node: "+nodeId+" cannot be found.")}}},{key:"moveTo",value:function moveTo(options){if(options===undefined){options={};return}if(options.offset===undefined){options.offset={x:0,y:0}}if(options.offset.x===undefined){options.offset.x=0}if(options.offset.y===undefined){options.offset.y=0}if(options.scale===undefined){options.scale=this.body.view.scale}if(options.position===undefined){options.position=this.getViewPosition()}if(options.animation===undefined){options.animation={duration:0}}if(options.animation===false){options.animation={duration:0}}if(options.animation===true){options.animation={}}if(options.animation.duration===undefined){options.animation.duration=1e3}if(options.animation.easingFunction===undefined){options.animation.easingFunction="easeInOutQuad"}this.animateView(options)}},{key:"animateView",value:function animateView(options){if(options===undefined){return}this.animationEasingFunction=options.animation.easingFunction;this.releaseNode();if(options.locked===true){this.lockedOnNodeId=options.lockedOnNode;this.lockedOnNodeOffset=options.offset}if(this.easingTime!=0){this._transitionRedraw(true)}this.sourceScale=this.body.view.scale;this.sourceTranslation=this.body.view.translation;this.targetScale=options.scale;this.body.view.scale=this.targetScale;var viewCenter=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight});var distanceFromCenter={x:viewCenter.x-options.position.x,y:viewCenter.y-options.position.y};this.targetTranslation={x:this.sourceTranslation.x+distanceFromCenter.x*this.targetScale+options.offset.x,y:this.sourceTranslation.y+distanceFromCenter.y*this.targetScale+options.offset.y};if(options.animation.duration===0){if(this.lockedOnNodeId!=undefined){this.viewFunction=this._lockedRedraw.bind(this);this.body.emitter.on("initRedraw",this.viewFunction)}else{this.body.view.scale=this.targetScale;this.body.view.translation=this.targetTranslation;this.body.emitter.emit("_requestRedraw")}}else{this.animationSpeed=1/(60*options.animation.duration*.001)||1/60;this.animationEasingFunction=options.animation.easingFunction;this.viewFunction=this._transitionRedraw.bind(this);this.body.emitter.on("initRedraw",this.viewFunction);this.body.emitter.emit("_startRendering")}}},{key:"_lockedRedraw",value:function _lockedRedraw(){var nodePosition={x:this.body.nodes[this.lockedOnNodeId].x,y:this.body.nodes[this.lockedOnNodeId].y};var viewCenter=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight});var distanceFromCenter={x:viewCenter.x-nodePosition.x,y:viewCenter.y-nodePosition.y};var sourceTranslation=this.body.view.translation;var targetTranslation={x:sourceTranslation.x+distanceFromCenter.x*this.body.view.scale+this.lockedOnNodeOffset.x,y:sourceTranslation.y+distanceFromCenter.y*this.body.view.scale+this.lockedOnNodeOffset.y};this.body.view.translation=targetTranslation}},{key:"releaseNode",value:function releaseNode(){if(this.lockedOnNodeId!==undefined&&this.viewFunction!==undefined){this.body.emitter.off("initRedraw",this.viewFunction);this.lockedOnNodeId=undefined;this.lockedOnNodeOffset=undefined}}},{key:"_transitionRedraw",value:function _transitionRedraw(){var finished=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.easingTime+=this.animationSpeed;this.easingTime=finished===true?1:this.easingTime;var progress=util.easingFunctions[this.animationEasingFunction](this.easingTime);this.body.view.scale=this.sourceScale+(this.targetScale-this.sourceScale)*progress;this.body.view.translation={x:this.sourceTranslation.x+(this.targetTranslation.x-this.sourceTranslation.x)*progress,y:this.sourceTranslation.y+(this.targetTranslation.y-this.sourceTranslation.y)*progress};if(this.easingTime>=1){this.body.emitter.off("initRedraw",this.viewFunction);this.easingTime=0;if(this.lockedOnNodeId!=undefined){this.viewFunction=this._lockedRedraw.bind(this);this.body.emitter.on("initRedraw",this.viewFunction)}this.body.emitter.emit("animationFinished")}}},{key:"getScale",value:function getScale(){return this.body.view.scale}},{key:"getViewPosition",value:function getViewPosition(){return this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight})}}]);return View}();exports["default"]=View},{"../../util":116,"../NetworkUtil":24,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _create=require("babel-runtime/core-js/object/create");var _create2=_interopRequireDefault(_create);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _Label=require("./shared/Label");var _Label2=_interopRequireDefault(_Label);var _CubicBezierEdge=require("./edges/CubicBezierEdge");var _CubicBezierEdge2=_interopRequireDefault(_CubicBezierEdge);var _BezierEdgeDynamic=require("./edges/BezierEdgeDynamic");var _BezierEdgeDynamic2=_interopRequireDefault(_BezierEdgeDynamic);var _BezierEdgeStatic=require("./edges/BezierEdgeStatic");var _BezierEdgeStatic2=_interopRequireDefault(_BezierEdgeStatic);var _StraightEdge=require("./edges/StraightEdge");var _StraightEdge2=_interopRequireDefault(_StraightEdge);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../../util");var Edge=function(){function Edge(options,body,globalOptions,defaultOptions,edgeOptions){(0,_classCallCheck3["default"])(this,Edge);if(body===undefined){throw"No body provided"}this.options=util.bridgeObject(globalOptions);this.globalOptions=globalOptions;this.defaultOptions=defaultOptions;this.edgeOptions=edgeOptions;this.body=body;this.id=undefined;this.fromId=undefined;this.toId=undefined;this.selected=false;this.hover=false;this.labelDirty=true;this.baseWidth=this.options.width;this.baseFontSize=this.options.font.size;this.from=undefined;this.to=undefined;this.edgeType=undefined;this.connected=false;this.labelModule=new _Label2["default"](this.body,this.options,true);this.setOptions(options)}(0,_createClass3["default"])(Edge,[{key:"setOptions",value:function setOptions(options){if(!options){return}Edge.parseOptions(this.options,options,true,this.globalOptions);if(options.id!==undefined){this.id=options.id}if(options.from!==undefined){this.fromId=options.from}if(options.to!==undefined){this.toId=options.to}if(options.title!==undefined){this.title=options.title}if(options.value!==undefined){options.value=parseFloat(options.value)}this.choosify(options);this.updateLabelModule(options);this.labelModule.propagateFonts(this.edgeOptions,options,this.defaultOptions);var dataChanged=this.updateEdgeType();this._setInteractionWidths();this.connect();if(options.hidden!==undefined||options.physics!==undefined){dataChanged=true}return dataChanged}},{key:"choosify",value:function choosify(options){this.chooser=true;var pile=[options,this.options,this.defaultOptions];var chosen=util.topMost(pile,"chosen");if(typeof chosen==="boolean"){this.chooser=chosen}else if((typeof chosen==="undefined"?"undefined":(0,_typeof3["default"])(chosen))==="object"){var chosenEdge=util.topMost(pile,["chosen","edge"]);if(typeof chosenEdge==="boolean"||typeof chosenEdge==="function"){this.chooser=chosenEdge}}}},{key:"getFormattingValues",value:function getFormattingValues(){var toArrow=this.options.arrows.to===true||this.options.arrows.to.enabled===true;var fromArrow=this.options.arrows.from===true||this.options.arrows.from.enabled===true;var middleArrow=this.options.arrows.middle===true||this.options.arrows.middle.enabled===true;var inheritsColor=this.options.color.inherit;var values={toArrow:toArrow,toArrowScale:this.options.arrows.to.scaleFactor,toArrowType:this.options.arrows.to.type,middleArrow:middleArrow,middleArrowScale:this.options.arrows.middle.scaleFactor,middleArrowType:this.options.arrows.middle.type,fromArrow:fromArrow,fromArrowScale:this.options.arrows.from.scaleFactor,fromArrowType:this.options.arrows.from.type,arrowStrikethrough:this.options.arrowStrikethrough,color:inheritsColor?undefined:this.options.color.color,inheritsColor:inheritsColor,opacity:this.options.color.opacity,hidden:this.options.hidden,length:this.options.length,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y,dashes:this.options.dashes,width:this.options.width};if(this.selected||this.hover){if(this.chooser===true){if(this.selected){var selectedWidth=this.options.selectionWidth;if(typeof selectedWidth==="function"){values.width=selectedWidth(values.width)}else if(typeof selectedWidth==="number"){values.width+=selectedWidth}values.width=Math.max(values.width,.3/this.body.view.scale);values.color=this.options.color.highlight;values.shadow=this.options.shadow.enabled}else if(this.hover){var hoverWidth=this.options.hoverWidth;if(typeof hoverWidth==="function"){values.width=hoverWidth(values.width)}else if(typeof hoverWidth==="number"){values.width+=hoverWidth}values.width=Math.max(values.width,.3/this.body.view.scale);values.color=this.options.color.hover;values.shadow=this.options.shadow.enabled}}else if(typeof this.chooser==="function"){this.chooser(values,this.options.id,this.selected,this.hover);if(values.color!==undefined){values.inheritsColor=false}if(values.shadow===false){if(values.shadowColor!==this.options.shadow.color||values.shadowSize!==this.options.shadow.size||values.shadowX!==this.options.shadow.x||values.shadowY!==this.options.shadow.y){values.shadow=true}}}}else{values.shadow=this.options.shadow.enabled;values.width=Math.max(values.width,.3/this.body.view.scale)}return values}},{key:"updateLabelModule",value:function updateLabelModule(options){this.labelModule.setOptions(this.options,true);if(this.labelModule.baseSize!==undefined){this.baseFontSize=this.labelModule.baseSize}this.labelModule.constrain(this.edgeOptions,options,this.defaultOptions);this.labelModule.choosify(this.edgeOptions,options,this.defaultOptions)}},{key:"updateEdgeType",value:function updateEdgeType(){var smooth=this.options.smooth;var dataChanged=false;var changeInType=true;if(this.edgeType!==undefined){if(this.edgeType instanceof _BezierEdgeDynamic2["default"]&&smooth.enabled===true&&smooth.type==="dynamic"||this.edgeType instanceof _CubicBezierEdge2["default"]&&smooth.enabled===true&&smooth.type==="cubicBezier"||this.edgeType instanceof _BezierEdgeStatic2["default"]&&smooth.enabled===true&&smooth.type!=="dynamic"&&smooth.type!=="cubicBezier"||this.edgeType instanceof _StraightEdge2["default"]&&smooth.type.enabled===false){changeInType=false}if(changeInType===true){dataChanged=this.cleanup()}}if(changeInType===true){if(smooth.enabled===true){if(smooth.type==="dynamic"){dataChanged=true;this.edgeType=new _BezierEdgeDynamic2["default"](this.options,this.body,this.labelModule)}else if(smooth.type==="cubicBezier"){this.edgeType=new _CubicBezierEdge2["default"](this.options,this.body,this.labelModule)}else{this.edgeType=new _BezierEdgeStatic2["default"](this.options,this.body,this.labelModule)}}else{this.edgeType=new _StraightEdge2["default"](this.options,this.body,this.labelModule)}}else{this.edgeType.setOptions(this.options)}return dataChanged}},{key:"connect",value:function connect(){this.disconnect();this.from=this.body.nodes[this.fromId]||undefined;this.to=this.body.nodes[this.toId]||undefined;this.connected=this.from!==undefined&&this.to!==undefined;if(this.connected===true){this.from.attachEdge(this);this.to.attachEdge(this)}else{if(this.from){this.from.detachEdge(this)}if(this.to){this.to.detachEdge(this)}}this.edgeType.connect()}},{key:"disconnect",value:function disconnect(){if(this.from){this.from.detachEdge(this);this.from=undefined}if(this.to){this.to.detachEdge(this);this.to=undefined}this.connected=false}},{key:"getTitle",value:function getTitle(){return this.title}},{key:"isSelected",value:function isSelected(){return this.selected}},{key:"getValue",value:function getValue(){return this.options.value}},{key:"setValueRange",value:function setValueRange(min,max,total){if(this.options.value!==undefined){var scale=this.options.scaling.customScalingFunction(min,max,total,this.options.value);var widthDiff=this.options.scaling.max-this.options.scaling.min;if(this.options.scaling.label.enabled===true){var fontDiff=this.options.scaling.label.max-this.options.scaling.label.min;this.options.font.size=this.options.scaling.label.min+scale*fontDiff}this.options.width=this.options.scaling.min+scale*widthDiff}else{this.options.width=this.baseWidth;this.options.font.size=this.baseFontSize}this._setInteractionWidths();this.updateLabelModule()}},{key:"_setInteractionWidths",value:function _setInteractionWidths(){if(typeof this.options.hoverWidth==="function"){this.edgeType.hoverWidth=this.options.hoverWidth(this.options.width)}else{this.edgeType.hoverWidth=this.options.hoverWidth+this.options.width}if(typeof this.options.selectionWidth==="function"){this.edgeType.selectionWidth=this.options.selectionWidth(this.options.width)}else{this.edgeType.selectionWidth=this.options.selectionWidth+this.options.width}}},{key:"draw",value:function draw(ctx){var values=this.getFormattingValues();if(values.hidden){return}var viaNode=this.edgeType.getViaNode();var arrowData={};this.edgeType.fromPoint=this.edgeType.from;this.edgeType.toPoint=this.edgeType.to;if(values.fromArrow){arrowData.from=this.edgeType.getArrowData(ctx,"from",viaNode,this.selected,this.hover,values);if(values.arrowStrikethrough===false)this.edgeType.fromPoint=arrowData.from.core}if(values.toArrow){arrowData.to=this.edgeType.getArrowData(ctx,"to",viaNode,this.selected,this.hover,values);if(values.arrowStrikethrough===false)this.edgeType.toPoint=arrowData.to.core}if(values.middleArrow){arrowData.middle=this.edgeType.getArrowData(ctx,"middle",viaNode,this.selected,this.hover,values)}this.edgeType.drawLine(ctx,values,this.selected,this.hover,viaNode);this.drawArrows(ctx,arrowData,values);this.drawLabel(ctx,viaNode)}},{key:"drawArrows",value:function drawArrows(ctx,arrowData,values){if(values.fromArrow){this.edgeType.drawArrowHead(ctx,values,this.selected,this.hover,arrowData.from)}if(values.middleArrow){this.edgeType.drawArrowHead(ctx,values,this.selected,this.hover,arrowData.middle)}if(values.toArrow){this.edgeType.drawArrowHead(ctx,values,this.selected,this.hover,arrowData.to)}}},{key:"drawLabel",value:function drawLabel(ctx,viaNode){if(this.options.label!==undefined){var node1=this.from;var node2=this.to;var selected=this.from.selected||this.to.selected||this.selected;if(node1.id!=node2.id){this.labelModule.pointToSelf=false;var point=this.edgeType.getPoint(.5,viaNode);ctx.save();if(this.options.font.align!=="horizontal"){this.labelModule.calculateLabelSize(ctx,selected,this.hover,point.x,point.y);ctx.translate(point.x,this.labelModule.size.yLine);this._rotateForLabelAlignment(ctx)}this.labelModule.draw(ctx,point.x,point.y,selected,this.hover);ctx.restore()}else{this.labelModule.pointToSelf=true;var x,y;var radius=this.options.selfReferenceSize;if(node1.shape.width>node1.shape.height){x=node1.x+node1.shape.width*.5;y=node1.y-radius}else{x=node1.x+radius;y=node1.y-node1.shape.height*.5}point=this._pointOnCircle(x,y,radius,.125);this.labelModule.draw(ctx,point.x,point.y,selected,this.hover)}}}},{key:"isOverlappingWith",value:function isOverlappingWith(obj){if(this.connected){var distMax=10;var xFrom=this.from.x;var yFrom=this.from.y;var xTo=this.to.x;var yTo=this.to.y;var xObj=obj.left;var yObj=obj.top;var dist=this.edgeType.getDistanceToEdge(xFrom,yFrom,xTo,yTo,xObj,yObj);return dist<distMax}else{return false}}},{key:"_rotateForLabelAlignment",value:function _rotateForLabelAlignment(ctx){var dy=this.from.y-this.to.y;var dx=this.from.x-this.to.x;var angleInDegrees=Math.atan2(dy,dx);if(angleInDegrees<-1&&dx<0||angleInDegrees>0&&dx<0){angleInDegrees=angleInDegrees+Math.PI}ctx.rotate(angleInDegrees)}},{key:"_pointOnCircle",value:function _pointOnCircle(x,y,radius,percentage){var angle=percentage*2*Math.PI;return{x:x+radius*Math.cos(angle),y:y-radius*Math.sin(angle)}}},{key:"select",value:function select(){this.selected=true}},{key:"unselect",value:function unselect(){this.selected=false}},{key:"cleanup",value:function cleanup(){return this.edgeType.cleanup()}}],[{key:"parseOptions",value:function parseOptions(parentOptions,newOptions){var allowDeletion=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var globalOptions=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var fields=["arrowStrikethrough","id","from","hidden","hoverWidth","label","labelHighlightBold","length","line","opacity","physics","scaling","selectionWidth","selfReferenceSize","to","title","value","width"];util.selectiveDeepExtend(fields,parentOptions,newOptions,allowDeletion);util.mergeOptions(parentOptions,newOptions,"smooth",allowDeletion,globalOptions);util.mergeOptions(parentOptions,newOptions,"shadow",allowDeletion,globalOptions);if(newOptions.dashes!==undefined&&newOptions.dashes!==null){parentOptions.dashes=newOptions.dashes}else if(allowDeletion===true&&newOptions.dashes===null){parentOptions.dashes=(0,_create2["default"])(globalOptions.dashes)}if(newOptions.scaling!==undefined&&newOptions.scaling!==null){if(newOptions.scaling.min!==undefined){parentOptions.scaling.min=newOptions.scaling.min}if(newOptions.scaling.max!==undefined){parentOptions.scaling.max=newOptions.scaling.max}util.mergeOptions(parentOptions.scaling,newOptions.scaling,"label",allowDeletion,globalOptions.scaling)}else if(allowDeletion===true&&newOptions.scaling===null){parentOptions.scaling=(0,
_create2["default"])(globalOptions.scaling)}if(newOptions.arrows!==undefined&&newOptions.arrows!==null){if(typeof newOptions.arrows==="string"){var arrows=newOptions.arrows.toLowerCase();parentOptions.arrows.to.enabled=arrows.indexOf("to")!=-1;parentOptions.arrows.middle.enabled=arrows.indexOf("middle")!=-1;parentOptions.arrows.from.enabled=arrows.indexOf("from")!=-1}else if((0,_typeof3["default"])(newOptions.arrows)==="object"){util.mergeOptions(parentOptions.arrows,newOptions.arrows,"to",allowDeletion,globalOptions.arrows);util.mergeOptions(parentOptions.arrows,newOptions.arrows,"middle",allowDeletion,globalOptions.arrows);util.mergeOptions(parentOptions.arrows,newOptions.arrows,"from",allowDeletion,globalOptions.arrows)}else{throw new Error("The arrow newOptions can only be an object or a string. Refer to the documentation. You used:"+(0,_stringify2["default"])(newOptions.arrows))}}else if(allowDeletion===true&&newOptions.arrows===null){parentOptions.arrows=(0,_create2["default"])(globalOptions.arrows)}if(newOptions.color!==undefined&&newOptions.color!==null){parentOptions.color=util.deepExtend({},parentOptions.color,true);if(util.isString(newOptions.color)){parentOptions.color.color=newOptions.color;parentOptions.color.highlight=newOptions.color;parentOptions.color.hover=newOptions.color;parentOptions.color.inherit=false}else{var colorsDefined=false;if(newOptions.color.color!==undefined){parentOptions.color.color=newOptions.color.color;colorsDefined=true}if(newOptions.color.highlight!==undefined){parentOptions.color.highlight=newOptions.color.highlight;colorsDefined=true}if(newOptions.color.hover!==undefined){parentOptions.color.hover=newOptions.color.hover;colorsDefined=true}if(newOptions.color.inherit!==undefined){parentOptions.color.inherit=newOptions.color.inherit}if(newOptions.color.opacity!==undefined){parentOptions.color.opacity=Math.min(1,Math.max(0,newOptions.color.opacity))}if(newOptions.color.inherit===undefined&&colorsDefined===true){parentOptions.color.inherit=false}}}else if(allowDeletion===true&&newOptions.color===null){parentOptions.color=util.bridgeObject(globalOptions.color)}if(newOptions.font!==undefined&&newOptions.font!==null){_Label2["default"].parseOptions(parentOptions.font,newOptions)}else if(allowDeletion===true&&newOptions.font===null){parentOptions.font=util.bridgeObject(globalOptions.font)}}}]);return Edge}();exports["default"]=Edge},{"../../../util":116,"./edges/BezierEdgeDynamic":45,"./edges/BezierEdgeStatic":46,"./edges/CubicBezierEdge":47,"./edges/StraightEdge":48,"./shared/Label":78,"babel-runtime/core-js/json/stringify":119,"babel-runtime/core-js/object/create":121,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../../util");var Hammer=require("../../../module/hammer");var hammerUtil=require("../../../hammerUtil");var keycharm=require("keycharm");var NavigationHandler=function(){function NavigationHandler(body,canvas){var _this=this;(0,_classCallCheck3["default"])(this,NavigationHandler);this.body=body;this.canvas=canvas;this.iconsCreated=false;this.navigationHammers=[];this.boundFunctions={};this.touchTime=0;this.activated=false;this.body.emitter.on("activate",function(){_this.activated=true;_this.configureKeyboardBindings()});this.body.emitter.on("deactivate",function(){_this.activated=false;_this.configureKeyboardBindings()});this.body.emitter.on("destroy",function(){if(_this.keycharm!==undefined){_this.keycharm.destroy()}});this.options={}}(0,_createClass3["default"])(NavigationHandler,[{key:"setOptions",value:function setOptions(options){if(options!==undefined){this.options=options;this.create()}}},{key:"create",value:function create(){if(this.options.navigationButtons===true){if(this.iconsCreated===false){this.loadNavigationElements()}}else if(this.iconsCreated===true){this.cleanNavigation()}this.configureKeyboardBindings()}},{key:"cleanNavigation",value:function cleanNavigation(){if(this.navigationHammers.length!=0){for(var i=0;i<this.navigationHammers.length;i++){this.navigationHammers[i].destroy()}this.navigationHammers=[]}if(this.navigationDOM&&this.navigationDOM["wrapper"]&&this.navigationDOM["wrapper"].parentNode){this.navigationDOM["wrapper"].parentNode.removeChild(this.navigationDOM["wrapper"])}this.iconsCreated=false}},{key:"loadNavigationElements",value:function loadNavigationElements(){var _this2=this;this.cleanNavigation();this.navigationDOM={};var navigationDivs=["up","down","left","right","zoomIn","zoomOut","zoomExtends"];var navigationDivActions=["_moveUp","_moveDown","_moveLeft","_moveRight","_zoomIn","_zoomOut","_fit"];this.navigationDOM["wrapper"]=document.createElement("div");this.navigationDOM["wrapper"].className="vis-navigation";this.canvas.frame.appendChild(this.navigationDOM["wrapper"]);for(var i=0;i<navigationDivs.length;i++){this.navigationDOM[navigationDivs[i]]=document.createElement("div");this.navigationDOM[navigationDivs[i]].className="vis-button vis-"+navigationDivs[i];this.navigationDOM["wrapper"].appendChild(this.navigationDOM[navigationDivs[i]]);var hammer=new Hammer(this.navigationDOM[navigationDivs[i]]);if(navigationDivActions[i]==="_fit"){hammerUtil.onTouch(hammer,this._fit.bind(this))}else{hammerUtil.onTouch(hammer,this.bindToRedraw.bind(this,navigationDivActions[i]))}this.navigationHammers.push(hammer)}var hammerFrame=new Hammer(this.canvas.frame);hammerUtil.onRelease(hammerFrame,function(){_this2._stopMovement()});this.navigationHammers.push(hammerFrame);this.iconsCreated=true}},{key:"bindToRedraw",value:function bindToRedraw(action){if(this.boundFunctions[action]===undefined){this.boundFunctions[action]=this[action].bind(this);this.body.emitter.on("initRedraw",this.boundFunctions[action]);this.body.emitter.emit("_startRendering")}}},{key:"unbindFromRedraw",value:function unbindFromRedraw(action){if(this.boundFunctions[action]!==undefined){this.body.emitter.off("initRedraw",this.boundFunctions[action]);this.body.emitter.emit("_stopRendering");delete this.boundFunctions[action]}}},{key:"_fit",value:function _fit(){if((new Date).valueOf()-this.touchTime>700){this.body.emitter.emit("fit",{duration:700});this.touchTime=(new Date).valueOf()}}},{key:"_stopMovement",value:function _stopMovement(){for(var boundAction in this.boundFunctions){if(this.boundFunctions.hasOwnProperty(boundAction)){this.body.emitter.off("initRedraw",this.boundFunctions[boundAction]);this.body.emitter.emit("_stopRendering")}}this.boundFunctions={}}},{key:"_moveUp",value:function _moveUp(){this.body.view.translation.y+=this.options.keyboard.speed.y}},{key:"_moveDown",value:function _moveDown(){this.body.view.translation.y-=this.options.keyboard.speed.y}},{key:"_moveLeft",value:function _moveLeft(){this.body.view.translation.x+=this.options.keyboard.speed.x}},{key:"_moveRight",value:function _moveRight(){this.body.view.translation.x-=this.options.keyboard.speed.x}},{key:"_zoomIn",value:function _zoomIn(){var scaleOld=this.body.view.scale;var scale=this.body.view.scale*(1+this.options.keyboard.speed.zoom);var translation=this.body.view.translation;var scaleFrac=scale/scaleOld;var tx=(1-scaleFrac)*this.canvas.canvasViewCenter.x+translation.x*scaleFrac;var ty=(1-scaleFrac)*this.canvas.canvasViewCenter.y+translation.y*scaleFrac;this.body.view.scale=scale;this.body.view.translation={x:tx,y:ty};this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:pointer})}},{key:"_zoomOut",value:function _zoomOut(){var scaleOld=this.body.view.scale;var scale=this.body.view.scale/(1+this.options.keyboard.speed.zoom);var translation=this.body.view.translation;var scaleFrac=scale/scaleOld;var tx=(1-scaleFrac)*this.canvas.canvasViewCenter.x+translation.x*scaleFrac;var ty=(1-scaleFrac)*this.canvas.canvasViewCenter.y+translation.y*scaleFrac;this.body.view.scale=scale;this.body.view.translation={x:tx,y:ty};this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:pointer})}},{key:"configureKeyboardBindings",value:function configureKeyboardBindings(){var _this3=this;if(this.keycharm!==undefined){this.keycharm.destroy()}if(this.options.keyboard.enabled===true){if(this.options.keyboard.bindToWindow===true){this.keycharm=keycharm({container:window,preventDefault:true})}else{this.keycharm=keycharm({container:this.canvas.frame,preventDefault:true})}this.keycharm.reset();if(this.activated===true){this.keycharm.bind("up",function(){_this3.bindToRedraw("_moveUp")},"keydown");this.keycharm.bind("down",function(){_this3.bindToRedraw("_moveDown")},"keydown");this.keycharm.bind("left",function(){_this3.bindToRedraw("_moveLeft")},"keydown");this.keycharm.bind("right",function(){_this3.bindToRedraw("_moveRight")},"keydown");this.keycharm.bind("=",function(){_this3.bindToRedraw("_zoomIn")},"keydown");this.keycharm.bind("num+",function(){_this3.bindToRedraw("_zoomIn")},"keydown");this.keycharm.bind("num-",function(){_this3.bindToRedraw("_zoomOut")},"keydown");this.keycharm.bind("-",function(){_this3.bindToRedraw("_zoomOut")},"keydown");this.keycharm.bind("[",function(){_this3.bindToRedraw("_zoomOut")},"keydown");this.keycharm.bind("]",function(){_this3.bindToRedraw("_zoomIn")},"keydown");this.keycharm.bind("pageup",function(){_this3.bindToRedraw("_zoomIn")},"keydown");this.keycharm.bind("pagedown",function(){_this3.bindToRedraw("_zoomOut")},"keydown");this.keycharm.bind("up",function(){_this3.unbindFromRedraw("_moveUp")},"keyup");this.keycharm.bind("down",function(){_this3.unbindFromRedraw("_moveDown")},"keyup");this.keycharm.bind("left",function(){_this3.unbindFromRedraw("_moveLeft")},"keyup");this.keycharm.bind("right",function(){_this3.unbindFromRedraw("_moveRight")},"keyup");this.keycharm.bind("=",function(){_this3.unbindFromRedraw("_zoomIn")},"keyup");this.keycharm.bind("num+",function(){_this3.unbindFromRedraw("_zoomIn")},"keyup");this.keycharm.bind("num-",function(){_this3.unbindFromRedraw("_zoomOut")},"keyup");this.keycharm.bind("-",function(){_this3.unbindFromRedraw("_zoomOut")},"keyup");this.keycharm.bind("[",function(){_this3.unbindFromRedraw("_zoomOut")},"keyup");this.keycharm.bind("]",function(){_this3.unbindFromRedraw("_zoomIn")},"keyup");this.keycharm.bind("pageup",function(){_this3.unbindFromRedraw("_zoomIn")},"keyup");this.keycharm.bind("pagedown",function(){_this3.unbindFromRedraw("_zoomOut")},"keyup")}}}}]);return NavigationHandler}();exports["default"]=NavigationHandler},{"../../../hammerUtil":18,"../../../module/hammer":19,"../../../util":116,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,keycharm:223}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _Label=require("./shared/Label");var _Label2=_interopRequireDefault(_Label);var _Box=require("./nodes/shapes/Box");var _Box2=_interopRequireDefault(_Box);var _Circle=require("./nodes/shapes/Circle");var _Circle2=_interopRequireDefault(_Circle);var _CircularImage=require("./nodes/shapes/CircularImage");var _CircularImage2=_interopRequireDefault(_CircularImage);var _Database=require("./nodes/shapes/Database");var _Database2=_interopRequireDefault(_Database);var _Diamond=require("./nodes/shapes/Diamond");var _Diamond2=_interopRequireDefault(_Diamond);var _Dot=require("./nodes/shapes/Dot");var _Dot2=_interopRequireDefault(_Dot);var _Ellipse=require("./nodes/shapes/Ellipse");var _Ellipse2=_interopRequireDefault(_Ellipse);var _Icon=require("./nodes/shapes/Icon");var _Icon2=_interopRequireDefault(_Icon);var _Image=require("./nodes/shapes/Image");var _Image2=_interopRequireDefault(_Image);var _Square=require("./nodes/shapes/Square");var _Square2=_interopRequireDefault(_Square);var _Star=require("./nodes/shapes/Star");var _Star2=_interopRequireDefault(_Star);var _Text=require("./nodes/shapes/Text");var _Text2=_interopRequireDefault(_Text);var _Triangle=require("./nodes/shapes/Triangle");var _Triangle2=_interopRequireDefault(_Triangle);var _TriangleDown=require("./nodes/shapes/TriangleDown");var _TriangleDown2=_interopRequireDefault(_TriangleDown);var _Validator=require("../../../shared/Validator");var _Validator2=_interopRequireDefault(_Validator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../../util");var Node=function(){function Node(options,body,imagelist,grouplist,globalOptions,defaultOptions,nodeOptions){(0,_classCallCheck3["default"])(this,Node);this.options=util.bridgeObject(globalOptions);this.globalOptions=globalOptions;this.defaultOptions=defaultOptions;this.nodeOptions=nodeOptions;this.body=body;this.edges=[];this.id=undefined;this.imagelist=imagelist;this.grouplist=grouplist;this.x=undefined;this.y=undefined;this.baseSize=this.options.size;this.baseFontSize=this.options.font.size;this.predefinedPosition=false;this.selected=false;this.hover=false;this.labelModule=new _Label2["default"](this.body,this.options,false);this.setOptions(options)}(0,_createClass3["default"])(Node,[{key:"attachEdge",value:function attachEdge(edge){if(this.edges.indexOf(edge)===-1){this.edges.push(edge)}}},{key:"detachEdge",value:function detachEdge(edge){var index=this.edges.indexOf(edge);if(index!=-1){this.edges.splice(index,1)}}},{key:"setOptions",value:function setOptions(options){var currentShape=this.options.shape;if(!options){return}if(options.id!==undefined){this.id=options.id}if(this.id===undefined){throw"Node must have an id"}if(options.x!==undefined){if(options.x===null){this.x=undefined;this.predefinedPosition=false}else{this.x=parseInt(options.x);this.predefinedPosition=true}}if(options.y!==undefined){if(options.y===null){this.y=undefined;this.predefinedPosition=false}else{this.y=parseInt(options.y);this.predefinedPosition=true}}if(options.size!==undefined){this.baseSize=options.size}if(options.value!==undefined){options.value=parseFloat(options.value)}if(typeof options.group==="number"||typeof options.group==="string"&&options.group!=""){var groupObj=this.grouplist.get(options.group);util.deepExtend(this.options,groupObj);this.options.color=util.parseColor(this.options.color)}Node.parseOptions(this.options,options,true,this.globalOptions);this.choosify(options);if(this.options.image!==undefined){if(this.imagelist){this.imageObj=this.imagelist.load(this.options.image,this.options.brokenImage,this.id)}else{throw"No imagelist provided"}}this.updateLabelModule(options);this.updateShape(currentShape);this.labelModule.propagateFonts(this.nodeOptions,options,this.defaultOptions);if(options.hidden!==undefined||options.physics!==undefined){return true}return false}},{key:"choosify",value:function choosify(options){this.chooser=true;var pile=[options,this.options,this.defaultOptions];var chosen=util.topMost(pile,"chosen");if(typeof chosen==="boolean"){this.chooser=chosen}else if((typeof chosen==="undefined"?"undefined":(0,_typeof3["default"])(chosen))==="object"){var chosenNode=util.topMost(pile,["chosen","node"]);if(typeof chosenNode==="boolean"||typeof chosenNode==="function"){this.chooser=chosenNode}}}},{key:"getFormattingValues",value:function getFormattingValues(){var values={color:this.options.color.background,borderWidth:this.options.borderWidth,borderColor:this.options.color.border,size:this.options.size,borderDashes:this.options.shapeProperties.borderDashes,borderRadius:this.options.shapeProperties.borderRadius,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y};if(this.selected||this.hover){if(this.chooser===true){if(this.selected){values.borderWidth*=2;values.color=this.options.color.highlight.background;values.borderColor=this.options.color.highlight.border;values.shadow=this.options.shadow.enabled}else if(this.hover){values.color=this.options.color.hover.background;values.borderColor=this.options.color.hover.border;values.shadow=this.options.shadow.enabled}}else if(typeof this.chooser==="function"){this.chooser(values,this.options.id,this.selected,this.hover);if(values.shadow===false){if(values.shadowColor!==this.options.shadow.color||values.shadowSize!==this.options.shadow.size||values.shadowX!==this.options.shadow.x||values.shadowY!==this.options.shadow.y){values.shadow=true}}}}else{values.shadow=this.options.shadow.enabled}return values}},{key:"updateLabelModule",value:function updateLabelModule(options){if(this.options.label===undefined||this.options.label===null){this.options.label=""}this.labelModule.setOptions(this.options,true);if(this.labelModule.baseSize!==undefined){this.baseFontSize=this.labelModule.baseSize}this.labelModule.constrain(this.nodeOptions,options,this.defaultOptions);this.labelModule.choosify(this.nodeOptions,options,this.defaultOptions)}},{key:"updateShape",value:function updateShape(currentShape){if(currentShape===this.options.shape&&this.shape){this.shape.setOptions(this.options,this.imageObj)}else{switch(this.options.shape){case"box":this.shape=new _Box2["default"](this.options,this.body,this.labelModule);break;case"circle":this.shape=new _Circle2["default"](this.options,this.body,this.labelModule);break;case"circularImage":this.shape=new _CircularImage2["default"](this.options,this.body,this.labelModule,this.imageObj);break;case"database":this.shape=new _Database2["default"](this.options,this.body,this.labelModule);break;case"diamond":this.shape=new _Diamond2["default"](this.options,this.body,this.labelModule);break;case"dot":this.shape=new _Dot2["default"](this.options,this.body,this.labelModule);break;case"ellipse":this.shape=new _Ellipse2["default"](this.options,this.body,this.labelModule);break;case"icon":this.shape=new _Icon2["default"](this.options,this.body,this.labelModule);break;case"image":this.shape=new _Image2["default"](this.options,this.body,this.labelModule,this.imageObj);break;case"square":this.shape=new _Square2["default"](this.options,this.body,this.labelModule);break;case"star":this.shape=new _Star2["default"](this.options,this.body,this.labelModule);break;case"text":this.shape=new _Text2["default"](this.options,this.body,this.labelModule);break;case"triangle":this.shape=new _Triangle2["default"](this.options,this.body,this.labelModule);break;case"triangleDown":this.shape=new _TriangleDown2["default"](this.options,this.body,this.labelModule);break;default:this.shape=new _Ellipse2["default"](this.options,this.body,this.labelModule);break}}this._reset()}},{key:"select",value:function select(){this.selected=true;this._reset()}},{key:"unselect",value:function unselect(){this.selected=false;this._reset()}},{key:"_reset",value:function _reset(){this.shape.width=undefined;this.shape.height=undefined}},{key:"getTitle",value:function getTitle(){return this.options.title}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this.shape.distanceToBorder(ctx,angle)}},{key:"isFixed",value:function isFixed(){return this.options.fixed.x&&this.options.fixed.y}},{key:"isSelected",value:function isSelected(){return this.selected}},{key:"getValue",value:function getValue(){return this.options.value}},{key:"setValueRange",value:function setValueRange(min,max,total){if(this.options.value!==undefined){var scale=this.options.scaling.customScalingFunction(min,max,total,this.options.value);var sizeDiff=this.options.scaling.max-this.options.scaling.min;if(this.options.scaling.label.enabled===true){var fontDiff=this.options.scaling.label.max-this.options.scaling.label.min;this.options.font.size=this.options.scaling.label.min+scale*fontDiff}this.options.size=this.options.scaling.min+scale*sizeDiff}else{this.options.size=this.baseSize;this.options.font.size=this.baseFontSize}this.updateLabelModule()}},{key:"draw",value:function draw(ctx){var values=this.getFormattingValues();this.shape.draw(ctx,this.x,this.y,this.selected,this.hover,values)}},{key:"updateBoundingBox",value:function updateBoundingBox(ctx){this.shape.updateBoundingBox(this.x,this.y,ctx)}},{key:"resize",value:function resize(ctx){var values=this.getFormattingValues();this.shape.resize(ctx,this.selected,this.hover,values)}},{key:"isOverlappingWith",value:function isOverlappingWith(obj){return this.shape.left<obj.right&&this.shape.left+this.shape.width>obj.left&&this.shape.top<obj.bottom&&this.shape.top+this.shape.height>obj.top}},{key:"isBoundingBoxOverlappingWith",value:function isBoundingBoxOverlappingWith(obj){return this.shape.boundingBox.left<obj.right&&this.shape.boundingBox.right>obj.left&&this.shape.boundingBox.top<obj.bottom&&this.shape.boundingBox.bottom>obj.top}}],[{key:"parseOptions",value:function parseOptions(parentOptions,newOptions){var allowDeletion=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var globalOptions=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var fields=["color","font","fixed","shadow"];util.selectiveNotDeepExtend(fields,parentOptions,newOptions,allowDeletion);util.mergeOptions(parentOptions,newOptions,"shadow",allowDeletion,globalOptions);if(newOptions.color!==undefined&&newOptions.color!==null){var parsedColor=util.parseColor(newOptions.color);util.fillIfDefined(parentOptions.color,parsedColor)}else if(allowDeletion===true&&newOptions.color===null){parentOptions.color=util.bridgeObject(globalOptions.color)}if(newOptions.fixed!==undefined&&newOptions.fixed!==null){if(typeof newOptions.fixed==="boolean"){parentOptions.fixed.x=newOptions.fixed;parentOptions.fixed.y=newOptions.fixed}else{if(newOptions.fixed.x!==undefined&&typeof newOptions.fixed.x==="boolean"){parentOptions.fixed.x=newOptions.fixed.x}if(newOptions.fixed.y!==undefined&&typeof newOptions.fixed.y==="boolean"){parentOptions.fixed.y=newOptions.fixed.y}}}if(newOptions.font!==undefined&&newOptions.font!==null){_Label2["default"].parseOptions(parentOptions.font,newOptions)}else if(allowDeletion===true&&newOptions.font===null){parentOptions.font=util.bridgeObject(globalOptions.font)}if(newOptions.scaling!==undefined){util.mergeOptions(parentOptions.scaling,newOptions.scaling,"label",allowDeletion,globalOptions.scaling)}}}]);return Node}();exports["default"]=Node},{"../../../shared/Validator":85,"../../../util":116,"./nodes/shapes/Box":53,"./nodes/shapes/Circle":54,"./nodes/shapes/CircularImage":55,"./nodes/shapes/Database":56,"./nodes/shapes/Diamond":57,"./nodes/shapes/Dot":58,"./nodes/shapes/Ellipse":59,"./nodes/shapes/Icon":60,"./nodes/shapes/Image":61,"./nodes/shapes/Square":62,"./nodes/shapes/Star":63,"./nodes/shapes/Text":64,"./nodes/shapes/Triangle":65,"./nodes/shapes/TriangleDown":66,"./shared/Label":78,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FloydWarshall=function(){function FloydWarshall(){(0,_classCallCheck3["default"])(this,FloydWarshall)}(0,_createClass3["default"])(FloydWarshall,[{key:"getDistances",value:function getDistances(body,nodesArray,edgesArray){var D_matrix={};var edges=body.edges;for(var i=0;i<nodesArray.length;i++){D_matrix[nodesArray[i]]={};D_matrix[nodesArray[i]]={};for(var j=0;j<nodesArray.length;j++){D_matrix[nodesArray[i]][nodesArray[j]]=i==j?0:1e9;D_matrix[nodesArray[i]][nodesArray[j]]=i==j?0:1e9}}for(var _i=0;_i<edgesArray.length;_i++){var edge=edges[edgesArray[_i]];if(edge.connected===true&&D_matrix[edge.fromId]!==undefined&&D_matrix[edge.toId]!==undefined){D_matrix[edge.fromId][edge.toId]=1;D_matrix[edge.toId][edge.fromId]=1}}var nodeCount=nodesArray.length;for(var k=0;k<nodeCount;k++){for(var _i2=0;_i2<nodeCount-1;_i2++){for(var _j=_i2+1;_j<nodeCount;_j++){D_matrix[nodesArray[_i2]][nodesArray[_j]]=Math.min(D_matrix[nodesArray[_i2]][nodesArray[_j]],D_matrix[nodesArray[_i2]][nodesArray[k]]+D_matrix[nodesArray[k]][nodesArray[_j]]);D_matrix[nodesArray[_j]][nodesArray[_i2]]=D_matrix[nodesArray[_i2]][nodesArray[_j]]}}}return D_matrix}}]);return FloydWarshall}();exports["default"]=FloydWarshall},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _BezierEdgeBase2=require("./util/BezierEdgeBase");var _BezierEdgeBase3=_interopRequireDefault(_BezierEdgeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BezierEdgeDynamic=function(_BezierEdgeBase){(0,_inherits3["default"])(BezierEdgeDynamic,_BezierEdgeBase);function BezierEdgeDynamic(options,body,labelModule){(0,_classCallCheck3["default"])(this,BezierEdgeDynamic);var _this=(0,_possibleConstructorReturn3["default"])(this,(BezierEdgeDynamic.__proto__||(0,_getPrototypeOf2["default"])(BezierEdgeDynamic)).call(this,options,body,labelModule));_this._boundFunction=function(){_this.positionBezierNode()};_this.body.emitter.on("_repositionBezierNodes",_this._boundFunction);return _this}(0,_createClass3["default"])(BezierEdgeDynamic,[{key:"setOptions",value:function setOptions(options){var physicsChange=false;if(this.options.physics!==options.physics){physicsChange=true}this.options=options;this.id=this.options.id;this.from=this.body.nodes[this.options.from];this.to=this.body.nodes[this.options.to];this.setupSupportNode();this.connect();if(physicsChange===true){this.via.setOptions({physics:this.options.physics});this.positionBezierNode()}}},{key:"connect",value:function connect(){this.from=this.body.nodes[this.options.from];this.to=this.body.nodes[this.options.to];if(this.from===undefined||this.to===undefined||this.options.physics===false){this.via.setOptions({physics:false})}else{if(this.from.id===this.to.id){this.via.setOptions({physics:false})}else{this.via.setOptions({physics:true})}}}},{key:"cleanup",value:function cleanup(){this.body.emitter.off("_repositionBezierNodes",this._boundFunction);if(this.via!==undefined){delete this.body.nodes[this.via.id];this.via=undefined;return true}return false}},{key:"setupSupportNode",value:function setupSupportNode(){if(this.via===undefined){var nodeId="edgeId:"+this.id;var node=this.body.functions.createNode({id:nodeId,shape:"circle",physics:true,hidden:true});this.body.nodes[nodeId]=node;this.via=node;this.via.parentEdgeId=this.id;this.positionBezierNode()}}},{key:"positionBezierNode",value:function positionBezierNode(){if(this.via!==undefined&&this.from!==undefined&&this.to!==undefined){this.via.x=.5*(this.from.x+this.to.x);this.via.y=.5*(this.from.y+this.to.y)}else if(this.via!==undefined){this.via.x=0;this.via.y=0}}},{key:"_line",value:function _line(ctx,values,viaNode){ctx.beginPath();ctx.moveTo(this.fromPoint.x,this.fromPoint.y);if(viaNode.x===undefined){ctx.lineTo(this.toPoint.x,this.toPoint.y)}else{ctx.quadraticCurveTo(viaNode.x,viaNode.y,this.toPoint.x,this.toPoint.y)}this.enableShadow(ctx,values);ctx.stroke();this.disableShadow(ctx,values)}},{key:"getViaNode",value:function getViaNode(){return this.via}},{key:"getPoint",value:function getPoint(percentage){var viaNode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.via;var t=percentage;var x=void 0,y=void 0;if(this.from===this.to){var _getCircleData=this._getCircleData(this.from),_getCircleData2=(0,_slicedToArray3["default"])(_getCircleData,3),cx=_getCircleData2[0],cy=_getCircleData2[1],cr=_getCircleData2[2];var a=2*Math.PI*(1-t);x=cx+cr*Math.sin(a);y=cy+cr-cr*(1-Math.cos(a))}else{x=Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*viaNode.x+Math.pow(t,2)*this.toPoint.x;y=Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*viaNode.y+Math.pow(t,2)*this.toPoint.y}return{x:x,y:y}}},{key:"_findBorderPosition",value:function _findBorderPosition(nearNode,ctx){return this._findBorderPositionBezier(nearNode,ctx,this.via)}},{key:"_getDistanceToEdge",value:function _getDistanceToEdge(x1,y1,x2,y2,x3,y3){return this._getDistanceToBezierEdge(x1,y1,x2,y2,x3,y3,this.via)}}]);return BezierEdgeDynamic}(_BezierEdgeBase3["default"]);exports["default"]=BezierEdgeDynamic},{"./util/BezierEdgeBase":49,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131,"babel-runtime/helpers/slicedToArray":132}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _BezierEdgeBase2=require("./util/BezierEdgeBase");var _BezierEdgeBase3=_interopRequireDefault(_BezierEdgeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BezierEdgeStatic=function(_BezierEdgeBase){(0,_inherits3["default"])(BezierEdgeStatic,_BezierEdgeBase);function BezierEdgeStatic(options,body,labelModule){(0,_classCallCheck3["default"])(this,BezierEdgeStatic);return(0,_possibleConstructorReturn3["default"])(this,(BezierEdgeStatic.__proto__||(0,_getPrototypeOf2["default"])(BezierEdgeStatic)).call(this,options,body,labelModule))}(0,_createClass3["default"])(BezierEdgeStatic,[{key:"_line",value:function _line(ctx,values,viaNode){ctx.beginPath();ctx.moveTo(this.fromPoint.x,this.fromPoint.y);if(viaNode.x===undefined){ctx.lineTo(this.toPoint.x,this.toPoint.y)}else{ctx.quadraticCurveTo(viaNode.x,viaNode.y,this.toPoint.x,this.toPoint.y)}this.enableShadow(ctx,values);ctx.stroke();this.disableShadow(ctx,values)}},{key:"getViaNode",value:function getViaNode(){return this._getViaCoordinates()}},{key:"_getViaCoordinates",value:function _getViaCoordinates(){
var xVia=undefined;var yVia=undefined;var factor=this.options.smooth.roundness;var type=this.options.smooth.type;var dx=Math.abs(this.from.x-this.to.x);var dy=Math.abs(this.from.y-this.to.y);if(type==="discrete"||type==="diagonalCross"){if(Math.abs(this.from.x-this.to.x)<=Math.abs(this.from.y-this.to.y)){if(this.from.y>=this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dy;yVia=this.from.y-factor*dy}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dy;yVia=this.from.y-factor*dy}}else if(this.from.y<this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dy;yVia=this.from.y+factor*dy}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dy;yVia=this.from.y+factor*dy}}if(type==="discrete"){xVia=dx<factor*dy?this.from.x:xVia}}else if(Math.abs(this.from.x-this.to.x)>Math.abs(this.from.y-this.to.y)){if(this.from.y>=this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dx;yVia=this.from.y-factor*dx}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dx;yVia=this.from.y-factor*dx}}else if(this.from.y<this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dx;yVia=this.from.y+factor*dx}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dx;yVia=this.from.y+factor*dx}}if(type==="discrete"){yVia=dy<factor*dx?this.from.y:yVia}}}else if(type==="straightCross"){if(Math.abs(this.from.x-this.to.x)<=Math.abs(this.from.y-this.to.y)){xVia=this.from.x;if(this.from.y<this.to.y){yVia=this.to.y-(1-factor)*dy}else{yVia=this.to.y+(1-factor)*dy}}else if(Math.abs(this.from.x-this.to.x)>Math.abs(this.from.y-this.to.y)){if(this.from.x<this.to.x){xVia=this.to.x-(1-factor)*dx}else{xVia=this.to.x+(1-factor)*dx}yVia=this.from.y}}else if(type==="horizontal"){if(this.from.x<this.to.x){xVia=this.to.x-(1-factor)*dx}else{xVia=this.to.x+(1-factor)*dx}yVia=this.from.y}else if(type==="vertical"){xVia=this.from.x;if(this.from.y<this.to.y){yVia=this.to.y-(1-factor)*dy}else{yVia=this.to.y+(1-factor)*dy}}else if(type==="curvedCW"){dx=this.to.x-this.from.x;dy=this.from.y-this.to.y;var radius=Math.sqrt(dx*dx+dy*dy);var pi=Math.PI;var originalAngle=Math.atan2(dy,dx);var myAngle=(originalAngle+(factor*.5+.5)*pi)%(2*pi);xVia=this.from.x+(factor*.5+.5)*radius*Math.sin(myAngle);yVia=this.from.y+(factor*.5+.5)*radius*Math.cos(myAngle)}else if(type==="curvedCCW"){dx=this.to.x-this.from.x;dy=this.from.y-this.to.y;var _radius=Math.sqrt(dx*dx+dy*dy);var _pi=Math.PI;var _originalAngle=Math.atan2(dy,dx);var _myAngle=(_originalAngle+(-factor*.5+.5)*_pi)%(2*_pi);xVia=this.from.x+(factor*.5+.5)*_radius*Math.sin(_myAngle);yVia=this.from.y+(factor*.5+.5)*_radius*Math.cos(_myAngle)}else{if(Math.abs(this.from.x-this.to.x)<=Math.abs(this.from.y-this.to.y)){if(this.from.y>=this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dy;yVia=this.from.y-factor*dy;xVia=this.to.x<xVia?this.to.x:xVia}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dy;yVia=this.from.y-factor*dy;xVia=this.to.x>xVia?this.to.x:xVia}}else if(this.from.y<this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dy;yVia=this.from.y+factor*dy;xVia=this.to.x<xVia?this.to.x:xVia}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dy;yVia=this.from.y+factor*dy;xVia=this.to.x>xVia?this.to.x:xVia}}}else if(Math.abs(this.from.x-this.to.x)>Math.abs(this.from.y-this.to.y)){if(this.from.y>=this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dx;yVia=this.from.y-factor*dx;yVia=this.to.y>yVia?this.to.y:yVia}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dx;yVia=this.from.y-factor*dx;yVia=this.to.y>yVia?this.to.y:yVia}}else if(this.from.y<this.to.y){if(this.from.x<=this.to.x){xVia=this.from.x+factor*dx;yVia=this.from.y+factor*dx;yVia=this.to.y<yVia?this.to.y:yVia}else if(this.from.x>this.to.x){xVia=this.from.x-factor*dx;yVia=this.from.y+factor*dx;yVia=this.to.y<yVia?this.to.y:yVia}}}}return{x:xVia,y:yVia}}},{key:"_findBorderPosition",value:function _findBorderPosition(nearNode,ctx){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return this._findBorderPositionBezier(nearNode,ctx,options.via)}},{key:"_getDistanceToEdge",value:function _getDistanceToEdge(x1,y1,x2,y2,x3,y3){var viaNode=arguments.length>6&&arguments[6]!==undefined?arguments[6]:this._getViaCoordinates();return this._getDistanceToBezierEdge(x1,y1,x2,y2,x3,y3,viaNode)}},{key:"getPoint",value:function getPoint(percentage){var viaNode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._getViaCoordinates();var t=percentage;var x=Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*viaNode.x+Math.pow(t,2)*this.toPoint.x;var y=Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*viaNode.y+Math.pow(t,2)*this.toPoint.y;return{x:x,y:y}}}]);return BezierEdgeStatic}(_BezierEdgeBase3["default"]);exports["default"]=BezierEdgeStatic},{"./util/BezierEdgeBase":49,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _CubicBezierEdgeBase2=require("./util/CubicBezierEdgeBase");var _CubicBezierEdgeBase3=_interopRequireDefault(_CubicBezierEdgeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CubicBezierEdge=function(_CubicBezierEdgeBase){(0,_inherits3["default"])(CubicBezierEdge,_CubicBezierEdgeBase);function CubicBezierEdge(options,body,labelModule){(0,_classCallCheck3["default"])(this,CubicBezierEdge);return(0,_possibleConstructorReturn3["default"])(this,(CubicBezierEdge.__proto__||(0,_getPrototypeOf2["default"])(CubicBezierEdge)).call(this,options,body,labelModule))}(0,_createClass3["default"])(CubicBezierEdge,[{key:"_line",value:function _line(ctx,values,viaNodes){var via1=viaNodes[0];var via2=viaNodes[1];ctx.beginPath();ctx.moveTo(this.fromPoint.x,this.fromPoint.y);if(viaNodes===undefined||via1.x===undefined){ctx.lineTo(this.toPoint.x,this.toPoint.y)}else{ctx.bezierCurveTo(via1.x,via1.y,via2.x,via2.y,this.toPoint.x,this.toPoint.y)}this.enableShadow(ctx,values);ctx.stroke();this.disableShadow(ctx,values)}},{key:"_getViaCoordinates",value:function _getViaCoordinates(){var dx=this.from.x-this.to.x;var dy=this.from.y-this.to.y;var x1=void 0,y1=void 0,x2=void 0,y2=void 0;var roundness=this.options.smooth.roundness;if((Math.abs(dx)>Math.abs(dy)||this.options.smooth.forceDirection===true||this.options.smooth.forceDirection==="horizontal")&&this.options.smooth.forceDirection!=="vertical"){y1=this.from.y;y2=this.to.y;x1=this.from.x-roundness*dx;x2=this.to.x+roundness*dx}else{y1=this.from.y-roundness*dy;y2=this.to.y+roundness*dy;x1=this.from.x;x2=this.to.x}return[{x:x1,y:y1},{x:x2,y:y2}]}},{key:"getViaNode",value:function getViaNode(){return this._getViaCoordinates()}},{key:"_findBorderPosition",value:function _findBorderPosition(nearNode,ctx){return this._findBorderPositionBezier(nearNode,ctx)}},{key:"_getDistanceToEdge",value:function _getDistanceToEdge(x1,y1,x2,y2,x3,y3){var _ref=arguments.length>6&&arguments[6]!==undefined?arguments[6]:this._getViaCoordinates(),_ref2=(0,_slicedToArray3["default"])(_ref,2),via1=_ref2[0],via2=_ref2[1];return this._getDistanceToBezierEdge(x1,y1,x2,y2,x3,y3,via1,via2)}},{key:"getPoint",value:function getPoint(percentage){var _ref3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._getViaCoordinates(),_ref4=(0,_slicedToArray3["default"])(_ref3,2),via1=_ref4[0],via2=_ref4[1];var t=percentage;var vec=[];vec[0]=Math.pow(1-t,3);vec[1]=3*t*Math.pow(1-t,2);vec[2]=3*Math.pow(t,2)*(1-t);vec[3]=Math.pow(t,3);var x=vec[0]*this.fromPoint.x+vec[1]*via1.x+vec[2]*via2.x+vec[3]*this.toPoint.x;var y=vec[0]*this.fromPoint.y+vec[1]*via1.y+vec[2]*via2.y+vec[3]*this.toPoint.y;return{x:x,y:y}}}]);return CubicBezierEdge}(_CubicBezierEdgeBase3["default"]);exports["default"]=CubicBezierEdge},{"./util/CubicBezierEdgeBase":50,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131,"babel-runtime/helpers/slicedToArray":132}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _EdgeBase2=require("./util/EdgeBase");var _EdgeBase3=_interopRequireDefault(_EdgeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StraightEdge=function(_EdgeBase){(0,_inherits3["default"])(StraightEdge,_EdgeBase);function StraightEdge(options,body,labelModule){(0,_classCallCheck3["default"])(this,StraightEdge);return(0,_possibleConstructorReturn3["default"])(this,(StraightEdge.__proto__||(0,_getPrototypeOf2["default"])(StraightEdge)).call(this,options,body,labelModule))}(0,_createClass3["default"])(StraightEdge,[{key:"_line",value:function _line(ctx,values){ctx.beginPath();ctx.moveTo(this.fromPoint.x,this.fromPoint.y);ctx.lineTo(this.toPoint.x,this.toPoint.y);this.enableShadow(ctx,values);ctx.stroke();this.disableShadow(ctx,values)}},{key:"getViaNode",value:function getViaNode(){return undefined}},{key:"getPoint",value:function getPoint(percentage){return{x:(1-percentage)*this.fromPoint.x+percentage*this.toPoint.x,y:(1-percentage)*this.fromPoint.y+percentage*this.toPoint.y}}},{key:"_findBorderPosition",value:function _findBorderPosition(nearNode,ctx){var node1=this.to;var node2=this.from;if(nearNode.id===this.from.id){node1=this.from;node2=this.to}var angle=Math.atan2(node1.y-node2.y,node1.x-node2.x);var dx=node1.x-node2.x;var dy=node1.y-node2.y;var edgeSegmentLength=Math.sqrt(dx*dx+dy*dy);var toBorderDist=nearNode.distanceToBorder(ctx,angle);var toBorderPoint=(edgeSegmentLength-toBorderDist)/edgeSegmentLength;var borderPos={};borderPos.x=(1-toBorderPoint)*node2.x+toBorderPoint*node1.x;borderPos.y=(1-toBorderPoint)*node2.y+toBorderPoint*node1.y;return borderPos}},{key:"_getDistanceToEdge",value:function _getDistanceToEdge(x1,y1,x2,y2,x3,y3){return this._getDistanceToLine(x1,y1,x2,y2,x3,y3)}}]);return StraightEdge}(_EdgeBase3["default"]);exports["default"]=StraightEdge},{"./util/EdgeBase":51,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _EdgeBase2=require("./EdgeBase");var _EdgeBase3=_interopRequireDefault(_EdgeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BezierEdgeBase=function(_EdgeBase){(0,_inherits3["default"])(BezierEdgeBase,_EdgeBase);function BezierEdgeBase(options,body,labelModule){(0,_classCallCheck3["default"])(this,BezierEdgeBase);return(0,_possibleConstructorReturn3["default"])(this,(BezierEdgeBase.__proto__||(0,_getPrototypeOf2["default"])(BezierEdgeBase)).call(this,options,body,labelModule))}(0,_createClass3["default"])(BezierEdgeBase,[{key:"_findBorderPositionBezier",value:function _findBorderPositionBezier(nearNode,ctx){var viaNode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this._getViaCoordinates();var maxIterations=10;var iteration=0;var low=0;var high=1;var pos,angle,distanceToBorder,distanceToPoint,difference;var threshold=.2;var node=this.to;var from=false;if(nearNode.id===this.from.id){node=this.from;from=true}while(low<=high&&iteration<maxIterations){var middle=(low+high)*.5;pos=this.getPoint(middle,viaNode);angle=Math.atan2(node.y-pos.y,node.x-pos.x);distanceToBorder=node.distanceToBorder(ctx,angle);distanceToPoint=Math.sqrt(Math.pow(pos.x-node.x,2)+Math.pow(pos.y-node.y,2));difference=distanceToBorder-distanceToPoint;if(Math.abs(difference)<threshold){break}else if(difference<0){if(from===false){low=middle}else{high=middle}}else{if(from===false){high=middle}else{low=middle}}iteration++}pos.t=middle;return pos}},{key:"_getDistanceToBezierEdge",value:function _getDistanceToBezierEdge(x1,y1,x2,y2,x3,y3,via){var minDistance=1e9;var distance=void 0;var i=void 0,t=void 0,x=void 0,y=void 0;var lastX=x1;var lastY=y1;for(i=1;i<10;i++){t=.1*i;x=Math.pow(1-t,2)*x1+2*t*(1-t)*via.x+Math.pow(t,2)*x2;y=Math.pow(1-t,2)*y1+2*t*(1-t)*via.y+Math.pow(t,2)*y2;if(i>0){distance=this._getDistanceToLine(lastX,lastY,x,y,x3,y3);minDistance=distance<minDistance?distance:minDistance}lastX=x;lastY=y}return minDistance}}]);return BezierEdgeBase}(_EdgeBase3["default"]);exports["default"]=BezierEdgeBase},{"./EdgeBase":51,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _BezierEdgeBase2=require("./BezierEdgeBase");var _BezierEdgeBase3=_interopRequireDefault(_BezierEdgeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CubicBezierEdgeBase=function(_BezierEdgeBase){(0,_inherits3["default"])(CubicBezierEdgeBase,_BezierEdgeBase);function CubicBezierEdgeBase(options,body,labelModule){(0,_classCallCheck3["default"])(this,CubicBezierEdgeBase);return(0,_possibleConstructorReturn3["default"])(this,(CubicBezierEdgeBase.__proto__||(0,_getPrototypeOf2["default"])(CubicBezierEdgeBase)).call(this,options,body,labelModule))}(0,_createClass3["default"])(CubicBezierEdgeBase,[{key:"_getDistanceToBezierEdge",value:function _getDistanceToBezierEdge(x1,y1,x2,y2,x3,y3,via1,via2){var minDistance=1e9;var distance=void 0;var i=void 0,t=void 0,x=void 0,y=void 0;var lastX=x1;var lastY=y1;var vec=[0,0,0,0];for(i=1;i<10;i++){t=.1*i;vec[0]=Math.pow(1-t,3);vec[1]=3*t*Math.pow(1-t,2);vec[2]=3*Math.pow(t,2)*(1-t);vec[3]=Math.pow(t,3);x=vec[0]*x1+vec[1]*via1.x+vec[2]*via2.x+vec[3]*x2;y=vec[0]*y1+vec[1]*via1.y+vec[2]*via2.y+vec[3]*y2;if(i>0){distance=this._getDistanceToLine(lastX,lastY,x,y,x3,y3);minDistance=distance<minDistance?distance:minDistance}lastX=x;lastY=y}return minDistance}}]);return CubicBezierEdgeBase}(_BezierEdgeBase3["default"]);exports["default"]=CubicBezierEdgeBase},{"./BezierEdgeBase":49,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../../../../util");var EdgeBase=function(){function EdgeBase(options,body,labelModule){(0,_classCallCheck3["default"])(this,EdgeBase);this.body=body;this.labelModule=labelModule;this.options={};this.setOptions(options);this.colorDirty=true;this.color={};this.selectionWidth=2;this.hoverWidth=1.5;this.fromPoint=this.from;this.toPoint=this.to}(0,_createClass3["default"])(EdgeBase,[{key:"connect",value:function connect(){this.from=this.body.nodes[this.options.from];this.to=this.body.nodes[this.options.to]}},{key:"cleanup",value:function cleanup(){return false}},{key:"setOptions",value:function setOptions(options){this.options=options;this.from=this.body.nodes[this.options.from];this.to=this.body.nodes[this.options.to];this.id=this.options.id}},{key:"drawLine",value:function drawLine(ctx,values,selected,hover,viaNode){ctx.strokeStyle=this.getColor(ctx,values,selected,hover);ctx.lineWidth=values.width;if(values.dashes!==false){this._drawDashedLine(ctx,values,viaNode)}else{this._drawLine(ctx,values,viaNode)}}},{key:"_drawLine",value:function _drawLine(ctx,values,viaNode,fromPoint,toPoint){if(this.from!=this.to){this._line(ctx,values,viaNode,fromPoint,toPoint)}else{var _getCircleData2=this._getCircleData(ctx,values),_getCircleData3=(0,_slicedToArray3["default"])(_getCircleData2,3),x=_getCircleData3[0],y=_getCircleData3[1],radius=_getCircleData3[2];this._circle(ctx,values,x,y,radius)}}},{key:"_drawDashedLine",value:function _drawDashedLine(ctx,values,viaNode,fromPoint,toPoint){ctx.lineCap="round";var pattern=[5,5];if(Array.isArray(values.dashes)===true){pattern=values.dashes}if(ctx.setLineDash!==undefined){ctx.save();ctx.setLineDash(pattern);ctx.lineDashOffset=0;if(this.from!=this.to){this._line(ctx,values,viaNode)}else{var _getCircleData4=this._getCircleData(ctx,values),_getCircleData5=(0,_slicedToArray3["default"])(_getCircleData4,3),x=_getCircleData5[0],y=_getCircleData5[1],radius=_getCircleData5[2];this._circle(ctx,values,x,y,radius)}ctx.setLineDash([0]);ctx.lineDashOffset=0;ctx.restore()}else{if(this.from!=this.to){ctx.dashedLine(this.from.x,this.from.y,this.to.x,this.to.y,pattern)}else{var _getCircleData6=this._getCircleData(ctx,values),_getCircleData7=(0,_slicedToArray3["default"])(_getCircleData6,3),_x=_getCircleData7[0],_y=_getCircleData7[1],_radius=_getCircleData7[2];this._circle(ctx,values,_x,_y,_radius)}this.enableShadow(ctx,values);ctx.stroke();this.disableShadow(ctx,values)}}},{key:"findBorderPosition",value:function findBorderPosition(nearNode,ctx,options){if(this.from!=this.to){return this._findBorderPosition(nearNode,ctx,options)}else{return this._findBorderPositionCircle(nearNode,ctx,options)}}},{key:"findBorderPositions",value:function findBorderPositions(ctx){var from={};var to={};if(this.from!=this.to){from=this._findBorderPosition(this.from,ctx);to=this._findBorderPosition(this.to,ctx)}else{var _getCircleData8=this._getCircleData(ctx),_getCircleData9=(0,_slicedToArray3["default"])(_getCircleData8,3),x=_getCircleData9[0],y=_getCircleData9[1],radius=_getCircleData9[2];from=this._findBorderPositionCircle(this.from,ctx,{x:x,y:y,low:.25,high:.6,direction:-1});to=this._findBorderPositionCircle(this.from,ctx,{x:x,y:y,low:.6,high:.8,direction:1})}return{from:from,to:to}}},{key:"_getCircleData",value:function _getCircleData(ctx){var x=void 0,y=void 0;var node=this.from;var radius=this.options.selfReferenceSize;if(ctx!==undefined){if(node.shape.width===undefined){node.shape.resize(ctx)}}if(node.shape.width>node.shape.height){x=node.x+node.shape.width*.5;y=node.y-radius}else{x=node.x+radius;y=node.y-node.shape.height*.5}return[x,y,radius]}},{key:"_pointOnCircle",value:function _pointOnCircle(x,y,radius,percentage){var angle=percentage*2*Math.PI;return{x:x+radius*Math.cos(angle),y:y-radius*Math.sin(angle)}}},{key:"_findBorderPositionCircle",value:function _findBorderPositionCircle(node,ctx,options){var x=options.x;var y=options.y;var low=options.low;var high=options.high;var direction=options.direction;var maxIterations=10;var iteration=0;var radius=this.options.selfReferenceSize;var pos=void 0,angle=void 0,distanceToBorder=void 0,distanceToPoint=void 0,difference=void 0;var threshold=.05;var middle=(low+high)*.5;while(low<=high&&iteration<maxIterations){middle=(low+high)*.5;pos=this._pointOnCircle(x,y,radius,middle);angle=Math.atan2(node.y-pos.y,node.x-pos.x);distanceToBorder=node.distanceToBorder(ctx,angle);distanceToPoint=Math.sqrt(Math.pow(pos.x-node.x,2)+Math.pow(pos.y-node.y,2));difference=distanceToBorder-distanceToPoint;if(Math.abs(difference)<threshold){break}else if(difference>0){if(direction>0){low=middle}else{high=middle}}else{if(direction>0){high=middle}else{low=middle}}iteration++}pos.t=middle;return pos}},{key:"getLineWidth",value:function getLineWidth(selected,hover){if(selected===true){return Math.max(this.selectionWidth,.3/this.body.view.scale)}else{if(hover===true){return Math.max(this.hoverWidth,.3/this.body.view.scale)}else{return Math.max(this.options.width,.3/this.body.view.scale)}}}},{key:"getColor",value:function getColor(ctx,values,selected,hover){if(values.inheritsColor!==false){if(values.inheritsColor==="both"&&this.from.id!==this.to.id){var grd=ctx.createLinearGradient(this.from.x,this.from.y,this.to.x,this.to.y);var fromColor=void 0,toColor=void 0;fromColor=this.from.options.color.highlight.border;toColor=this.to.options.color.highlight.border;if(this.from.selected===false&&this.to.selected===false){fromColor=util.overrideOpacity(this.from.options.color.border,values.opacity);toColor=util.overrideOpacity(this.to.options.color.border,values.opacity)}else if(this.from.selected===true&&this.to.selected===false){toColor=this.to.options.color.border}else if(this.from.selected===false&&this.to.selected===true){fromColor=this.from.options.color.border}grd.addColorStop(0,fromColor);grd.addColorStop(1,toColor);return grd}if(values.inheritsColor==="to"){return util.overrideOpacity(this.to.options.color.border,values.opacity)}else{return util.overrideOpacity(this.from.options.color.border,values.opacity)}}else{return util.overrideOpacity(values.color,values.opacity)}}},{key:"_circle",value:function _circle(ctx,values,x,y,radius){this.enableShadow(ctx,values);ctx.beginPath();ctx.arc(x,y,radius,0,2*Math.PI,false);ctx.stroke();this.disableShadow(ctx,values)}},{key:"getDistanceToEdge",value:function getDistanceToEdge(x1,y1,x2,y2,x3,y3,via,values){var returnValue=0;if(this.from!=this.to){returnValue=this._getDistanceToEdge(x1,y1,x2,y2,x3,y3,via)}else{var _getCircleData10=this._getCircleData(undefined,values),_getCircleData11=(0,_slicedToArray3["default"])(_getCircleData10,3),x=_getCircleData11[0],y=_getCircleData11[1],radius=_getCircleData11[2];var dx=x-x3;var dy=y-y3;returnValue=Math.abs(Math.sqrt(dx*dx+dy*dy)-radius)}if(this.labelModule.size.left<x3&&this.labelModule.size.left+this.labelModule.size.width>x3&&this.labelModule.size.top<y3&&this.labelModule.size.top+this.labelModule.size.height>y3){return 0}else{return returnValue}}},{key:"_getDistanceToLine",value:function _getDistanceToLine(x1,y1,x2,y2,x3,y3){var px=x2-x1;var py=y2-y1;var something=px*px+py*py;var u=((x3-x1)*px+(y3-y1)*py)/something;if(u>1){u=1}else if(u<0){u=0}var x=x1+u*px;var y=y1+u*py;var dx=x-x3;var dy=y-y3;return Math.sqrt(dx*dx+dy*dy)}},{key:"getArrowData",value:function getArrowData(ctx,position,viaNode,selected,hover,values){var angle=void 0;var arrowPoint=void 0;var node1=void 0;var node2=void 0;var guideOffset=void 0;var scaleFactor=void 0;var type=void 0;var lineWidth=values.width;if(position==="from"){node1=this.from;node2=this.to;guideOffset=.1;scaleFactor=values.fromArrowScale;type=values.fromArrowType}else if(position==="to"){node1=this.to;node2=this.from;guideOffset=-.1;scaleFactor=values.toArrowScale;type=values.toArrowType}else{node1=this.to;node2=this.from;scaleFactor=values.middleArrowScale;type=values.middleArrowType}if(node1!=node2){if(position!=="middle"){if(this.options.smooth.enabled===true){arrowPoint=this.findBorderPosition(node1,ctx,{via:viaNode});var guidePos=this.getPoint(Math.max(0,Math.min(1,arrowPoint.t+guideOffset)),viaNode);angle=Math.atan2(arrowPoint.y-guidePos.y,arrowPoint.x-guidePos.x)}else{angle=Math.atan2(node1.y-node2.y,node1.x-node2.x);arrowPoint=this.findBorderPosition(node1,ctx)}}else{angle=Math.atan2(node1.y-node2.y,node1.x-node2.x);arrowPoint=this.getPoint(.5,viaNode)}}else{var _getCircleData12=this._getCircleData(ctx),_getCircleData13=(0,_slicedToArray3["default"])(_getCircleData12,3),x=_getCircleData13[0],y=_getCircleData13[1],radius=_getCircleData13[2];if(position==="from"){arrowPoint=this.findBorderPosition(this.from,ctx,{x:x,y:y,low:.25,high:.6,direction:-1});angle=arrowPoint.t*-2*Math.PI+1.5*Math.PI+.1*Math.PI}else if(position==="to"){arrowPoint=this.findBorderPosition(this.from,ctx,{x:x,y:y,low:.6,high:1,direction:1});angle=arrowPoint.t*-2*Math.PI+1.5*Math.PI-1.1*Math.PI}else{arrowPoint=this._pointOnCircle(x,y,radius,.175);angle=3.9269908169872414}}var length=15*scaleFactor+3*lineWidth;var xi=arrowPoint.x-length*.9*Math.cos(angle);var yi=arrowPoint.y-length*.9*Math.sin(angle);var arrowCore={x:xi,y:yi};return{point:arrowPoint,core:arrowCore,angle:angle,length:length,type:type}}},{key:"drawArrowHead",value:function drawArrowHead(ctx,values,selected,hover,arrowData){ctx.strokeStyle=this.getColor(ctx,values,selected,hover);ctx.fillStyle=ctx.strokeStyle;ctx.lineWidth=values.width;if(arrowData.type&&arrowData.type.toLowerCase()==="circle"){ctx.circleEndpoint(arrowData.point.x,arrowData.point.y,arrowData.angle,arrowData.length)}else{ctx.arrowEndpoint(arrowData.point.x,arrowData.point.y,arrowData.angle,arrowData.length)}this.enableShadow(ctx,values);ctx.fill();this.disableShadow(ctx,values)}},{key:"enableShadow",value:function enableShadow(ctx,values){if(values.shadow===true){ctx.shadowColor=values.shadowColor;ctx.shadowBlur=values.shadowSize;ctx.shadowOffsetX=values.shadowX;ctx.shadowOffsetY=values.shadowY}}},{key:"disableShadow",value:function disableShadow(ctx,values){if(values.shadow===true){ctx.shadowColor="rgba(0,0,0,0)";ctx.shadowBlur=0;ctx.shadowOffsetX=0;ctx.shadowOffsetY=0}}}]);return EdgeBase}();exports["default"]=EdgeBase},{"../../../../../util":116,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/slicedToArray":132}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _Node2=require("../Node");var _Node3=_interopRequireDefault(_Node2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Cluster=function(_Node){(0,_inherits3["default"])(Cluster,_Node);function Cluster(options,body,imagelist,grouplist,globalOptions){(0,_classCallCheck3["default"])(this,Cluster);var _this=(0,_possibleConstructorReturn3["default"])(this,(Cluster.__proto__||(0,_getPrototypeOf2["default"])(Cluster)).call(this,options,body,imagelist,grouplist,globalOptions));_this.isCluster=true;_this.containedNodes={};_this.containedEdges={};return _this}return Cluster}(_Node3["default"]);exports["default"]=Cluster},{"../Node":43,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Box=function(_NodeBase){(0,_inherits3["default"])(Box,_NodeBase);function Box(options,body,labelModule){(0,_classCallCheck3["default"])(this,Box);var _this=(0,_possibleConstructorReturn3["default"])(this,(Box.__proto__||(0,_getPrototypeOf2["default"])(Box)).call(this,options,body,labelModule));_this._setMargins(labelModule);return _this}(0,_createClass3["default"])(Box,[{key:"resize",value:function resize(ctx){var selected=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.selected;var hover=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.hover;if(this.width===undefined||this.labelModule.differentState(selected,hover)){this.textSize=this.labelModule.getTextSize(ctx,selected,hover);this.width=this.textSize.width+this.margin.right+this.margin.left;this.height=this.textSize.height+this.margin.top+this.margin.bottom;this.radius=this.width/2}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize(ctx,selected,hover);this.left=x-this.width/2;this.top=y-this.height/2;ctx.strokeStyle=values.borderColor;ctx.lineWidth=values.borderWidth;ctx.lineWidth/=this.body.view.scale;ctx.lineWidth=Math.min(this.width,ctx.lineWidth);ctx.fillStyle=values.color;ctx.roundRect(this.left,this.top,this.width,this.height,values.borderRadius);this.enableShadow(ctx,values);
ctx.fill();this.disableShadow(ctx,values);ctx.save();if(values.borderWidth>0){this.enableBorderDashes(ctx,values);ctx.stroke();this.disableBorderDashes(ctx,values)}ctx.restore();this.updateBoundingBox(x,y,ctx,selected,hover);this.labelModule.draw(ctx,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,selected,hover)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y,ctx,selected,hover){this.resize(ctx,selected,hover);this.left=x-this.width/2;this.top=y-this.height/2;var borderRadius=this.options.shapeProperties.borderRadius;this.boundingBox.left=this.left-borderRadius;this.boundingBox.top=this.top-borderRadius;this.boundingBox.bottom=this.top+this.height+borderRadius;this.boundingBox.right=this.left+this.width+borderRadius}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){this.resize(ctx);var borderWidth=this.options.borderWidth;return Math.min(Math.abs(this.width/2/Math.cos(angle)),Math.abs(this.height/2/Math.sin(angle)))+borderWidth}}]);return Box}(_NodeBase3["default"]);exports["default"]=Box},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _CircleImageBase2=require("../util/CircleImageBase");var _CircleImageBase3=_interopRequireDefault(_CircleImageBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Circle=function(_CircleImageBase){(0,_inherits3["default"])(Circle,_CircleImageBase);function Circle(options,body,labelModule){(0,_classCallCheck3["default"])(this,Circle);var _this=(0,_possibleConstructorReturn3["default"])(this,(Circle.__proto__||(0,_getPrototypeOf2["default"])(Circle)).call(this,options,body,labelModule));_this._setMargins(labelModule);return _this}(0,_createClass3["default"])(Circle,[{key:"resize",value:function resize(ctx){var selected=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.selected;var hover=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.hover;var values=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{size:this.options.size};if(this.width===undefined||this.labelModule.differentState(selected,hover)){this.textSize=this.labelModule.getTextSize(ctx,selected,hover);var diameter=Math.max(this.textSize.width+this.margin.right+this.margin.left,this.textSize.height+this.margin.top+this.margin.bottom);this.options.size=diameter/2;this.width=diameter;this.height=diameter;this.radius=this.width/2}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize(ctx,selected,hover);this.left=x-this.width/2;this.top=y-this.height/2;this._drawRawCircle(ctx,x,y,selected,hover,values);this.boundingBox.top=y-values.size;this.boundingBox.left=x-values.size;this.boundingBox.right=x+values.size;this.boundingBox.bottom=y+values.size;this.updateBoundingBox(x,y);this.labelModule.draw(ctx,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,selected,hover)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y){this.boundingBox.top=y-this.options.size;this.boundingBox.left=x-this.options.size;this.boundingBox.right=x+this.options.size;this.boundingBox.bottom=y+this.options.size}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){this.resize(ctx);return this.width*.5}}]);return Circle}(_CircleImageBase3["default"]);exports["default"]=Circle},{"../util/CircleImageBase":67,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _CircleImageBase2=require("../util/CircleImageBase");var _CircleImageBase3=_interopRequireDefault(_CircleImageBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CircularImage=function(_CircleImageBase){(0,_inherits3["default"])(CircularImage,_CircleImageBase);function CircularImage(options,body,labelModule,imageObj){(0,_classCallCheck3["default"])(this,CircularImage);var _this=(0,_possibleConstructorReturn3["default"])(this,(CircularImage.__proto__||(0,_getPrototypeOf2["default"])(CircularImage)).call(this,options,body,labelModule));_this.imageObj=imageObj;_this._swapToImageResizeWhenImageLoaded=true;return _this}(0,_createClass3["default"])(CircularImage,[{key:"resize",value:function resize(ctx){var selected=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.selected;var hover=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.hover;if(this.imageObj.src===undefined||this.imageObj.width===undefined||this.imageObj.height===undefined||this.labelModule.differentState(selected,hover)){var diameter=this.options.size*2;this.width=diameter;this.height=diameter;this._swapToImageResizeWhenImageLoaded=true;this.radius=.5*this.width}else{if(this._swapToImageResizeWhenImageLoaded){this.width=undefined;this.height=undefined;this._swapToImageResizeWhenImageLoaded=false}this._resizeImage()}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize();this.left=x-this.width/2;this.top=y-this.height/2;var size=Math.min(.5*this.height,.5*this.width);this._drawRawCircle(ctx,x,y,selected,hover,values);ctx.save();ctx.clip();this._drawImageAtPosition(ctx,values);ctx.restore();this._drawImageLabel(ctx,x,y,selected,hover);this.updateBoundingBox(x,y)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y){this.boundingBox.top=y-this.options.size;this.boundingBox.left=x-this.options.size;this.boundingBox.right=x+this.options.size;this.boundingBox.bottom=y+this.options.size;this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left);this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width);this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){this.resize(ctx);return this.width*.5}}]);return CircularImage}(_CircleImageBase3["default"]);exports["default"]=CircularImage},{"../util/CircleImageBase":67,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Database=function(_NodeBase){(0,_inherits3["default"])(Database,_NodeBase);function Database(options,body,labelModule){(0,_classCallCheck3["default"])(this,Database);var _this=(0,_possibleConstructorReturn3["default"])(this,(Database.__proto__||(0,_getPrototypeOf2["default"])(Database)).call(this,options,body,labelModule));_this._setMargins(labelModule);return _this}(0,_createClass3["default"])(Database,[{key:"resize",value:function resize(ctx,selected,hover){if(this.width===undefined||this.labelModule.differentState(selected,hover)){this.textSize=this.labelModule.getTextSize(ctx,selected,hover);var size=this.textSize.width+this.margin.right+this.margin.left;this.width=size;this.height=size;this.radius=this.width/2}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize(ctx,selected,hover);this.left=x-this.width/2;this.top=y-this.height/2;var borderWidth=values.borderWidth/this.body.view.scale;ctx.lineWidth=Math.min(this.width,borderWidth);ctx.strokeStyle=values.borderColor;ctx.fillStyle=values.color;ctx.database(x-this.width/2,y-this.height/2,this.width,this.height);this.enableShadow(ctx,values);ctx.fill();this.disableShadow(ctx,values);ctx.save();if(borderWidth>0){this.enableBorderDashes(ctx,values);ctx.stroke();this.disableBorderDashes(ctx,values)}ctx.restore();this.updateBoundingBox(x,y,ctx,selected,hover);this.labelModule.draw(ctx,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,selected,hover)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y,ctx,selected,hover){this.resize(ctx,selected,hover);this.left=x-this.width*.5;this.top=y-this.height*.5;this.boundingBox.left=this.left;this.boundingBox.top=this.top;this.boundingBox.bottom=this.top+this.height;this.boundingBox.right=this.left+this.width}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Database}(_NodeBase3["default"]);exports["default"]=Database},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _ShapeBase2=require("../util/ShapeBase");var _ShapeBase3=_interopRequireDefault(_ShapeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Diamond=function(_ShapeBase){(0,_inherits3["default"])(Diamond,_ShapeBase);function Diamond(options,body,labelModule){(0,_classCallCheck3["default"])(this,Diamond);return(0,_possibleConstructorReturn3["default"])(this,(Diamond.__proto__||(0,_getPrototypeOf2["default"])(Diamond)).call(this,options,body,labelModule))}(0,_createClass3["default"])(Diamond,[{key:"resize",value:function resize(ctx,values){var selected=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.selected;var hover=arguments.length>3&&arguments[3]!==undefined?arguments[3]:this.hover;this._resizeShape(selected,hover,values)}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this._drawShape(ctx,"diamond",4,x,y,selected,hover,values)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Diamond}(_ShapeBase3["default"]);exports["default"]=Diamond},{"../util/ShapeBase":69,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _ShapeBase2=require("../util/ShapeBase");var _ShapeBase3=_interopRequireDefault(_ShapeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Dot=function(_ShapeBase){(0,_inherits3["default"])(Dot,_ShapeBase);function Dot(options,body,labelModule){(0,_classCallCheck3["default"])(this,Dot);return(0,_possibleConstructorReturn3["default"])(this,(Dot.__proto__||(0,_getPrototypeOf2["default"])(Dot)).call(this,options,body,labelModule))}(0,_createClass3["default"])(Dot,[{key:"resize",value:function resize(ctx,values){var selected=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.selected;var hover=arguments.length>3&&arguments[3]!==undefined?arguments[3]:this.hover;this._resizeShape(selected,hover,values)}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this._drawShape(ctx,"circle",2,x,y,selected,hover,values)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){this.resize(ctx);return this.options.size}}]);return Dot}(_ShapeBase3["default"]);exports["default"]=Dot},{"../util/ShapeBase":69,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Ellipse=function(_NodeBase){(0,_inherits3["default"])(Ellipse,_NodeBase);function Ellipse(options,body,labelModule){(0,_classCallCheck3["default"])(this,Ellipse);return(0,_possibleConstructorReturn3["default"])(this,(Ellipse.__proto__||(0,_getPrototypeOf2["default"])(Ellipse)).call(this,options,body,labelModule))}(0,_createClass3["default"])(Ellipse,[{key:"resize",value:function resize(ctx){var selected=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.selected;var hover=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.hover;if(this.width===undefined||this.labelModule.differentState(selected,hover)){var textSize=this.labelModule.getTextSize(ctx,selected,hover);this.height=textSize.height*2;this.width=textSize.width+this.height;this.radius=.5*this.width}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize(ctx,selected,hover);this.left=x-this.width*.5;this.top=y-this.height*.5;var borderWidth=values.borderWidth/this.body.view.scale;ctx.lineWidth=Math.min(this.width,borderWidth);ctx.strokeStyle=values.borderColor;ctx.fillStyle=values.color;ctx.ellipse(this.left,this.top,this.width,this.height);this.enableShadow(ctx,values);ctx.fill();this.disableShadow(ctx,values);ctx.save();if(borderWidth>0){this.enableBorderDashes(ctx,values);ctx.stroke();this.disableBorderDashes(ctx,values)}ctx.restore();this.updateBoundingBox(x,y,ctx,selected,hover);this.labelModule.draw(ctx,x,y,selected,hover)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y,ctx,selected,hover){this.resize(ctx,selected,hover);this.left=x-this.width*.5;this.top=y-this.height*.5;this.boundingBox.left=this.left;this.boundingBox.top=this.top;this.boundingBox.bottom=this.top+this.height;this.boundingBox.right=this.left+this.width}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){this.resize(ctx);var a=this.width*.5;var b=this.height*.5;var w=Math.sin(angle)*a;var h=Math.cos(angle)*b;return a*b/Math.sqrt(w*w+h*h)}}]);return Ellipse}(_NodeBase3["default"]);exports["default"]=Ellipse},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Icon=function(_NodeBase){(0,_inherits3["default"])(Icon,_NodeBase);function Icon(options,body,labelModule){(0,_classCallCheck3["default"])(this,Icon);var _this=(0,_possibleConstructorReturn3["default"])(this,(Icon.__proto__||(0,_getPrototypeOf2["default"])(Icon)).call(this,options,body,labelModule));_this._setMargins(labelModule);return _this}(0,_createClass3["default"])(Icon,[{key:"resize",value:function resize(ctx,selected,hover){if(this.width===undefined||this.labelModule.differentState(selected,hover)){this.iconSize={width:Number(this.options.icon.size),height:Number(this.options.icon.size)};this.width=this.iconSize.width+this.margin.right+this.margin.left;this.height=this.iconSize.height+this.margin.top+this.margin.bottom;this.radius=.5*this.width}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize(ctx,selected,hover);this.options.icon.size=this.options.icon.size||50;this.left=x-this.width/2;this.top=y-this.height/2;this._icon(ctx,x,y,selected,hover,values);if(this.options.label!==undefined){var iconTextSpacing=5;this.labelModule.draw(ctx,this.left+this.iconSize.width/2+this.margin.left,y+this.height/2+iconTextSpacing,selected)}this.updateBoundingBox(x,y)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y){this.boundingBox.top=y-this.options.icon.size*.5;this.boundingBox.left=x-this.options.icon.size*.5;this.boundingBox.right=x+this.options.icon.size*.5;this.boundingBox.bottom=y+this.options.icon.size*.5;if(this.options.label!==undefined&&this.labelModule.size.width>0){var iconTextSpacing=5;this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left);this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width);this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+iconTextSpacing)}}},{key:"_icon",value:function _icon(ctx,x,y,selected,hover,values){var iconSize=Number(this.options.icon.size);if(this.options.icon.code!==undefined){ctx.font=(selected?"bold ":"")+iconSize+"px "+this.options.icon.face;ctx.fillStyle=this.options.icon.color||"black";ctx.textAlign="center";ctx.textBaseline="middle";this.enableShadow(ctx,values);ctx.fillText(this.options.icon.code,x,y);this.disableShadow(ctx,values)}else{console.error("When using the icon shape, you need to define the code in the icon options object. This can be done per node or globally.")}}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Icon}(_NodeBase3["default"]);exports["default"]=Icon},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _CircleImageBase2=require("../util/CircleImageBase");var _CircleImageBase3=_interopRequireDefault(_CircleImageBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Image=function(_CircleImageBase){(0,_inherits3["default"])(Image,_CircleImageBase);function Image(options,body,labelModule,imageObj){(0,_classCallCheck3["default"])(this,Image);var _this=(0,_possibleConstructorReturn3["default"])(this,(Image.__proto__||(0,_getPrototypeOf2["default"])(Image)).call(this,options,body,labelModule));_this.imageObj=imageObj;return _this}(0,_createClass3["default"])(Image,[{key:"resize",value:function resize(){this._resizeImage()}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize();this.left=x-this.width/2;this.top=y-this.height/2;if(this.options.shapeProperties.useBorderWithImage===true){var neutralborderWidth=this.options.borderWidth;var selectionLineWidth=this.options.borderWidthSelected||2*this.options.borderWidth;var borderWidth=(selected?selectionLineWidth:neutralborderWidth)/this.body.view.scale;ctx.lineWidth=Math.min(this.width,borderWidth);ctx.beginPath();ctx.strokeStyle=selected?this.options.color.highlight.border:hover?this.options.color.hover.border:this.options.color.border;ctx.fillStyle=selected?this.options.color.highlight.background:hover?this.options.color.hover.background:this.options.color.background;ctx.rect(this.left-.5*ctx.lineWidth,this.top-.5*ctx.lineWidth,this.width+ctx.lineWidth,this.height+ctx.lineWidth);ctx.fill();ctx.save();if(borderWidth>0){this.enableBorderDashes(ctx);ctx.stroke();this.disableBorderDashes(ctx)}ctx.restore();ctx.closePath()}this._drawImageAtPosition(ctx,values);this._drawImageLabel(ctx,x,y,selected,hover);this.updateBoundingBox(x,y)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y){this.resize();this.left=x-this.width/2;this.top=y-this.height/2;this.boundingBox.top=this.top;this.boundingBox.left=this.left;this.boundingBox.right=this.left+this.width;this.boundingBox.bottom=this.top+this.height;if(this.options.label!==undefined&&this.labelModule.size.width>0){this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left);this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width);this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Image}(_CircleImageBase3["default"]);exports["default"]=Image},{"../util/CircleImageBase":67,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _ShapeBase2=require("../util/ShapeBase");var _ShapeBase3=_interopRequireDefault(_ShapeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Square=function(_ShapeBase){(0,_inherits3["default"])(Square,_ShapeBase);function Square(options,body,labelModule){(0,_classCallCheck3["default"])(this,Square);return(0,_possibleConstructorReturn3["default"])(this,(Square.__proto__||(0,_getPrototypeOf2["default"])(Square)).call(this,options,body,labelModule))}(0,_createClass3["default"])(Square,[{key:"resize",value:function resize(){this._resizeShape()}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this._drawShape(ctx,"square",2,x,y,selected,hover,values)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Square}(_ShapeBase3["default"]);exports["default"]=Square},{"../util/ShapeBase":69,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _ShapeBase2=require("../util/ShapeBase");var _ShapeBase3=_interopRequireDefault(_ShapeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Star=function(_ShapeBase){(0,_inherits3["default"])(Star,_ShapeBase);function Star(options,body,labelModule){(0,_classCallCheck3["default"])(this,Star);return(0,_possibleConstructorReturn3["default"])(this,(Star.__proto__||(0,_getPrototypeOf2["default"])(Star)).call(this,options,body,labelModule))}(0,_createClass3["default"])(Star,[{key:"resize",value:function resize(ctx,values,selected,hover){this._resizeShape(selected,hover,values)}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this._drawShape(ctx,"star",4,x,y,selected,hover,values)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Star}(_ShapeBase3["default"]);exports["default"]=Star},{"../util/ShapeBase":69,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Text=function(_NodeBase){(0,_inherits3["default"])(Text,_NodeBase);function Text(options,body,labelModule){(0,_classCallCheck3["default"])(this,Text);var _this=(0,_possibleConstructorReturn3["default"])(this,(Text.__proto__||(0,_getPrototypeOf2["default"])(Text)).call(this,options,body,labelModule));_this._setMargins(labelModule);return _this}(0,_createClass3["default"])(Text,[{key:"resize",value:function resize(ctx,selected,hover){if(this.width===undefined||this.labelModule.differentState(selected,hover)){this.textSize=this.labelModule.getTextSize(ctx,selected,hover);this.width=this.textSize.width+this.margin.right+this.margin.left;this.height=this.textSize.height+this.margin.top+this.margin.bottom;this.radius=.5*this.width}}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this.resize(ctx,selected,hover);this.left=x-this.width/2;this.top=y-this.height/2;this.enableShadow(ctx,values);this.labelModule.draw(ctx,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,selected,hover);
this.disableShadow(ctx,values);this.updateBoundingBox(x,y,ctx,selected,hover)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y,ctx,selected,hover){this.resize(ctx,selected,hover);this.left=x-this.width/2;this.top=y-this.height/2;this.boundingBox.top=this.top;this.boundingBox.left=this.left;this.boundingBox.right=this.left+this.width;this.boundingBox.bottom=this.top+this.height}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Text}(_NodeBase3["default"]);exports["default"]=Text},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _ShapeBase2=require("../util/ShapeBase");var _ShapeBase3=_interopRequireDefault(_ShapeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Triangle=function(_ShapeBase){(0,_inherits3["default"])(Triangle,_ShapeBase);function Triangle(options,body,labelModule){(0,_classCallCheck3["default"])(this,Triangle);return(0,_possibleConstructorReturn3["default"])(this,(Triangle.__proto__||(0,_getPrototypeOf2["default"])(Triangle)).call(this,options,body,labelModule))}(0,_createClass3["default"])(Triangle,[{key:"resize",value:function resize(ctx){this._resizeShape()}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this._drawShape(ctx,"triangle",3,x,y,selected,hover,values)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return Triangle}(_ShapeBase3["default"]);exports["default"]=Triangle},{"../util/ShapeBase":69,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _ShapeBase2=require("../util/ShapeBase");var _ShapeBase3=_interopRequireDefault(_ShapeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TriangleDown=function(_ShapeBase){(0,_inherits3["default"])(TriangleDown,_ShapeBase);function TriangleDown(options,body,labelModule){(0,_classCallCheck3["default"])(this,TriangleDown);return(0,_possibleConstructorReturn3["default"])(this,(TriangleDown.__proto__||(0,_getPrototypeOf2["default"])(TriangleDown)).call(this,options,body,labelModule))}(0,_createClass3["default"])(TriangleDown,[{key:"resize",value:function resize(ctx){this._resizeShape()}},{key:"draw",value:function draw(ctx,x,y,selected,hover,values){this._drawShape(ctx,"triangleDown",3,x,y,selected,hover,values)}},{key:"distanceToBorder",value:function distanceToBorder(ctx,angle){return this._distanceToBorder(ctx,angle)}}]);return TriangleDown}(_ShapeBase3["default"]);exports["default"]=TriangleDown},{"../util/ShapeBase":69,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CircleImageBase=function(_NodeBase){(0,_inherits3["default"])(CircleImageBase,_NodeBase);function CircleImageBase(options,body,labelModule){(0,_classCallCheck3["default"])(this,CircleImageBase);var _this=(0,_possibleConstructorReturn3["default"])(this,(CircleImageBase.__proto__||(0,_getPrototypeOf2["default"])(CircleImageBase)).call(this,options,body,labelModule));_this.labelOffset=0;_this.imageLoaded=false;return _this}(0,_createClass3["default"])(CircleImageBase,[{key:"setOptions",value:function setOptions(options,imageObj){this.options=options;if(imageObj){this.imageObj=imageObj}}},{key:"_resizeImage",value:function _resizeImage(){var force=false;if(!this.imageObj.width||!this.imageObj.height){this.imageLoaded=false}else if(this.imageLoaded===false){this.imageLoaded=true;force=true}if(!this.width||!this.height||force===true){var width,height,ratio;if(this.imageObj.width&&this.imageObj.height){width=0;height=0}if(this.options.shapeProperties.useImageSize===false){if(this.imageObj.width>this.imageObj.height){ratio=this.imageObj.width/this.imageObj.height;width=this.options.size*2*ratio||this.imageObj.width;height=this.options.size*2||this.imageObj.height}else{if(this.imageObj.width&&this.imageObj.height){ratio=this.imageObj.height/this.imageObj.width}else{ratio=1}width=this.options.size*2;height=this.options.size*2*ratio}}else{width=this.imageObj.width;height=this.imageObj.height}this.width=width;this.height=height;this.radius=.5*this.width}}},{key:"_drawRawCircle",value:function _drawRawCircle(ctx,x,y,selected,hover,values){var borderWidth=values.borderWidth/this.body.view.scale;ctx.lineWidth=Math.min(this.width,borderWidth);ctx.strokeStyle=values.borderColor;ctx.fillStyle=values.color;ctx.circle(x,y,values.size);this.enableShadow(ctx,values);ctx.fill();this.disableShadow(ctx,values);ctx.save();if(borderWidth>0){this.enableBorderDashes(ctx,values);ctx.stroke();this.disableBorderDashes(ctx,values)}ctx.restore()}},{key:"_drawImageAtPosition",value:function _drawImageAtPosition(ctx,values){if(this.imageObj.width!=0){ctx.globalAlpha=1;this.enableShadow(ctx,values);var factor=this.imageObj.width/this.width/this.body.view.scale;if(factor>2&&this.options.shapeProperties.interpolation===true){var w=this.imageObj.width;var h=this.imageObj.height;var can2=document.createElement("canvas");can2.width=w;can2.height=w;var ctx2=can2.getContext("2d");factor*=.5;w*=.5;h*=.5;ctx2.drawImage(this.imageObj,0,0,w,h);var distance=0;var iterations=1;while(factor>2&&iterations<4){ctx2.drawImage(can2,distance,0,w,h,distance+w,0,w/2,h/2);distance+=w;factor*=.5;w*=.5;h*=.5;iterations+=1}ctx.drawImage(can2,distance,0,w,h,this.left,this.top,this.width,this.height)}else{ctx.drawImage(this.imageObj,this.left,this.top,this.width,this.height)}this.disableShadow(ctx,values)}}},{key:"_drawImageLabel",value:function _drawImageLabel(ctx,x,y,selected,hover){var yLabel;var offset=0;if(this.height!==undefined){offset=this.height*.5;var labelDimensions=this.labelModule.getTextSize(ctx,selected,hover);if(labelDimensions.lineCount>=1){offset+=labelDimensions.height/2}}yLabel=y+offset;if(this.options.label){this.labelOffset=offset}this.labelModule.draw(ctx,x,yLabel,selected,hover,"hanging")}}]);return CircleImageBase}(_NodeBase3["default"]);exports["default"]=CircleImageBase},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var NodeBase=function(){function NodeBase(options,body,labelModule){(0,_classCallCheck3["default"])(this,NodeBase);this.body=body;this.labelModule=labelModule;this.setOptions(options);this.top=undefined;this.left=undefined;this.height=undefined;this.width=undefined;this.radius=undefined;this.margin=undefined;this.boundingBox={top:0,left:0,right:0,bottom:0}}(0,_createClass3["default"])(NodeBase,[{key:"setOptions",value:function setOptions(options){this.options=options}},{key:"_setMargins",value:function _setMargins(labelModule){this.margin={};if(this.options.margin){if((0,_typeof3["default"])(this.options.margin)=="object"){this.margin.top=this.options.margin.top;this.margin.right=this.options.margin.right;this.margin.bottom=this.options.margin.bottom;this.margin.left=this.options.margin.left}else{this.margin.top=this.options.margin;this.margin.right=this.options.margin;this.margin.bottom=this.options.margin;this.margin.left=this.options.margin}}labelModule.adjustSizes(this.margin)}},{key:"_distanceToBorder",value:function _distanceToBorder(ctx,angle){var borderWidth=this.options.borderWidth;this.resize(ctx);return Math.min(Math.abs(this.width/2/Math.cos(angle)),Math.abs(this.height/2/Math.sin(angle)))+borderWidth}},{key:"enableShadow",value:function enableShadow(ctx,values){if(values.shadow){ctx.shadowColor=values.shadowColor;ctx.shadowBlur=values.shadowSize;ctx.shadowOffsetX=values.shadowX;ctx.shadowOffsetY=values.shadowY}}},{key:"disableShadow",value:function disableShadow(ctx,values){if(values.shadow){ctx.shadowColor="rgba(0,0,0,0)";ctx.shadowBlur=0;ctx.shadowOffsetX=0;ctx.shadowOffsetY=0}}},{key:"enableBorderDashes",value:function enableBorderDashes(ctx,values){if(values.borderDashes!==false){if(ctx.setLineDash!==undefined){var dashes=values.borderDashes;if(dashes===true){dashes=[5,15]}ctx.setLineDash(dashes)}else{console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used.");this.options.shapeProperties.borderDashes=false;values.borderDashes=false}}}},{key:"disableBorderDashes",value:function disableBorderDashes(ctx,values){if(values.borderDashes!==false){if(ctx.setLineDash!==undefined){ctx.setLineDash([0])}else{console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used.");this.options.shapeProperties.borderDashes=false;values.borderDashes=false}}}}]);return NodeBase}();exports["default"]=NodeBase},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _NodeBase2=require("../util/NodeBase");var _NodeBase3=_interopRequireDefault(_NodeBase2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ShapeBase=function(_NodeBase){(0,_inherits3["default"])(ShapeBase,_NodeBase);function ShapeBase(options,body,labelModule){(0,_classCallCheck3["default"])(this,ShapeBase);return(0,_possibleConstructorReturn3["default"])(this,(ShapeBase.__proto__||(0,_getPrototypeOf2["default"])(ShapeBase)).call(this,options,body,labelModule))}(0,_createClass3["default"])(ShapeBase,[{key:"_resizeShape",value:function _resizeShape(){var selected=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.selected;var hover=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.hover;var values=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{size:this.options.size};if(this.width===undefined||this.labelModule.differentState(selected,hover)){var size=2*values.size;this.width=size;this.height=size;this.radius=.5*this.width}}},{key:"_drawShape",value:function _drawShape(ctx,shape,sizeMultiplier,x,y,selected,hover,values){this._resizeShape(selected,hover,values);this.left=x-this.width/2;this.top=y-this.height/2;var borderWidth=values.borderWidth/this.body.view.scale;ctx.lineWidth=Math.min(this.width,borderWidth);ctx.strokeStyle=values.borderColor;ctx.fillStyle=values.color;ctx[shape](x,y,values.size);this.enableShadow(ctx,values);ctx.fill();this.disableShadow(ctx,values);ctx.save();if(borderWidth>0){this.enableBorderDashes(ctx,values);ctx.stroke();this.disableBorderDashes(ctx,values)}ctx.restore();if(this.options.label!==undefined){var yLabel=y+.5*this.height+3;this.labelModule.draw(ctx,x,yLabel,selected,hover,"hanging")}this.updateBoundingBox(x,y)}},{key:"updateBoundingBox",value:function updateBoundingBox(x,y){this.boundingBox.top=y-this.options.size;this.boundingBox.left=x-this.options.size;this.boundingBox.right=x+this.options.size;this.boundingBox.bottom=y+this.options.size;if(this.options.label!==undefined&&this.labelModule.size.width>0){this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left);this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width);this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+3)}}}]);return ShapeBase}(_NodeBase3["default"]);exports["default"]=ShapeBase},{"../util/NodeBase":68,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BarnesHutSolver=function(){function BarnesHutSolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,BarnesHutSolver);this.body=body;this.physicsBody=physicsBody;this.barnesHutTree;this.setOptions(options);this.randomSeed=5}(0,_createClass3["default"])(BarnesHutSolver,[{key:"setOptions",value:function setOptions(options){this.options=options;this.thetaInversed=1/this.options.theta;this.overlapAvoidanceFactor=1-Math.max(0,Math.min(1,this.options.avoidOverlap))}},{key:"seededRandom",value:function seededRandom(){var x=Math.sin(this.randomSeed++)*1e4;return x-Math.floor(x)}},{key:"solve",value:function solve(){if(this.options.gravitationalConstant!==0&&this.physicsBody.physicsNodeIndices.length>0){var node=void 0;var nodes=this.body.nodes;var nodeIndices=this.physicsBody.physicsNodeIndices;var nodeCount=nodeIndices.length;var barnesHutTree=this._formBarnesHutTree(nodes,nodeIndices);this.barnesHutTree=barnesHutTree;for(var i=0;i<nodeCount;i++){node=nodes[nodeIndices[i]];if(node.options.mass>0){this._getForceContribution(barnesHutTree.root.children.NW,node);this._getForceContribution(barnesHutTree.root.children.NE,node);this._getForceContribution(barnesHutTree.root.children.SW,node);this._getForceContribution(barnesHutTree.root.children.SE,node)}}}}},{key:"_getForceContribution",value:function _getForceContribution(parentBranch,node){if(parentBranch.childrenCount>0){var dx=void 0,dy=void 0,distance=void 0;dx=parentBranch.centerOfMass.x-node.x;dy=parentBranch.centerOfMass.y-node.y;distance=Math.sqrt(dx*dx+dy*dy);if(distance*parentBranch.calcSize>this.thetaInversed){this._calculateForces(distance,dx,dy,node,parentBranch)}else{if(parentBranch.childrenCount===4){this._getForceContribution(parentBranch.children.NW,node);this._getForceContribution(parentBranch.children.NE,node);this._getForceContribution(parentBranch.children.SW,node);this._getForceContribution(parentBranch.children.SE,node)}else{if(parentBranch.children.data.id!=node.id){this._calculateForces(distance,dx,dy,node,parentBranch)}}}}}},{key:"_calculateForces",value:function _calculateForces(distance,dx,dy,node,parentBranch){if(distance===0){distance=.1;dx=distance}if(this.overlapAvoidanceFactor<1&&node.shape.radius){distance=Math.max(.1+this.overlapAvoidanceFactor*node.shape.radius,distance-node.shape.radius)}var gravityForce=this.options.gravitationalConstant*parentBranch.mass*node.options.mass/Math.pow(distance,3);var fx=dx*gravityForce;var fy=dy*gravityForce;this.physicsBody.forces[node.id].x+=fx;this.physicsBody.forces[node.id].y+=fy}},{key:"_formBarnesHutTree",value:function _formBarnesHutTree(nodes,nodeIndices){var node=void 0;var nodeCount=nodeIndices.length;var minX=nodes[nodeIndices[0]].x;var minY=nodes[nodeIndices[0]].y;var maxX=nodes[nodeIndices[0]].x;var maxY=nodes[nodeIndices[0]].y;for(var i=1;i<nodeCount;i++){var x=nodes[nodeIndices[i]].x;var y=nodes[nodeIndices[i]].y;if(nodes[nodeIndices[i]].options.mass>0){if(x<minX){minX=x}if(x>maxX){maxX=x}if(y<minY){minY=y}if(y>maxY){maxY=y}}}var sizeDiff=Math.abs(maxX-minX)-Math.abs(maxY-minY);if(sizeDiff>0){minY-=.5*sizeDiff;maxY+=.5*sizeDiff}else{minX+=.5*sizeDiff;maxX-=.5*sizeDiff}var minimumTreeSize=1e-5;var rootSize=Math.max(minimumTreeSize,Math.abs(maxX-minX));var halfRootSize=.5*rootSize;var centerX=.5*(minX+maxX),centerY=.5*(minY+maxY);var barnesHutTree={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:centerX-halfRootSize,maxX:centerX+halfRootSize,minY:centerY-halfRootSize,maxY:centerY+halfRootSize},size:rootSize,calcSize:1/rootSize,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(barnesHutTree.root);for(var _i=0;_i<nodeCount;_i++){node=nodes[nodeIndices[_i]];if(node.options.mass>0){this._placeInTree(barnesHutTree.root,node)}}return barnesHutTree}},{key:"_updateBranchMass",value:function _updateBranchMass(parentBranch,node){var totalMass=parentBranch.mass+node.options.mass;var totalMassInv=1/totalMass;parentBranch.centerOfMass.x=parentBranch.centerOfMass.x*parentBranch.mass+node.x*node.options.mass;parentBranch.centerOfMass.x*=totalMassInv;parentBranch.centerOfMass.y=parentBranch.centerOfMass.y*parentBranch.mass+node.y*node.options.mass;parentBranch.centerOfMass.y*=totalMassInv;parentBranch.mass=totalMass;var biggestSize=Math.max(Math.max(node.height,node.radius),node.width);parentBranch.maxWidth=parentBranch.maxWidth<biggestSize?biggestSize:parentBranch.maxWidth}},{key:"_placeInTree",value:function _placeInTree(parentBranch,node,skipMassUpdate){if(skipMassUpdate!=true||skipMassUpdate===undefined){this._updateBranchMass(parentBranch,node)}if(parentBranch.children.NW.range.maxX>node.x){if(parentBranch.children.NW.range.maxY>node.y){this._placeInRegion(parentBranch,node,"NW")}else{this._placeInRegion(parentBranch,node,"SW")}}else{if(parentBranch.children.NW.range.maxY>node.y){this._placeInRegion(parentBranch,node,"NE")}else{this._placeInRegion(parentBranch,node,"SE")}}}},{key:"_placeInRegion",value:function _placeInRegion(parentBranch,node,region){switch(parentBranch.children[region].childrenCount){case 0:parentBranch.children[region].children.data=node;parentBranch.children[region].childrenCount=1;this._updateBranchMass(parentBranch.children[region],node);break;case 1:if(parentBranch.children[region].children.data.x===node.x&&parentBranch.children[region].children.data.y===node.y){node.x+=this.seededRandom();node.y+=this.seededRandom()}else{this._splitBranch(parentBranch.children[region]);this._placeInTree(parentBranch.children[region],node)}break;case 4:this._placeInTree(parentBranch.children[region],node);break}}},{key:"_splitBranch",value:function _splitBranch(parentBranch){var containedNode=null;if(parentBranch.childrenCount===1){containedNode=parentBranch.children.data;parentBranch.mass=0;parentBranch.centerOfMass.x=0;parentBranch.centerOfMass.y=0}parentBranch.childrenCount=4;parentBranch.children.data=null;this._insertRegion(parentBranch,"NW");this._insertRegion(parentBranch,"NE");this._insertRegion(parentBranch,"SW");this._insertRegion(parentBranch,"SE");if(containedNode!=null){this._placeInTree(parentBranch,containedNode)}}},{key:"_insertRegion",value:function _insertRegion(parentBranch,region){var minX=void 0,maxX=void 0,minY=void 0,maxY=void 0;var childSize=.5*parentBranch.size;switch(region){case"NW":minX=parentBranch.range.minX;maxX=parentBranch.range.minX+childSize;minY=parentBranch.range.minY;maxY=parentBranch.range.minY+childSize;break;case"NE":minX=parentBranch.range.minX+childSize;maxX=parentBranch.range.maxX;minY=parentBranch.range.minY;maxY=parentBranch.range.minY+childSize;break;case"SW":minX=parentBranch.range.minX;maxX=parentBranch.range.minX+childSize;minY=parentBranch.range.minY+childSize;maxY=parentBranch.range.maxY;break;case"SE":minX=parentBranch.range.minX+childSize;maxX=parentBranch.range.maxX;minY=parentBranch.range.minY+childSize;maxY=parentBranch.range.maxY;break}parentBranch.children[region]={centerOfMass:{x:0,y:0},mass:0,range:{minX:minX,maxX:maxX,minY:minY,maxY:maxY},size:.5*parentBranch.size,calcSize:2*parentBranch.calcSize,children:{data:null},maxWidth:0,level:parentBranch.level+1,childrenCount:0}}},{key:"_debug",value:function _debug(ctx,color){if(this.barnesHutTree!==undefined){ctx.lineWidth=1;this._drawBranch(this.barnesHutTree.root,ctx,color)}}},{key:"_drawBranch",value:function _drawBranch(branch,ctx,color){if(color===undefined){color="#FF0000"}if(branch.childrenCount===4){this._drawBranch(branch.children.NW,ctx);this._drawBranch(branch.children.NE,ctx);this._drawBranch(branch.children.SE,ctx);this._drawBranch(branch.children.SW,ctx)}ctx.strokeStyle=color;ctx.beginPath();ctx.moveTo(branch.range.minX,branch.range.minY);ctx.lineTo(branch.range.maxX,branch.range.minY);ctx.stroke();ctx.beginPath();ctx.moveTo(branch.range.maxX,branch.range.minY);ctx.lineTo(branch.range.maxX,branch.range.maxY);ctx.stroke();ctx.beginPath();ctx.moveTo(branch.range.maxX,branch.range.maxY);ctx.lineTo(branch.range.minX,branch.range.maxY);ctx.stroke();ctx.beginPath();ctx.moveTo(branch.range.minX,branch.range.maxY);ctx.lineTo(branch.range.minX,branch.range.minY);ctx.stroke()}}]);return BarnesHutSolver}();exports["default"]=BarnesHutSolver},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CentralGravitySolver=function(){function CentralGravitySolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,CentralGravitySolver);this.body=body;this.physicsBody=physicsBody;this.setOptions(options)}(0,_createClass3["default"])(CentralGravitySolver,[{key:"setOptions",value:function setOptions(options){this.options=options}},{key:"solve",value:function solve(){var dx=void 0,dy=void 0,distance=void 0,node=void 0;var nodes=this.body.nodes;var nodeIndices=this.physicsBody.physicsNodeIndices;var forces=this.physicsBody.forces;for(var i=0;i<nodeIndices.length;i++){var nodeId=nodeIndices[i];node=nodes[nodeId];dx=-node.x;dy=-node.y;distance=Math.sqrt(dx*dx+dy*dy);this._calculateForces(distance,dx,dy,forces,node)}}},{key:"_calculateForces",value:function _calculateForces(distance,dx,dy,forces,node){var gravityForce=distance===0?0:this.options.centralGravity/distance;forces[node.id].x=dx*gravityForce;forces[node.id].y=dy*gravityForce}}]);return CentralGravitySolver}();exports["default"]=CentralGravitySolver},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _CentralGravitySolver2=require("./CentralGravitySolver");var _CentralGravitySolver3=_interopRequireDefault(_CentralGravitySolver2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ForceAtlas2BasedCentralGravitySolver=function(_CentralGravitySolver){(0,_inherits3["default"])(ForceAtlas2BasedCentralGravitySolver,_CentralGravitySolver);function ForceAtlas2BasedCentralGravitySolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,ForceAtlas2BasedCentralGravitySolver);return(0,_possibleConstructorReturn3["default"])(this,(ForceAtlas2BasedCentralGravitySolver.__proto__||(0,_getPrototypeOf2["default"])(ForceAtlas2BasedCentralGravitySolver)).call(this,body,physicsBody,options))}(0,_createClass3["default"])(ForceAtlas2BasedCentralGravitySolver,[{key:"_calculateForces",value:function _calculateForces(distance,dx,dy,forces,node){if(distance>0){var degree=node.edges.length+1;var gravityForce=this.options.centralGravity*degree*node.options.mass;forces[node.id].x=dx*gravityForce;forces[node.id].y=dy*gravityForce}}}]);return ForceAtlas2BasedCentralGravitySolver}(_CentralGravitySolver3["default"]);exports["default"]=ForceAtlas2BasedCentralGravitySolver},{"./CentralGravitySolver":71,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of");var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn");var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require("babel-runtime/helpers/inherits");var _inherits3=_interopRequireDefault(_inherits2);var _BarnesHutSolver2=require("./BarnesHutSolver");var _BarnesHutSolver3=_interopRequireDefault(_BarnesHutSolver2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ForceAtlas2BasedRepulsionSolver=function(_BarnesHutSolver){(0,_inherits3["default"])(ForceAtlas2BasedRepulsionSolver,_BarnesHutSolver);function ForceAtlas2BasedRepulsionSolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,ForceAtlas2BasedRepulsionSolver);return(0,_possibleConstructorReturn3["default"])(this,(ForceAtlas2BasedRepulsionSolver.__proto__||(0,_getPrototypeOf2["default"])(ForceAtlas2BasedRepulsionSolver)).call(this,body,physicsBody,options))}(0,_createClass3["default"])(ForceAtlas2BasedRepulsionSolver,[{key:"_calculateForces",value:function _calculateForces(distance,dx,dy,node,parentBranch){if(distance===0){distance=.1*Math.random();dx=distance}if(this.overlapAvoidanceFactor<1&&node.shape.radius){distance=Math.max(.1+this.overlapAvoidanceFactor*node.shape.radius,distance-node.shape.radius)}var degree=node.edges.length+1;var gravityForce=this.options.gravitationalConstant*parentBranch.mass*node.options.mass*degree/Math.pow(distance,2);var fx=dx*gravityForce;var fy=dy*gravityForce;this.physicsBody.forces[node.id].x+=fx;this.physicsBody.forces[node.id].y+=fy}}]);return ForceAtlas2BasedRepulsionSolver}(_BarnesHutSolver3["default"]);exports["default"]=ForceAtlas2BasedRepulsionSolver},{"./BarnesHutSolver":70,"babel-runtime/core-js/object/get-prototype-of":123,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/inherits":130,"babel-runtime/helpers/possibleConstructorReturn":131}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HierarchicalRepulsionSolver=function(){function HierarchicalRepulsionSolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,HierarchicalRepulsionSolver);this.body=body;this.physicsBody=physicsBody;this.setOptions(options)}(0,_createClass3["default"])(HierarchicalRepulsionSolver,[{key:"setOptions",value:function setOptions(options){this.options=options}},{key:"solve",value:function solve(){var dx,dy,distance,fx,fy,repulsingForce,node1,node2,i,j;var nodes=this.body.nodes;var nodeIndices=this.physicsBody.physicsNodeIndices;var forces=this.physicsBody.forces;var nodeDistance=this.options.nodeDistance;for(i=0;i<nodeIndices.length-1;i++){node1=nodes[nodeIndices[i]];for(j=i+1;j<nodeIndices.length;j++){node2=nodes[nodeIndices[j]];if(node1.level===node2.level){dx=node2.x-node1.x;dy=node2.y-node1.y;distance=Math.sqrt(dx*dx+dy*dy);
var steepness=.05;if(distance<nodeDistance){repulsingForce=-Math.pow(steepness*distance,2)+Math.pow(steepness*nodeDistance,2)}else{repulsingForce=0}if(distance===0){distance=.01}else{repulsingForce=repulsingForce/distance}fx=dx*repulsingForce;fy=dy*repulsingForce;forces[node1.id].x-=fx;forces[node1.id].y-=fy;forces[node2.id].x+=fx;forces[node2.id].y+=fy}}}}}]);return HierarchicalRepulsionSolver}();exports["default"]=HierarchicalRepulsionSolver},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HierarchicalSpringSolver=function(){function HierarchicalSpringSolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,HierarchicalSpringSolver);this.body=body;this.physicsBody=physicsBody;this.setOptions(options)}(0,_createClass3["default"])(HierarchicalSpringSolver,[{key:"setOptions",value:function setOptions(options){this.options=options}},{key:"solve",value:function solve(){var edgeLength,edge;var dx,dy,fx,fy,springForce,distance;var edges=this.body.edges;var factor=.5;var edgeIndices=this.physicsBody.physicsEdgeIndices;var nodeIndices=this.physicsBody.physicsNodeIndices;var forces=this.physicsBody.forces;for(var i=0;i<nodeIndices.length;i++){var nodeId=nodeIndices[i];forces[nodeId].springFx=0;forces[nodeId].springFy=0}for(var _i=0;_i<edgeIndices.length;_i++){edge=edges[edgeIndices[_i]];if(edge.connected===true){edgeLength=edge.options.length===undefined?this.options.springLength:edge.options.length;dx=edge.from.x-edge.to.x;dy=edge.from.y-edge.to.y;distance=Math.sqrt(dx*dx+dy*dy);distance=distance===0?.01:distance;springForce=this.options.springConstant*(edgeLength-distance)/distance;fx=dx*springForce;fy=dy*springForce;if(edge.to.level!=edge.from.level){if(forces[edge.toId]!==undefined){forces[edge.toId].springFx-=fx;forces[edge.toId].springFy-=fy}if(forces[edge.fromId]!==undefined){forces[edge.fromId].springFx+=fx;forces[edge.fromId].springFy+=fy}}else{if(forces[edge.toId]!==undefined){forces[edge.toId].x-=factor*fx;forces[edge.toId].y-=factor*fy}if(forces[edge.fromId]!==undefined){forces[edge.fromId].x+=factor*fx;forces[edge.fromId].y+=factor*fy}}}}var springForce=1;var springFx,springFy;for(var _i2=0;_i2<nodeIndices.length;_i2++){var _nodeId=nodeIndices[_i2];springFx=Math.min(springForce,Math.max(-springForce,forces[_nodeId].springFx));springFy=Math.min(springForce,Math.max(-springForce,forces[_nodeId].springFy));forces[_nodeId].x+=springFx;forces[_nodeId].y+=springFy}var totalFx=0;var totalFy=0;for(var _i3=0;_i3<nodeIndices.length;_i3++){var _nodeId2=nodeIndices[_i3];totalFx+=forces[_nodeId2].x;totalFy+=forces[_nodeId2].y}var correctionFx=totalFx/nodeIndices.length;var correctionFy=totalFy/nodeIndices.length;for(var _i4=0;_i4<nodeIndices.length;_i4++){var _nodeId3=nodeIndices[_i4];forces[_nodeId3].x-=correctionFx;forces[_nodeId3].y-=correctionFy}}}]);return HierarchicalSpringSolver}();exports["default"]=HierarchicalSpringSolver},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RepulsionSolver=function(){function RepulsionSolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,RepulsionSolver);this.body=body;this.physicsBody=physicsBody;this.setOptions(options)}(0,_createClass3["default"])(RepulsionSolver,[{key:"setOptions",value:function setOptions(options){this.options=options}},{key:"solve",value:function solve(){var dx,dy,distance,fx,fy,repulsingForce,node1,node2;var nodes=this.body.nodes;var nodeIndices=this.physicsBody.physicsNodeIndices;var forces=this.physicsBody.forces;var nodeDistance=this.options.nodeDistance;var a=-2/3/nodeDistance;var b=4/3;for(var i=0;i<nodeIndices.length-1;i++){node1=nodes[nodeIndices[i]];for(var j=i+1;j<nodeIndices.length;j++){node2=nodes[nodeIndices[j]];dx=node2.x-node1.x;dy=node2.y-node1.y;distance=Math.sqrt(dx*dx+dy*dy);if(distance===0){distance=.1*Math.random();dx=distance}if(distance<2*nodeDistance){if(distance<.5*nodeDistance){repulsingForce=1}else{repulsingForce=a*distance+b}repulsingForce=repulsingForce/distance;fx=dx*repulsingForce;fy=dy*repulsingForce;forces[node1.id].x-=fx;forces[node1.id].y-=fy;forces[node2.id].x+=fx;forces[node2.id].y+=fy}}}}}]);return RepulsionSolver}();exports["default"]=RepulsionSolver},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SpringSolver=function(){function SpringSolver(body,physicsBody,options){(0,_classCallCheck3["default"])(this,SpringSolver);this.body=body;this.physicsBody=physicsBody;this.setOptions(options)}(0,_createClass3["default"])(SpringSolver,[{key:"setOptions",value:function setOptions(options){this.options=options}},{key:"solve",value:function solve(){var edgeLength=void 0,edge=void 0;var edgeIndices=this.physicsBody.physicsEdgeIndices;var edges=this.body.edges;var node1=void 0,node2=void 0,node3=void 0;for(var i=0;i<edgeIndices.length;i++){edge=edges[edgeIndices[i]];if(edge.connected===true&&edge.toId!==edge.fromId){if(this.body.nodes[edge.toId]!==undefined&&this.body.nodes[edge.fromId]!==undefined){if(edge.edgeType.via!==undefined){edgeLength=edge.options.length===undefined?this.options.springLength:edge.options.length;node1=edge.to;node2=edge.edgeType.via;node3=edge.from;this._calculateSpringForce(node1,node2,.5*edgeLength);this._calculateSpringForce(node2,node3,.5*edgeLength)}else{edgeLength=edge.options.length===undefined?this.options.springLength*1.5:edge.options.length;this._calculateSpringForce(edge.from,edge.to,edgeLength)}}}}}},{key:"_calculateSpringForce",value:function _calculateSpringForce(node1,node2,edgeLength){var dx=node1.x-node2.x;var dy=node1.y-node2.y;var distance=Math.max(Math.sqrt(dx*dx+dy*dy),.01);var springForce=this.options.springConstant*(edgeLength-distance)/distance;var fx=dx*springForce;var fy=dy*springForce;if(this.physicsBody.forces[node1.id]!==undefined){this.physicsBody.forces[node1.id].x+=fx;this.physicsBody.forces[node1.id].y+=fy}if(this.physicsBody.forces[node2.id]!==undefined){this.physicsBody.forces[node2.id].x-=fx;this.physicsBody.forces[node2.id].y-=fy}}}]);return SpringSolver}();exports["default"]=SpringSolver},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray2=require("babel-runtime/helpers/slicedToArray");var _slicedToArray3=_interopRequireDefault(_slicedToArray2);var _getIterator2=require("babel-runtime/core-js/get-iterator");var _getIterator3=_interopRequireDefault(_getIterator2);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../../../util");var Label=function(){function Label(body,options){var edgelabel=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;(0,_classCallCheck3["default"])(this,Label);this.body=body;this.pointToSelf=false;this.baseSize=undefined;this.fontOptions={};this.setOptions(options);this.size={top:0,left:0,width:0,height:0,yLine:0};this.isEdgeLabel=edgelabel}(0,_createClass3["default"])(Label,[{key:"setOptions",value:function setOptions(options){var allowDeletion=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.elementOptions=options;this.fontOptions=util.deepExtend({},options.font,true);if(options.label!==undefined){this.labelDirty=true}if(options.font!==undefined){Label.parseOptions(this.fontOptions,options,allowDeletion);if(typeof options.font==="string"){this.baseSize=this.fontOptions.size}else if((0,_typeof3["default"])(options.font)==="object"){if(options.font.size!==undefined){this.baseSize=options.font.size}}}}},{key:"constrain",value:function constrain(elementOptions,options,defaultOptions){this.fontOptions.constrainWidth=false;this.fontOptions.maxWdt=-1;this.fontOptions.minWdt=-1;var pile=[options,elementOptions,defaultOptions];var widthConstraint=util.topMost(pile,"widthConstraint");if(typeof widthConstraint==="number"){this.fontOptions.maxWdt=Number(widthConstraint);this.fontOptions.minWdt=Number(widthConstraint)}else if((typeof widthConstraint==="undefined"?"undefined":(0,_typeof3["default"])(widthConstraint))==="object"){var widthConstraintMaximum=util.topMost(pile,["widthConstraint","maximum"]);if(typeof widthConstraintMaximum==="number"){this.fontOptions.maxWdt=Number(widthConstraintMaximum)}var widthConstraintMinimum=util.topMost(pile,["widthConstraint","minimum"]);if(typeof widthConstraintMinimum==="number"){this.fontOptions.minWdt=Number(widthConstraintMinimum)}}this.fontOptions.constrainHeight=false;this.fontOptions.minHgt=-1;this.fontOptions.valign="middle";var heightConstraint=util.topMost(pile,"heightConstraint");if(typeof heightConstraint==="number"){this.fontOptions.minHgt=Number(heightConstraint)}else if((typeof heightConstraint==="undefined"?"undefined":(0,_typeof3["default"])(heightConstraint))==="object"){var heightConstraintMinimum=util.topMost(pile,["heightConstraint","minimum"]);if(typeof heightConstraintMinimum==="number"){this.fontOptions.minHgt=Number(heightConstraintMinimum)}var heightConstraintValign=util.topMost(pile,["heightConstraint","valign"]);if(typeof heightConstraintValign==="string"){if(heightConstraintValign==="top"||heightConstraintValign==="bottom"){this.fontOptions.valign=heightConstraintValign}}}}},{key:"choosify",value:function choosify(elementOptions,options,defaultOptions){this.fontOptions.chooser=true;var pile=[options,elementOptions,defaultOptions];var chosen=util.topMost(pile,"chosen");if(typeof chosen==="boolean"){this.fontOptions.chooser=chosen}else if((typeof chosen==="undefined"?"undefined":(0,_typeof3["default"])(chosen))==="object"){var chosenLabel=util.topMost(pile,["chosen","label"]);if(typeof chosenLabel==="boolean"||typeof chosenLabel==="function"){this.fontOptions.chooser=chosenLabel}}}},{key:"adjustSizes",value:function adjustSizes(margins){var widthBias=margins?margins.right+margins.left:0;if(this.fontOptions.constrainWidth){this.fontOptions.maxWdt-=widthBias;this.fontOptions.minWdt-=widthBias}var heightBias=margins?margins.top+margins.bottom:0;if(this.fontOptions.constrainHeight){this.fontOptions.minHgt-=heightBias}}},{key:"propagateFonts",value:function propagateFonts(options,groupOptions,defaultOptions){if(this.fontOptions.multi){var mods=["bold","ital","boldital","mono"];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3["default"])(mods),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var mod=_step.value;var optionsFontMod=void 0;if(options.font){optionsFontMod=options.font[mod]}if(typeof optionsFontMod==="string"){var modOptionsArray=optionsFontMod.split(" ");this.fontOptions[mod].size=modOptionsArray[0].replace("px","");this.fontOptions[mod].face=modOptionsArray[1];this.fontOptions[mod].color=modOptionsArray[2];this.fontOptions[mod].vadjust=this.fontOptions.vadjust;this.fontOptions[mod].mod=defaultOptions.font[mod].mod}else{if(optionsFontMod&&optionsFontMod.hasOwnProperty("face")){this.fontOptions[mod].face=optionsFontMod.face}else if(groupOptions.font&&groupOptions.font[mod]&&groupOptions.font[mod].hasOwnProperty("face")){this.fontOptions[mod].face=groupOptions.font[mod].face}else if(mod==="mono"){this.fontOptions[mod].face=defaultOptions.font[mod].face}else if(groupOptions.font&&groupOptions.font.hasOwnProperty("face")){this.fontOptions[mod].face=groupOptions.font.face}else{this.fontOptions[mod].face=this.fontOptions.face}if(optionsFontMod&&optionsFontMod.hasOwnProperty("color")){this.fontOptions[mod].color=optionsFontMod.color}else if(groupOptions.font&&groupOptions.font[mod]&&groupOptions.font[mod].hasOwnProperty("color")){this.fontOptions[mod].color=groupOptions.font[mod].color}else if(groupOptions.font&&groupOptions.font.hasOwnProperty("color")){this.fontOptions[mod].color=groupOptions.font.color}else{this.fontOptions[mod].color=this.fontOptions.color}if(optionsFontMod&&optionsFontMod.hasOwnProperty("mod")){this.fontOptions[mod].mod=optionsFontMod.mod}else if(groupOptions.font&&groupOptions.font[mod]&&groupOptions.font[mod].hasOwnProperty("mod")){this.fontOptions[mod].mod=groupOptions.font[mod].mod}else if(groupOptions.font&&groupOptions.font.hasOwnProperty("mod")){this.fontOptions[mod].mod=groupOptions.font.mod}else{this.fontOptions[mod].mod=defaultOptions.font[mod].mod}if(optionsFontMod&&optionsFontMod.hasOwnProperty("size")){this.fontOptions[mod].size=optionsFontMod.size}else if(groupOptions.font&&groupOptions.font[mod]&&groupOptions.font[mod].hasOwnProperty("size")){this.fontOptions[mod].size=groupOptions.font[mod].size}else if(this.fontOptions[mod].face===defaultOptions.font[mod].face&&this.fontOptions.face===defaultOptions.font.face){var ratio=this.fontOptions.size/Number(defaultOptions.font.size);this.fontOptions[mod].size=defaultOptions.font[mod].size*ratio}else if(groupOptions.font&&groupOptions.font.hasOwnProperty("size")){this.fontOptions[mod].size=groupOptions.font.size}else{this.fontOptions[mod].size=this.fontOptions.size}if(optionsFontMod&&optionsFontMod.hasOwnProperty("vadjust")){this.fontOptions[mod].vadjust=optionsFontMod.vadjust}else if(groupOptions.font&&groupOptions.font[mod]&&groupOptions.font[mod].hasOwnProperty("vadjust")){this.fontOptions[mod].vadjust=groupOptions.font[mod].vadjust}else if(this.fontOptions[mod].face===defaultOptions.font[mod].face&&this.fontOptions.face===defaultOptions.font.face){var _ratio=this.fontOptions.size/Number(defaultOptions.font.size);this.fontOptions[mod].vadjust=defaultOptions.font[mod].vadjust*Math.round(_ratio)}else if(groupOptions.font&&groupOptions.font.hasOwnProperty("vadjust")){this.fontOptions[mod].vadjust=groupOptions.font.vadjust}else{this.fontOptions[mod].vadjust=this.fontOptions.vadjust}}this.fontOptions[mod].size=Number(this.fontOptions[mod].size);this.fontOptions[mod].vadjust=Number(this.fontOptions[mod].vadjust)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator["return"]){_iterator["return"]()}}finally{if(_didIteratorError){throw _iteratorError}}}}}},{key:"draw",value:function draw(ctx,x,y,selected,hover){var baseline=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"middle";if(this.elementOptions.label===undefined)return;var viewFontSize=this.fontOptions.size*this.body.view.scale;if(this.elementOptions.label&&viewFontSize<this.elementOptions.scaling.label.drawThreshold-1)return;this.calculateLabelSize(ctx,selected,hover,x,y,baseline);this._drawBackground(ctx);this._drawText(ctx,selected,hover,x,y,baseline)}},{key:"_drawBackground",value:function _drawBackground(ctx){if(this.fontOptions.background!==undefined&&this.fontOptions.background!=="none"){ctx.fillStyle=this.fontOptions.background;var lineMargin=2;if(this.isEdgeLabel){switch(this.fontOptions.align){case"middle":ctx.fillRect(-this.size.width*.5,-this.size.height*.5,this.size.width,this.size.height);break;case"top":ctx.fillRect(-this.size.width*.5,-(this.size.height+lineMargin),this.size.width,this.size.height);break;case"bottom":ctx.fillRect(-this.size.width*.5,lineMargin,this.size.width,this.size.height);break;default:ctx.fillRect(this.size.left,this.size.top-.5*lineMargin,this.size.width,this.size.height);break}}else{ctx.fillRect(this.size.left,this.size.top-.5*lineMargin,this.size.width,this.size.height)}}}},{key:"_drawText",value:function _drawText(ctx,selected,hover,x,y){var baseline=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"middle";var fontSize=this.fontOptions.size;var viewFontSize=fontSize*this.body.view.scale;if(viewFontSize>=this.elementOptions.scaling.label.maxVisible){fontSize=Number(this.elementOptions.scaling.label.maxVisible)/this.body.view.scale}var yLine=this.size.yLine;var _setAlignment2=this._setAlignment(ctx,x,yLine,baseline);var _setAlignment3=(0,_slicedToArray3["default"])(_setAlignment2,2);x=_setAlignment3[0];yLine=_setAlignment3[1];ctx.textAlign="left";x=x-this.size.width/2;if(this.fontOptions.valign&&this.size.height>this.size.labelHeight){if(this.fontOptions.valign==="top"){yLine-=(this.size.height-this.size.labelHeight)/2}if(this.fontOptions.valign==="bottom"){yLine+=(this.size.height-this.size.labelHeight)/2}}for(var i=0;i<this.lineCount;i++){if(this.lines[i]&&this.lines[i].blocks){var width=0;if(this.isEdgeLabel||this.fontOptions.align==="center"){width+=(this.size.width-this.lines[i].width)/2}else if(this.fontOptions.align==="right"){width+=this.size.width-this.lines[i].width}for(var j=0;j<this.lines[i].blocks.length;j++){var block=this.lines[i].blocks[j];ctx.font=block.font;var _getColor2=this._getColor(block.color,viewFontSize,block.strokeColor),_getColor3=(0,_slicedToArray3["default"])(_getColor2,2),fontColor=_getColor3[0],strokeColor=_getColor3[1];if(block.strokeWidth>0){ctx.lineWidth=block.strokeWidth;ctx.strokeStyle=strokeColor;ctx.lineJoin="round"}ctx.fillStyle=fontColor;if(block.strokeWidth>0){ctx.strokeText(block.text,x+width,yLine+block.vadjust)}ctx.fillText(block.text,x+width,yLine+block.vadjust);width+=block.width}yLine+=this.lines[i].height}}}},{key:"_setAlignment",value:function _setAlignment(ctx,x,yLine,baseline){if(this.isEdgeLabel&&this.fontOptions.align!=="horizontal"&&this.pointToSelf===false){x=0;yLine=0;var lineMargin=2;if(this.fontOptions.align==="top"){ctx.textBaseline="alphabetic";yLine-=2*lineMargin}else if(this.fontOptions.align==="bottom"){ctx.textBaseline="hanging";yLine+=2*lineMargin}else{ctx.textBaseline="middle"}}else{ctx.textBaseline=baseline}return[x,yLine]}},{key:"_getColor",value:function _getColor(color,viewFontSize,initialStrokeColor){var fontColor=color||"#000000";var strokeColor=initialStrokeColor||"#ffffff";if(viewFontSize<=this.elementOptions.scaling.label.drawThreshold){var opacity=Math.max(0,Math.min(1,1-(this.elementOptions.scaling.label.drawThreshold-viewFontSize)));fontColor=util.overrideOpacity(fontColor,opacity);strokeColor=util.overrideOpacity(strokeColor,opacity)}return[fontColor,strokeColor]}},{key:"getTextSize",value:function getTextSize(ctx){var selected=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var hover=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;this._processLabel(ctx,selected,hover);return{width:this.size.width,height:this.size.height,lineCount:this.lineCount}}},{key:"calculateLabelSize",value:function calculateLabelSize(ctx,selected,hover){var x=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var y=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var baseline=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"middle";if(this.labelDirty===true){this._processLabel(ctx,selected,hover)}this.size.left=x-this.size.width*.5;this.size.top=y-this.size.height*.5;this.size.yLine=y+(1-this.lineCount)*.5*this.fontOptions.size;if(baseline==="hanging"){this.size.top+=.5*this.fontOptions.size;this.size.top+=4;this.size.yLine+=4}this.labelDirty=false}},{key:"decodeMarkupSystem",value:function decodeMarkupSystem(markupSystem){var system="none";if(markupSystem==="markdown"||markupSystem==="md"){system="markdown"}else if(markupSystem===true||markupSystem==="html"){system="html"}return system}},{key:"splitBlocks",value:function splitBlocks(text,markupSystem){var system=this.decodeMarkupSystem(markupSystem);if(system==="none"){return[{text:text,mod:"normal"}]}else if(system==="markdown"){return this.splitMarkdownBlocks(text)}else if(system==="html"){return this.splitHtmlBlocks(text)}}},{key:"splitMarkdownBlocks",value:function splitMarkdownBlocks(text){var blocks=[];var s={bold:false,ital:false,mono:false,beginable:true,spacing:false,position:0,buffer:"",modStack:[]};s.mod=function(){return this.modStack.length===0?"normal":this.modStack[0]};s.modName=function(){if(this.modStack.length===0)return"normal";else if(this.modStack[0]==="mono")return"mono";else{if(s.bold&&s.ital){return"boldital"}else if(s.bold){return"bold"}else if(s.ital){return"ital"}}};s.emitBlock=function(){var override=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.spacing){this.add(" ");this.spacing=false}if(this.buffer.length>0){blocks.push({text:this.buffer,mod:this.modName()});this.buffer=""}};s.add=function(text){if(text===" "){s.spacing=true}if(s.spacing){this.buffer+=" ";this.spacing=false}if(text!=" "){this.buffer+=text}};while(s.position<text.length){var ch=text.charAt(s.position);if(/[ \t]/.test(ch)){if(!s.mono){s.spacing=true}else{s.add(ch)}s.beginable=true}else if(/\\/.test(ch)){if(s.position<text.length+1){s.position++;ch=text.charAt(s.position);if(/ \t/.test(ch)){s.spacing=true}else{s.add(ch);s.beginable=false}}}else if(!s.mono&&!s.bold&&(s.beginable||s.spacing)&&/\*/.test(ch)){s.emitBlock();s.bold=true;s.modStack.unshift("bold")}else if(!s.mono&&!s.ital&&(s.beginable||s.spacing)&&/\_/.test(ch)){s.emitBlock();s.ital=true;s.modStack.unshift("ital")}else if(!s.mono&&(s.beginable||s.spacing)&&/`/.test(ch)){s.emitBlock();s.mono=true;s.modStack.unshift("mono")}else if(!s.mono&&s.mod()==="bold"&&/\*/.test(ch)){if(s.position===text.length-1||/[.,_` \t\n]/.test(text.charAt(s.position+1))){s.emitBlock();s.bold=false;s.modStack.shift()}else{s.add(ch)}}else if(!s.mono&&s.mod()==="ital"&&/\_/.test(ch)){if(s.position===text.length-1||/[.,*` \t\n]/.test(text.charAt(s.position+1))){s.emitBlock();s.ital=false;s.modStack.shift()}else{s.add(ch)}}else if(s.mono&&s.mod()==="mono"&&/`/.test(ch)){if(s.position===text.length-1||/[.,*_ \t\n]/.test(text.charAt(s.position+1))){s.emitBlock();s.mono=false;s.modStack.shift()}else{s.add(ch)}}else{s.add(ch);s.beginable=false}s.position++}s.emitBlock();return blocks}},{key:"splitHtmlBlocks",value:function splitHtmlBlocks(text){var blocks=[];var s={bold:false,ital:false,mono:false,spacing:false,position:0,buffer:"",modStack:[]};s.mod=function(){return this.modStack.length===0?"normal":this.modStack[0]};s.modName=function(){if(this.modStack.length===0)return"normal";else if(this.modStack[0]==="mono")return"mono";else{if(s.bold&&s.ital){return"boldital"}else if(s.bold){return"bold"}else if(s.ital){return"ital"}}};s.emitBlock=function(){var override=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.spacing){this.add(" ");this.spacing=false}if(this.buffer.length>0){blocks.push({text:this.buffer,mod:this.modName()});this.buffer=""}};s.add=function(text){if(text===" "){s.spacing=true}if(s.spacing){this.buffer+=" ";this.spacing=false}if(text!=" "){this.buffer+=text}};while(s.position<text.length){var ch=text.charAt(s.position);if(/[ \t]/.test(ch)){if(!s.mono){s.spacing=true}else{s.add(ch)}}else if(/</.test(ch)){if(!s.mono&&!s.bold&&/<b>/.test(text.substr(s.position,3))){s.emitBlock();s.bold=true;s.modStack.unshift("bold");s.position+=2}else if(!s.mono&&!s.ital&&/<i>/.test(text.substr(s.position,3))){s.emitBlock();s.ital=true;s.modStack.unshift("ital");s.position+=2}else if(!s.mono&&/<code>/.test(text.substr(s.position,6))){s.emitBlock();s.mono=true;s.modStack.unshift("mono");s.position+=5}else if(!s.mono&&s.mod()==="bold"&&/<\/b>/.test(text.substr(s.position,4))){s.emitBlock();s.bold=false;s.modStack.shift();s.position+=3}else if(!s.mono&&s.mod()==="ital"&&/<\/i>/.test(text.substr(s.position,4))){s.emitBlock();s.ital=false;s.modStack.shift();s.position+=3}else if(s.mod()==="mono"&&/<\/code>/.test(text.substr(s.position,7))){s.emitBlock();s.mono=false;s.modStack.shift();s.position+=6}else{s.add(ch)}}else if(/&/.test(ch)){if(/&lt;/.test(text.substr(s.position,4))){s.add("<");s.position+=3}else if(/&amp;/.test(text.substr(s.position,5))){s.add("&");s.position+=4}else{s.add("&")}}else{s.add(ch)}s.position++}s.emitBlock();return blocks}},{key:"getFormattingValues",value:function getFormattingValues(ctx,selected,hover,mod){var values={color:mod==="normal"?this.fontOptions.color:this.fontOptions[mod].color,size:mod==="normal"?this.fontOptions.size:this.fontOptions[mod].size,face:mod==="normal"?this.fontOptions.face:this.fontOptions[mod].face,mod:mod==="normal"?"":this.fontOptions[mod].mod,vadjust:mod==="normal"?this.fontOptions.vadjust:this.fontOptions[mod].vadjust,strokeWidth:this.fontOptions.strokeWidth,strokeColor:this.fontOptions.strokeColor};if(mod==="normal"){if(selected||hover){if(this.fontOptions.chooser===true&&this.elementOptions.labelHighlightBold){values.mod="bold"}else if(typeof this.fontOptions.chooser==="function"){this.fontOptions.chooser(ctx,values,this.elementOptions.id,selected,hover)}}}else{if((selected||hover)&&typeof this.fontOptions.chooser==="function"){this.fontOptions.chooser(ctx,values,this.elementOptions.id,selected,hover)}}ctx.font=(values.mod+" "+values.size+"px "+values.face).replace(/"/g,"");values.font=ctx.font;values.height=values.size;return values}},{key:"differentState",value:function differentState(selected,hover){return selected!==this.fontOptions.selectedState&&hover!==this.fontOptions.hoverState}},{key:"_processLabel",value:function _processLabel(ctx,selected,hover){var width=0;var height=0;var nlLines=[];var lines=[];var k=0;lines.add=function(l,text,font,color,width,height,vadjust,mod,strokeWidth,strokeColor){if(this.length==l){this[l]={width:0,height:0,blocks:[]}}this[l].blocks.push({text:text,font:font,color:color,width:width,height:height,vadjust:vadjust,mod:mod,strokeWidth:strokeWidth,strokeColor:strokeColor})};lines.accumulate=function(l,width,height){this[l].width+=width;this[l].height=height>this[l].height?height:this[l].height};lines.addAndAccumulate=function(l,text,font,color,width,height,vadjust,mod,strokeWidth,strokeColor){this.add(l,text,font,color,width,height,vadjust,mod,strokeWidth,strokeColor);this.accumulate(l,width,height)};if(this.elementOptions.label!==undefined){var _nlLines=String(this.elementOptions.label).split("\n");var lineCount=_nlLines.length;if(this.elementOptions.font.multi){for(var i=0;i<lineCount;i++){var blocks=this.splitBlocks(_nlLines[i],this.elementOptions.font.multi);var lineWidth=0;var lineHeight=0;if(blocks){if(blocks.length==0){var values=this.getFormattingValues(ctx,selected,hover,"normal");lines.addAndAccumulate(k,"",values.font,values.color,0,values.size,values.vadjust,"normal",values.strokeWidth,values.strokeColor);height+=lines[k].height;k++;continue}for(var j=0;j<blocks.length;j++){if(this.fontOptions.maxWdt>0){var _values=this.getFormattingValues(ctx,selected,hover,blocks[j].mod);var words=blocks[j].text.split(" ");var atStart=true;var text="";var measure=void 0;var lastMeasure=void 0;var w=0;while(w<words.length){var pre=atStart?"":" ";lastMeasure=measure;measure=ctx.measureText(text+pre+words[w]);if(lineWidth+measure.width>this.fontOptions.maxWdt){lineHeight=_values.height>lineHeight?_values.height:lineHeight;lines.add(k,text,_values.font,_values.color,lastMeasure.width,_values.height,_values.vadjust,blocks[j].mod,_values.strokeWidth,_values.strokeColor);lines.accumulate(k,lastMeasure.width,lineHeight);text="";atStart=true;lineWidth=0;width=lines[k].width>width?lines[k].width:width;height+=lines[k].height;k++}else{text=text+pre+words[w];if(w===words.length-1){lineHeight=_values.height>lineHeight?_values.height:lineHeight;lineWidth+=measure.width;lines.add(k,text,_values.font,_values.color,measure.width,_values.height,_values.vadjust,blocks[j].mod,_values.strokeWidth,_values.strokeColor);lines.accumulate(k,measure.width,lineHeight);if(j===blocks.length-1){width=lines[k].width>width?lines[k].width:width;height+=lines[k].height;k++}}w++;atStart=false}}}else{var _values2=this.getFormattingValues(ctx,selected,hover,blocks[j].mod);var _measure=ctx.measureText(blocks[j].text);lines.addAndAccumulate(k,blocks[j].text,_values2.font,_values2.color,_measure.width,_values2.height,_values2.vadjust,blocks[j].mod,_values2.strokeWidth,_values2.strokeColor);width=lines[k].width>width?lines[k].width:width;if(blocks.length-1===j){height+=lines[k].height;k++}}}}}}else{for(var _i=0;_i<lineCount;_i++){var _values3=this.getFormattingValues(ctx,selected,hover,"normal");if(this.fontOptions.maxWdt>0){var _words=_nlLines[_i].split(" ");var _text="";var _measure2=void 0;var _lastMeasure=void 0;var _w=0;while(_w<_words.length){var _pre=_text===""?"":" ";_lastMeasure=_measure2;_measure2=ctx.measureText(_text+_pre+_words[_w]);if(_measure2.width>this.fontOptions.maxWdt){lines.addAndAccumulate(k,_text,_values3.font,_values3.color,_lastMeasure.width,_values3.size,_values3.vadjust,"normal",_values3.strokeWidth,_values3.strokeColor);width=lines[k].width>width?lines[k].width:width;height+=lines[k].height;_text="";k++}else{_text=_text+_pre+_words[_w];if(_w===_words.length-1){lines.addAndAccumulate(k,_text,_values3.font,_values3.color,_measure2.width,_values3.size,_values3.vadjust,"normal",_values3.strokeWidth,_values3.strokeColor);width=lines[k].width>width?lines[k].width:width;height+=lines[k].height;k++}_w++}}}else{var _text2=_nlLines[_i];var _measure3=ctx.measureText(_text2);lines.addAndAccumulate(k,_text2,_values3.font,_values3.color,_measure3.width,_values3.size,_values3.vadjust,"normal",_values3.strokeWidth,_values3.strokeColor);width=lines[k].width>width?lines[k].width:width;height+=lines[k].height;k++}}}}if(this.fontOptions.minWdt>0&&width<this.fontOptions.minWdt){width=this.fontOptions.minWdt}this.size.labelHeight=height;if(this.fontOptions.minHgt>0&&height<this.fontOptions.minHgt){height=this.fontOptions.minHgt}this.lines=lines;this.lineCount=lines.length;this.size.width=width;this.size.height=height;this.selectedState=selected;this.hoverState=hover}}],[{key:"parseOptions",value:function parseOptions(parentOptions,newOptions){var allowDeletion=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(typeof newOptions.font==="string"){var newOptionsArray=newOptions.font.split(" ");parentOptions.size=newOptionsArray[0].replace("px","");parentOptions.face=newOptionsArray[1];parentOptions.color=newOptionsArray[2];parentOptions.vadjust=0}else if((0,_typeof3["default"])(newOptions.font)==="object"){util.fillIfDefined(parentOptions,newOptions.font,allowDeletion)}parentOptions.size=Number(parentOptions.size);parentOptions.vadjust=Number(parentOptions.vadjust)}}]);return Label}();exports["default"]=Label},{"../../../../util":116,"babel-runtime/core-js/get-iterator":117,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/slicedToArray":132,"babel-runtime/helpers/typeof":133}],79:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:true});var string="string";var bool="boolean";var number="number";var array="array";var object="object";var dom="dom";var any="any";var allOptions={configure:{enabled:{boolean:bool},filter:{boolean:bool,string:string,array:array,function:"function"},container:{dom:dom},showButton:{boolean:bool},__type__:{object:object,boolean:bool,string:string,array:array,function:"function"}},edges:{arrows:{to:{enabled:{boolean:bool},scaleFactor:{number:number},type:{string:["arrow","circle"]},__type__:{object:object,boolean:bool}},middle:{enabled:{boolean:bool},scaleFactor:{number:number},type:{string:["arrow","circle"]},__type__:{object:object,boolean:bool}},from:{enabled:{boolean:bool},scaleFactor:{number:number},type:{string:["arrow","circle"]},__type__:{object:object,boolean:bool}},__type__:{string:["from","to","middle"],object:object}},arrowStrikethrough:{boolean:bool},chosen:{label:{boolean:bool,function:"function"},edge:{boolean:bool,function:"function"},__type__:{object:object,boolean:bool}},color:{color:{string:string},highlight:{string:string},hover:{string:string},inherit:{string:["from","to","both"],boolean:bool},opacity:{number:number},__type__:{object:object,string:string}},dashes:{boolean:bool,array:array},font:{color:{string:string},size:{number:number},face:{string:string},background:{string:string},strokeWidth:{number:number},strokeColor:{string:string},align:{string:["horizontal","top","middle","bottom"]},vadjust:{number:number},multi:{boolean:bool,string:string},bold:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},boldital:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},ital:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},mono:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},__type__:{object:object,string:string}},hidden:{boolean:bool},hoverWidth:{function:"function",number:number},label:{string:string,undefined:"undefined"},labelHighlightBold:{boolean:bool},length:{number:number,undefined:"undefined"},physics:{boolean:bool},scaling:{min:{number:number},max:{number:number},label:{enabled:{boolean:bool},min:{number:number},max:{number:number},maxVisible:{number:number},drawThreshold:{number:number},__type__:{object:object,boolean:bool}},customScalingFunction:{function:"function"},__type__:{object:object}},selectionWidth:{function:"function",number:number},selfReferenceSize:{number:number},shadow:{enabled:{boolean:bool},color:{string:string},size:{number:number},x:{number:number},y:{number:number},__type__:{object:object,boolean:bool}},smooth:{enabled:{boolean:bool},type:{string:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"]},roundness:{number:number},forceDirection:{string:["horizontal","vertical","none"],boolean:bool},__type__:{object:object,boolean:bool}},title:{string:string,undefined:"undefined"},width:{number:number},widthConstraint:{maximum:{number:number},__type__:{object:object,boolean:bool,number:number}},value:{number:number,undefined:"undefined"},__type__:{object:object}},groups:{useDefaultGroups:{boolean:bool},__any__:"get from nodes, will be overwritten below",__type__:{object:object}},interaction:{dragNodes:{boolean:bool},dragView:{boolean:bool},hideEdgesOnDrag:{boolean:bool},hideNodesOnDrag:{boolean:bool},hover:{boolean:bool},keyboard:{enabled:{boolean:bool},speed:{x:{number:number},y:{number:number},zoom:{number:number},__type__:{object:object}},bindToWindow:{boolean:bool},__type__:{object:object,boolean:bool}},multiselect:{boolean:bool},navigationButtons:{boolean:bool},selectable:{boolean:bool},selectConnectedEdges:{boolean:bool},hoverConnectedEdges:{boolean:bool},tooltipDelay:{number:number},zoomView:{boolean:bool},__type__:{object:object}},layout:{randomSeed:{undefined:"undefined",number:number},improvedLayout:{boolean:bool},hierarchical:{enabled:{boolean:bool},levelSeparation:{number:number},nodeSpacing:{number:number},treeSpacing:{number:number},blockShifting:{boolean:bool},edgeMinimization:{boolean:bool},parentCentralization:{boolean:bool},direction:{string:["UD","DU","LR","RL"]},sortMethod:{string:["hubsize","directed"]},__type__:{object:object,boolean:bool}},__type__:{object:object}},manipulation:{enabled:{boolean:bool},initiallyActive:{boolean:bool},addNode:{boolean:bool,function:"function"},addEdge:{boolean:bool,function:"function"},editNode:{function:"function"},editEdge:{editWithoutDrag:{function:"function"},__type__:{object:object,boolean:bool,function:"function"}},deleteNode:{boolean:bool,function:"function"},deleteEdge:{boolean:bool,function:"function"},controlNodeStyle:"get from nodes, will be overwritten below",__type__:{object:object,boolean:bool}},nodes:{borderWidth:{number:number},borderWidthSelected:{number:number,undefined:"undefined"},brokenImage:{string:string,undefined:"undefined"},chosen:{label:{boolean:bool,function:"function"},node:{boolean:bool,function:"function"},__type__:{object:object,boolean:bool}},color:{border:{string:string},background:{string:string},highlight:{border:{string:string},background:{string:string},__type__:{object:object,string:string}},hover:{border:{string:string},background:{string:string},__type__:{object:object,string:string}},__type__:{object:object,string:string}},fixed:{x:{boolean:bool},y:{boolean:bool},__type__:{object:object,boolean:bool}},font:{align:{string:string},color:{string:string},size:{number:number},face:{string:string},background:{string:string},strokeWidth:{number:number},strokeColor:{string:string},vadjust:{number:number},multi:{boolean:bool,string:string},bold:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},boldital:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},ital:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},mono:{color:{string:string},size:{number:number},face:{string:string},mod:{string:string},vadjust:{number:number},__type__:{object:object,string:string}},__type__:{object:object,string:string}},group:{string:string,number:number,undefined:"undefined"},heightConstraint:{minimum:{number:number},valign:{string:string},__type__:{object:object,boolean:bool,number:number}},hidden:{boolean:bool},icon:{face:{string:string},code:{string:string},size:{number:number},color:{string:string},__type__:{object:object}},id:{string:string,number:number},image:{string:string,undefined:"undefined"},label:{string:string,undefined:"undefined"},labelHighlightBold:{boolean:bool},level:{number:number,undefined:"undefined"},margin:{top:{number:number},right:{number:number},bottom:{number:number},left:{number:number},__type__:{object:object,number:number}},mass:{number:number},physics:{boolean:bool},scaling:{min:{number:number},max:{number:number},label:{enabled:{boolean:bool},min:{number:number},max:{number:number},maxVisible:{number:number},drawThreshold:{number:number},__type__:{object:object,boolean:bool}},customScalingFunction:{function:"function"},__type__:{object:object}},shadow:{enabled:{boolean:bool},color:{string:string},size:{number:number},x:{number:number},y:{number:number},__type__:{object:object,boolean:bool}},shape:{string:["ellipse","circle","database","box","text","image","circularImage","diamond","dot","star","triangle","triangleDown","square","icon"]},shapeProperties:{borderDashes:{boolean:bool,array:array},borderRadius:{number:number},interpolation:{boolean:bool},useImageSize:{boolean:bool},useBorderWithImage:{boolean:bool},__type__:{object:object}},size:{number:number},title:{string:string,undefined:"undefined"},value:{number:number,undefined:"undefined"},widthConstraint:{minimum:{number:number},maximum:{number:number},__type__:{object:object,boolean:bool,number:number}},x:{number:number},y:{number:number},__type__:{object:object}},physics:{enabled:{boolean:bool},barnesHut:{gravitationalConstant:{number:number},centralGravity:{number:number},springLength:{number:number},springConstant:{number:number},damping:{number:number},avoidOverlap:{number:number},__type__:{object:object}},forceAtlas2Based:{gravitationalConstant:{number:number},centralGravity:{number:number},springLength:{number:number},springConstant:{number:number},damping:{number:number},avoidOverlap:{number:number},__type__:{object:object}},repulsion:{centralGravity:{number:number},springLength:{number:number},springConstant:{number:number},nodeDistance:{number:number},damping:{number:number},__type__:{object:object}},hierarchicalRepulsion:{centralGravity:{number:number},springLength:{number:number},springConstant:{number:number},nodeDistance:{number:number},damping:{number:number},__type__:{object:object}},maxVelocity:{number:number},minVelocity:{number:number},solver:{string:["barnesHut","repulsion","hierarchicalRepulsion","forceAtlas2Based"]},stabilization:{enabled:{boolean:bool},iterations:{number:number},updateInterval:{number:number},onlyDynamicEdges:{boolean:bool},fit:{boolean:bool},__type__:{object:object,boolean:bool}},timestep:{number:number},adaptiveTimestep:{boolean:bool},__type__:{object:object,boolean:bool}},autoResize:{boolean:bool},clickToUse:{boolean:bool},locale:{string:string},locales:{__any__:{any:any},__type__:{object:object}},height:{string:string},width:{string:string},__type__:{object:object}};allOptions.groups.__any__=allOptions.nodes;allOptions.manipulation.controlNodeStyle=allOptions.nodes;var configureOptions={nodes:{borderWidth:[1,0,10,1],borderWidthSelected:[2,0,10,1],color:{border:["color","#2B7CE9"],background:["color","#97C2FC"],highlight:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]},hover:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]}},fixed:{x:false,y:false},font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[0,0,50,1],strokeColor:["color","#ffffff"]},hidden:false,labelHighlightBold:true,physics:true,scaling:{min:[10,0,200,1],max:[30,0,200,1],label:{enabled:false,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},shadow:{enabled:false,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},shape:["ellipse","box","circle","database","diamond","dot","square","star","text","triangle","triangleDown"],shapeProperties:{borderDashes:false,borderRadius:[6,0,20,1],interpolation:true,useImageSize:false},size:[25,0,200,1]},edges:{arrows:{to:{enabled:false,scaleFactor:[1,0,3,.05],type:"arrow"},middle:{enabled:false,scaleFactor:[1,0,3,.05],type:"arrow"},from:{enabled:false,scaleFactor:[1,0,3,.05],type:"arrow"}},arrowStrikethrough:true,color:{color:["color","#848484"],highlight:["color","#848484"],hover:["color","#848484"],inherit:["from","to","both",true,false],opacity:[1,0,1,.05]},dashes:false,font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[2,0,50,1],strokeColor:["color","#ffffff"],align:["horizontal","top","middle","bottom"]},hidden:false,hoverWidth:[1.5,0,5,.1],labelHighlightBold:true,physics:true,scaling:{min:[1,0,100,1],max:[15,0,100,1],label:{enabled:true,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},selectionWidth:[1.5,0,5,.1],selfReferenceSize:[20,0,200,1],shadow:{enabled:false,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},smooth:{enabled:true,type:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"],forceDirection:["horizontal","vertical","none"],roundness:[.5,0,1,.05]},width:[1,0,30,1]},layout:{hierarchical:{enabled:false,levelSeparation:[150,20,500,5],nodeSpacing:[100,20,500,5],treeSpacing:[200,20,500,5],blockShifting:true,edgeMinimization:true,parentCentralization:true,direction:["UD","DU","LR","RL"],sortMethod:["hubsize","directed"]}},interaction:{dragNodes:true,dragView:true,hideEdgesOnDrag:false,hideNodesOnDrag:false,hover:false,keyboard:{enabled:false,speed:{x:[10,0,40,1],y:[10,0,40,1],zoom:[.02,0,.1,.005]},bindToWindow:true},multiselect:false,navigationButtons:false,selectable:true,selectConnectedEdges:true,hoverConnectedEdges:true,tooltipDelay:[300,0,1e3,25],zoomView:true},manipulation:{enabled:false,initiallyActive:false},physics:{enabled:true,barnesHut:{gravitationalConstant:[-2e3,-3e4,0,50],centralGravity:[.3,0,10,.05],springLength:[95,0,500,5],springConstant:[.04,0,1.2,.005],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},forceAtlas2Based:{gravitationalConstant:[-50,-500,0,1],centralGravity:[.01,0,1,.005],springLength:[95,0,500,5],springConstant:[.08,0,1.2,.005],damping:[.4,0,1,.01],avoidOverlap:[0,0,1,.01]},repulsion:{centralGravity:[.2,0,10,.05],springLength:[200,0,500,5],springConstant:[.05,0,1.2,.005],nodeDistance:[100,0,500,5],damping:[.09,0,1,.01]},hierarchicalRepulsion:{centralGravity:[.2,0,10,.05],springLength:[100,0,500,5],springConstant:[.01,0,1.2,.005],nodeDistance:[120,0,500,5],damping:[.09,0,1,.01]},maxVelocity:[50,0,150,1],minVelocity:[.1,.01,.5,.01],solver:["barnesHut","forceAtlas2Based","repulsion","hierarchicalRepulsion"],timestep:[.5,.01,1,.01]}};exports.allOptions=allOptions;exports.configureOptions=configureOptions},{}],80:[function(require,module,exports){"use strict";if(typeof CanvasRenderingContext2D!=="undefined"){CanvasRenderingContext2D.prototype.circle=function(x,y,r){this.beginPath();this.arc(x,y,r,0,2*Math.PI,false);this.closePath()};CanvasRenderingContext2D.prototype.square=function(x,y,r){this.beginPath();this.rect(x-r,y-r,r*2,r*2);this.closePath()};CanvasRenderingContext2D.prototype.triangle=function(x,y,r){this.beginPath();r*=1.15;y+=.275*r;var s=r*2;var s2=s/2;var ir=Math.sqrt(3)/6*s;var h=Math.sqrt(s*s-s2*s2);this.moveTo(x,y-(h-ir));this.lineTo(x+s2,y+ir);this.lineTo(x-s2,y+ir);this.lineTo(x,y-(h-ir));this.closePath()};CanvasRenderingContext2D.prototype.triangleDown=function(x,y,r){this.beginPath();r*=1.15;y-=.275*r;var s=r*2;var s2=s/2;var ir=Math.sqrt(3)/6*s;var h=Math.sqrt(s*s-s2*s2);this.moveTo(x,y+(h-ir));this.lineTo(x+s2,y-ir);this.lineTo(x-s2,y-ir);this.lineTo(x,y+(h-ir));this.closePath()};CanvasRenderingContext2D.prototype.star=function(x,y,r){this.beginPath();r*=.82;y+=.1*r;for(var n=0;n<10;n++){var radius=n%2===0?r*1.3:r*.5;this.lineTo(x+radius*Math.sin(n*2*Math.PI/10),y-radius*Math.cos(n*2*Math.PI/10))}this.closePath()};CanvasRenderingContext2D.prototype.diamond=function(x,y,r){this.beginPath();this.lineTo(x,y+r);this.lineTo(x+r,y);this.lineTo(x,y-r);this.lineTo(x-r,y);this.closePath()};CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){var r2d=Math.PI/180;if(w-2*r<0){r=w/2}if(h-2*r<0){r=h/2}this.beginPath();this.moveTo(x+r,y);this.lineTo(x+w-r,y);this.arc(x+w-r,y+r,r,r2d*270,r2d*360,false);this.lineTo(x+w,y+h-r);this.arc(x+w-r,y+h-r,r,0,r2d*90,false);this.lineTo(x+r,y+h);this.arc(x+r,y+h-r,r,r2d*90,r2d*180,false);this.lineTo(x,y+r);this.arc(x+r,y+r,r,r2d*180,r2d*270,false);this.closePath()};CanvasRenderingContext2D.prototype.ellipse=function(x,y,w,h){var kappa=.5522848,ox=w/2*kappa,oy=h/2*kappa,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;this.beginPath();this.moveTo(x,ym);this.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);this.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);this.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);this.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);this.closePath()};CanvasRenderingContext2D.prototype.database=function(x,y,w,h){var f=1/3;var wEllipse=w;var hEllipse=h*f;var kappa=.5522848,ox=wEllipse/2*kappa,oy=hEllipse/2*kappa,xe=x+wEllipse,ye=y+hEllipse,xm=x+wEllipse/2,ym=y+hEllipse/2,ymb=y+(h-hEllipse/2),yeb=y+h;this.beginPath();this.moveTo(xe,ym);this.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);this.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);this.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);this.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);this.lineTo(xe,ymb);this.bezierCurveTo(xe,ymb+oy,xm+ox,yeb,xm,yeb);this.bezierCurveTo(xm-ox,yeb,x,ymb+oy,x,ymb);this.lineTo(x,ym)};CanvasRenderingContext2D.prototype.arrowEndpoint=function(x,y,angle,length){var xt=x-length*Math.cos(angle);var yt=y-length*Math.sin(angle);var xi=x-length*.9*Math.cos(angle);var yi=y-length*.9*Math.sin(angle);var xl=xt+length/3*Math.cos(angle+.5*Math.PI);var yl=yt+length/3*Math.sin(angle+.5*Math.PI);var xr=xt+length/3*Math.cos(angle-.5*Math.PI);var yr=yt+length/3*Math.sin(angle-.5*Math.PI);this.beginPath();this.moveTo(x,y);this.lineTo(xl,yl);this.lineTo(xi,yi);this.lineTo(xr,yr);this.closePath()};CanvasRenderingContext2D.prototype.circleEndpoint=function(x,y,angle,length){var radius=length*.4;var xc=x-radius*Math.cos(angle);var yc=y-radius*Math.sin(angle);this.circle(xc,yc,radius)};CanvasRenderingContext2D.prototype.dashedLine=function(x,y,x2,y2,pattern){this.beginPath();this.moveTo(x,y);var patternLength=pattern.length;var dx=x2-x;var dy=y2-y;var slope=dy/dx;var distRemaining=Math.sqrt(dx*dx+dy*dy);var patternIndex=0;var draw=true;var xStep=0;var dashLength=pattern[0];while(distRemaining>=.1){dashLength=pattern[patternIndex++%patternLength];if(dashLength>distRemaining){dashLength=distRemaining}xStep=Math.sqrt(dashLength*dashLength/(1+slope*slope));xStep=dx<0?-xStep:xStep;x+=xStep;y+=slope*xStep;if(draw===true){this.lineTo(x,y)}else{this.moveTo(x,y)}distRemaining-=dashLength;draw=!draw}}}},{}],81:[function(require,module,exports){"use strict";var keycharm=require("keycharm");var Emitter=require("emitter-component");var Hammer=require("../module/hammer");var util=require("../util");function Activator(container){this.active=false;this.dom={container:container};this.dom.overlay=document.createElement("div");this.dom.overlay.className="vis-overlay";this.dom.container.appendChild(this.dom.overlay);this.hammer=Hammer(this.dom.overlay);this.hammer.on("tap",this._onTapOverlay.bind(this));var me=this;var events=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];events.forEach(function(event){me.hammer.on(event,function(event){event.stopPropagation()})});if(document&&document.body){this.onClick=function(event){if(!_hasParent(event.target,container)){me.deactivate()}};document.body.addEventListener("click",this.onClick)}if(this.keycharm!==undefined){this.keycharm.destroy()}this.keycharm=keycharm();this.escListener=this.deactivate.bind(this)}Emitter(Activator.prototype);Activator.current=null;Activator.prototype.destroy=function(){this.deactivate();this.dom.overlay.parentNode.removeChild(this.dom.overlay);if(this.onClick){document.body.removeEventListener("click",this.onClick)}this.hammer.destroy();this.hammer=null};Activator.prototype.activate=function(){if(Activator.current){Activator.current.deactivate()}Activator.current=this;this.active=true;this.dom.overlay.style.display="none";util.addClassName(this.dom.container,"vis-active");this.emit("change");this.emit("activate");this.keycharm.bind("esc",this.escListener)};Activator.prototype.deactivate=function(){this.active=false;this.dom.overlay.style.display="";util.removeClassName(this.dom.container,"vis-active");this.keycharm.unbind("esc",this.escListener);this.emit("change");this.emit("deactivate")};Activator.prototype._onTapOverlay=function(event){this.activate();event.stopPropagation()};function _hasParent(element,parent){while(element){if(element===parent){return true}element=element.parentNode}return false}module.exports=Activator},{"../module/hammer":19,"../util":116,"emitter-component":221,keycharm:223}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Hammer=require("../module/hammer");var hammerUtil=require("../hammerUtil");var util=require("../util");var ColorPicker=function(){function ColorPicker(){var pixelRatio=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;(0,_classCallCheck3["default"])(this,ColorPicker);this.pixelRatio=pixelRatio;this.generated=false;this.centerCoordinates={x:289/2,y:289/2};this.r=289*.49;this.color={r:255,g:255,b:255,a:1};this.hueCircle=undefined;this.initialColor={r:255,g:255,b:255,a:1};this.previousColor=undefined;this.applied=false;this.updateCallback=function(){};this.closeCallback=function(){};this._create()}(0,_createClass3["default"])(ColorPicker,[{key:"insertTo",value:function insertTo(container){if(this.hammer!==undefined){this.hammer.destroy();this.hammer=undefined}this.container=container;this.container.appendChild(this.frame);this._bindHammer();this._setSize()}},{key:"setUpdateCallback",value:function setUpdateCallback(callback){if(typeof callback==="function"){this.updateCallback=callback}else{throw new Error("Function attempted to set as colorPicker update callback is not a function.")}}},{key:"setCloseCallback",value:function setCloseCallback(callback){if(typeof callback==="function"){this.closeCallback=callback}else{throw new Error("Function attempted to set as colorPicker closing callback is not a function.")}}},{key:"_isColorString",value:function _isColorString(color){var htmlColors={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"};if(typeof color==="string"){return htmlColors[color]}}},{key:"setColor",value:function setColor(color){var setInitial=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(color==="none"){return}var rgba=void 0;var htmlColor=this._isColorString(color);if(htmlColor!==undefined){color=htmlColor}if(util.isString(color)===true){if(util.isValidRGB(color)===true){var rgbaArray=color.substr(4).substr(0,color.length-5).split(",");rgba={r:rgbaArray[0],g:rgbaArray[1],b:rgbaArray[2],a:1}}else if(util.isValidRGBA(color)===true){var _rgbaArray=color.substr(5).substr(0,color.length-6).split(",");rgba={r:_rgbaArray[0],g:_rgbaArray[1],b:_rgbaArray[2],a:_rgbaArray[3]}}else if(util.isValidHex(color)===true){var rgbObj=util.hexToRGB(color);rgba={r:rgbObj.r,g:rgbObj.g,b:rgbObj.b,a:1}}}else{if(color instanceof Object){if(color.r!==undefined&&color.g!==undefined&&color.b!==undefined){var alpha=color.a!==undefined?color.a:"1.0";rgba={r:color.r,g:color.g,b:color.b,a:alpha}}}}if(rgba===undefined){throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+(0,_stringify2["default"])(color))}else{this._setColor(rgba,setInitial)}}},{key:"show",value:function show(){if(this.closeCallback!==undefined){this.closeCallback();this.closeCallback=undefined}this.applied=false;this.frame.style.display="block";this._generateHueCircle()}},{key:"_hide",value:function _hide(){var _this=this;var storePrevious=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(storePrevious===true){this.previousColor=util.extend({},this.color)}if(this.applied===true){this.updateCallback(this.initialColor)}this.frame.style.display="none";setTimeout(function(){if(_this.closeCallback!==undefined){_this.closeCallback();_this.closeCallback=undefined}},0)}},{key:"_save",value:function _save(){this.updateCallback(this.color);this.applied=false;this._hide()}},{key:"_apply",value:function _apply(){this.applied=true;this.updateCallback(this.color);this._updatePicker(this.color)}},{key:"_loadLast",value:function _loadLast(){if(this.previousColor!==undefined){this.setColor(this.previousColor,false)}else{alert("There is no last color to load...")}}},{key:"_setColor",value:function _setColor(rgba){var setInitial=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(setInitial===true){this.initialColor=util.extend({},rgba)}this.color=rgba;var hsv=util.RGBToHSV(rgba.r,rgba.g,rgba.b);var angleConvert=2*Math.PI;var radius=this.r*hsv.s;var x=this.centerCoordinates.x+radius*Math.sin(angleConvert*hsv.h);var y=this.centerCoordinates.y+radius*Math.cos(angleConvert*hsv.h);this.colorPickerSelector.style.left=x-.5*this.colorPickerSelector.clientWidth+"px";this.colorPickerSelector.style.top=y-.5*this.colorPickerSelector.clientHeight+"px";this._updatePicker(rgba)}},{key:"_setOpacity",value:function _setOpacity(value){this.color.a=value/100;this._updatePicker(this.color)}},{key:"_setBrightness",value:function _setBrightness(value){var hsv=util.RGBToHSV(this.color.r,this.color.g,this.color.b);hsv.v=value/100;var rgba=util.HSVToRGB(hsv.h,hsv.s,hsv.v);rgba["a"]=this.color.a;this.color=rgba;this._updatePicker()}},{key:"_updatePicker",value:function _updatePicker(){var rgba=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.color;var hsv=util.RGBToHSV(rgba.r,rgba.g,rgba.b);var ctx=this.colorPickerCanvas.getContext("2d");if(this.pixelRation===undefined){this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1)}ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var w=this.colorPickerCanvas.clientWidth;var h=this.colorPickerCanvas.clientHeight;ctx.clearRect(0,0,w,h);ctx.putImageData(this.hueCircle,0,0);ctx.fillStyle="rgba(0,0,0,"+(1-hsv.v)+")";ctx.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r);ctx.fill();this.brightnessRange.value=100*hsv.v;this.opacityRange.value=100*rgba.a;this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")";this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function _setSize(){this.colorPickerCanvas.style.width="100%";this.colorPickerCanvas.style.height="100%";this.colorPickerCanvas.width=289*this.pixelRatio;this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function _create(){this.frame=document.createElement("div");this.frame.className="vis-color-picker";this.colorPickerDiv=document.createElement("div");this.colorPickerSelector=document.createElement("div");this.colorPickerSelector.className="vis-selector";this.colorPickerDiv.appendChild(this.colorPickerSelector);this.colorPickerCanvas=document.createElement("canvas");this.colorPickerDiv.appendChild(this.colorPickerCanvas);if(!this.colorPickerCanvas.getContext){var noCanvas=document.createElement("DIV");noCanvas.style.color="red";noCanvas.style.fontWeight="bold";noCanvas.style.padding="10px";noCanvas.innerHTML="Error: your browser does not support HTML canvas";this.colorPickerCanvas.appendChild(noCanvas)}else{var ctx=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1);this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}this.colorPickerDiv.className="vis-color";this.opacityDiv=document.createElement("div");this.opacityDiv.className="vis-opacity";this.brightnessDiv=document.createElement("div");this.brightnessDiv.className="vis-brightness";this.arrowDiv=document.createElement("div");this.arrowDiv.className="vis-arrow";this.opacityRange=document.createElement("input");try{this.opacityRange.type="range";this.opacityRange.min="0";this.opacityRange.max="100"}catch(err){}this.opacityRange.value="100";this.opacityRange.className="vis-range";this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range";this.brightnessRange.min="0";this.brightnessRange.max="100"}catch(err){}this.brightnessRange.value="100";this.brightnessRange.className="vis-range";this.opacityDiv.appendChild(this.opacityRange);this.brightnessDiv.appendChild(this.brightnessRange);var me=this;this.opacityRange.onchange=function(){me._setOpacity(this.value)};this.opacityRange.oninput=function(){me._setOpacity(this.value)};this.brightnessRange.onchange=function(){me._setBrightness(this.value)};this.brightnessRange.oninput=function(){me._setBrightness(this.value)};this.brightnessLabel=document.createElement("div");this.brightnessLabel.className="vis-label vis-brightness";this.brightnessLabel.innerHTML="brightness:";this.opacityLabel=document.createElement("div");this.opacityLabel.className="vis-label vis-opacity";this.opacityLabel.innerHTML="opacity:";this.newColorDiv=document.createElement("div");this.newColorDiv.className="vis-new-color";this.newColorDiv.innerHTML="new";this.initialColorDiv=document.createElement("div");this.initialColorDiv.className="vis-initial-color";this.initialColorDiv.innerHTML="initial";
this.cancelButton=document.createElement("div");this.cancelButton.className="vis-button vis-cancel";this.cancelButton.innerHTML="cancel";this.cancelButton.onclick=this._hide.bind(this,false);this.applyButton=document.createElement("div");this.applyButton.className="vis-button vis-apply";this.applyButton.innerHTML="apply";this.applyButton.onclick=this._apply.bind(this);this.saveButton=document.createElement("div");this.saveButton.className="vis-button vis-save";this.saveButton.innerHTML="save";this.saveButton.onclick=this._save.bind(this);this.loadButton=document.createElement("div");this.loadButton.className="vis-button vis-load";this.loadButton.innerHTML="load last";this.loadButton.onclick=this._loadLast.bind(this);this.frame.appendChild(this.colorPickerDiv);this.frame.appendChild(this.arrowDiv);this.frame.appendChild(this.brightnessLabel);this.frame.appendChild(this.brightnessDiv);this.frame.appendChild(this.opacityLabel);this.frame.appendChild(this.opacityDiv);this.frame.appendChild(this.newColorDiv);this.frame.appendChild(this.initialColorDiv);this.frame.appendChild(this.cancelButton);this.frame.appendChild(this.applyButton);this.frame.appendChild(this.saveButton);this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function _bindHammer(){var _this2=this;this.drag={};this.pinch={};this.hammer=new Hammer(this.colorPickerCanvas);this.hammer.get("pinch").set({enable:true});hammerUtil.onTouch(this.hammer,function(event){_this2._moveSelector(event)});this.hammer.on("tap",function(event){_this2._moveSelector(event)});this.hammer.on("panstart",function(event){_this2._moveSelector(event)});this.hammer.on("panmove",function(event){_this2._moveSelector(event)});this.hammer.on("panend",function(event){_this2._moveSelector(event)})}},{key:"_generateHueCircle",value:function _generateHueCircle(){if(this.generated===false){var ctx=this.colorPickerCanvas.getContext("2d");if(this.pixelRation===undefined){this.pixelRatio=(window.devicePixelRatio||1)/(ctx.webkitBackingStorePixelRatio||ctx.mozBackingStorePixelRatio||ctx.msBackingStorePixelRatio||ctx.oBackingStorePixelRatio||ctx.backingStorePixelRatio||1)}ctx.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var w=this.colorPickerCanvas.clientWidth;var h=this.colorPickerCanvas.clientHeight;ctx.clearRect(0,0,w,h);var x=void 0,y=void 0,hue=void 0,sat=void 0;this.centerCoordinates={x:w*.5,y:h*.5};this.r=.49*w;var angleConvert=2*Math.PI/360;var hfac=1/360;var sfac=1/this.r;var rgb=void 0;for(hue=0;hue<360;hue++){for(sat=0;sat<this.r;sat++){x=this.centerCoordinates.x+sat*Math.sin(angleConvert*hue);y=this.centerCoordinates.y+sat*Math.cos(angleConvert*hue);rgb=util.HSVToRGB(hue*hfac,sat*sfac,1);ctx.fillStyle="rgb("+rgb.r+","+rgb.g+","+rgb.b+")";ctx.fillRect(x-.5,y-.5,2,2)}}ctx.strokeStyle="rgba(0,0,0,1)";ctx.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r);ctx.stroke();this.hueCircle=ctx.getImageData(0,0,w,h)}this.generated=true}},{key:"_moveSelector",value:function _moveSelector(event){var rect=this.colorPickerDiv.getBoundingClientRect();var left=event.center.x-rect.left;var top=event.center.y-rect.top;var centerY=.5*this.colorPickerDiv.clientHeight;var centerX=.5*this.colorPickerDiv.clientWidth;var x=left-centerX;var y=top-centerY;var angle=Math.atan2(x,y);var radius=.98*Math.min(Math.sqrt(x*x+y*y),centerX);var newTop=Math.cos(angle)*radius+centerY;var newLeft=Math.sin(angle)*radius+centerX;this.colorPickerSelector.style.top=newTop-.5*this.colorPickerSelector.clientHeight+"px";this.colorPickerSelector.style.left=newLeft-.5*this.colorPickerSelector.clientWidth+"px";var h=angle/(2*Math.PI);h=h<0?h+1:h;var s=radius/this.r;var hsv=util.RGBToHSV(this.color.r,this.color.g,this.color.b);hsv.h=h;hsv.s=s;var rgba=util.HSVToRGB(hsv.h,hsv.s,hsv.v);rgba["a"]=this.color.a;this.color=rgba;this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")";this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]);return ColorPicker}();exports["default"]=ColorPicker},{"../hammerUtil":18,"../module/hammer":19,"../util":116,"babel-runtime/core-js/json/stringify":119,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);var _ColorPicker=require("./ColorPicker");var _ColorPicker2=_interopRequireDefault(_ColorPicker);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../util");var Configurator=function(){function Configurator(parentModule,defaultContainer,configureOptions){var pixelRatio=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1;(0,_classCallCheck3["default"])(this,Configurator);this.parent=parentModule;this.changedOptions=[];this.container=defaultContainer;this.allowCreation=false;this.options={};this.initialized=false;this.popupCounter=0;this.defaultOptions={enabled:false,filter:true,container:undefined,showButton:true};util.extend(this.options,this.defaultOptions);this.configureOptions=configureOptions;this.moduleOptions={};this.domElements=[];this.popupDiv={};this.popupLimit=5;this.popupHistory={};this.colorPicker=new _ColorPicker2["default"](pixelRatio);this.wrapper=undefined}(0,_createClass3["default"])(Configurator,[{key:"setOptions",value:function setOptions(options){if(options!==undefined){this.popupHistory={};this._removePopup();var enabled=true;if(typeof options==="string"){this.options.filter=options}else if(options instanceof Array){this.options.filter=options.join()}else if((typeof options==="undefined"?"undefined":(0,_typeof3["default"])(options))==="object"){if(options.container!==undefined){this.options.container=options.container}if(options.filter!==undefined){this.options.filter=options.filter}if(options.showButton!==undefined){this.options.showButton=options.showButton}if(options.enabled!==undefined){enabled=options.enabled}}else if(typeof options==="boolean"){this.options.filter=true;enabled=options}else if(typeof options==="function"){this.options.filter=options;enabled=true}if(this.options.filter===false){enabled=false}this.options.enabled=enabled}this._clean()}},{key:"setModuleOptions",value:function setModuleOptions(moduleOptions){this.moduleOptions=moduleOptions;if(this.options.enabled===true){this._clean();if(this.options.container!==undefined){this.container=this.options.container}this._create()}}},{key:"_create",value:function _create(){var _this=this;this._clean();this.changedOptions=[];var filter=this.options.filter;var counter=0;var show=false;for(var option in this.configureOptions){if(this.configureOptions.hasOwnProperty(option)){this.allowCreation=false;show=false;if(typeof filter==="function"){show=filter(option,[]);show=show||this._handleObject(this.configureOptions[option],[option],true)}else if(filter===true||filter.indexOf(option)!==-1){show=true}if(show!==false){this.allowCreation=true;if(counter>0){this._makeItem([])}this._makeHeader(option);this._handleObject(this.configureOptions[option],[option])}counter++}}if(this.options.showButton===true){(function(){var generateButton=document.createElement("div");generateButton.className="vis-configuration vis-config-button";generateButton.innerHTML="generate options";generateButton.onclick=function(){_this._printOptions()};generateButton.onmouseover=function(){generateButton.className="vis-configuration vis-config-button hover"};generateButton.onmouseout=function(){generateButton.className="vis-configuration vis-config-button"};_this.optionsContainer=document.createElement("div");_this.optionsContainer.className="vis-configuration vis-config-option-container";_this.domElements.push(_this.optionsContainer);_this.domElements.push(generateButton)})()}this._push()}},{key:"_push",value:function _push(){this.wrapper=document.createElement("div");this.wrapper.className="vis-configuration-wrapper";this.container.appendChild(this.wrapper);for(var i=0;i<this.domElements.length;i++){this.wrapper.appendChild(this.domElements[i])}this._showPopupIfNeeded()}},{key:"_clean",value:function _clean(){for(var i=0;i<this.domElements.length;i++){this.wrapper.removeChild(this.domElements[i])}if(this.wrapper!==undefined){this.container.removeChild(this.wrapper);this.wrapper=undefined}this.domElements=[];this._removePopup()}},{key:"_getValue",value:function _getValue(path){var base=this.moduleOptions;for(var i=0;i<path.length;i++){if(base[path[i]]!==undefined){base=base[path[i]]}else{base=undefined;break}}return base}},{key:"_makeItem",value:function _makeItem(path){var _arguments=arguments,_this2=this;if(this.allowCreation===true){var _len,domElements,_key;var _ret2=function(){var item=document.createElement("div");item.className="vis-configuration vis-config-item vis-config-s"+path.length;for(_len=_arguments.length,domElements=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){domElements[_key-1]=_arguments[_key]}domElements.forEach(function(element){item.appendChild(element)});_this2.domElements.push(item);return{v:_this2.domElements.length}}();if((typeof _ret2==="undefined"?"undefined":(0,_typeof3["default"])(_ret2))==="object")return _ret2.v}return 0}},{key:"_makeHeader",value:function _makeHeader(name){var div=document.createElement("div");div.className="vis-configuration vis-config-header";div.innerHTML=name;this._makeItem([],div)}},{key:"_makeLabel",value:function _makeLabel(name,path){var objectLabel=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var div=document.createElement("div");div.className="vis-configuration vis-config-label vis-config-s"+path.length;if(objectLabel===true){div.innerHTML="<i><b>"+name+":</b></i>"}else{div.innerHTML=name+":"}return div}},{key:"_makeDropdown",value:function _makeDropdown(arr,value,path){var select=document.createElement("select");select.className="vis-configuration vis-config-select";var selectedValue=0;if(value!==undefined){if(arr.indexOf(value)!==-1){selectedValue=arr.indexOf(value)}}for(var i=0;i<arr.length;i++){var option=document.createElement("option");option.value=arr[i];if(i===selectedValue){option.selected="selected"}option.innerHTML=arr[i];select.appendChild(option)}var me=this;select.onchange=function(){me._update(this.value,path)};var label=this._makeLabel(path[path.length-1],path);this._makeItem(path,label,select)}},{key:"_makeRange",value:function _makeRange(arr,value,path){var defaultValue=arr[0];var min=arr[1];var max=arr[2];var step=arr[3];var range=document.createElement("input");range.className="vis-configuration vis-config-range";try{range.type="range";range.min=min;range.max=max}catch(err){}range.step=step;var popupString="";var popupValue=0;if(value!==undefined){var factor=1.2;if(value<0&&value*factor<min){range.min=Math.ceil(value*factor);popupValue=range.min;popupString="range increased"}else if(value/factor<min){range.min=Math.ceil(value/factor);popupValue=range.min;popupString="range increased"}if(value*factor>max&&max!==1){range.max=Math.ceil(value*factor);popupValue=range.max;popupString="range increased"}range.value=value}else{range.value=defaultValue}var input=document.createElement("input");input.className="vis-configuration vis-config-rangeinput";input.value=range.value;var me=this;range.onchange=function(){input.value=this.value;me._update(Number(this.value),path)};range.oninput=function(){input.value=this.value};var label=this._makeLabel(path[path.length-1],path);var itemIndex=this._makeItem(path,label,range,input);if(popupString!==""&&this.popupHistory[itemIndex]!==popupValue){this.popupHistory[itemIndex]=popupValue;this._setupPopup(popupString,itemIndex)}}},{key:"_setupPopup",value:function _setupPopup(string,index){var _this3=this;if(this.initialized===true&&this.allowCreation===true&&this.popupCounter<this.popupLimit){var div=document.createElement("div");div.id="vis-configuration-popup";div.className="vis-configuration-popup";div.innerHTML=string;div.onclick=function(){_this3._removePopup()};this.popupCounter+=1;this.popupDiv={html:div,index:index}}}},{key:"_removePopup",value:function _removePopup(){if(this.popupDiv.html!==undefined){this.popupDiv.html.parentNode.removeChild(this.popupDiv.html);clearTimeout(this.popupDiv.hideTimeout);clearTimeout(this.popupDiv.deleteTimeout);this.popupDiv={}}}},{key:"_showPopupIfNeeded",value:function _showPopupIfNeeded(){var _this4=this;if(this.popupDiv.html!==undefined){var correspondingElement=this.domElements[this.popupDiv.index];var rect=correspondingElement.getBoundingClientRect();this.popupDiv.html.style.left=rect.left+"px";this.popupDiv.html.style.top=rect.top-30+"px";document.body.appendChild(this.popupDiv.html);this.popupDiv.hideTimeout=setTimeout(function(){_this4.popupDiv.html.style.opacity=0},1500);this.popupDiv.deleteTimeout=setTimeout(function(){_this4._removePopup()},1800)}}},{key:"_makeCheckbox",value:function _makeCheckbox(defaultValue,value,path){var checkbox=document.createElement("input");checkbox.type="checkbox";checkbox.className="vis-configuration vis-config-checkbox";checkbox.checked=defaultValue;if(value!==undefined){checkbox.checked=value;if(value!==defaultValue){if((typeof defaultValue==="undefined"?"undefined":(0,_typeof3["default"])(defaultValue))==="object"){if(value!==defaultValue.enabled){this.changedOptions.push({path:path,value:value})}}else{this.changedOptions.push({path:path,value:value})}}}var me=this;checkbox.onchange=function(){me._update(this.checked,path)};var label=this._makeLabel(path[path.length-1],path);this._makeItem(path,label,checkbox)}},{key:"_makeTextInput",value:function _makeTextInput(defaultValue,value,path){var checkbox=document.createElement("input");checkbox.type="text";checkbox.className="vis-configuration vis-config-text";checkbox.value=value;if(value!==defaultValue){this.changedOptions.push({path:path,value:value})}var me=this;checkbox.onchange=function(){me._update(this.value,path)};var label=this._makeLabel(path[path.length-1],path);this._makeItem(path,label,checkbox)}},{key:"_makeColorField",value:function _makeColorField(arr,value,path){var _this5=this;var defaultColor=arr[1];var div=document.createElement("div");value=value===undefined?defaultColor:value;if(value!=="none"){div.className="vis-configuration vis-config-colorBlock";div.style.backgroundColor=value}else{div.className="vis-configuration vis-config-colorBlock none"}value=value===undefined?defaultColor:value;div.onclick=function(){_this5._showColorPicker(value,div,path)};var label=this._makeLabel(path[path.length-1],path);this._makeItem(path,label,div)}},{key:"_showColorPicker",value:function _showColorPicker(value,div,path){var _this6=this;div.onclick=function(){};this.colorPicker.insertTo(div);this.colorPicker.show();this.colorPicker.setColor(value);this.colorPicker.setUpdateCallback(function(color){var colorString="rgba("+color.r+","+color.g+","+color.b+","+color.a+")";div.style.backgroundColor=colorString;_this6._update(colorString,path)});this.colorPicker.setCloseCallback(function(){div.onclick=function(){_this6._showColorPicker(value,div,path)}})}},{key:"_handleObject",value:function _handleObject(obj){var path=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var checkOnly=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var show=false;var filter=this.options.filter;var visibleInSet=false;for(var subObj in obj){if(obj.hasOwnProperty(subObj)){show=true;var item=obj[subObj];var newPath=util.copyAndExtendArray(path,subObj);if(typeof filter==="function"){show=filter(subObj,path);if(show===false){if(!(item instanceof Array)&&typeof item!=="string"&&typeof item!=="boolean"&&item instanceof Object){this.allowCreation=false;show=this._handleObject(item,newPath,true);this.allowCreation=checkOnly===false}}}if(show!==false){visibleInSet=true;var value=this._getValue(newPath);if(item instanceof Array){this._handleArray(item,value,newPath)}else if(typeof item==="string"){this._makeTextInput(item,value,newPath)}else if(typeof item==="boolean"){this._makeCheckbox(item,value,newPath)}else if(item instanceof Object){var draw=true;if(path.indexOf("physics")!==-1){if(this.moduleOptions.physics.solver!==subObj){draw=false}}if(draw===true){if(item.enabled!==undefined){var enabledPath=util.copyAndExtendArray(newPath,"enabled");var enabledValue=this._getValue(enabledPath);if(enabledValue===true){var label=this._makeLabel(subObj,newPath,true);this._makeItem(newPath,label);visibleInSet=this._handleObject(item,newPath)||visibleInSet}else{this._makeCheckbox(item,enabledValue,newPath)}}else{var _label=this._makeLabel(subObj,newPath,true);this._makeItem(newPath,_label);visibleInSet=this._handleObject(item,newPath)||visibleInSet}}}else{console.error("dont know how to handle",item,subObj,newPath)}}}}return visibleInSet}},{key:"_handleArray",value:function _handleArray(arr,value,path){if(typeof arr[0]==="string"&&arr[0]==="color"){this._makeColorField(arr,value,path);if(arr[1]!==value){this.changedOptions.push({path:path,value:value})}}else if(typeof arr[0]==="string"){this._makeDropdown(arr,value,path);if(arr[0]!==value){this.changedOptions.push({path:path,value:value})}}else if(typeof arr[0]==="number"){this._makeRange(arr,value,path);if(arr[0]!==value){this.changedOptions.push({path:path,value:Number(value)})}}}},{key:"_update",value:function _update(value,path){var options=this._constructOptions(value,path);if(this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit){this.parent.body.emitter.emit("configChange",options)}this.initialized=true;this.parent.setOptions(options)}},{key:"_constructOptions",value:function _constructOptions(value,path){var optionsObj=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var pointer=optionsObj;value=value==="true"?true:value;value=value==="false"?false:value;for(var i=0;i<path.length;i++){if(path[i]!=="global"){if(pointer[path[i]]===undefined){pointer[path[i]]={}}if(i!==path.length-1){pointer=pointer[path[i]]}else{pointer[path[i]]=value}}}return optionsObj}},{key:"_printOptions",value:function _printOptions(){var options=this.getOptions();this.optionsContainer.innerHTML="<pre>var options = "+(0,_stringify2["default"])(options,null,2)+"</pre>"}},{key:"getOptions",value:function getOptions(){var options={};for(var i=0;i<this.changedOptions.length;i++){this._constructOptions(this.changedOptions[i].value,this.changedOptions[i].path,options)}return options}}]);return Configurator}();exports["default"]=Configurator},{"../util":116,"./ColorPicker":82,"babel-runtime/core-js/json/stringify":119,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Popup=function(){function Popup(container,overflowMethod){(0,_classCallCheck3["default"])(this,Popup);this.container=container;this.overflowMethod=overflowMethod||"cap";this.x=0;this.y=0;this.padding=5;this.hidden=false;this.frame=document.createElement("div");this.frame.className="vis-tooltip";this.container.appendChild(this.frame)}(0,_createClass3["default"])(Popup,[{key:"setPosition",value:function setPosition(x,y){this.x=parseInt(x);this.y=parseInt(y)}},{key:"setText",value:function setText(content){if(content instanceof Element){this.frame.innerHTML="";this.frame.appendChild(content)}else{this.frame.innerHTML=content}}},{key:"show",value:function show(doShow){if(doShow===undefined){doShow=true}if(doShow===true){var height=this.frame.clientHeight;var width=this.frame.clientWidth;var maxHeight=this.frame.parentNode.clientHeight;var maxWidth=this.frame.parentNode.clientWidth;var left=0,top=0;if(this.overflowMethod=="flip"){var isLeft=false,isTop=true;if(this.y-height<this.padding){isTop=false}if(this.x+width>maxWidth-this.padding){isLeft=true}if(isLeft){left=this.x-width}else{left=this.x}if(isTop){top=this.y-height}else{top=this.y}}else{top=this.y-height;if(top+height+this.padding>maxHeight){top=maxHeight-height-this.padding}if(top<this.padding){top=this.padding}left=this.x;if(left+width+this.padding>maxWidth){left=maxWidth-width-this.padding}if(left<this.padding){left=this.padding}}this.frame.style.left=left+"px";this.frame.style.top=top+"px";this.frame.style.visibility="visible";this.hidden=false}else{this.hide()}}},{key:"hide",value:function hide(){this.hidden=true;this.frame.style.visibility="hidden"}},{key:"destroy",value:function destroy(){this.frame.parentNode.removeChild(this.frame)}}]);return Popup}();exports["default"]=Popup},{"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.printStyle=undefined;var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _classCallCheck2=require("babel-runtime/helpers/classCallCheck");var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=require("babel-runtime/helpers/createClass");var _createClass3=_interopRequireDefault(_createClass2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../util");var errorFound=false;var allOptions=void 0;var printStyle="background: #FFeeee; color: #dd0000";var Validator=function(){function Validator(){(0,_classCallCheck3["default"])(this,Validator)}(0,_createClass3["default"])(Validator,null,[{key:"validate",value:function validate(options,referenceOptions,subObject){errorFound=false;allOptions=referenceOptions;var usedOptions=referenceOptions;if(subObject!==undefined){usedOptions=referenceOptions[subObject]}Validator.parse(options,usedOptions,[]);return errorFound}},{key:"parse",value:function parse(options,referenceOptions,path){for(var option in options){if(options.hasOwnProperty(option)){Validator.check(option,options,referenceOptions,path)}}}},{key:"check",value:function check(option,options,referenceOptions,path){if(referenceOptions[option]===undefined&&referenceOptions.__any__===undefined){Validator.getSuggestion(option,referenceOptions,path)}else if(referenceOptions[option]===undefined&&referenceOptions.__any__!==undefined){if(Validator.getType(options[option])==="object"&&referenceOptions["__any__"].__type__!==undefined){Validator.checkFields(option,options,referenceOptions,"__any__",referenceOptions["__any__"].__type__,path)}else{Validator.checkFields(option,options,referenceOptions,"__any__",referenceOptions["__any__"],path)}}else{if(referenceOptions[option].__type__!==undefined){Validator.checkFields(option,options,referenceOptions,option,referenceOptions[option].__type__,path)}else{Validator.checkFields(option,options,referenceOptions,option,referenceOptions[option],path)}}}},{key:"checkFields",value:function checkFields(option,options,referenceOptions,referenceOption,refOptionObj,path){var optionType=Validator.getType(options[option]);var refOptionType=refOptionObj[optionType];if(refOptionType!==undefined){if(Validator.getType(refOptionType)==="array"){if(refOptionType.indexOf(options[option])===-1){console.log('%cInvalid option detected in "'+option+'".'+" Allowed values are:"+Validator.print(refOptionType)+' not "'+options[option]+'". '+Validator.printLocation(path,option),printStyle);errorFound=true}else if(optionType==="object"&&referenceOption!=="__any__"){path=util.copyAndExtendArray(path,option);Validator.parse(options[option],referenceOptions[referenceOption],path)}}else if(optionType==="object"&&referenceOption!=="__any__"){path=util.copyAndExtendArray(path,option);Validator.parse(options[option],referenceOptions[referenceOption],path)}}else if(refOptionObj["any"]===undefined){console.log('%cInvalid type received for "'+option+'". Expected: '+Validator.print((0,_keys2["default"])(refOptionObj))+". Received ["+optionType+'] "'+options[option]+'"'+Validator.printLocation(path,option),printStyle);errorFound=true}}},{key:"getType",value:function getType(object){var type=typeof object==="undefined"?"undefined":(0,_typeof3["default"])(object);if(type==="object"){if(object===null){return"null"}if(object instanceof Boolean){return"boolean"}if(object instanceof Number){return"number"}if(object instanceof String){return"string"}if(Array.isArray(object)){return"array"}if(object instanceof Date){return"date"}if(object.nodeType!==undefined){return"dom"}if(object._isAMomentObject===true){return"moment"}return"object"}else if(type==="number"){return"number"}else if(type==="boolean"){return"boolean"}else if(type==="string"){return"string"}else if(type===undefined){return"undefined"}return type}},{key:"getSuggestion",value:function getSuggestion(option,options,path){var localSearch=Validator.findInOptions(option,options,path,false);var globalSearch=Validator.findInOptions(option,allOptions,[],true);var localSearchThreshold=8;var globalSearchThreshold=4;if(localSearch.indexMatch!==undefined){console.log('%cUnknown option detected: "'+option+'" in '+Validator.printLocation(localSearch.path,option,"")+'Perhaps it was incomplete? Did you mean: "'+localSearch.indexMatch+'"?\n\n',printStyle)}else if(globalSearch.distance<=globalSearchThreshold&&localSearch.distance>globalSearch.distance){console.log('%cUnknown option detected: "'+option+'" in '+Validator.printLocation(localSearch.path,option,"")+"Perhaps it was misplaced? Matching option found at: "+Validator.printLocation(globalSearch.path,globalSearch.closestMatch,""),printStyle)}else if(localSearch.distance<=localSearchThreshold){console.log('%cUnknown option detected: "'+option+'". Did you mean "'+localSearch.closestMatch+'"?'+Validator.printLocation(localSearch.path,option),printStyle)}else{console.log('%cUnknown option detected: "'+option+'". Did you mean one of these: '+Validator.print((0,_keys2["default"])(options))+Validator.printLocation(path,option),printStyle)}errorFound=true}},{key:"findInOptions",value:function findInOptions(option,options,path){var recursive=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var min=1e9;var closestMatch="";var closestMatchPath=[];var lowerCaseOption=option.toLowerCase();var indexMatch=undefined;for(var op in options){var distance=void 0;if(options[op].__type__!==undefined&&recursive===true){var result=Validator.findInOptions(option,options[op],util.copyAndExtendArray(path,op));if(min>result.distance){closestMatch=result.closestMatch;closestMatchPath=result.path;min=result.distance;indexMatch=result.indexMatch}}else{if(op.toLowerCase().indexOf(lowerCaseOption)!==-1){indexMatch=op}distance=Validator.levenshteinDistance(option,op);if(min>distance){closestMatch=op;closestMatchPath=util.copyArray(path);min=distance}}}return{closestMatch:closestMatch,path:closestMatchPath,distance:min,indexMatch:indexMatch}}},{key:"printLocation",value:function printLocation(path,option){var prefix=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Problem value found at: \n";var str="\n\n"+prefix+"options = {\n";for(var i=0;i<path.length;i++){for(var j=0;j<i+1;j++){str+="  "}str+=path[i]+": {\n"}for(var _j=0;_j<path.length+1;_j++){str+="  "}str+=option+"\n";for(var _i=0;_i<path.length+1;_i++){for(var _j2=0;_j2<path.length-_i;_j2++){str+="  "}str+="}\n"}return str+"\n\n"}},{key:"print",value:function print(options){return(0,_stringify2["default"])(options).replace(/(\")|(\[)|(\])|(,"__type__")/g,"").replace(/(\,)/g,", ")}},{key:"levenshteinDistance",value:function levenshteinDistance(a,b){if(a.length===0)return b.length;if(b.length===0)return a.length;var matrix=[];var i;for(i=0;i<=b.length;i++){matrix[i]=[i]}var j;for(j=0;j<=a.length;j++){matrix[0][j]=j}for(i=1;i<=b.length;i++){for(j=1;j<=a.length;j++){if(b.charAt(i-1)==a.charAt(j-1)){matrix[i][j]=matrix[i-1][j-1]}else{matrix[i][j]=Math.min(matrix[i-1][j-1]+1,Math.min(matrix[i][j-1]+1,matrix[i-1][j]+1))}}}return matrix[b.length][a.length]}}]);return Validator}();exports["default"]=Validator;exports.printStyle=printStyle},{"../util":116,"babel-runtime/core-js/json/stringify":119,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/classCallCheck":128,"babel-runtime/helpers/createClass":129,"babel-runtime/helpers/typeof":133}],86:[function(require,module,exports){"use strict";var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Emitter=require("emitter-component");var Hammer=require("../module/hammer");var hammerUtil=require("../hammerUtil");var util=require("../util");var DataSet=require("../DataSet");var DataView=require("../DataView");var Range=require("./Range");var ItemSet=require("./component/ItemSet");var TimeAxis=require("./component/TimeAxis");var Activator=require("../shared/Activator");var DateUtil=require("./DateUtil");var CustomTime=require("./component/CustomTime");function Core(){}Emitter(Core.prototype);Core.prototype._create=function(container){this.dom={};this.dom.container=container;this.dom.root=document.createElement("div");this.dom.background=document.createElement("div");this.dom.backgroundVertical=document.createElement("div");this.dom.backgroundHorizontal=document.createElement("div");this.dom.centerContainer=document.createElement("div");this.dom.leftContainer=document.createElement("div");this.dom.rightContainer=document.createElement("div");this.dom.center=document.createElement("div");this.dom.left=document.createElement("div");this.dom.right=document.createElement("div");this.dom.top=document.createElement("div");this.dom.bottom=document.createElement("div");this.dom.shadowTop=document.createElement("div");this.dom.shadowBottom=document.createElement("div");this.dom.shadowTopLeft=document.createElement("div");this.dom.shadowBottomLeft=document.createElement("div");this.dom.shadowTopRight=document.createElement("div");this.dom.shadowBottomRight=document.createElement("div");this.dom.rollingModeBtn=document.createElement("div");this.dom.root.className="vis-timeline";this.dom.background.className="vis-panel vis-background";this.dom.backgroundVertical.className="vis-panel vis-background vis-vertical";this.dom.backgroundHorizontal.className="vis-panel vis-background vis-horizontal";this.dom.centerContainer.className="vis-panel vis-center";this.dom.leftContainer.className="vis-panel vis-left";this.dom.rightContainer.className="vis-panel vis-right";this.dom.top.className="vis-panel vis-top";this.dom.bottom.className="vis-panel vis-bottom";this.dom.left.className="vis-content";this.dom.center.className="vis-content";this.dom.right.className="vis-content";this.dom.shadowTop.className="vis-shadow vis-top";this.dom.shadowBottom.className="vis-shadow vis-bottom";this.dom.shadowTopLeft.className="vis-shadow vis-top";this.dom.shadowBottomLeft.className="vis-shadow vis-bottom";
this.dom.shadowTopRight.className="vis-shadow vis-top";this.dom.shadowBottomRight.className="vis-shadow vis-bottom";this.dom.rollingModeBtn.className="vis-rolling-mode-btn";this.dom.root.appendChild(this.dom.background);this.dom.root.appendChild(this.dom.backgroundVertical);this.dom.root.appendChild(this.dom.backgroundHorizontal);this.dom.root.appendChild(this.dom.centerContainer);this.dom.root.appendChild(this.dom.leftContainer);this.dom.root.appendChild(this.dom.rightContainer);this.dom.root.appendChild(this.dom.top);this.dom.root.appendChild(this.dom.bottom);this.dom.root.appendChild(this.dom.bottom);this.dom.root.appendChild(this.dom.rollingModeBtn);this.dom.centerContainer.appendChild(this.dom.center);this.dom.leftContainer.appendChild(this.dom.left);this.dom.rightContainer.appendChild(this.dom.right);this.dom.centerContainer.appendChild(this.dom.shadowTop);this.dom.centerContainer.appendChild(this.dom.shadowBottom);this.dom.leftContainer.appendChild(this.dom.shadowTopLeft);this.dom.leftContainer.appendChild(this.dom.shadowBottomLeft);this.dom.rightContainer.appendChild(this.dom.shadowTopRight);this.dom.rightContainer.appendChild(this.dom.shadowBottomRight);this.props={root:{},background:{},centerContainer:{},leftContainer:{},rightContainer:{},center:{},left:{},right:{},top:{},bottom:{},border:{},scrollTop:0,scrollTopMin:0};this.on("rangechange",function(){if(this.initialDrawDone===true){this._redraw()}}.bind(this));this.on("touch",this._onTouch.bind(this));this.on("panmove",this._onDrag.bind(this));var me=this;this._origRedraw=this._redraw.bind(this);this._redraw=util.throttle(this._origRedraw);this.on("_change",function(properties){if(me.itemSet&&me.itemSet.initialItemSetDrawn&&properties&&properties.queue==true){me._redraw()}else{me._origRedraw()}});this.hammer=new Hammer(this.dom.root);var pinchRecognizer=this.hammer.get("pinch").set({enable:true});hammerUtil.disablePreventDefaultVertically(pinchRecognizer);this.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_HORIZONTAL});this.listeners={};var events=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];events.forEach(function(type){var listener=function listener(event){if(me.isActive()){me.emit(type,event)}};me.hammer.on(type,listener);me.listeners[type]=listener});hammerUtil.onTouch(this.hammer,function(event){me.emit("touch",event)}.bind(this));hammerUtil.onRelease(this.hammer,function(event){me.emit("release",event)}.bind(this));function onMouseWheel(event){if(this.isActive()){this.emit("mousewheel",event)}if(!this.options.verticalScroll||this.options.horizontalScroll)return;if(!this.options.zoomKey||event[this.options.zoomKey])return;event.preventDefault();var delta=0;if(event.wheelDelta){delta=event.wheelDelta/120}else if(event.detail){delta=-event.detail/3}var current=this.props.scrollTop;var adjusted=current+delta*120;if(this.isActive()){this._setScrollTop(adjusted);this._redraw();this.emit("scroll",event)}}if(this.dom.centerContainer.addEventListener){this.dom.centerContainer.addEventListener("mousewheel",onMouseWheel.bind(this),false);this.dom.centerContainer.addEventListener("DOMMouseScroll",onMouseWheel.bind(this),false)}else{this.dom.centerContainer.attachEvent("onmousewheel",onMouseWheel.bind(this))}function onMouseScrollSide(event){if(!me.options.verticalScroll)return;event.preventDefault();if(me.isActive()){var adjusted=-event.target.scrollTop;me._setScrollTop(adjusted);me._redraw();me.emit("scrollSide",event)}}this.dom.left.parentNode.addEventListener("scroll",onMouseScrollSide.bind(this));this.dom.right.parentNode.addEventListener("scroll",onMouseScrollSide.bind(this));var itemAddedToTimeline=false;function handleDragOver(event){if(event.preventDefault){event.preventDefault()}if(!event.target.className.indexOf("vis")>-1)return;if(itemAddedToTimeline)return;event.dataTransfer.dropEffect="move";itemAddedToTimeline=true;return false}function handleDrop(event){try{var itemData=JSON.parse(event.dataTransfer.getData("text"));if(!itemData.content)return}catch(err){return false}itemAddedToTimeline=false;event.center={x:event.clientX,y:event.clientY};me.itemSet._onAddItem(event);return false}this.dom.center.addEventListener("dragover",handleDragOver.bind(this),false);this.dom.center.addEventListener("drop",handleDrop.bind(this),false);this.customTimes=[];this.touch={};this.redrawCount=0;this.initialDrawDone=false;if(!container)throw new Error("No container provided");container.appendChild(this.dom.root)};Core.prototype.setOptions=function(options){if(options){var fields=["width","height","minHeight","maxHeight","autoResize","start","end","clickToUse","dataAttributes","hiddenDates","locale","locales","moment","rtl","zoomKey","horizontalScroll","verticalScroll"];util.selectiveExtend(fields,this.options,options);this.dom.rollingModeBtn.style.visibility="hidden";if(this.options.rtl){this.dom.container.style.direction="rtl";this.dom.backgroundVertical.className="vis-panel vis-background vis-vertical-rtl"}if(this.options.verticalScroll){if(this.options.rtl){this.dom.rightContainer.className="vis-panel vis-right vis-vertical-scroll"}else{this.dom.leftContainer.className="vis-panel vis-left vis-vertical-scroll"}}this.options.orientation={item:undefined,axis:undefined};if("orientation"in options){if(typeof options.orientation==="string"){this.options.orientation={item:options.orientation,axis:options.orientation}}else if((0,_typeof3["default"])(options.orientation)==="object"){if("item"in options.orientation){this.options.orientation.item=options.orientation.item}if("axis"in options.orientation){this.options.orientation.axis=options.orientation.axis}}}if(this.options.orientation.axis==="both"){if(!this.timeAxis2){var timeAxis2=this.timeAxis2=new TimeAxis(this.body);timeAxis2.setOptions=function(options){var _options=options?util.extend({},options):{};_options.orientation="top";TimeAxis.prototype.setOptions.call(timeAxis2,_options)};this.components.push(timeAxis2)}}else{if(this.timeAxis2){var index=this.components.indexOf(this.timeAxis2);if(index!==-1){this.components.splice(index,1)}this.timeAxis2.destroy();this.timeAxis2=null}}if(typeof options.drawPoints=="function"){options.drawPoints={onRender:options.drawPoints}}if("hiddenDates"in this.options){DateUtil.convertHiddenOptions(this.options.moment,this.body,this.options.hiddenDates)}if("clickToUse"in options){if(options.clickToUse){if(!this.activator){this.activator=new Activator(this.dom.root)}}else{if(this.activator){this.activator.destroy();delete this.activator}}}if("showCustomTime"in options){throw new Error("Option `showCustomTime` is deprecated. Create a custom time bar via timeline.addCustomTime(time [, id])")}this._initAutoResize()}this.components.forEach(function(component){return component.setOptions(options)});if("configure"in options){if(!this.configurator){this.configurator=this._createConfigurator()}this.configurator.setOptions(options.configure);var appliedOptions=util.deepExtend({},this.options);this.components.forEach(function(component){util.deepExtend(appliedOptions,component.options)});this.configurator.setModuleOptions({global:appliedOptions})}this._redraw()};Core.prototype.isActive=function(){return!this.activator||this.activator.active};Core.prototype.destroy=function(){this.setItems(null);this.setGroups(null);this.off();this._stopAutoResize();if(this.dom.root.parentNode){this.dom.root.parentNode.removeChild(this.dom.root)}this.dom=null;if(this.activator){this.activator.destroy();delete this.activator}for(var event in this.listeners){if(this.listeners.hasOwnProperty(event)){delete this.listeners[event]}}this.listeners=null;this.hammer=null;this.components.forEach(function(component){return component.destroy()});this.body=null};Core.prototype.setCustomTime=function(time,id){var customTimes=this.customTimes.filter(function(component){return id===component.options.id});if(customTimes.length===0){throw new Error("No custom time bar found with id "+(0,_stringify2["default"])(id))}if(customTimes.length>0){customTimes[0].setCustomTime(time)}};Core.prototype.getCustomTime=function(id){var customTimes=this.customTimes.filter(function(component){return component.options.id===id});if(customTimes.length===0){throw new Error("No custom time bar found with id "+(0,_stringify2["default"])(id))}return customTimes[0].getCustomTime()};Core.prototype.setCustomTimeTitle=function(title,id){var customTimes=this.customTimes.filter(function(component){return component.options.id===id});if(customTimes.length===0){throw new Error("No custom time bar found with id "+(0,_stringify2["default"])(id))}if(customTimes.length>0){return customTimes[0].setCustomTitle(title)}};Core.prototype.getEventProperties=function(event){return{event:event}};Core.prototype.addCustomTime=function(time,id){var timestamp=time!==undefined?util.convert(time,"Date").valueOf():new Date;var exists=this.customTimes.some(function(customTime){return customTime.options.id===id});if(exists){throw new Error("A custom time with id "+(0,_stringify2["default"])(id)+" already exists")}var customTime=new CustomTime(this.body,util.extend({},this.options,{time:timestamp,id:id}));this.customTimes.push(customTime);this.components.push(customTime);this._redraw();return id};Core.prototype.removeCustomTime=function(id){var customTimes=this.customTimes.filter(function(bar){return bar.options.id===id});if(customTimes.length===0){throw new Error("No custom time bar found with id "+(0,_stringify2["default"])(id))}customTimes.forEach(function(customTime){this.customTimes.splice(this.customTimes.indexOf(customTime),1);this.components.splice(this.components.indexOf(customTime),1);customTime.destroy()}.bind(this))};Core.prototype.getVisibleItems=function(){return this.itemSet&&this.itemSet.getVisibleItems()||[]};Core.prototype.fit=function(options){var range=this.getDataRange();if(range.min===null&&range.max===null){return}var interval=range.max-range.min;var min=new Date(range.min.valueOf()-interval*.01);var max=new Date(range.max.valueOf()+interval*.01);var animation=options&&options.animation!==undefined?options.animation:true;this.range.setRange(min,max,animation)};Core.prototype.getDataRange=function(){throw new Error("Cannot invoke abstract method getDataRange")};Core.prototype.setWindow=function(start,end,options){var animation;if(arguments.length==1){var range=arguments[0];animation=range.animation!==undefined?range.animation:true;this.range.setRange(range.start,range.end,animation)}else{animation=options&&options.animation!==undefined?options.animation:true;this.range.setRange(start,end,animation)}};Core.prototype.moveTo=function(time,options){var interval=this.range.end-this.range.start;var t=util.convert(time,"Date").valueOf();var start=t-interval/2;var end=t+interval/2;var animation=options&&options.animation!==undefined?options.animation:true;this.range.setRange(start,end,animation)};Core.prototype.getWindow=function(){var range=this.range.getRange();return{start:new Date(range.start),end:new Date(range.end)}};Core.prototype.zoomIn=function(percentage){if(!percentage||percentage<0||percentage>1)return;var range=this.getWindow();var start=range.start.valueOf();var end=range.end.valueOf();var interval=end-start;var newInterval=interval/(1+percentage);var distance=(interval-newInterval)/2;var newStart=start+distance;var newEnd=end-distance;this.setWindow({start:newStart,end:newEnd})};Core.prototype.zoomOut=function(percentage){if(!percentage||percentage<0||percentage>1)return;var range=this.getWindow();var start=range.start.valueOf();var end=range.end.valueOf();var interval=end-start;var newStart=start-interval*percentage/2;var newEnd=end+interval*percentage/2;this.setWindow({start:newStart,end:newEnd})};Core.prototype.redraw=function(){this._redraw()};Core.prototype._redraw=function(){this.redrawCount++;var resized=false;var options=this.options;var props=this.props;var dom=this.dom;if(!dom||!dom.container||dom.root.offsetWidth==0)return;DateUtil.updateHiddenDates(this.options.moment,this.body,this.options.hiddenDates);if(options.orientation=="top"){util.addClassName(dom.root,"vis-top");util.removeClassName(dom.root,"vis-bottom")}else{util.removeClassName(dom.root,"vis-top");util.addClassName(dom.root,"vis-bottom")}dom.root.style.maxHeight=util.option.asSize(options.maxHeight,"");dom.root.style.minHeight=util.option.asSize(options.minHeight,"");dom.root.style.width=util.option.asSize(options.width,"");props.border.left=(dom.centerContainer.offsetWidth-dom.centerContainer.clientWidth)/2;props.border.right=props.border.left;props.border.top=(dom.centerContainer.offsetHeight-dom.centerContainer.clientHeight)/2;props.border.bottom=props.border.top;props.borderRootHeight=dom.root.offsetHeight-dom.root.clientHeight;props.borderRootWidth=dom.root.offsetWidth-dom.root.clientWidth;if(dom.centerContainer.clientHeight===0){props.border.left=props.border.top;props.border.right=props.border.left}if(dom.root.clientHeight===0){props.borderRootWidth=props.borderRootHeight}props.center.height=dom.center.offsetHeight;props.left.height=dom.left.offsetHeight;props.right.height=dom.right.offsetHeight;props.top.height=dom.top.clientHeight||-props.border.top;props.bottom.height=dom.bottom.clientHeight||-props.border.bottom;var contentHeight=Math.max(props.left.height,props.center.height,props.right.height);var autoHeight=props.top.height+contentHeight+props.bottom.height+props.borderRootHeight+props.border.top+props.border.bottom;dom.root.style.height=util.option.asSize(options.height,autoHeight+"px");props.root.height=dom.root.offsetHeight;props.background.height=props.root.height-props.borderRootHeight;var containerHeight=props.root.height-props.top.height-props.bottom.height-props.borderRootHeight;props.centerContainer.height=containerHeight;props.leftContainer.height=containerHeight;props.rightContainer.height=props.leftContainer.height;props.root.width=dom.root.offsetWidth;props.background.width=props.root.width-props.borderRootWidth;if(!this.initialDrawDone){props.scrollbarWidth=util.getScrollBarWidth()}if(options.verticalScroll){if(options.rtl){props.left.width=dom.leftContainer.clientWidth||-props.border.left;props.right.width=dom.rightContainer.clientWidth+props.scrollbarWidth||-props.border.right}else{props.left.width=dom.leftContainer.clientWidth+props.scrollbarWidth||-props.border.left;props.right.width=dom.rightContainer.clientWidth||-props.border.right}}else{props.left.width=dom.leftContainer.clientWidth||-props.border.left;props.right.width=dom.rightContainer.clientWidth||-props.border.right}this._setDOM();var offset=this._updateScrollTop();if(options.orientation.item!="top"){offset+=Math.max(props.centerContainer.height-props.center.height-props.border.top-props.border.bottom,0)}dom.center.style.top=offset+"px";var visibilityTop=props.scrollTop==0?"hidden":"";var visibilityBottom=props.scrollTop==props.scrollTopMin?"hidden":"";dom.shadowTop.style.visibility=visibilityTop;dom.shadowBottom.style.visibility=visibilityBottom;dom.shadowTopLeft.style.visibility=visibilityTop;dom.shadowBottomLeft.style.visibility=visibilityBottom;dom.shadowTopRight.style.visibility=visibilityTop;dom.shadowBottomRight.style.visibility=visibilityBottom;if(options.verticalScroll){dom.rightContainer.className="vis-panel vis-right vis-vertical-scroll";dom.leftContainer.className="vis-panel vis-left vis-vertical-scroll";dom.shadowTopRight.style.visibility="hidden";dom.shadowBottomRight.style.visibility="hidden";dom.shadowTopLeft.style.visibility="hidden";dom.shadowBottomLeft.style.visibility="hidden";dom.left.style.top="0px";dom.right.style.top="0px"}if(!options.verticalScroll||props.center.height<props.centerContainer.height){dom.left.style.top=offset+"px";dom.right.style.top=offset+"px";dom.rightContainer.className=dom.rightContainer.className.replace(new RegExp("(?:^|\\s)"+"vis-vertical-scroll"+"(?:\\s|$)")," ");dom.leftContainer.className=dom.leftContainer.className.replace(new RegExp("(?:^|\\s)"+"vis-vertical-scroll"+"(?:\\s|$)")," ");props.left.width=dom.leftContainer.clientWidth||-props.border.left;props.right.width=dom.rightContainer.clientWidth||-props.border.right;this._setDOM()}var contentsOverflow=props.center.height>props.centerContainer.height;this.hammer.get("pan").set({direction:contentsOverflow?Hammer.DIRECTION_ALL:Hammer.DIRECTION_HORIZONTAL});this.components.forEach(function(component){resized=component.redraw()||resized});var MAX_REDRAW=5;if(resized){if(this.redrawCount<MAX_REDRAW){this.body.emitter.emit("_change");return}else{console.log("WARNING: infinite loop in redraw?")}}else{this.redrawCount=0}this.initialDrawDone=true;this.body.emitter.emit("changed")};Core.prototype._setDOM=function(){var props=this.props;var dom=this.dom;props.leftContainer.width=props.left.width;props.rightContainer.width=props.right.width;var centerWidth=props.root.width-props.left.width-props.right.width-props.borderRootWidth;props.center.width=centerWidth;props.centerContainer.width=centerWidth;props.top.width=centerWidth;props.bottom.width=centerWidth;dom.background.style.height=props.background.height+"px";dom.backgroundVertical.style.height=props.background.height+"px";dom.backgroundHorizontal.style.height=props.centerContainer.height+"px";dom.centerContainer.style.height=props.centerContainer.height+"px";dom.leftContainer.style.height=props.leftContainer.height+"px";dom.rightContainer.style.height=props.rightContainer.height+"px";dom.background.style.width=props.background.width+"px";dom.backgroundVertical.style.width=props.centerContainer.width+"px";dom.backgroundHorizontal.style.width=props.background.width+"px";dom.centerContainer.style.width=props.center.width+"px";dom.top.style.width=props.top.width+"px";dom.bottom.style.width=props.bottom.width+"px";dom.background.style.left="0";dom.background.style.top="0";dom.backgroundVertical.style.left=props.left.width+props.border.left+"px";dom.backgroundVertical.style.top="0";dom.backgroundHorizontal.style.left="0";dom.backgroundHorizontal.style.top=props.top.height+"px";dom.centerContainer.style.left=props.left.width+"px";dom.centerContainer.style.top=props.top.height+"px";dom.leftContainer.style.left="0";dom.leftContainer.style.top=props.top.height+"px";dom.rightContainer.style.left=props.left.width+props.center.width+"px";dom.rightContainer.style.top=props.top.height+"px";dom.top.style.left=props.left.width+"px";dom.top.style.top="0";dom.bottom.style.left=props.left.width+"px";dom.bottom.style.top=props.top.height+props.centerContainer.height+"px";dom.center.style.left="0";dom.left.style.left="0";dom.right.style.left="0"};Core.prototype.repaint=function(){throw new Error("Function repaint is deprecated. Use redraw instead.")};Core.prototype.setCurrentTime=function(time){if(!this.currentTime){throw new Error("Option showCurrentTime must be true")}this.currentTime.setCurrentTime(time)};Core.prototype.getCurrentTime=function(){if(!this.currentTime){throw new Error("Option showCurrentTime must be true")}return this.currentTime.getCurrentTime()};Core.prototype._toTime=function(x){return DateUtil.toTime(this,x,this.props.center.width)};Core.prototype._toGlobalTime=function(x){return DateUtil.toTime(this,x,this.props.root.width)};Core.prototype._toScreen=function(time){return DateUtil.toScreen(this,time,this.props.center.width)};Core.prototype._toGlobalScreen=function(time){return DateUtil.toScreen(this,time,this.props.root.width)};Core.prototype._initAutoResize=function(){if(this.options.autoResize==true){this._startAutoResize()}else{this._stopAutoResize()}};Core.prototype._startAutoResize=function(){var me=this;this._stopAutoResize();this._onResize=function(){if(me.options.autoResize!=true){me._stopAutoResize();return}if(me.dom.root){if(me.dom.root.offsetWidth!=me.props.lastWidth||me.dom.root.offsetHeight!=me.props.lastHeight){me.props.lastWidth=me.dom.root.offsetWidth;me.props.lastHeight=me.dom.root.offsetHeight;me.props.scrollbarWidth=util.getScrollBarWidth();me.body.emitter.emit("_change")}}};util.addEventListener(window,"resize",this._onResize);if(me.dom.root){me.props.lastWidth=me.dom.root.offsetWidth;me.props.lastHeight=me.dom.root.offsetHeight}this.watchTimer=setInterval(this._onResize,1e3)};Core.prototype._stopAutoResize=function(){if(this.watchTimer){clearInterval(this.watchTimer);this.watchTimer=undefined}if(this._onResize){util.removeEventListener(window,"resize",this._onResize);this._onResize=null}};Core.prototype._onTouch=function(event){this.touch.allowDragging=true;this.touch.initialScrollTop=this.props.scrollTop};Core.prototype._onPinch=function(event){this.touch.allowDragging=false};Core.prototype._onDrag=function(event){if(!event)return;if(!this.touch.allowDragging)return;var delta=event.deltaY;var oldScrollTop=this._getScrollTop();var newScrollTop=this._setScrollTop(this.touch.initialScrollTop+delta);if(this.options.verticalScroll){this.dom.left.parentNode.scrollTop=-this.props.scrollTop;this.dom.right.parentNode.scrollTop=-this.props.scrollTop}if(newScrollTop!=oldScrollTop){this.emit("verticalDrag")}};Core.prototype._setScrollTop=function(scrollTop){this.props.scrollTop=scrollTop;this._updateScrollTop();return this.props.scrollTop};Core.prototype._updateScrollTop=function(){var scrollTopMin=Math.min(this.props.centerContainer.height-this.props.center.height,0);if(scrollTopMin!=this.props.scrollTopMin){if(this.options.orientation.item!="top"){this.props.scrollTop+=scrollTopMin-this.props.scrollTopMin}this.props.scrollTopMin=scrollTopMin}if(this.props.scrollTop>0)this.props.scrollTop=0;if(this.props.scrollTop<scrollTopMin)this.props.scrollTop=scrollTopMin;if(this.options.verticalScroll){this.dom.left.parentNode.scrollTop=-this.props.scrollTop;this.dom.right.parentNode.scrollTop=-this.props.scrollTop}return this.props.scrollTop};Core.prototype._getScrollTop=function(){return this.props.scrollTop};Core.prototype._createConfigurator=function(){throw new Error("Cannot invoke abstract method _createConfigurator")};module.exports=Core},{"../DataSet":6,"../DataView":7,"../hammerUtil":18,"../module/hammer":19,"../shared/Activator":81,"../util":116,"./DateUtil":87,"./Range":89,"./component/CustomTime":96,"./component/ItemSet":101,"./component/TimeAxis":104,"babel-runtime/core-js/json/stringify":119,"babel-runtime/helpers/typeof":133,"emitter-component":221}],87:[function(require,module,exports){"use strict";exports.convertHiddenOptions=function(moment,body,hiddenDates){if(hiddenDates&&!Array.isArray(hiddenDates)){return exports.convertHiddenOptions(moment,body,[hiddenDates])}body.hiddenDates=[];if(hiddenDates){if(Array.isArray(hiddenDates)==true){for(var i=0;i<hiddenDates.length;i++){if(hiddenDates[i].repeat===undefined){var dateItem={};dateItem.start=moment(hiddenDates[i].start).toDate().valueOf();dateItem.end=moment(hiddenDates[i].end).toDate().valueOf();body.hiddenDates.push(dateItem)}}body.hiddenDates.sort(function(a,b){return a.start-b.start})}}};exports.updateHiddenDates=function(moment,body,hiddenDates){if(hiddenDates&&!Array.isArray(hiddenDates)){return exports.updateHiddenDates(moment,body,[hiddenDates])}if(hiddenDates&&body.domProps.centerContainer.width!==undefined){exports.convertHiddenOptions(moment,body,hiddenDates);var start=moment(body.range.start);var end=moment(body.range.end);var totalRange=body.range.end-body.range.start;var pixelTime=totalRange/body.domProps.centerContainer.width;for(var i=0;i<hiddenDates.length;i++){if(hiddenDates[i].repeat!==undefined){var startDate=moment(hiddenDates[i].start);var endDate=moment(hiddenDates[i].end);if(startDate._d=="Invalid Date"){throw new Error("Supplied start date is not valid: "+hiddenDates[i].start)}if(endDate._d=="Invalid Date"){throw new Error("Supplied end date is not valid: "+hiddenDates[i].end)}var duration=endDate-startDate;if(duration>=4*pixelTime){var offset=0;var runUntil=end.clone();switch(hiddenDates[i].repeat){case"daily":if(startDate.day()!=endDate.day()){offset=1}startDate.dayOfYear(start.dayOfYear());startDate.year(start.year());startDate.subtract(7,"days");endDate.dayOfYear(start.dayOfYear());endDate.year(start.year());endDate.subtract(7-offset,"days");runUntil.add(1,"weeks");break;case"weekly":var dayOffset=endDate.diff(startDate,"days");var day=startDate.day();startDate.date(start.date());startDate.month(start.month());startDate.year(start.year());endDate=startDate.clone();startDate.day(day);endDate.day(day);endDate.add(dayOffset,"days");startDate.subtract(1,"weeks");endDate.subtract(1,"weeks");runUntil.add(1,"weeks");break;case"monthly":if(startDate.month()!=endDate.month()){offset=1}startDate.month(start.month());startDate.year(start.year());startDate.subtract(1,"months");endDate.month(start.month());endDate.year(start.year());endDate.subtract(1,"months");endDate.add(offset,"months");runUntil.add(1,"months");break;case"yearly":if(startDate.year()!=endDate.year()){offset=1}startDate.year(start.year());startDate.subtract(1,"years");endDate.year(start.year());endDate.subtract(1,"years");endDate.add(offset,"years");runUntil.add(1,"years");break;default:console.log("Wrong repeat format, allowed are: daily, weekly, monthly, yearly. Given:",hiddenDates[i].repeat);return}while(startDate<runUntil){body.hiddenDates.push({start:startDate.valueOf(),end:endDate.valueOf()});switch(hiddenDates[i].repeat){case"daily":startDate.add(1,"days");endDate.add(1,"days");break;case"weekly":startDate.add(1,"weeks");endDate.add(1,"weeks");break;case"monthly":startDate.add(1,"months");endDate.add(1,"months");break;case"yearly":startDate.add(1,"y");endDate.add(1,"y");break;default:console.log("Wrong repeat format, allowed are: daily, weekly, monthly, yearly. Given:",hiddenDates[i].repeat);return}}body.hiddenDates.push({start:startDate.valueOf(),end:endDate.valueOf()})}}}exports.removeDuplicates(body);var startHidden=exports.isHidden(body.range.start,body.hiddenDates);var endHidden=exports.isHidden(body.range.end,body.hiddenDates);var rangeStart=body.range.start;var rangeEnd=body.range.end;if(startHidden.hidden==true){rangeStart=body.range.startToFront==true?startHidden.startDate-1:startHidden.endDate+1}if(endHidden.hidden==true){rangeEnd=body.range.endToFront==true?endHidden.startDate-1:endHidden.endDate+1}if(startHidden.hidden==true||endHidden.hidden==true){body.range._applyRange(rangeStart,rangeEnd)}}};exports.removeDuplicates=function(body){var hiddenDates=body.hiddenDates;var safeDates=[];for(var i=0;i<hiddenDates.length;i++){for(var j=0;j<hiddenDates.length;j++){if(i!=j&&hiddenDates[j].remove!=true&&hiddenDates[i].remove!=true){if(hiddenDates[j].start>=hiddenDates[i].start&&hiddenDates[j].end<=hiddenDates[i].end){hiddenDates[j].remove=true}else if(hiddenDates[j].start>=hiddenDates[i].start&&hiddenDates[j].start<=hiddenDates[i].end){hiddenDates[i].end=hiddenDates[j].end;hiddenDates[j].remove=true}else if(hiddenDates[j].end>=hiddenDates[i].start&&hiddenDates[j].end<=hiddenDates[i].end){hiddenDates[i].start=hiddenDates[j].start;hiddenDates[j].remove=true}}}}for(var i=0;i<hiddenDates.length;i++){if(hiddenDates[i].remove!==true){safeDates.push(hiddenDates[i])}}body.hiddenDates=safeDates;body.hiddenDates.sort(function(a,b){return a.start-b.start})};exports.printDates=function(dates){for(var i=0;i<dates.length;i++){console.log(i,new Date(dates[i].start),new Date(dates[i].end),dates[i].start,dates[i].end,dates[i].remove)}};exports.stepOverHiddenDates=function(moment,timeStep,previousTime){var stepInHidden=false;var currentValue=timeStep.current.valueOf();for(var i=0;i<timeStep.hiddenDates.length;i++){var startDate=timeStep.hiddenDates[i].start;var endDate=timeStep.hiddenDates[i].end;if(currentValue>=startDate&&currentValue<endDate){stepInHidden=true;break}}if(stepInHidden==true&&currentValue<timeStep._end.valueOf()&&currentValue!=previousTime){var prevValue=moment(previousTime);var newValue=moment(endDate);if(prevValue.year()!=newValue.year()){timeStep.switchedYear=true}else if(prevValue.month()!=newValue.month()){timeStep.switchedMonth=true}else if(prevValue.dayOfYear()!=newValue.dayOfYear()){timeStep.switchedDay=true}timeStep.current=newValue}};exports.toScreen=function(Core,time,width){if(Core.body.hiddenDates.length==0){var conversion=Core.range.conversion(width);return(time.valueOf()-conversion.offset)*conversion.scale}else{var hidden=exports.isHidden(time,Core.body.hiddenDates);if(hidden.hidden==true){time=hidden.startDate}var duration=exports.getHiddenDurationBetween(Core.body.hiddenDates,Core.range.start,Core.range.end);if(time<Core.range.start){var conversion=Core.range.conversion(width,duration);var hiddenBeforeStart=exports.getHiddenDurationBeforeStart(Core.body.hiddenDates,time,conversion.offset);time=Core.options.moment(time).toDate().valueOf();time=time+hiddenBeforeStart;return-(conversion.offset-time.valueOf())*conversion.scale}else if(time>Core.range.end){var rangeAfterEnd={start:Core.range.start,end:time};time=exports.correctTimeForHidden(Core.options.moment,Core.body.hiddenDates,rangeAfterEnd,time);var conversion=Core.range.conversion(width,duration);return(time.valueOf()-conversion.offset)*conversion.scale}else{time=exports.correctTimeForHidden(Core.options.moment,Core.body.hiddenDates,Core.range,time);var conversion=Core.range.conversion(width,duration);return(time.valueOf()-conversion.offset)*conversion.scale}}};exports.toTime=function(Core,x,width){if(Core.body.hiddenDates.length==0){var conversion=Core.range.conversion(width);return new Date(x/conversion.scale+conversion.offset)}else{var hiddenDuration=exports.getHiddenDurationBetween(Core.body.hiddenDates,Core.range.start,Core.range.end);var totalDuration=Core.range.end-Core.range.start-hiddenDuration;var partialDuration=totalDuration*x/width;var accumulatedHiddenDuration=exports.getAccumulatedHiddenDuration(Core.body.hiddenDates,Core.range,partialDuration);var newTime=new Date(accumulatedHiddenDuration+partialDuration+Core.range.start);return newTime}};exports.getHiddenDurationBetween=function(hiddenDates,start,end){var duration=0;for(var i=0;i<hiddenDates.length;i++){var startDate=hiddenDates[i].start;var endDate=hiddenDates[i].end;if(startDate>=start&&endDate<end){duration+=endDate-startDate}}return duration};exports.getHiddenDurationBeforeStart=function(hiddenDates,start,end){var duration=0;for(var i=0;i<hiddenDates.length;i++){var startDate=hiddenDates[i].start;var endDate=hiddenDates[i].end;if(startDate>=start&&endDate<=end){duration+=endDate-startDate}}return duration};exports.correctTimeForHidden=function(moment,hiddenDates,range,time){time=moment(time).toDate().valueOf();time-=exports.getHiddenDurationBefore(moment,hiddenDates,range,time);return time};exports.getHiddenDurationBefore=function(moment,hiddenDates,range,time){var timeOffset=0;time=moment(time).toDate().valueOf();for(var i=0;i<hiddenDates.length;i++){var startDate=hiddenDates[i].start;var endDate=hiddenDates[i].end;if(startDate>=range.start&&endDate<range.end){if(time>=endDate){timeOffset+=endDate-startDate}}}return timeOffset};exports.getAccumulatedHiddenDuration=function(hiddenDates,range,requiredDuration){var hiddenDuration=0;var duration=0;var previousPoint=range.start;for(var i=0;i<hiddenDates.length;i++){var startDate=hiddenDates[i].start;var endDate=hiddenDates[i].end;if(startDate>=range.start&&endDate<range.end){duration+=startDate-previousPoint;previousPoint=endDate;if(duration>=requiredDuration){break}else{hiddenDuration+=endDate-startDate}}}return hiddenDuration};exports.snapAwayFromHidden=function(hiddenDates,time,direction,correctionEnabled){var isHidden=exports.isHidden(time,hiddenDates);if(isHidden.hidden==true){if(direction<0){if(correctionEnabled==true){return isHidden.startDate-(isHidden.endDate-time)-1}else{return isHidden.startDate-1}}else{if(correctionEnabled==true){return isHidden.endDate+(time-isHidden.startDate)+1}else{return isHidden.endDate+1}}}else{return time}};exports.isHidden=function(time,hiddenDates){for(var i=0;i<hiddenDates.length;i++){var startDate=hiddenDates[i].start;var endDate=hiddenDates[i].end;if(time>=startDate&&time<endDate){return{
hidden:true,startDate:startDate,endDate:endDate};break}}return{hidden:false,startDate:startDate,endDate:endDate}}},{}],88:[function(require,module,exports){"use strict";var _Configurator=require("../shared/Configurator");var _Configurator2=_interopRequireDefault(_Configurator);var _Validator=require("../shared/Validator");var _Validator2=_interopRequireDefault(_Validator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Emitter=require("emitter-component");var Hammer=require("../module/hammer");var moment=require("../module/moment");var util=require("../util");var DataSet=require("../DataSet");var DataView=require("../DataView");var Range=require("./Range");var Core=require("./Core");var TimeAxis=require("./component/TimeAxis");var CurrentTime=require("./component/CurrentTime");var CustomTime=require("./component/CustomTime");var LineGraph=require("./component/LineGraph");var printStyle=require("../shared/Validator").printStyle;var allOptions=require("./optionsGraph2d").allOptions;var configureOptions=require("./optionsGraph2d").configureOptions;function Graph2d(container,items,groups,options){if(!(Array.isArray(groups)||groups instanceof DataSet||groups instanceof DataView)&&groups instanceof Object){var forthArgument=options;options=groups;groups=forthArgument}if(options&&options.throttleRedraw){console.warn('Graph2d option "throttleRedraw" is DEPRICATED and no longer supported. It will be removed in the next MAJOR release.')}var me=this;this.defaultOptions={start:null,end:null,autoResize:true,orientation:{axis:"bottom",item:"bottom"},moment:moment,width:null,height:null,maxHeight:null,minHeight:null};this.options=util.deepExtend({},this.defaultOptions);this._create(container);this.components=[];this.body={dom:this.dom,domProps:this.props,emitter:{on:this.on.bind(this),off:this.off.bind(this),emit:this.emit.bind(this)},hiddenDates:[],util:{toScreen:me._toScreen.bind(me),toGlobalScreen:me._toGlobalScreen.bind(me),toTime:me._toTime.bind(me),toGlobalTime:me._toGlobalTime.bind(me)}};this.range=new Range(this.body);this.components.push(this.range);this.body.range=this.range;this.timeAxis=new TimeAxis(this.body);this.components.push(this.timeAxis);this.currentTime=new CurrentTime(this.body);this.components.push(this.currentTime);this.linegraph=new LineGraph(this.body);this.components.push(this.linegraph);this.itemsData=null;this.groupsData=null;this.on("tap",function(event){me.emit("click",me.getEventProperties(event))});this.on("doubletap",function(event){me.emit("doubleClick",me.getEventProperties(event))});this.dom.root.oncontextmenu=function(event){me.emit("contextmenu",me.getEventProperties(event))};if(options){this.setOptions(options)}if(groups){this.setGroups(groups)}if(items){this.setItems(items)}this._redraw()}Graph2d.prototype=new Core;Graph2d.prototype.setOptions=function(options){var errorFound=_Validator2["default"].validate(options,allOptions);if(errorFound===true){console.log("%cErrors have been found in the supplied options object.",printStyle)}Core.prototype.setOptions.call(this,options)};Graph2d.prototype.setItems=function(items){var initialLoad=this.itemsData==null;var newDataSet;if(!items){newDataSet=null}else if(items instanceof DataSet||items instanceof DataView){newDataSet=items}else{newDataSet=new DataSet(items,{type:{start:"Date",end:"Date"}})}this.itemsData=newDataSet;this.linegraph&&this.linegraph.setItems(newDataSet);if(initialLoad){if(this.options.start!=undefined||this.options.end!=undefined){var start=this.options.start!=undefined?this.options.start:null;var end=this.options.end!=undefined?this.options.end:null;this.setWindow(start,end,{animation:false})}else{this.fit({animation:false})}}};Graph2d.prototype.setGroups=function(groups){var newDataSet;if(!groups){newDataSet=null}else if(groups instanceof DataSet||groups instanceof DataView){newDataSet=groups}else{newDataSet=new DataSet(groups)}this.groupsData=newDataSet;this.linegraph.setGroups(newDataSet)};Graph2d.prototype.getLegend=function(groupId,width,height){if(width===undefined){width=15}if(height===undefined){height=15}if(this.linegraph.groups[groupId]!==undefined){return this.linegraph.groups[groupId].getLegend(width,height)}else{return"cannot find group:'"+groupId+"'"}};Graph2d.prototype.isGroupVisible=function(groupId){if(this.linegraph.groups[groupId]!==undefined){return this.linegraph.groups[groupId].visible&&(this.linegraph.options.groups.visibility[groupId]===undefined||this.linegraph.options.groups.visibility[groupId]==true)}else{return false}};Graph2d.prototype.getDataRange=function(){var min=null;var max=null;for(var groupId in this.linegraph.groups){if(this.linegraph.groups.hasOwnProperty(groupId)){if(this.linegraph.groups[groupId].visible==true){for(var i=0;i<this.linegraph.groups[groupId].itemsData.length;i++){var item=this.linegraph.groups[groupId].itemsData[i];var value=util.convert(item.x,"Date").valueOf();min=min==null?value:min>value?value:min;max=max==null?value:max<value?value:max}}}}return{min:min!=null?new Date(min):null,max:max!=null?new Date(max):null}};Graph2d.prototype.getEventProperties=function(event){var clientX=event.center?event.center.x:event.clientX;var clientY=event.center?event.center.y:event.clientY;var x=clientX-util.getAbsoluteLeft(this.dom.centerContainer);var y=clientY-util.getAbsoluteTop(this.dom.centerContainer);var time=this._toTime(x);var customTime=CustomTime.customTimeFromTarget(event);var element=util.getTarget(event);var what=null;if(util.hasParent(element,this.timeAxis.dom.foreground)){what="axis"}else if(this.timeAxis2&&util.hasParent(element,this.timeAxis2.dom.foreground)){what="axis"}else if(util.hasParent(element,this.linegraph.yAxisLeft.dom.frame)){what="data-axis"}else if(util.hasParent(element,this.linegraph.yAxisRight.dom.frame)){what="data-axis"}else if(util.hasParent(element,this.linegraph.legendLeft.dom.frame)){what="legend"}else if(util.hasParent(element,this.linegraph.legendRight.dom.frame)){what="legend"}else if(customTime!=null){what="custom-time"}else if(util.hasParent(element,this.currentTime.bar)){what="current-time"}else if(util.hasParent(element,this.dom.center)){what="background"}var value=[];var yAxisLeft=this.linegraph.yAxisLeft;var yAxisRight=this.linegraph.yAxisRight;if(!yAxisLeft.hidden&&this.itemsData.length>0){value.push(yAxisLeft.screenToValue(y))}if(!yAxisRight.hidden&&this.itemsData.length>0){value.push(yAxisRight.screenToValue(y))}return{event:event,what:what,pageX:event.srcEvent?event.srcEvent.pageX:event.pageX,pageY:event.srcEvent?event.srcEvent.pageY:event.pageY,x:x,y:y,time:time,value:value}};Graph2d.prototype._createConfigurator=function(){return new _Configurator2["default"](this,this.dom.container,configureOptions)};module.exports=Graph2d},{"../DataSet":6,"../DataView":7,"../module/hammer":19,"../module/moment":20,"../shared/Configurator":83,"../shared/Validator":85,"../util":116,"./Core":86,"./Range":89,"./component/CurrentTime":95,"./component/CustomTime":96,"./component/LineGraph":103,"./component/TimeAxis":104,"./optionsGraph2d":114,"emitter-component":221}],89:[function(require,module,exports){"use strict";var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../util");var hammerUtil=require("../hammerUtil");var moment=require("../module/moment");var Component=require("./component/Component");var DateUtil=require("./DateUtil");function Range(body,options){var now=moment().hours(0).minutes(0).seconds(0).milliseconds(0);var start=now.clone().add(-3,"days").valueOf();var end=now.clone().add(-3,"days").valueOf();if(options===undefined){this.start=start;this.end=end}else{this.start=options.start||start;this.end=options.end||end}this.rolling=false;this.body=body;this.deltaDifference=0;this.scaleOffset=0;this.startToFront=false;this.endToFront=true;this.defaultOptions={rtl:false,start:null,end:null,moment:moment,direction:"horizontal",moveable:true,zoomable:true,min:null,max:null,zoomMin:10,zoomMax:1e3*60*60*24*365*1e4};this.options=util.extend({},this.defaultOptions);this.props={touch:{}};this.animationTimer=null;this.body.emitter.on("panstart",this._onDragStart.bind(this));this.body.emitter.on("panmove",this._onDrag.bind(this));this.body.emitter.on("panend",this._onDragEnd.bind(this));this.body.emitter.on("mousewheel",this._onMouseWheel.bind(this));this.body.emitter.on("touch",this._onTouch.bind(this));this.body.emitter.on("pinch",this._onPinch.bind(this));this.body.dom.rollingModeBtn.addEventListener("click",this.startRolling.bind(this));this.setOptions(options)}Range.prototype=new Component;Range.prototype.setOptions=function(options){if(options){var fields=["animation","direction","min","max","zoomMin","zoomMax","moveable","zoomable","moment","activate","hiddenDates","zoomKey","rtl","showCurrentTime","rollMode","horizontalScroll"];util.selectiveExtend(fields,this.options,options);if(options.rollingMode){this.startRolling()}if("start"in options||"end"in options){this.setRange(options.start,options.end)}}};function validateDirection(direction){if(direction!="horizontal"&&direction!="vertical"){throw new TypeError('Unknown direction "'+direction+'". '+'Choose "horizontal" or "vertical".')}}Range.prototype.startRolling=function(){var me=this;function update(){me.stopRolling();me.rolling=true;var interval=me.end-me.start;var t=util.convert(new Date,"Date").valueOf();var start=t-interval/2;var end=t+interval/2;var animation=me.options&&me.options.animation!==undefined?me.options.animation:true;me.setRange(start,end,false);var scale=me.conversion(me.body.domProps.center.width).scale;var interval=1/scale/10;if(interval<30)interval=30;if(interval>1e3)interval=1e3;me.body.dom.rollingModeBtn.style.visibility="hidden";me.currentTimeTimer=setTimeout(update,interval)}update()};Range.prototype.stopRolling=function(){if(this.currentTimeTimer!==undefined){clearTimeout(this.currentTimeTimer);this.rolling=false;this.body.dom.rollingModeBtn.style.visibility="visible"}};Range.prototype.setRange=function(start,end,animation,byUser,event){if(byUser!==true){byUser=false}var finalStart=start!=undefined?util.convert(start,"Date").valueOf():null;var finalEnd=end!=undefined?util.convert(end,"Date").valueOf():null;this._cancelAnimation();if(animation){var me=this;var initStart=this.start;var initEnd=this.end;var duration=(typeof animation==="undefined"?"undefined":(0,_typeof3["default"])(animation))==="object"&&"duration"in animation?animation.duration:500;var easingName=(typeof animation==="undefined"?"undefined":(0,_typeof3["default"])(animation))==="object"&&"easingFunction"in animation?animation.easingFunction:"easeInOutQuad";var easingFunction=util.easingFunctions[easingName];if(!easingFunction){throw new Error("Unknown easing function "+(0,_stringify2["default"])(easingName)+". "+"Choose from: "+(0,_keys2["default"])(util.easingFunctions).join(", "))}var initTime=(new Date).valueOf();var anyChanged=false;var next=function next(){if(!me.props.touch.dragging){var now=(new Date).valueOf();var time=now-initTime;var ease=easingFunction(time/duration);var done=time>duration;var s=done||finalStart===null?finalStart:initStart+(finalStart-initStart)*ease;var e=done||finalEnd===null?finalEnd:initEnd+(finalEnd-initEnd)*ease;changed=me._applyRange(s,e);DateUtil.updateHiddenDates(me.options.moment,me.body,me.options.hiddenDates);anyChanged=anyChanged||changed;var params={start:new Date(me.start),end:new Date(me.end),byUser:byUser,event:util.elementsCensor(event)};if(changed){me.body.emitter.emit("rangechange",params)}if(done){if(anyChanged){me.body.emitter.emit("rangechanged",params)}}else{me.animationTimer=setTimeout(next,20)}}};return next()}else{var changed=this._applyRange(finalStart,finalEnd);DateUtil.updateHiddenDates(this.options.moment,this.body,this.options.hiddenDates);if(changed){var params={start:new Date(this.start),end:new Date(this.end),byUser:byUser,event:util.elementsCensor(event)};this.body.emitter.emit("rangechange",params);this.body.emitter.emit("rangechanged",params)}}};Range.prototype._cancelAnimation=function(){if(this.animationTimer){clearTimeout(this.animationTimer);this.animationTimer=null}};Range.prototype._applyRange=function(start,end){var newStart=start!=null?util.convert(start,"Date").valueOf():this.start,newEnd=end!=null?util.convert(end,"Date").valueOf():this.end,max=this.options.max!=null?util.convert(this.options.max,"Date").valueOf():null,min=this.options.min!=null?util.convert(this.options.min,"Date").valueOf():null,diff;if(isNaN(newStart)||newStart===null){throw new Error('Invalid start "'+start+'"')}if(isNaN(newEnd)||newEnd===null){throw new Error('Invalid end "'+end+'"')}if(newEnd<newStart){newEnd=newStart}if(min!==null){if(newStart<min){diff=min-newStart;newStart+=diff;newEnd+=diff;if(max!=null){if(newEnd>max){newEnd=max}}}}if(max!==null){if(newEnd>max){diff=newEnd-max;newStart-=diff;newEnd-=diff;if(min!=null){if(newStart<min){newStart=min}}}}if(this.options.zoomMin!==null){var zoomMin=parseFloat(this.options.zoomMin);if(zoomMin<0){zoomMin=0}if(newEnd-newStart<zoomMin){if(this.end-this.start===zoomMin&&newStart>this.start&&newEnd<this.end){newStart=this.start;newEnd=this.end}else{diff=zoomMin-(newEnd-newStart);newStart-=diff/2;newEnd+=diff/2}}}if(this.options.zoomMax!==null){var zoomMax=parseFloat(this.options.zoomMax);if(zoomMax<0){zoomMax=0}if(newEnd-newStart>zoomMax){if(this.end-this.start===zoomMax&&newStart<this.start&&newEnd>this.end){newStart=this.start;newEnd=this.end}else{diff=newEnd-newStart-zoomMax;newStart+=diff/2;newEnd-=diff/2}}}var changed=this.start!=newStart||this.end!=newEnd;if(!(newStart>=this.start&&newStart<=this.end||newEnd>=this.start&&newEnd<=this.end)&&!(this.start>=newStart&&this.start<=newEnd||this.end>=newStart&&this.end<=newEnd)){this.body.emitter.emit("checkRangedItems")}this.start=newStart;this.end=newEnd;return changed};Range.prototype.getRange=function(){return{start:this.start,end:this.end}};Range.prototype.conversion=function(width,totalHidden){return Range.conversion(this.start,this.end,width,totalHidden)};Range.conversion=function(start,end,width,totalHidden){if(totalHidden===undefined){totalHidden=0}if(width!=0&&end-start!=0){return{offset:start,scale:width/(end-start-totalHidden)}}else{return{offset:0,scale:1}}};Range.prototype._onDragStart=function(event){this.deltaDifference=0;this.previousDelta=0;if(!this.options.moveable)return;if(!this._isInsideRange(event))return;if(!this.props.touch.allowDragging)return;this.stopRolling();this.props.touch.start=this.start;this.props.touch.end=this.end;this.props.touch.dragging=true;if(this.body.dom.root){this.body.dom.root.style.cursor="move"}};Range.prototype._onDrag=function(event){if(!event)return;if(!this.props.touch.dragging)return;if(!this.options.moveable)return;if(!this.props.touch.allowDragging)return;var direction=this.options.direction;validateDirection(direction);var delta=direction=="horizontal"?event.deltaX:event.deltaY;delta-=this.deltaDifference;var interval=this.props.touch.end-this.props.touch.start;var duration=DateUtil.getHiddenDurationBetween(this.body.hiddenDates,this.start,this.end);interval-=duration;var width=direction=="horizontal"?this.body.domProps.center.width:this.body.domProps.center.height;if(this.options.rtl){var diffRange=delta/width*interval}else{var diffRange=-delta/width*interval}var newStart=this.props.touch.start+diffRange;var newEnd=this.props.touch.end+diffRange;var safeStart=DateUtil.snapAwayFromHidden(this.body.hiddenDates,newStart,this.previousDelta-delta,true);var safeEnd=DateUtil.snapAwayFromHidden(this.body.hiddenDates,newEnd,this.previousDelta-delta,true);if(safeStart!=newStart||safeEnd!=newEnd){this.deltaDifference+=delta;this.props.touch.start=safeStart;this.props.touch.end=safeEnd;this._onDrag(event);return}this.previousDelta=delta;this._applyRange(newStart,newEnd);var startDate=new Date(this.start);var endDate=new Date(this.end);this.body.emitter.emit("rangechange",{start:startDate,end:endDate,byUser:true,event:util.elementsCensor(event)});this.body.emitter.emit("panmove")};Range.prototype._onDragEnd=function(event){if(!this.props.touch.dragging)return;if(!this.options.moveable)return;if(!this.props.touch.allowDragging)return;this.props.touch.dragging=false;if(this.body.dom.root){this.body.dom.root.style.cursor="auto"}this.body.emitter.emit("rangechanged",{start:new Date(this.start),end:new Date(this.end),byUser:true,event:util.elementsCensor(event)})};Range.prototype._onMouseWheel=function(event){var delta=0;if(event.wheelDelta){delta=event.wheelDelta/120}else if(event.detail){delta=-event.detail/3}if(this.options.zoomKey&&!event[this.options.zoomKey]&&this.options.zoomable||!this.options.zoomable&&this.options.moveable){if(this.options.horizontalScroll){event.preventDefault();var diff=delta*(this.end-this.start)/20;var newStart=this.start-diff;var newEnd=this.end-diff;this.setRange(newStart,newEnd,false,true,event)}return}if(!(this.options.zoomable&&this.options.moveable))return;if(!this._isInsideRange(event))return;if(delta){var scale;if(delta<0){scale=1-delta/5}else{scale=1/(1+delta/5)}var pointerDate;if(this.rolling){pointerDate=(this.start+this.end)/2}else{var pointer=this.getPointer({x:event.clientX,y:event.clientY},this.body.dom.center);pointerDate=this._pointerToDate(pointer)}this.zoom(scale,pointerDate,delta,event);event.preventDefault()}};Range.prototype._onTouch=function(event){this.props.touch.start=this.start;this.props.touch.end=this.end;this.props.touch.allowDragging=true;this.props.touch.center=null;this.scaleOffset=0;this.deltaDifference=0};Range.prototype._onPinch=function(event){if(!(this.options.zoomable&&this.options.moveable))return;this.props.touch.allowDragging=false;if(!this.props.touch.center){this.props.touch.center=this.getPointer(event.center,this.body.dom.center)}this.stopRolling();var scale=1/(event.scale+this.scaleOffset);var centerDate=this._pointerToDate(this.props.touch.center);var hiddenDuration=DateUtil.getHiddenDurationBetween(this.body.hiddenDates,this.start,this.end);var hiddenDurationBefore=DateUtil.getHiddenDurationBefore(this.options.moment,this.body.hiddenDates,this,centerDate);var hiddenDurationAfter=hiddenDuration-hiddenDurationBefore;var newStart=centerDate-hiddenDurationBefore+(this.props.touch.start-(centerDate-hiddenDurationBefore))*scale;var newEnd=centerDate+hiddenDurationAfter+(this.props.touch.end-(centerDate+hiddenDurationAfter))*scale;this.startToFront=1-scale<=0;this.endToFront=scale-1<=0;var safeStart=DateUtil.snapAwayFromHidden(this.body.hiddenDates,newStart,1-scale,true);var safeEnd=DateUtil.snapAwayFromHidden(this.body.hiddenDates,newEnd,scale-1,true);if(safeStart!=newStart||safeEnd!=newEnd){this.props.touch.start=safeStart;this.props.touch.end=safeEnd;this.scaleOffset=1-event.scale;newStart=safeStart;newEnd=safeEnd}this.setRange(newStart,newEnd,false,true,event);this.startToFront=false;this.endToFront=true};Range.prototype._isInsideRange=function(event){var clientX=event.center?event.center.x:event.clientX;if(this.options.rtl){var x=clientX-util.getAbsoluteLeft(this.body.dom.centerContainer)}else{var x=util.getAbsoluteRight(this.body.dom.centerContainer)-clientX}var time=this.body.util.toTime(x);return time>=this.start&&time<=this.end};Range.prototype._pointerToDate=function(pointer){var conversion;var direction=this.options.direction;validateDirection(direction);if(direction=="horizontal"){return this.body.util.toTime(pointer.x).valueOf()}else{var height=this.body.domProps.center.height;conversion=this.conversion(height);return pointer.y/conversion.scale+conversion.offset}};Range.prototype.getPointer=function(touch,element){if(this.options.rtl){return{x:util.getAbsoluteRight(element)-touch.x,y:touch.y-util.getAbsoluteTop(element)}}else{return{x:touch.x-util.getAbsoluteLeft(element),y:touch.y-util.getAbsoluteTop(element)}}};Range.prototype.zoom=function(scale,center,delta,event){if(center==null){center=(this.start+this.end)/2}var hiddenDuration=DateUtil.getHiddenDurationBetween(this.body.hiddenDates,this.start,this.end);var hiddenDurationBefore=DateUtil.getHiddenDurationBefore(this.options.moment,this.body.hiddenDates,this,center);var hiddenDurationAfter=hiddenDuration-hiddenDurationBefore;var newStart=center-hiddenDurationBefore+(this.start-(center-hiddenDurationBefore))*scale;var newEnd=center+hiddenDurationAfter+(this.end-(center+hiddenDurationAfter))*scale;this.startToFront=delta>0?false:true;this.endToFront=-delta>0?false:true;var safeStart=DateUtil.snapAwayFromHidden(this.body.hiddenDates,newStart,delta,true);var safeEnd=DateUtil.snapAwayFromHidden(this.body.hiddenDates,newEnd,-delta,true);if(safeStart!=newStart||safeEnd!=newEnd){newStart=safeStart;newEnd=safeEnd}this.setRange(newStart,newEnd,false,true,event);this.startToFront=false;this.endToFront=true};Range.prototype.move=function(delta){var diff=this.end-this.start;var newStart=this.start+diff*delta;var newEnd=this.end+diff*delta;this.start=newStart;this.end=newEnd};Range.prototype.moveTo=function(moveTo){var center=(this.start+this.end)/2;var diff=center-moveTo;var newStart=this.start-diff;var newEnd=this.end-diff;this.setRange(newStart,newEnd,false,true,event)};module.exports=Range},{"../hammerUtil":18,"../module/moment":20,"../util":116,"./DateUtil":87,"./component/Component":94,"babel-runtime/core-js/json/stringify":119,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/typeof":133}],90:[function(require,module,exports){"use strict";var EPSILON=.001;exports.orderByStart=function(items){items.sort(function(a,b){return a.data.start-b.data.start})};exports.orderByEnd=function(items){items.sort(function(a,b){var aTime="end"in a.data?a.data.end:a.data.start,bTime="end"in b.data?b.data.end:b.data.start;return aTime-bTime})};exports.stack=function(items,margin,force){if(force){for(var i=0;i<items.length;i++){items[i].top=null}}for(var i=0;i<items.length;i++){var item=items[i];if(item.stack&&item.top===null){item.top=margin.axis;do{var collidingItem=null;for(var j=0,jj=items.length;j<jj;j++){var other=items[j];if(other.top!==null&&other!==item&&other.stack&&exports.collision(item,other,margin.item,other.options.rtl)){collidingItem=other;break}}if(collidingItem!=null){item.top=collidingItem.top+collidingItem.height+margin.item.vertical}}while(collidingItem)}}};exports.nostack=function(items,margin,subgroups,stackSubgroups){for(var i=0;i<items.length;i++){if(items[i].data.subgroup==undefined){items[i].top=margin.item.vertical}else if(items[i].data.subgroup!==undefined&&stackSubgroups){var newTop=0;for(var subgroup in subgroups){if(subgroups.hasOwnProperty(subgroup)){if(subgroups[subgroup].visible==true&&subgroups[subgroup].index<subgroups[items[i].data.subgroup].index){newTop+=subgroups[subgroup].height;subgroups[items[i].data.subgroup].top=newTop}}}items[i].top=newTop+.5*margin.item.vertical}}if(!stackSubgroups){exports.stackSubgroups(items,margin,subgroups)}};exports.stackSubgroups=function(items,margin,subgroups){for(var subgroup in subgroups){if(subgroups.hasOwnProperty(subgroup)){subgroups[subgroup].top=0;do{var collidingItem=null;for(var otherSubgroup in subgroups){if(subgroups[otherSubgroup].top!==null&&otherSubgroup!==subgroup&&subgroups[subgroup].index>subgroups[otherSubgroup].index&&exports.collisionByTimes(subgroups[subgroup],subgroups[otherSubgroup])){collidingItem=subgroups[otherSubgroup];break}}if(collidingItem!=null){subgroups[subgroup].top=collidingItem.top+collidingItem.height}}while(collidingItem)}}for(var i=0;i<items.length;i++){if(items[i].data.subgroup!==undefined){items[i].top=subgroups[items[i].data.subgroup].top+.5*margin.item.vertical}}};exports.collision=function(a,b,margin,rtl){if(rtl){return a.right-margin.horizontal+EPSILON<b.right+b.width&&a.right+a.width+margin.horizontal-EPSILON>b.right&&a.top-margin.vertical+EPSILON<b.top+b.height&&a.top+a.height+margin.vertical-EPSILON>b.top}else{return a.left-margin.horizontal+EPSILON<b.left+b.width&&a.left+a.width+margin.horizontal-EPSILON>b.left&&a.top-margin.vertical+EPSILON<b.top+b.height&&a.top+a.height+margin.vertical-EPSILON>b.top}};exports.collisionByTimes=function(a,b){return a.start<=b.start&&a.end>=b.start&&a.top<b.top+b.height&&a.top+a.height>b.top||b.start<=a.start&&b.end>=a.start&&b.top<a.top+a.height&&b.top+b.height>a.top}},{}],91:[function(require,module,exports){"use strict";var moment=require("../module/moment");var DateUtil=require("./DateUtil");var util=require("../util");function TimeStep(start,end,minimumStep,hiddenDates){this.moment=moment;this.current=this.moment();this._start=this.moment();this._end=this.moment();this.autoScale=true;this.scale="day";this.step=1;this.setRange(start,end,minimumStep);this.switchedDay=false;this.switchedMonth=false;this.switchedYear=false;if(Array.isArray(hiddenDates)){this.hiddenDates=hiddenDates}else if(hiddenDates!=undefined){this.hiddenDates=[hiddenDates]}else{this.hiddenDates=[]}this.format=TimeStep.FORMAT}TimeStep.FORMAT={minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",month:"YYYY",year:""}};TimeStep.prototype.setMoment=function(moment){this.moment=moment;this.current=this.moment(this.current.valueOf());this._start=this.moment(this._start.valueOf());this._end=this.moment(this._end.valueOf())};TimeStep.prototype.setFormat=function(format){var defaultFormat=util.deepExtend({},TimeStep.FORMAT);this.format=util.deepExtend(defaultFormat,format)};TimeStep.prototype.setRange=function(start,end,minimumStep){if(!(start instanceof Date)||!(end instanceof Date)){throw"No legal start or end date in method setRange"}this._start=start!=undefined?this.moment(start.valueOf()):new Date;this._end=end!=undefined?this.moment(end.valueOf()):new Date;if(this.autoScale){this.setMinimumStep(minimumStep)}};TimeStep.prototype.start=function(){this.current=this._start.clone();this.roundToMinor()};TimeStep.prototype.roundToMinor=function(){switch(this.scale){case"year":this.current.year(this.step*Math.floor(this.current.year()/this.step));this.current.month(0);case"month":this.current.date(1);case"day":case"weekday":this.current.hours(0);case"hour":this.current.minutes(0);case"minute":this.current.seconds(0);case"second":this.current.milliseconds(0)}if(this.step!=1){switch(this.scale){case"millisecond":this.current.subtract(this.current.milliseconds()%this.step,"milliseconds");break;case"second":this.current.subtract(this.current.seconds()%this.step,"seconds");break;case"minute":this.current.subtract(this.current.minutes()%this.step,"minutes");break;case"hour":this.current.subtract(this.current.hours()%this.step,"hours");break;case"weekday":case"day":this.current.subtract((this.current.date()-1)%this.step,"day");break;case"month":this.current.subtract(this.current.month()%this.step,"month");break;case"year":this.current.subtract(this.current.year()%this.step,"year");break;default:break}}};TimeStep.prototype.hasNext=function(){return this.current.valueOf()<=this._end.valueOf()};TimeStep.prototype.next=function(){var prev=this.current.valueOf();if(this.current.month()<6){switch(this.scale){case"millisecond":this.current.add(this.step,"millisecond");break;case"second":this.current.add(this.step,"second");break;case"minute":this.current.add(this.step,"minute");break;case"hour":this.current.add(this.step,"hour");this.current.subtract(this.current.hours()%this.step,"hour");break;case"weekday":case"day":this.current.add(this.step,"day");break;case"month":this.current.add(this.step,"month");break;case"year":this.current.add(this.step,"year");break;default:break}}else{switch(this.scale){case"millisecond":this.current.add(this.step,"millisecond");break;case"second":this.current.add(this.step,"second");break;case"minute":this.current.add(this.step,"minute");break;case"hour":this.current.add(this.moment.duration(this.step,"hour"));if(this.current.hours()%this.step!==0){this.current.add(this.step-this.current.hours()%this.step,"hour")}break;case"weekday":case"day":this.current.add(this.step,"day");break;case"month":this.current.add(this.step,"month");break;case"year":this.current.add(this.step,"year");break;default:break}}if(this.step!=1){switch(this.scale){case"millisecond":if(this.current.milliseconds()>0&&this.current.milliseconds()<this.step)this.current.milliseconds(0);break;case"second":if(this.current.seconds()>0&&this.current.seconds()<this.step)this.current.seconds(0);break;case"minute":if(this.current.minutes()>0&&this.current.minutes()<this.step)this.current.minutes(0);break;case"hour":if(this.current.hours()>0&&this.current.hours()<this.step)this.current.hours(0);break;case"weekday":case"day":if(this.current.date()<this.step+1)this.current.date(1);break;case"month":if(this.current.month()<this.step)this.current.month(0);break;case"year":break;default:break}}if(this.current.valueOf()==prev){this.current=this._end.clone()}this.switchedDay=false;this.switchedMonth=false;this.switchedYear=false;DateUtil.stepOverHiddenDates(this.moment,this,prev)};TimeStep.prototype.getCurrent=function(){return this.current};TimeStep.prototype.setScale=function(params){if(params&&typeof params.scale=="string"){this.scale=params.scale;this.step=params.step>0?params.step:1;this.autoScale=false}};TimeStep.prototype.setAutoScale=function(enable){this.autoScale=enable};TimeStep.prototype.setMinimumStep=function(minimumStep){if(minimumStep==undefined){return}var stepYear=1e3*60*60*24*30*12;var stepMonth=1e3*60*60*24*30;var stepDay=1e3*60*60*24;var stepHour=1e3*60*60;var stepMinute=1e3*60;var stepSecond=1e3;var stepMillisecond=1;if(stepYear*1e3>minimumStep){this.scale="year";this.step=1e3}if(stepYear*500>minimumStep){this.scale="year";this.step=500}if(stepYear*100>minimumStep){this.scale="year";this.step=100}if(stepYear*50>minimumStep){this.scale="year";this.step=50}if(stepYear*10>minimumStep){this.scale="year";this.step=10}if(stepYear*5>minimumStep){this.scale="year";this.step=5}if(stepYear>minimumStep){this.scale="year";this.step=1}if(stepMonth*3>minimumStep){this.scale="month";this.step=3}if(stepMonth>minimumStep){this.scale="month";this.step=1}if(stepDay*5>minimumStep){this.scale="day";this.step=5}if(stepDay*2>minimumStep){this.scale="day";this.step=2}if(stepDay>minimumStep){this.scale="day";this.step=1}if(stepDay/2>minimumStep){this.scale="weekday";this.step=1}if(stepHour*4>minimumStep){this.scale="hour";this.step=4}if(stepHour>minimumStep){this.scale="hour";this.step=1}if(stepMinute*15>minimumStep){this.scale="minute";this.step=15}if(stepMinute*10>minimumStep){this.scale="minute";this.step=10}if(stepMinute*5>minimumStep){this.scale="minute";this.step=5}if(stepMinute>minimumStep){this.scale="minute";this.step=1}if(stepSecond*15>minimumStep){this.scale="second";this.step=15}if(stepSecond*10>minimumStep){this.scale="second";this.step=10}if(stepSecond*5>minimumStep){this.scale="second";this.step=5}if(stepSecond>minimumStep){this.scale="second";this.step=1}if(stepMillisecond*200>minimumStep){this.scale="millisecond";this.step=200}if(stepMillisecond*100>minimumStep){this.scale="millisecond";this.step=100}if(stepMillisecond*50>minimumStep){this.scale="millisecond";this.step=50}if(stepMillisecond*10>minimumStep){this.scale="millisecond";this.step=10}if(stepMillisecond*5>minimumStep){this.scale="millisecond";this.step=5}if(stepMillisecond>minimumStep){this.scale="millisecond";this.step=1}};TimeStep.snap=function(date,scale,step){var clone=moment(date);if(scale=="year"){var year=clone.year()+Math.round(clone.month()/12);clone.year(Math.round(year/step)*step);clone.month(0);clone.date(0);clone.hours(0);
clone.minutes(0);clone.seconds(0);clone.milliseconds(0)}else if(scale=="month"){if(clone.date()>15){clone.date(1);clone.add(1,"month")}else{clone.date(1)}clone.hours(0);clone.minutes(0);clone.seconds(0);clone.milliseconds(0)}else if(scale=="day"){switch(step){case 5:case 2:clone.hours(Math.round(clone.hours()/24)*24);break;default:clone.hours(Math.round(clone.hours()/12)*12);break}clone.minutes(0);clone.seconds(0);clone.milliseconds(0)}else if(scale=="weekday"){switch(step){case 5:case 2:clone.hours(Math.round(clone.hours()/12)*12);break;default:clone.hours(Math.round(clone.hours()/6)*6);break}clone.minutes(0);clone.seconds(0);clone.milliseconds(0)}else if(scale=="hour"){switch(step){case 4:clone.minutes(Math.round(clone.minutes()/60)*60);break;default:clone.minutes(Math.round(clone.minutes()/30)*30);break}clone.seconds(0);clone.milliseconds(0)}else if(scale=="minute"){switch(step){case 15:case 10:clone.minutes(Math.round(clone.minutes()/5)*5);clone.seconds(0);break;case 5:clone.seconds(Math.round(clone.seconds()/60)*60);break;default:clone.seconds(Math.round(clone.seconds()/30)*30);break}clone.milliseconds(0)}else if(scale=="second"){switch(step){case 15:case 10:clone.seconds(Math.round(clone.seconds()/5)*5);clone.milliseconds(0);break;case 5:clone.milliseconds(Math.round(clone.milliseconds()/1e3)*1e3);break;default:clone.milliseconds(Math.round(clone.milliseconds()/500)*500);break}}else if(scale=="millisecond"){var _step=step>5?step/2:1;clone.milliseconds(Math.round(clone.milliseconds()/_step)*_step)}return clone};TimeStep.prototype.isMajor=function(){if(this.switchedYear==true){switch(this.scale){case"year":case"month":case"weekday":case"day":case"hour":case"minute":case"second":case"millisecond":return true;default:return false}}else if(this.switchedMonth==true){switch(this.scale){case"weekday":case"day":case"hour":case"minute":case"second":case"millisecond":return true;default:return false}}else if(this.switchedDay==true){switch(this.scale){case"millisecond":case"second":case"minute":case"hour":return true;default:return false}}var date=this.moment(this.current);switch(this.scale){case"millisecond":return date.milliseconds()==0;case"second":return date.seconds()==0;case"minute":return date.hours()==0&&date.minutes()==0;case"hour":return date.hours()==0;case"weekday":case"day":return date.date()==1;case"month":return date.month()==0;case"year":return false;default:return false}};TimeStep.prototype.getLabelMinor=function(date){if(date==undefined){date=this.current}if(typeof this.format.minorLabels==="function"){return this.format.minorLabels(date,this.scale,this.step)}var format=this.format.minorLabels[this.scale];return format&&format.length>0?this.moment(date).format(format):""};TimeStep.prototype.getLabelMajor=function(date){if(date==undefined){date=this.current}if(typeof this.format.majorLabels==="function"){return this.format.majorLabels(date,this.scale,this.step)}var format=this.format.majorLabels[this.scale];return format&&format.length>0?this.moment(date).format(format):""};TimeStep.prototype.getClassName=function(){var _moment=this.moment;var m=this.moment(this.current);var current=m.locale?m.locale("en"):m.lang("en");var step=this.step;function even(value){return value/step%2==0?" vis-even":" vis-odd"}function today(date){if(date.isSame(new Date,"day")){return" vis-today"}if(date.isSame(_moment().add(1,"day"),"day")){return" vis-tomorrow"}if(date.isSame(_moment().add(-1,"day"),"day")){return" vis-yesterday"}return""}function currentWeek(date){return date.isSame(new Date,"week")?" vis-current-week":""}function currentMonth(date){return date.isSame(new Date,"month")?" vis-current-month":""}function currentYear(date){return date.isSame(new Date,"year")?" vis-current-year":""}switch(this.scale){case"millisecond":return today(current)+even(current.milliseconds()).trim();case"second":return today(current)+even(current.seconds()).trim();case"minute":return today(current)+even(current.minutes()).trim();case"hour":return"vis-h"+current.hours()+(this.step==4?"-h"+(current.hours()+4):"")+today(current)+even(current.hours());case"weekday":return"vis-"+current.format("dddd").toLowerCase()+today(current)+currentWeek(current)+even(current.date());case"day":return"vis-day"+current.date()+" vis-"+current.format("MMMM").toLowerCase()+today(current)+currentMonth(current)+(this.step<=2?today(current):"")+(this.step<=2?" vis-"+current.format("dddd").toLowerCase():""+even(current.date()-1));case"month":return"vis-"+current.format("MMMM").toLowerCase()+currentMonth(current)+even(current.month());case"year":var year=current.year();return"vis-year"+year+currentYear(current)+even(year);default:return""}};module.exports=TimeStep},{"../module/moment":20,"../util":116,"./DateUtil":87}],92:[function(require,module,exports){"use strict";var _Configurator=require("../shared/Configurator");var _Configurator2=_interopRequireDefault(_Configurator);var _Validator=require("../shared/Validator");var _Validator2=_interopRequireDefault(_Validator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Emitter=require("emitter-component");var Hammer=require("../module/hammer");var moment=require("../module/moment");var util=require("../util");var DataSet=require("../DataSet");var DataView=require("../DataView");var Range=require("./Range");var Core=require("./Core");var TimeAxis=require("./component/TimeAxis");var CurrentTime=require("./component/CurrentTime");var CustomTime=require("./component/CustomTime");var ItemSet=require("./component/ItemSet");var printStyle=require("../shared/Validator").printStyle;var allOptions=require("./optionsTimeline").allOptions;var configureOptions=require("./optionsTimeline").configureOptions;function Timeline(container,items,groups,options){if(!(this instanceof Timeline)){throw new SyntaxError("Constructor must be called with the new operator")}if(!(Array.isArray(groups)||groups instanceof DataSet||groups instanceof DataView)&&groups instanceof Object){var forthArgument=options;options=groups;groups=forthArgument}if(options&&options.throttleRedraw){console.warn('Timeline option "throttleRedraw" is DEPRICATED and no longer supported. It will be removed in the next MAJOR release.')}var me=this;this.defaultOptions={start:null,end:null,autoResize:true,orientation:{axis:"bottom",item:"bottom"},moment:moment,width:null,height:null,maxHeight:null,minHeight:null};this.options=util.deepExtend({},this.defaultOptions);this._create(container);if(!options||options&&typeof options.rtl=="undefined"){var directionFromDom,domNode=this.dom.root;while(!directionFromDom&&domNode){directionFromDom=window.getComputedStyle(domNode,null).direction;domNode=domNode.parentElement}this.options.rtl=directionFromDom&&directionFromDom.toLowerCase()=="rtl"}else{this.options.rtl=options.rtl}this.options.rollingMode=options&&options.rollingMode;this.components=[];this.body={dom:this.dom,domProps:this.props,emitter:{on:this.on.bind(this),off:this.off.bind(this),emit:this.emit.bind(this)},hiddenDates:[],util:{getScale:function getScale(){return me.timeAxis.step.scale},getStep:function getStep(){return me.timeAxis.step.step},toScreen:me._toScreen.bind(me),toGlobalScreen:me._toGlobalScreen.bind(me),toTime:me._toTime.bind(me),toGlobalTime:me._toGlobalTime.bind(me)}};this.range=new Range(this.body,this.options);this.components.push(this.range);this.body.range=this.range;this.timeAxis=new TimeAxis(this.body,this.options);this.timeAxis2=null;this.components.push(this.timeAxis);this.currentTime=new CurrentTime(this.body,this.options);this.components.push(this.currentTime);this.itemSet=new ItemSet(this.body,this.options);this.components.push(this.itemSet);this.itemsData=null;this.groupsData=null;this.dom.root.onclick=function(event){me.emit("click",me.getEventProperties(event))};this.dom.root.ondblclick=function(event){me.emit("doubleClick",me.getEventProperties(event))};this.dom.root.oncontextmenu=function(event){me.emit("contextmenu",me.getEventProperties(event))};this.dom.root.onmouseover=function(event){me.emit("mouseOver",me.getEventProperties(event))};this.dom.root.onmousemove=function(event){me.emit("mouseMove",me.getEventProperties(event))};this.fitDone=false;this.on("changed",function(){if(this.itemsData==null||this.options.rollingMode)return;if(!me.fitDone){me.fitDone=true;if(me.options.start!=undefined||me.options.end!=undefined){if(me.options.start==undefined||me.options.end==undefined){var range=me.getItemRange()}var start=me.options.start!=undefined?me.options.start:range.min;var end=me.options.end!=undefined?me.options.end:range.max;me.setWindow(start,end,{animation:false})}else{me.fit({animation:false})}}});if(options){this.setOptions(options)}if(groups){this.setGroups(groups)}if(items){this.setItems(items)}this._redraw()}Timeline.prototype=new Core;Timeline.prototype._createConfigurator=function(){return new _Configurator2["default"](this,this.dom.container,configureOptions)};Timeline.prototype.redraw=function(){this.itemSet&&this.itemSet.markDirty({refreshItems:true});this._redraw()};Timeline.prototype.setOptions=function(options){var errorFound=_Validator2["default"].validate(options,allOptions);if(errorFound===true){console.log("%cErrors have been found in the supplied options object.",printStyle)}Core.prototype.setOptions.call(this,options);if("type"in options){if(options.type!==this.options.type){this.options.type=options.type;var itemsData=this.itemsData;if(itemsData){var selection=this.getSelection();this.setItems(null);this.setItems(itemsData);this.setSelection(selection)}}}};Timeline.prototype.setItems=function(items){var newDataSet;if(!items){newDataSet=null}else if(items instanceof DataSet||items instanceof DataView){newDataSet=items}else{newDataSet=new DataSet(items,{type:{start:"Date",end:"Date"}})}this.itemsData=newDataSet;this.itemSet&&this.itemSet.setItems(newDataSet)};Timeline.prototype.setGroups=function(groups){var newDataSet;if(!groups){newDataSet=null}else{var filter=function filter(group){return group.visible!==false};if(groups instanceof DataSet||groups instanceof DataView){newDataSet=new DataView(groups,{filter:filter})}else{newDataSet=new DataSet(groups.filter(filter))}}this.groupsData=newDataSet;this.itemSet.setGroups(newDataSet)};Timeline.prototype.setData=function(data){if(data&&data.groups){this.setGroups(data.groups)}if(data&&data.items){this.setItems(data.items)}};Timeline.prototype.setSelection=function(ids,options){this.itemSet&&this.itemSet.setSelection(ids);if(options&&options.focus){this.focus(ids,options)}};Timeline.prototype.getSelection=function(){return this.itemSet&&this.itemSet.getSelection()||[]};Timeline.prototype.focus=function(id,options){if(!this.itemsData||id==undefined)return;var ids=Array.isArray(id)?id:[id];var itemsData=this.itemsData.getDataSet().get(ids,{type:{start:"Date",end:"Date"}});var start=null;var end=null;itemsData.forEach(function(itemData){var s=itemData.start.valueOf();var e="end"in itemData?itemData.end.valueOf():itemData.start.valueOf();if(start===null||s<start){start=s}if(end===null||e>end){end=e}});if(start!==null&&end!==null){var middle=(start+end)/2;var interval=Math.max(this.range.end-this.range.start,(end-start)*1.1);var animation=options&&options.animation!==undefined?options.animation:true;this.range.setRange(middle-interval/2,middle+interval/2,animation)}};Timeline.prototype.fit=function(options){var animation=options&&options.animation!==undefined?options.animation:true;var range;var dataset=this.itemsData&&this.itemsData.getDataSet();if(dataset.length===1&&dataset.get()[0].end===undefined){range=this.getDataRange();this.moveTo(range.min.valueOf(),{animation:animation})}else{range=this.getItemRange();this.range.setRange(range.min,range.max,animation)}};Timeline.prototype.getItemRange=function(){var _this=this;var range=this.getDataRange();var min=range.min!==null?range.min.valueOf():null;var max=range.max!==null?range.max.valueOf():null;var minItem=null;var maxItem=null;if(min!=null&&max!=null){var interval;var factor;var lhs;var rhs;var delta;(function(){var getStart=function getStart(item){return util.convert(item.data.start,"Date").valueOf()};var getEnd=function getEnd(item){var end=item.data.end!=undefined?item.data.end:item.data.start;return util.convert(end,"Date").valueOf()};interval=max-min;if(interval<=0){interval=10}factor=interval/_this.props.center.width;util.forEach(_this.itemSet.items,function(item){if(item.groupShowing){item.show();item.repositionX()}var start=getStart(item);var end=getEnd(item);if(this.options.rtl){var startSide=start-(item.getWidthRight()+10)*factor;var endSide=end+(item.getWidthLeft()+10)*factor}else{var startSide=start-(item.getWidthLeft()+10)*factor;var endSide=end+(item.getWidthRight()+10)*factor}if(startSide<min){min=startSide;minItem=item}if(endSide>max){max=endSide;maxItem=item}}.bind(_this));if(minItem&&maxItem){lhs=minItem.getWidthLeft()+10;rhs=maxItem.getWidthRight()+10;delta=_this.props.center.width-lhs-rhs;if(delta>0){if(_this.options.rtl){min=getStart(minItem)-rhs*interval/delta;max=getEnd(maxItem)+lhs*interval/delta}else{min=getStart(minItem)-lhs*interval/delta;max=getEnd(maxItem)+rhs*interval/delta}}}})()}return{min:min!=null?new Date(min):null,max:max!=null?new Date(max):null}};Timeline.prototype.getDataRange=function(){var min=null;var max=null;var dataset=this.itemsData&&this.itemsData.getDataSet();if(dataset){dataset.forEach(function(item){var start=util.convert(item.start,"Date").valueOf();var end=util.convert(item.end!=undefined?item.end:item.start,"Date").valueOf();if(min===null||start<min){min=start}if(max===null||end>max){max=end}})}return{min:min!=null?new Date(min):null,max:max!=null?new Date(max):null}};Timeline.prototype.getEventProperties=function(event){var clientX=event.center?event.center.x:event.clientX;var clientY=event.center?event.center.y:event.clientY;if(this.options.rtl){var x=util.getAbsoluteRight(this.dom.centerContainer)-clientX}else{var x=clientX-util.getAbsoluteLeft(this.dom.centerContainer)}var y=clientY-util.getAbsoluteTop(this.dom.centerContainer);var item=this.itemSet.itemFromTarget(event);var group=this.itemSet.groupFromTarget(event);var customTime=CustomTime.customTimeFromTarget(event);var snap=this.itemSet.options.snap||null;var scale=this.body.util.getScale();var step=this.body.util.getStep();var time=this._toTime(x);var snappedTime=snap?snap(time,scale,step):time;var element=util.getTarget(event);var what=null;if(item!=null){what="item"}else if(customTime!=null){what="custom-time"}else if(util.hasParent(element,this.timeAxis.dom.foreground)){what="axis"}else if(this.timeAxis2&&util.hasParent(element,this.timeAxis2.dom.foreground)){what="axis"}else if(util.hasParent(element,this.itemSet.dom.labelSet)){what="group-label"}else if(util.hasParent(element,this.currentTime.bar)){what="current-time"}else if(util.hasParent(element,this.dom.center)){what="background"}return{event:event,item:item?item.id:null,group:group?group.groupId:null,what:what,pageX:event.srcEvent?event.srcEvent.pageX:event.pageX,pageY:event.srcEvent?event.srcEvent.pageY:event.pageY,x:x,y:y,time:time,snappedTime:snappedTime}};module.exports=Timeline},{"../DataSet":6,"../DataView":7,"../module/hammer":19,"../module/moment":20,"../shared/Configurator":83,"../shared/Validator":85,"../util":116,"./Core":86,"./Range":89,"./component/CurrentTime":95,"./component/CustomTime":96,"./component/ItemSet":101,"./component/TimeAxis":104,"./optionsTimeline":115,"emitter-component":221}],93:[function(require,module,exports){"use strict";var _create=require("babel-runtime/core-js/object/create");var _create2=_interopRequireDefault(_create);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var Group=require("./Group");function BackgroundGroup(groupId,data,itemSet){Group.call(this,groupId,data,itemSet);this.width=0;this.height=0;this.top=0;this.left=0}BackgroundGroup.prototype=(0,_create2["default"])(Group.prototype);BackgroundGroup.prototype.redraw=function(range,margin,restack){var resized=false;this.visibleItems=this._updateItemsInRange(this.orderedItems,this.visibleItems,range);this.width=this.dom.background.offsetWidth;this.dom.background.style.height="0";for(var i=0,ii=this.visibleItems.length;i<ii;i++){var item=this.visibleItems[i];item.repositionY(margin)}return resized};BackgroundGroup.prototype.show=function(){if(!this.dom.background.parentNode){this.itemSet.dom.background.appendChild(this.dom.background)}};module.exports=BackgroundGroup},{"../../util":116,"./Group":100,"babel-runtime/core-js/object/create":121}],94:[function(require,module,exports){"use strict";var util=require("../../util");function Component(body,options){this.options=null;this.props=null}Component.prototype.setOptions=function(options){if(options){util.extend(this.options,options)}};Component.prototype.redraw=function(){return false};Component.prototype.destroy=function(){};Component.prototype._isResized=function(){var resized=this.props._previousWidth!==this.props.width||this.props._previousHeight!==this.props.height;this.props._previousWidth=this.props.width;this.props._previousHeight=this.props.height;return resized};module.exports=Component},{"../../util":116}],95:[function(require,module,exports){"use strict";var util=require("../../util");var Component=require("./Component");var moment=require("../../module/moment");var locales=require("../locales");function CurrentTime(body,options){this.body=body;this.defaultOptions={rtl:false,showCurrentTime:true,moment:moment,locales:locales,locale:"en"};this.options=util.extend({},this.defaultOptions);this.offset=0;this._create();this.setOptions(options)}CurrentTime.prototype=new Component;CurrentTime.prototype._create=function(){var bar=document.createElement("div");bar.className="vis-current-time";bar.style.position="absolute";bar.style.top="0px";bar.style.height="100%";this.bar=bar};CurrentTime.prototype.destroy=function(){this.options.showCurrentTime=false;this.redraw();this.body=null};CurrentTime.prototype.setOptions=function(options){if(options){util.selectiveExtend(["rtl","showCurrentTime","moment","locale","locales"],this.options,options)}};CurrentTime.prototype.redraw=function(){if(this.options.showCurrentTime){var parent=this.body.dom.backgroundVertical;if(this.bar.parentNode!=parent){if(this.bar.parentNode){this.bar.parentNode.removeChild(this.bar)}parent.appendChild(this.bar);this.start()}var now=this.options.moment((new Date).valueOf()+this.offset);var x=this.body.util.toScreen(now);var locale=this.options.locales[this.options.locale];if(!locale){if(!this.warned){console.log("WARNING: options.locales['"+this.options.locale+"'] not found. See http://visjs.org/docs/timeline/#Localization");this.warned=true}locale=this.options.locales["en"]}var title=locale.current+" "+locale.time+": "+now.format("dddd, MMMM Do YYYY, H:mm:ss");title=title.charAt(0).toUpperCase()+title.substring(1);if(this.options.rtl){this.bar.style.right=x+"px"}else{this.bar.style.left=x+"px"}this.bar.title=title}else{if(this.bar.parentNode){this.bar.parentNode.removeChild(this.bar)}this.stop()}return false};CurrentTime.prototype.start=function(){var me=this;function update(){me.stop();var scale=me.body.range.conversion(me.body.domProps.center.width).scale;var interval=1/scale/10;if(interval<30)interval=30;if(interval>1e3)interval=1e3;me.redraw();me.body.emitter.emit("currentTimeTick");me.currentTimeTimer=setTimeout(update,interval)}update()};CurrentTime.prototype.stop=function(){if(this.currentTimeTimer!==undefined){clearTimeout(this.currentTimeTimer);delete this.currentTimeTimer}};CurrentTime.prototype.setCurrentTime=function(time){var t=util.convert(time,"Date").valueOf();var now=(new Date).valueOf();this.offset=t-now;this.redraw()};CurrentTime.prototype.getCurrentTime=function(){return new Date((new Date).valueOf()+this.offset)};module.exports=CurrentTime},{"../../module/moment":20,"../../util":116,"../locales":113,"./Component":94}],96:[function(require,module,exports){"use strict";var Hammer=require("../../module/hammer");var util=require("../../util");var Component=require("./Component");var moment=require("../../module/moment");var locales=require("../locales");function CustomTime(body,options){this.body=body;this.defaultOptions={moment:moment,locales:locales,locale:"en",id:undefined,title:undefined};this.options=util.extend({},this.defaultOptions);if(options&&options.time){this.customTime=options.time}else{this.customTime=new Date}this.eventParams={};this.setOptions(options);this._create()}CustomTime.prototype=new Component;CustomTime.prototype.setOptions=function(options){if(options){util.selectiveExtend(["moment","locale","locales","id"],this.options,options)}};CustomTime.prototype._create=function(){var bar=document.createElement("div");bar["custom-time"]=this;bar.className="vis-custom-time "+(this.options.id||"");bar.style.position="absolute";bar.style.top="0px";bar.style.height="100%";this.bar=bar;var drag=document.createElement("div");drag.style.position="relative";drag.style.top="0px";drag.style.left="-10px";drag.style.height="100%";drag.style.width="20px";function onMouseWheel(e){this.body.range._onMouseWheel(e)}if(drag.addEventListener){drag.addEventListener("mousewheel",onMouseWheel.bind(this),false);drag.addEventListener("DOMMouseScroll",onMouseWheel.bind(this),false)}else{drag.attachEvent("onmousewheel",onMouseWheel.bind(this))}bar.appendChild(drag);this.hammer=new Hammer(drag);this.hammer.on("panstart",this._onDragStart.bind(this));this.hammer.on("panmove",this._onDrag.bind(this));this.hammer.on("panend",this._onDragEnd.bind(this));this.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_HORIZONTAL})};CustomTime.prototype.destroy=function(){this.hide();this.hammer.destroy();this.hammer=null;this.body=null};CustomTime.prototype.redraw=function(){var parent=this.body.dom.backgroundVertical;if(this.bar.parentNode!=parent){if(this.bar.parentNode){this.bar.parentNode.removeChild(this.bar)}parent.appendChild(this.bar)}var x=this.body.util.toScreen(this.customTime);var locale=this.options.locales[this.options.locale];if(!locale){if(!this.warned){console.log("WARNING: options.locales['"+this.options.locale+"'] not found. See http://visjs.org/docs/timeline/#Localization");this.warned=true}locale=this.options.locales["en"]}var title=this.options.title;if(title===undefined){title=locale.time+": "+this.options.moment(this.customTime).format("dddd, MMMM Do YYYY, H:mm:ss");title=title.charAt(0).toUpperCase()+title.substring(1)}this.bar.style.left=x+"px";this.bar.title=title;return false};CustomTime.prototype.hide=function(){if(this.bar.parentNode){this.bar.parentNode.removeChild(this.bar)}};CustomTime.prototype.setCustomTime=function(time){this.customTime=util.convert(time,"Date");this.redraw()};CustomTime.prototype.getCustomTime=function(){return new Date(this.customTime.valueOf())};CustomTime.prototype.setCustomTitle=function(title){this.options.title=title};CustomTime.prototype._onDragStart=function(event){this.eventParams.dragging=true;this.eventParams.customTime=this.customTime;event.stopPropagation()};CustomTime.prototype._onDrag=function(event){if(!this.eventParams.dragging)return;var x=this.body.util.toScreen(this.eventParams.customTime)+event.deltaX;var time=this.body.util.toTime(x);this.setCustomTime(time);this.body.emitter.emit("timechange",{id:this.options.id,time:new Date(this.customTime.valueOf()),event:util.elementsCensor(event)});event.stopPropagation()};CustomTime.prototype._onDragEnd=function(event){if(!this.eventParams.dragging)return;this.body.emitter.emit("timechanged",{id:this.options.id,time:new Date(this.customTime.valueOf()),event:util.elementsCensor(event)});event.stopPropagation()};CustomTime.customTimeFromTarget=function(event){var target=event.target;while(target){if(target.hasOwnProperty("custom-time")){return target["custom-time"]}target=target.parentNode}return null};module.exports=CustomTime},{"../../module/hammer":19,"../../module/moment":20,"../../util":116,"../locales":113,"./Component":94}],97:[function(require,module,exports){"use strict";var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var DOMutil=require("../../DOMutil");var Component=require("./Component");var DataScale=require("./DataScale");function DataAxis(body,options,svg,linegraphOptions){this.id=util.randomUUID();this.body=body;this.defaultOptions={orientation:"left",showMinorLabels:true,showMajorLabels:true,icons:false,majorLinesOffset:7,minorLinesOffset:4,labelOffsetX:10,labelOffsetY:2,iconWidth:20,width:"40px",visible:true,alignZeros:true,left:{range:{min:undefined,max:undefined},format:function format(value){return""+parseFloat(value.toPrecision(3))},title:{text:undefined,style:undefined}},right:{range:{min:undefined,max:undefined},format:function format(value){return""+parseFloat(value.toPrecision(3))},title:{text:undefined,style:undefined}}};this.linegraphOptions=linegraphOptions;this.linegraphSVG=svg;this.props={};this.DOMelements={lines:{},labels:{},title:{}};this.dom={};this.scale=undefined;this.range={start:0,end:0};this.options=util.extend({},this.defaultOptions);this.conversionFactor=1;this.setOptions(options);this.width=Number((""+this.options.width).replace("px",""));this.minWidth=this.width;this.height=this.linegraphSVG.getBoundingClientRect().height;this.hidden=false;this.stepPixels=25;this.zeroCrossing=-1;this.amountOfSteps=-1;this.lineOffset=0;this.master=true;this.masterAxis=null;this.svgElements={};this.iconsRemoved=false;this.groups={};this.amountOfGroups=0;this._create();this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups};var me=this;this.body.emitter.on("verticalDrag",function(){me.dom.lineContainer.style.top=me.body.domProps.scrollTop+"px"})}DataAxis.prototype=new Component;DataAxis.prototype.addGroup=function(label,graphOptions){if(!this.groups.hasOwnProperty(label)){this.groups[label]=graphOptions}this.amountOfGroups+=1};DataAxis.prototype.updateGroup=function(label,graphOptions){if(!this.groups.hasOwnProperty(label)){this.amountOfGroups+=1}this.groups[label]=graphOptions};DataAxis.prototype.removeGroup=function(label){if(this.groups.hasOwnProperty(label)){delete this.groups[label];this.amountOfGroups-=1}};DataAxis.prototype.setOptions=function(options){if(options){var redraw=false;if(this.options.orientation!=options.orientation&&options.orientation!==undefined){redraw=true}var fields=["orientation","showMinorLabels","showMajorLabels","icons","majorLinesOffset","minorLinesOffset","labelOffsetX","labelOffsetY","iconWidth","width","visible","left","right","alignZeros"];util.selectiveDeepExtend(fields,this.options,options);this.minWidth=Number((""+this.options.width).replace("px",""));if(redraw===true&&this.dom.frame){this.hide();this.show()}}};DataAxis.prototype._create=function(){this.dom.frame=document.createElement("div");this.dom.frame.style.width=this.options.width;this.dom.frame.style.height=this.height;this.dom.lineContainer=document.createElement("div");this.dom.lineContainer.style.width="100%";this.dom.lineContainer.style.height=this.height;this.dom.lineContainer.style.position="relative";this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg");this.svg.style.position="absolute";this.svg.style.top="0px";this.svg.style.height="100%";this.svg.style.width="100%";this.svg.style.display="block";this.dom.frame.appendChild(this.svg)};DataAxis.prototype._redrawGroupIcons=function(){DOMutil.prepareElements(this.svgElements);var x;var iconWidth=this.options.iconWidth;var iconHeight=15;var iconOffset=4;var y=iconOffset+.5*iconHeight;if(this.options.orientation==="left"){x=iconOffset}else{x=this.width-iconWidth-iconOffset}var groupArray=(0,_keys2["default"])(this.groups);groupArray.sort(function(a,b){return a<b?-1:1});for(var i=0;i<groupArray.length;i++){var groupId=groupArray[i];if(this.groups[groupId].visible===true&&(this.linegraphOptions.visibility[groupId]===undefined||this.linegraphOptions.visibility[groupId]===true)){this.groups[groupId].getLegend(iconWidth,iconHeight,this.framework,x,y);y+=iconHeight+iconOffset}}DOMutil.cleanupElements(this.svgElements);this.iconsRemoved=false};DataAxis.prototype._cleanupIcons=function(){if(this.iconsRemoved===false){DOMutil.prepareElements(this.svgElements);DOMutil.cleanupElements(this.svgElements);this.iconsRemoved=true}};DataAxis.prototype.show=function(){this.hidden=false;if(!this.dom.frame.parentNode){if(this.options.orientation==="left"){this.body.dom.left.appendChild(this.dom.frame)}else{this.body.dom.right.appendChild(this.dom.frame)}}if(!this.dom.lineContainer.parentNode){this.body.dom.backgroundHorizontal.appendChild(this.dom.lineContainer)}};DataAxis.prototype.hide=function(){this.hidden=true;if(this.dom.frame.parentNode){this.dom.frame.parentNode.removeChild(this.dom.frame)}if(this.dom.lineContainer.parentNode){this.dom.lineContainer.parentNode.removeChild(this.dom.lineContainer)}};DataAxis.prototype.setRange=function(start,end){this.range.start=start;this.range.end=end};DataAxis.prototype.redraw=function(){var resized=false;var activeGroups=0;this.dom.lineContainer.style.top=this.body.domProps.scrollTop+"px";for(var groupId in this.groups){if(this.groups.hasOwnProperty(groupId)){if(this.groups[groupId].visible===true&&(this.linegraphOptions.visibility[groupId]===undefined||this.linegraphOptions.visibility[groupId]===true)){activeGroups++}}}if(this.amountOfGroups===0||activeGroups===0){this.hide()}else{this.show();this.height=Number(this.linegraphSVG.style.height.replace("px",""));this.dom.lineContainer.style.height=this.height+"px";this.width=this.options.visible===true?Number((""+this.options.width).replace("px","")):0;var props=this.props;var frame=this.dom.frame;frame.className="vis-data-axis";this._calculateCharSize();var orientation=this.options.orientation;var showMinorLabels=this.options.showMinorLabels;var showMajorLabels=this.options.showMajorLabels;props.minorLabelHeight=showMinorLabels?props.minorCharHeight:0;props.majorLabelHeight=showMajorLabels?props.majorCharHeight:0;props.minorLineWidth=this.body.dom.backgroundHorizontal.offsetWidth-this.lineOffset-this.width+2*this.options.minorLinesOffset;props.minorLineHeight=1;props.majorLineWidth=this.body.dom.backgroundHorizontal.offsetWidth-this.lineOffset-this.width+2*this.options.majorLinesOffset;props.majorLineHeight=1;if(orientation==="left"){frame.style.top="0";frame.style.left="0";frame.style.bottom="";frame.style.width=this.width+"px";frame.style.height=this.height+"px";this.props.width=this.body.domProps.left.width;this.props.height=this.body.domProps.left.height}else{frame.style.top="";frame.style.bottom="0";frame.style.left="0";frame.style.width=this.width+"px";frame.style.height=this.height+"px";this.props.width=this.body.domProps.right.width;this.props.height=this.body.domProps.right.height}resized=this._redrawLabels();resized=this._isResized()||resized;if(this.options.icons===true){this._redrawGroupIcons()}else{this._cleanupIcons()}this._redrawTitle(orientation)}return resized};DataAxis.prototype._redrawLabels=function(){var _this=this;var resized=false;DOMutil.prepareElements(this.DOMelements.lines);DOMutil.prepareElements(this.DOMelements.labels);var orientation=this.options["orientation"];var customRange=this.options[orientation].range!=undefined?this.options[orientation].range:{};var autoScaleEnd=true;if(customRange.max!=undefined){this.range.end=customRange.max;autoScaleEnd=false}var autoScaleStart=true;if(customRange.min!=undefined){this.range.start=customRange.min;autoScaleStart=false}this.scale=new DataScale(this.range.start,this.range.end,autoScaleStart,autoScaleEnd,this.dom.frame.offsetHeight,this.props.majorCharHeight,this.options.alignZeros,this.options[orientation].format);if(this.master===false&&this.masterAxis!=undefined){
this.scale.followScale(this.masterAxis.scale)}this.maxLabelSize=0;var lines=this.scale.getLines();lines.forEach(function(line){var y=line.y;var isMajor=line.major;if(_this.options["showMinorLabels"]&&isMajor===false){_this._redrawLabel(y-2,line.val,orientation,"vis-y-axis vis-minor",_this.props.minorCharHeight)}if(isMajor){if(y>=0){_this._redrawLabel(y-2,line.val,orientation,"vis-y-axis vis-major",_this.props.majorCharHeight)}}if(_this.master===true){if(isMajor){_this._redrawLine(y,orientation,"vis-grid vis-horizontal vis-major",_this.options.majorLinesOffset,_this.props.majorLineWidth)}else{_this._redrawLine(y,orientation,"vis-grid vis-horizontal vis-minor",_this.options.minorLinesOffset,_this.props.minorLineWidth)}}});var titleWidth=0;if(this.options[orientation].title!==undefined&&this.options[orientation].title.text!==undefined){titleWidth=this.props.titleCharHeight}var offset=this.options.icons===true?Math.max(this.options.iconWidth,titleWidth)+this.options.labelOffsetX+15:titleWidth+this.options.labelOffsetX+15;if(this.maxLabelSize>this.width-offset&&this.options.visible===true){this.width=this.maxLabelSize+offset;this.options.width=this.width+"px";DOMutil.cleanupElements(this.DOMelements.lines);DOMutil.cleanupElements(this.DOMelements.labels);this.redraw();resized=true}else if(this.maxLabelSize<this.width-offset&&this.options.visible===true&&this.width>this.minWidth){this.width=Math.max(this.minWidth,this.maxLabelSize+offset);this.options.width=this.width+"px";DOMutil.cleanupElements(this.DOMelements.lines);DOMutil.cleanupElements(this.DOMelements.labels);this.redraw();resized=true}else{DOMutil.cleanupElements(this.DOMelements.lines);DOMutil.cleanupElements(this.DOMelements.labels);resized=false}return resized};DataAxis.prototype.convertValue=function(value){return this.scale.convertValue(value)};DataAxis.prototype.screenToValue=function(x){return this.scale.screenToValue(x)};DataAxis.prototype._redrawLabel=function(y,text,orientation,className,characterHeight){var label=DOMutil.getDOMElement("div",this.DOMelements.labels,this.dom.frame);label.className=className;label.innerHTML=text;if(orientation==="left"){label.style.left="-"+this.options.labelOffsetX+"px";label.style.textAlign="right"}else{label.style.right="-"+this.options.labelOffsetX+"px";label.style.textAlign="left"}label.style.top=y-.5*characterHeight+this.options.labelOffsetY+"px";text+="";var largestWidth=Math.max(this.props.majorCharWidth,this.props.minorCharWidth);if(this.maxLabelSize<text.length*largestWidth){this.maxLabelSize=text.length*largestWidth}};DataAxis.prototype._redrawLine=function(y,orientation,className,offset,width){if(this.master===true){var line=DOMutil.getDOMElement("div",this.DOMelements.lines,this.dom.lineContainer);line.className=className;line.innerHTML="";if(orientation==="left"){line.style.left=this.width-offset+"px"}else{line.style.right=this.width-offset+"px"}line.style.width=width+"px";line.style.top=y+"px"}};DataAxis.prototype._redrawTitle=function(orientation){DOMutil.prepareElements(this.DOMelements.title);if(this.options[orientation].title!==undefined&&this.options[orientation].title.text!==undefined){var title=DOMutil.getDOMElement("div",this.DOMelements.title,this.dom.frame);title.className="vis-y-axis vis-title vis-"+orientation;title.innerHTML=this.options[orientation].title.text;if(this.options[orientation].title.style!==undefined){util.addCssText(title,this.options[orientation].title.style)}if(orientation==="left"){title.style.left=this.props.titleCharHeight+"px"}else{title.style.right=this.props.titleCharHeight+"px"}title.style.width=this.height+"px"}DOMutil.cleanupElements(this.DOMelements.title)};DataAxis.prototype._calculateCharSize=function(){if(!("minorCharHeight"in this.props)){var textMinor=document.createTextNode("0");var measureCharMinor=document.createElement("div");measureCharMinor.className="vis-y-axis vis-minor vis-measure";measureCharMinor.appendChild(textMinor);this.dom.frame.appendChild(measureCharMinor);this.props.minorCharHeight=measureCharMinor.clientHeight;this.props.minorCharWidth=measureCharMinor.clientWidth;this.dom.frame.removeChild(measureCharMinor)}if(!("majorCharHeight"in this.props)){var textMajor=document.createTextNode("0");var measureCharMajor=document.createElement("div");measureCharMajor.className="vis-y-axis vis-major vis-measure";measureCharMajor.appendChild(textMajor);this.dom.frame.appendChild(measureCharMajor);this.props.majorCharHeight=measureCharMajor.clientHeight;this.props.majorCharWidth=measureCharMajor.clientWidth;this.dom.frame.removeChild(measureCharMajor)}if(!("titleCharHeight"in this.props)){var textTitle=document.createTextNode("0");var measureCharTitle=document.createElement("div");measureCharTitle.className="vis-y-axis vis-title vis-measure";measureCharTitle.appendChild(textTitle);this.dom.frame.appendChild(measureCharTitle);this.props.titleCharHeight=measureCharTitle.clientHeight;this.props.titleCharWidth=measureCharTitle.clientWidth;this.dom.frame.removeChild(measureCharTitle)}};module.exports=DataAxis},{"../../DOMutil":5,"../../util":116,"./Component":94,"./DataScale":98,"babel-runtime/core-js/object/keys":124}],98:[function(require,module,exports){"use strict";function DataScale(start,end,autoScaleStart,autoScaleEnd,containerHeight,majorCharHeight){var zeroAlign=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;var formattingFunction=arguments.length>7&&arguments[7]!==undefined?arguments[7]:false;this.majorSteps=[1,2,5,10];this.minorSteps=[.25,.5,1,2];this.customLines=null;this.containerHeight=containerHeight;this.majorCharHeight=majorCharHeight;this._start=start;this._end=end;this.scale=1;this.minorStepIdx=-1;this.magnitudefactor=1;this.determineScale();this.zeroAlign=zeroAlign;this.autoScaleStart=autoScaleStart;this.autoScaleEnd=autoScaleEnd;this.formattingFunction=formattingFunction;if(autoScaleStart||autoScaleEnd){var me=this;var roundToMinor=function roundToMinor(value){var rounded=value-value%(me.magnitudefactor*me.minorSteps[me.minorStepIdx]);if(value%(me.magnitudefactor*me.minorSteps[me.minorStepIdx])>.5*(me.magnitudefactor*me.minorSteps[me.minorStepIdx])){return rounded+me.magnitudefactor*me.minorSteps[me.minorStepIdx]}else{return rounded}};if(autoScaleStart){this._start-=this.magnitudefactor*2*this.minorSteps[this.minorStepIdx];this._start=roundToMinor(this._start)}if(autoScaleEnd){this._end+=this.magnitudefactor*this.minorSteps[this.minorStepIdx];this._end=roundToMinor(this._end)}this.determineScale()}}DataScale.prototype.setCharHeight=function(majorCharHeight){this.majorCharHeight=majorCharHeight};DataScale.prototype.setHeight=function(containerHeight){this.containerHeight=containerHeight};DataScale.prototype.determineScale=function(){var range=this._end-this._start;this.scale=this.containerHeight/range;var minimumStepValue=this.majorCharHeight/this.scale;var orderOfMagnitude=range>0?Math.round(Math.log(range)/Math.LN10):0;this.minorStepIdx=-1;this.magnitudefactor=Math.pow(10,orderOfMagnitude);var start=0;if(orderOfMagnitude<0){start=orderOfMagnitude}var solutionFound=false;for(var l=start;Math.abs(l)<=Math.abs(orderOfMagnitude);l++){this.magnitudefactor=Math.pow(10,l);for(var j=0;j<this.minorSteps.length;j++){var stepSize=this.magnitudefactor*this.minorSteps[j];if(stepSize>=minimumStepValue){solutionFound=true;this.minorStepIdx=j;break}}if(solutionFound===true){break}}};DataScale.prototype.is_major=function(value){return value%(this.magnitudefactor*this.majorSteps[this.minorStepIdx])===0};DataScale.prototype.getStep=function(){return this.magnitudefactor*this.minorSteps[this.minorStepIdx]};DataScale.prototype.getFirstMajor=function(){var majorStep=this.magnitudefactor*this.majorSteps[this.minorStepIdx];return this.convertValue(this._start+(majorStep-this._start%majorStep)%majorStep)};DataScale.prototype.formatValue=function(current){var returnValue=current.toPrecision(5);if(typeof this.formattingFunction==="function"){returnValue=this.formattingFunction(current)}if(typeof returnValue==="number"){return""+returnValue}else if(typeof returnValue==="string"){return returnValue}else{return current.toPrecision(5)}};DataScale.prototype.getLines=function(){var lines=[];var step=this.getStep();var bottomOffset=(step-this._start%step)%step;for(var i=this._start+bottomOffset;this._end-i>1e-5;i+=step){if(i!=this._start){lines.push({major:this.is_major(i),y:this.convertValue(i),val:this.formatValue(i)})}}return lines};DataScale.prototype.followScale=function(other){var oldStepIdx=this.minorStepIdx;var oldStart=this._start;var oldEnd=this._end;var me=this;var increaseMagnitude=function increaseMagnitude(){me.magnitudefactor*=2};var decreaseMagnitude=function decreaseMagnitude(){me.magnitudefactor/=2};if(other.minorStepIdx<=1&&this.minorStepIdx<=1||other.minorStepIdx>1&&this.minorStepIdx>1){}else if(other.minorStepIdx<this.minorStepIdx){this.minorStepIdx=1;if(oldStepIdx==2){increaseMagnitude()}else{increaseMagnitude();increaseMagnitude()}}else{this.minorStepIdx=2;if(oldStepIdx==1){decreaseMagnitude()}else{decreaseMagnitude();decreaseMagnitude()}}var lines=other.getLines();var otherZero=other.convertValue(0);var otherStep=other.getStep()*other.scale;var done=false;var count=0;while(!done&&count++<5){this.scale=otherStep/(this.minorSteps[this.minorStepIdx]*this.magnitudefactor);var newRange=this.containerHeight/this.scale;this._start=oldStart;this._end=this._start+newRange;var myOriginalZero=this._end*this.scale;var majorStep=this.magnitudefactor*this.majorSteps[this.minorStepIdx];var majorOffset=this.getFirstMajor()-other.getFirstMajor();if(this.zeroAlign){var zeroOffset=otherZero-myOriginalZero;this._end+=zeroOffset/this.scale;this._start=this._end-newRange}else{if(!this.autoScaleStart){this._start+=majorStep-majorOffset/this.scale;this._end=this._start+newRange}else{this._start-=majorOffset/this.scale;this._end=this._start+newRange}}if(!this.autoScaleEnd&&this._end>oldEnd+1e-5){decreaseMagnitude();done=false;continue}if(!this.autoScaleStart&&this._start<oldStart-1e-5){if(this.zeroAlign&&oldStart>=0){console.warn("Can't adhere to given 'min' range, due to zeroalign")}else{decreaseMagnitude();done=false;continue}}if(this.autoScaleStart&&this.autoScaleEnd&&newRange<oldEnd-oldStart){increaseMagnitude();done=false;continue}done=true}};DataScale.prototype.convertValue=function(value){return this.containerHeight-(value-this._start)*this.scale};DataScale.prototype.screenToValue=function(pixels){return(this.containerHeight-pixels)/this.scale+this._start};module.exports=DataScale},{}],99:[function(require,module,exports){"use strict";var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var DOMutil=require("../../DOMutil");var Bars=require("./graph2d_types/bar");var Lines=require("./graph2d_types/line");var Points=require("./graph2d_types/points");function GraphGroup(group,groupId,options,groupsUsingDefaultStyles){this.id=groupId;var fields=["sampling","style","sort","yAxisOrientation","barChart","drawPoints","shaded","interpolation","zIndex","excludeFromStacking","excludeFromLegend"];this.options=util.selectiveBridgeObject(fields,options);this.usingDefaultStyle=group.className===undefined;this.groupsUsingDefaultStyles=groupsUsingDefaultStyles;this.zeroPosition=0;this.update(group);if(this.usingDefaultStyle==true){this.groupsUsingDefaultStyles[0]+=1}this.itemsData=[];this.visible=group.visible===undefined?true:group.visible}GraphGroup.prototype.setItems=function(items){if(items!=null){this.itemsData=items;if(this.options.sort==true){util.insertSort(this.itemsData,function(a,b){return a.x>b.x?1:-1})}}else{this.itemsData=[]}};GraphGroup.prototype.getItems=function(){return this.itemsData};GraphGroup.prototype.setZeroPosition=function(pos){this.zeroPosition=pos};GraphGroup.prototype.setOptions=function(options){if(options!==undefined){var fields=["sampling","style","sort","yAxisOrientation","barChart","zIndex","excludeFromStacking","excludeFromLegend"];util.selectiveDeepExtend(fields,this.options,options);if(typeof options.drawPoints=="function"){options.drawPoints={onRender:options.drawPoints}}util.mergeOptions(this.options,options,"interpolation");util.mergeOptions(this.options,options,"drawPoints");util.mergeOptions(this.options,options,"shaded");if(options.interpolation){if((0,_typeof3["default"])(options.interpolation)=="object"){if(options.interpolation.parametrization){if(options.interpolation.parametrization=="uniform"){this.options.interpolation.alpha=0}else if(options.interpolation.parametrization=="chordal"){this.options.interpolation.alpha=1}else{this.options.interpolation.parametrization="centripetal";this.options.interpolation.alpha=.5}}}}}};GraphGroup.prototype.update=function(group){this.group=group;this.content=group.content||"graph";this.className=group.className||this.className||"vis-graph-group"+this.groupsUsingDefaultStyles[0]%10;this.visible=group.visible===undefined?true:group.visible;this.style=group.style;this.setOptions(group.options)};GraphGroup.prototype.getLegend=function(iconWidth,iconHeight,framework,x,y){if(framework==undefined||framework==null){var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");framework={svg:svg,svgElements:{},options:this.options,groups:[this]}}if(x==undefined||x==null){x=0}if(y==undefined||y==null){y=.5*iconHeight}switch(this.options.style){case"line":Lines.drawIcon(this,x,y,iconWidth,iconHeight,framework);break;case"points":case"point":Points.drawIcon(this,x,y,iconWidth,iconHeight,framework);break;case"bar":Bars.drawIcon(this,x,y,iconWidth,iconHeight,framework);break}return{icon:framework.svg,label:this.content,orientation:this.options.yAxisOrientation}};GraphGroup.prototype.getYRange=function(groupData){var yMin=groupData[0].y;var yMax=groupData[0].y;for(var j=0;j<groupData.length;j++){yMin=yMin>groupData[j].y?groupData[j].y:yMin;yMax=yMax<groupData[j].y?groupData[j].y:yMax}return{min:yMin,max:yMax,yAxisOrientation:this.options.yAxisOrientation}};module.exports=GraphGroup},{"../../DOMutil":5,"../../util":116,"./graph2d_types/bar":105,"./graph2d_types/line":106,"./graph2d_types/points":107,"babel-runtime/helpers/typeof":133}],100:[function(require,module,exports){"use strict";var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var stack=require("../Stack");var RangeItem=require("./item/RangeItem");function Group(groupId,data,itemSet){this.groupId=groupId;this.subgroups={};this.subgroupIndex=0;this.subgroupOrderer=data&&data.subgroupOrder;this.itemSet=itemSet;this.isVisible=null;if(data&&data.nestedGroups){this.nestedGroups=data.nestedGroups;if(data.showNested==false){this.showNested=false}else{this.showNested=true}}this.nestedInGroup=null;this.dom={};this.props={label:{width:0,height:0}};this.className=null;this.items={};this.visibleItems=[];this.itemsInRange=[];this.orderedItems={byStart:[],byEnd:[]};this.checkRangedItems=false;var me=this;this.itemSet.body.emitter.on("checkRangedItems",function(){me.checkRangedItems=true});this._create();this.setData(data)}Group.prototype._create=function(){var label=document.createElement("div");if(this.itemSet.options.groupEditable.order){label.className="vis-label draggable"}else{label.className="vis-label"}this.dom.label=label;var inner=document.createElement("div");inner.className="vis-inner";label.appendChild(inner);this.dom.inner=inner;var foreground=document.createElement("div");foreground.className="vis-group";foreground["timeline-group"]=this;this.dom.foreground=foreground;this.dom.background=document.createElement("div");this.dom.background.className="vis-group";this.dom.axis=document.createElement("div");this.dom.axis.className="vis-group";this.dom.marker=document.createElement("div");this.dom.marker.style.visibility="hidden";this.dom.marker.style.position="absolute";this.dom.marker.innerHTML="";this.dom.background.appendChild(this.dom.marker)};Group.prototype.setData=function(data){var content;var templateFunction;if(this.itemSet.options&&this.itemSet.options.groupTemplate){templateFunction=this.itemSet.options.groupTemplate.bind(this);content=templateFunction(data,this.dom.inner)}else{content=data&&data.content}if(content instanceof Element){this.dom.inner.appendChild(content);while(this.dom.inner.firstChild){this.dom.inner.removeChild(this.dom.inner.firstChild)}this.dom.inner.appendChild(content)}else if(content instanceof Object){templateFunction(data,this.dom.inner)}else if(content!==undefined&&content!==null){this.dom.inner.innerHTML=content}else{this.dom.inner.innerHTML=this.groupId||""}this.dom.label.title=data&&data.title||"";if(!this.dom.inner.firstChild){util.addClassName(this.dom.inner,"vis-hidden")}else{util.removeClassName(this.dom.inner,"vis-hidden")}if(data&&data.nestedGroups){if(data.showNested==false){this.showNested=false}else{this.showNested=true}util.addClassName(this.dom.label,"vis-nesting-group");if(this.showNested){util.removeClassName(this.dom.label,"collapsed");util.addClassName(this.dom.label,"expanded")}else{util.removeClassName(this.dom.label,"expanded");var collapsedDirClassName=this.itemSet.options.rtl?"collapsed-rtl":"collapsed";util.addClassName(this.dom.label,collapsedDirClassName)}}if(data&&data.nestedInGroup){util.addClassName(this.dom.label,"vis-nested-group");if(this.itemSet.options&&this.itemSet.options.rtl){this.dom.inner.style.paddingRight="30px"}else{this.dom.inner.style.paddingLeft="30px"}}var className=data&&data.className||null;if(className!=this.className){if(this.className){util.removeClassName(this.dom.label,this.className);util.removeClassName(this.dom.foreground,this.className);util.removeClassName(this.dom.background,this.className);util.removeClassName(this.dom.axis,this.className)}util.addClassName(this.dom.label,className);util.addClassName(this.dom.foreground,className);util.addClassName(this.dom.background,className);util.addClassName(this.dom.axis,className);this.className=className}if(this.style){util.removeCssText(this.dom.label,this.style);this.style=null}if(data&&data.style){util.addCssText(this.dom.label,data.style);this.style=data.style}};Group.prototype.getLabelWidth=function(){return this.props.label.width};Group.prototype.redraw=function(range,margin,restack){var resized=false;var markerHeight=this.dom.marker.clientHeight;if(markerHeight!=this.lastMarkerHeight){this.lastMarkerHeight=markerHeight;util.forEach(this.items,function(item){item.dirty=true;if(item.displayed)item.redraw()});restack=true}this._calculateSubGroupHeights(margin);var foreground=this.dom.foreground;this.top=foreground.offsetTop;this.right=foreground.offsetLeft;this.width=foreground.offsetWidth;this.isVisible=this._isGroupVisible(range,margin);if(typeof this.itemSet.options.order==="function"){if(restack){var me=this;var limitSize=false;util.forEach(this.items,function(item){if(!item.displayed){item.redraw();me.visibleItems.push(item)}item.repositionX(limitSize)});var customOrderedItems=this.orderedItems.byStart.slice().sort(function(a,b){return me.itemSet.options.order(a.data,b.data)});stack.stack(customOrderedItems,margin,true)}this.visibleItems=this._updateItemsInRange(this.orderedItems,this.visibleItems,range)}else{this.visibleItems=this._updateItemsInRange(this.orderedItems,this.visibleItems,range);if(this.itemSet.options.stack){stack.stack(this.visibleItems,margin,restack)}else{stack.nostack(this.visibleItems,margin,this.subgroups,this.itemSet.options.stackSubgroups)}}this._updateSubgroupsSizes();var height=this._calculateHeight(margin);var foreground=this.dom.foreground;this.top=foreground.offsetTop;this.right=foreground.offsetLeft;this.width=foreground.offsetWidth;resized=util.updateProperty(this,"height",height)||resized;resized=util.updateProperty(this.props.label,"width",this.dom.inner.clientWidth)||resized;resized=util.updateProperty(this.props.label,"height",this.dom.inner.clientHeight)||resized;this.dom.background.style.height=height+"px";this.dom.foreground.style.height=height+"px";this.dom.label.style.height=height+"px";for(var i=0,ii=this.visibleItems.length;i<ii;i++){var item=this.visibleItems[i];item.repositionY(margin);if(!this.isVisible&&this.groupId!="__background__"){if(item.displayed)item.hide()}}if(!this.isVisible&&this.height){return resized=false}return resized};Group.prototype._calculateSubGroupHeights=function(margin){if((0,_keys2["default"])(this.subgroups).length>0){var me=this;this.resetSubgroups();util.forEach(this.visibleItems,function(item){if(item.data.subgroup!==undefined){me.subgroups[item.data.subgroup].height=Math.max(me.subgroups[item.data.subgroup].height,item.height+margin.item.vertical);me.subgroups[item.data.subgroup].visible=true}})}};Group.prototype._isGroupVisible=function(range,margin){var isVisible=this.top<=range.body.domProps.centerContainer.height-range.body.domProps.scrollTop+margin.axis&&this.top+this.height+margin.axis>=-range.body.domProps.scrollTop;return isVisible};Group.prototype._calculateHeight=function(margin){var height;var itemsInRange=this.visibleItems;if(itemsInRange.length>0){var min=itemsInRange[0].top;var max=itemsInRange[0].top+itemsInRange[0].height;util.forEach(itemsInRange,function(item){min=Math.min(min,item.top);max=Math.max(max,item.top+item.height)});if(min>margin.axis){var offset=min-margin.axis;max-=offset;util.forEach(itemsInRange,function(item){item.top-=offset})}height=max+margin.item.vertical/2}else{height=0}height=Math.max(height,this.props.label.height);return height};Group.prototype.show=function(){if(!this.dom.label.parentNode){this.itemSet.dom.labelSet.appendChild(this.dom.label)}if(!this.dom.foreground.parentNode){this.itemSet.dom.foreground.appendChild(this.dom.foreground)}if(!this.dom.background.parentNode){this.itemSet.dom.background.appendChild(this.dom.background)}if(!this.dom.axis.parentNode){this.itemSet.dom.axis.appendChild(this.dom.axis)}};Group.prototype.hide=function(){var label=this.dom.label;if(label.parentNode){label.parentNode.removeChild(label)}var foreground=this.dom.foreground;if(foreground.parentNode){foreground.parentNode.removeChild(foreground)}var background=this.dom.background;if(background.parentNode){background.parentNode.removeChild(background)}var axis=this.dom.axis;if(axis.parentNode){axis.parentNode.removeChild(axis)}};Group.prototype.add=function(item){this.items[item.id]=item;item.setParent(this);if(item.data.subgroup!==undefined){if(this.subgroups[item.data.subgroup]===undefined){this.subgroups[item.data.subgroup]={height:0,top:0,start:item.data.start,end:item.data.end,visible:false,index:this.subgroupIndex,items:[]};this.subgroupIndex++}if(new Date(item.data.start)<new Date(this.subgroups[item.data.subgroup].start)){this.subgroups[item.data.subgroup].start=item.data.start}if(new Date(item.data.end)>new Date(this.subgroups[item.data.subgroup].end)){this.subgroups[item.data.subgroup].end=item.data.end}this.subgroups[item.data.subgroup].items.push(item)}this.orderSubgroups();if(this.visibleItems.indexOf(item)==-1){var range=this.itemSet.body.range;this._checkIfVisible(item,this.visibleItems,range)}};Group.prototype._updateSubgroupsSizes=function(){var me=this;if(me.subgroups){for(var subgroup in me.subgroups){var newStart=me.subgroups[subgroup].items[0].data.start;var newEnd=me.subgroups[subgroup].items[0].data.end;me.subgroups[subgroup].items.forEach(function(item){if(new Date(item.data.start)<new Date(newStart)){newStart=item.data.start}if(new Date(item.data.end)>new Date(newEnd)){newEnd=item.data.end}});me.subgroups[subgroup].start=newStart;me.subgroups[subgroup].end=newEnd}}};Group.prototype.orderSubgroups=function(){if(this.subgroupOrderer!==undefined){var sortArray=[];if(typeof this.subgroupOrderer=="string"){for(var subgroup in this.subgroups){sortArray.push({subgroup:subgroup,sortField:this.subgroups[subgroup].items[0].data[this.subgroupOrderer]})}sortArray.sort(function(a,b){return a.sortField-b.sortField})}else if(typeof this.subgroupOrderer=="function"){for(var subgroup in this.subgroups){sortArray.push(this.subgroups[subgroup].items[0].data)}sortArray.sort(this.subgroupOrderer)}if(sortArray.length>0){for(var i=0;i<sortArray.length;i++){this.subgroups[sortArray[i].subgroup].index=i}}}};Group.prototype.resetSubgroups=function(){for(var subgroup in this.subgroups){if(this.subgroups.hasOwnProperty(subgroup)){this.subgroups[subgroup].visible=false}}};Group.prototype.remove=function(item){delete this.items[item.id];item.setParent(null);var index=this.visibleItems.indexOf(item);if(index!=-1)this.visibleItems.splice(index,1);if(item.data.subgroup!==undefined){var subgroup=this.subgroups[item.data.subgroup];if(subgroup){var itemIndex=subgroup.items.indexOf(item);subgroup.items.splice(itemIndex,1);if(!subgroup.items.length){delete this.subgroups[item.data.subgroup];this.subgroupIndex--}else{this._updateSubgroupsSizes()}this.orderSubgroups()}}};Group.prototype.removeFromDataSet=function(item){this.itemSet.removeItem(item.id)};Group.prototype.order=function(){var array=util.toArray(this.items);var startArray=[];var endArray=[];for(var i=0;i<array.length;i++){if(array[i].data.end!==undefined){endArray.push(array[i])}startArray.push(array[i])}this.orderedItems={byStart:startArray,byEnd:endArray};stack.orderByStart(this.orderedItems.byStart);stack.orderByEnd(this.orderedItems.byEnd)};Group.prototype._updateItemsInRange=function(orderedItems,oldVisibleItems,range){var visibleItems=[];var visibleItemsLookup={};var interval=(range.end-range.start)/4;var lowerBound=range.start-interval;var upperBound=range.end+interval;var searchFunction=function searchFunction(value){if(value<lowerBound){return-1}else if(value<=upperBound){return 0}else{return 1}};if(oldVisibleItems.length>0){for(var i=0;i<oldVisibleItems.length;i++){this._checkIfVisibleWithReference(oldVisibleItems[i],visibleItems,visibleItemsLookup,range)}}var initialPosByStart=util.binarySearchCustom(orderedItems.byStart,searchFunction,"data","start");this._traceVisible(initialPosByStart,orderedItems.byStart,visibleItems,visibleItemsLookup,function(item){return item.data.start<lowerBound||item.data.start>upperBound});if(this.checkRangedItems==true){this.checkRangedItems=false;for(i=0;i<orderedItems.byEnd.length;i++){this._checkIfVisibleWithReference(orderedItems.byEnd[i],visibleItems,visibleItemsLookup,range)}}else{var initialPosByEnd=util.binarySearchCustom(orderedItems.byEnd,searchFunction,"data","end");this._traceVisible(initialPosByEnd,orderedItems.byEnd,visibleItems,visibleItemsLookup,function(item){return item.data.end<lowerBound||item.data.end>upperBound})}for(var i=0;i<visibleItems.length;i++){var item=visibleItems[i];if(!item.displayed)item.show();item.repositionX()}return visibleItems};Group.prototype._traceVisible=function(initialPos,items,visibleItems,visibleItemsLookup,breakCondition){if(initialPos!=-1){for(var i=initialPos;i>=0;i--){var item=items[i];if(breakCondition(item)){break}else{if(visibleItemsLookup[item.id]===undefined){visibleItemsLookup[item.id]=true;visibleItems.push(item)}}}for(var i=initialPos+1;i<items.length;i++){var item=items[i];if(breakCondition(item)){break}else{if(visibleItemsLookup[item.id]===undefined){visibleItemsLookup[item.id]=true;visibleItems.push(item)}}}}};Group.prototype._checkIfVisible=function(item,visibleItems,range){if(item.isVisible(range)){if(!item.displayed)item.show();item.repositionX();visibleItems.push(item)}else{if(item.displayed)item.hide()}};Group.prototype._checkIfVisibleWithReference=function(item,visibleItems,visibleItemsLookup,range){if(item.isVisible(range)){if(visibleItemsLookup[item.id]===undefined){visibleItemsLookup[item.id]=true;visibleItems.push(item)}}else{if(item.displayed)item.hide()}};module.exports=Group},{"../../util":116,"../Stack":90,"./item/RangeItem":112,"babel-runtime/core-js/object/keys":124}],101:[function(require,module,exports){"use strict";var _create=require("babel-runtime/core-js/object/create");var _create2=_interopRequireDefault(_create);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _Popup=require("../../shared/Popup");var _Popup2=_interopRequireDefault(_Popup);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Hammer=require("../../module/hammer");var util=require("../../util");var DataSet=require("../../DataSet");var DataView=require("../../DataView");var TimeStep=require("../TimeStep");var Component=require("./Component");var Group=require("./Group");var BackgroundGroup=require("./BackgroundGroup");var BoxItem=require("./item/BoxItem");var PointItem=require("./item/PointItem");var RangeItem=require("./item/RangeItem");var BackgroundItem=require("./item/BackgroundItem");var UNGROUPED="__ungrouped__";var BACKGROUND="__background__";function ItemSet(body,options){this.body=body;this.defaultOptions={type:null,orientation:{item:"bottom"},align:"auto",stack:true,stackSubgroups:true,groupOrderSwap:function groupOrderSwap(fromGroup,toGroup,groups){var targetOrder=toGroup.order;toGroup.order=fromGroup.order;fromGroup.order=targetOrder},groupOrder:"order",selectable:true,multiselect:false,itemsAlwaysDraggable:false,editable:{updateTime:false,updateGroup:false,add:false,remove:false,overrideItems:false},groupEditable:{order:false,add:false,remove:false},snap:TimeStep.snap,onAdd:function onAdd(item,callback){callback(item)},onUpdate:function onUpdate(item,callback){callback(item)},onMove:function onMove(item,callback){callback(item)},onRemove:function onRemove(item,callback){callback(item)},onMoving:function onMoving(item,callback){callback(item)},onAddGroup:function onAddGroup(item,callback){callback(item)},onMoveGroup:function onMoveGroup(item,callback){callback(item)},onRemoveGroup:function onRemoveGroup(item,callback){callback(item)},margin:{item:{horizontal:10,vertical:10},axis:20},tooltip:{followMouse:false,overflowMethod:"flip"},tooltipOnItemUpdateTime:false};this.options=util.extend({},this.defaultOptions);this.options.rtl=options.rtl;this.itemOptions={type:{start:"Date",end:"Date"}};this.conversion={toScreen:body.util.toScreen,toTime:body.util.toTime};this.dom={};this.props={};this.hammer=null;var me=this;this.itemsData=null;this.groupsData=null;this.itemListeners={add:function add(event,params,senderId){me._onAdd(params.items)},update:function update(event,params,senderId){me._onUpdate(params.items)},remove:function remove(event,params,senderId){me._onRemove(params.items)}};this.groupListeners={add:function add(event,params,senderId){me._onAddGroups(params.items)},update:function update(event,params,senderId){me._onUpdateGroups(params.items)},remove:function remove(event,params,senderId){me._onRemoveGroups(params.items)}};this.items={};this.groups={};this.groupIds=[];this.selection=[];this.stackDirty=true;this.touchParams={};this.groupTouchParams={};this._create();this.setOptions(options)}ItemSet.prototype=new Component;ItemSet.types={background:BackgroundItem,box:BoxItem,range:RangeItem,point:PointItem};ItemSet.prototype._create=function(){var frame=document.createElement("div");frame.className="vis-itemset";frame["timeline-itemset"]=this;this.dom.frame=frame;var background=document.createElement("div");background.className="vis-background";frame.appendChild(background);this.dom.background=background;var foreground=document.createElement("div");foreground.className="vis-foreground";frame.appendChild(foreground);this.dom.foreground=foreground;var axis=document.createElement("div");axis.className="vis-axis";this.dom.axis=axis;var labelSet=document.createElement("div");labelSet.className="vis-labelset";this.dom.labelSet=labelSet;this._updateUngrouped();var backgroundGroup=new BackgroundGroup(BACKGROUND,null,this);backgroundGroup.show();this.groups[BACKGROUND]=backgroundGroup;this.hammer=new Hammer(this.body.dom.centerContainer);
this.hammer.on("hammer.input",function(event){if(event.isFirst){this._onTouch(event)}}.bind(this));this.hammer.on("panstart",this._onDragStart.bind(this));this.hammer.on("panmove",this._onDrag.bind(this));this.hammer.on("panend",this._onDragEnd.bind(this));this.hammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_HORIZONTAL});this.hammer.on("tap",this._onSelectItem.bind(this));this.hammer.on("press",this._onMultiSelectItem.bind(this));this.hammer.on("doubletap",this._onAddItem.bind(this));if(this.options.rtl){this.groupHammer=new Hammer(this.body.dom.rightContainer)}else{this.groupHammer=new Hammer(this.body.dom.leftContainer)}this.groupHammer.on("tap",this._onGroupClick.bind(this));this.groupHammer.on("panstart",this._onGroupDragStart.bind(this));this.groupHammer.on("panmove",this._onGroupDrag.bind(this));this.groupHammer.on("panend",this._onGroupDragEnd.bind(this));this.groupHammer.get("pan").set({threshold:5,direction:Hammer.DIRECTION_VERTICAL});this.body.dom.centerContainer.addEventListener("mouseover",this._onMouseOver.bind(this));this.body.dom.centerContainer.addEventListener("mouseout",this._onMouseOut.bind(this));this.body.dom.centerContainer.addEventListener("mousemove",this._onMouseMove.bind(this));this.body.dom.centerContainer.addEventListener("contextmenu",this._onDragEnd.bind(this));this.show()};ItemSet.prototype.setOptions=function(options){if(options){var fields=["type","rtl","align","order","stack","stackSubgroups","selectable","multiselect","itemsAlwaysDraggable","multiselectPerGroup","groupOrder","dataAttributes","template","groupTemplate","visibleFrameTemplate","hide","snap","groupOrderSwap","tooltip","tooltipOnItemUpdateTime"];util.selectiveExtend(fields,this.options,options);if("orientation"in options){if(typeof options.orientation==="string"){this.options.orientation.item=options.orientation==="top"?"top":"bottom"}else if((0,_typeof3["default"])(options.orientation)==="object"&&"item"in options.orientation){this.options.orientation.item=options.orientation.item}}if("margin"in options){if(typeof options.margin==="number"){this.options.margin.axis=options.margin;this.options.margin.item.horizontal=options.margin;this.options.margin.item.vertical=options.margin}else if((0,_typeof3["default"])(options.margin)==="object"){util.selectiveExtend(["axis"],this.options.margin,options.margin);if("item"in options.margin){if(typeof options.margin.item==="number"){this.options.margin.item.horizontal=options.margin.item;this.options.margin.item.vertical=options.margin.item}else if((0,_typeof3["default"])(options.margin.item)==="object"){util.selectiveExtend(["horizontal","vertical"],this.options.margin.item,options.margin.item)}}}}if("editable"in options){if(typeof options.editable==="boolean"){this.options.editable.updateTime=options.editable;this.options.editable.updateGroup=options.editable;this.options.editable.add=options.editable;this.options.editable.remove=options.editable;this.options.editable.overrideItems=false}else if((0,_typeof3["default"])(options.editable)==="object"){util.selectiveExtend(["updateTime","updateGroup","add","remove","overrideItems"],this.options.editable,options.editable)}}if("groupEditable"in options){if(typeof options.groupEditable==="boolean"){this.options.groupEditable.order=options.groupEditable;this.options.groupEditable.add=options.groupEditable;this.options.groupEditable.remove=options.groupEditable}else if((0,_typeof3["default"])(options.groupEditable)==="object"){util.selectiveExtend(["order","add","remove"],this.options.groupEditable,options.groupEditable)}}var addCallback=function(name){var fn=options[name];if(fn){if(!(fn instanceof Function)){throw new Error("option "+name+" must be a function "+name+"(item, callback)")}this.options[name]=fn}}.bind(this);["onAdd","onUpdate","onRemove","onMove","onMoving","onAddGroup","onMoveGroup","onRemoveGroup"].forEach(addCallback);this.markDirty()}};ItemSet.prototype.markDirty=function(options){this.groupIds=[];this.stackDirty=true;if(options&&options.refreshItems){util.forEach(this.items,function(item){item.dirty=true;if(item.displayed)item.redraw()})}};ItemSet.prototype.destroy=function(){this.hide();this.setItems(null);this.setGroups(null);this.hammer=null;this.body=null;this.conversion=null};ItemSet.prototype.hide=function(){if(this.dom.frame.parentNode){this.dom.frame.parentNode.removeChild(this.dom.frame)}if(this.dom.axis.parentNode){this.dom.axis.parentNode.removeChild(this.dom.axis)}if(this.dom.labelSet.parentNode){this.dom.labelSet.parentNode.removeChild(this.dom.labelSet)}};ItemSet.prototype.show=function(){if(!this.dom.frame.parentNode){this.body.dom.center.appendChild(this.dom.frame)}if(!this.dom.axis.parentNode){this.body.dom.backgroundVertical.appendChild(this.dom.axis)}if(!this.dom.labelSet.parentNode){if(this.options.rtl){this.body.dom.right.appendChild(this.dom.labelSet)}else{this.body.dom.left.appendChild(this.dom.labelSet)}}};ItemSet.prototype.setSelection=function(ids){var i,ii,id,item;if(ids==undefined)ids=[];if(!Array.isArray(ids))ids=[ids];for(i=0,ii=this.selection.length;i<ii;i++){id=this.selection[i];item=this.items[id];if(item)item.unselect()}this.selection=[];for(i=0,ii=ids.length;i<ii;i++){id=ids[i];item=this.items[id];if(item){this.selection.push(id);item.select()}}};ItemSet.prototype.getSelection=function(){return this.selection.concat([])};ItemSet.prototype.getVisibleItems=function(){var range=this.body.range.getRange();if(this.options.rtl){var right=this.body.util.toScreen(range.start);var left=this.body.util.toScreen(range.end)}else{var left=this.body.util.toScreen(range.start);var right=this.body.util.toScreen(range.end)}var ids=[];for(var groupId in this.groups){if(this.groups.hasOwnProperty(groupId)){var group=this.groups[groupId];var rawVisibleItems=group.visibleItems;for(var i=0;i<rawVisibleItems.length;i++){var item=rawVisibleItems[i];if(this.options.rtl){if(item.right<left&&item.right+item.width>right){ids.push(item.id)}}else{if(item.left<right&&item.left+item.width>left){ids.push(item.id)}}}}}return ids};ItemSet.prototype._deselect=function(id){var selection=this.selection;for(var i=0,ii=selection.length;i<ii;i++){if(selection[i]==id){selection.splice(i,1);break}}};ItemSet.prototype.redraw=function(){var margin=this.options.margin,range=this.body.range,asSize=util.option.asSize,options=this.options,orientation=options.orientation.item,resized=false,frame=this.dom.frame;this.props.top=this.body.domProps.top.height+this.body.domProps.border.top;if(this.options.rtl){this.props.right=this.body.domProps.right.width+this.body.domProps.border.right}else{this.props.left=this.body.domProps.left.width+this.body.domProps.border.left}frame.className="vis-itemset";resized=this._orderGroups()||resized;var visibleInterval=range.end-range.start;var zoomed=visibleInterval!=this.lastVisibleInterval||this.props.width!=this.props.lastWidth;if(zoomed)this.stackDirty=true;this.lastVisibleInterval=visibleInterval;this.props.lastWidth=this.props.width;var restack=this.stackDirty;var firstGroup=this._firstGroup();var firstMargin={item:margin.item,axis:margin.axis};var nonFirstMargin={item:margin.item,axis:margin.item.vertical/2};var height=0;var minHeight=margin.axis+margin.item.vertical;this.groups[BACKGROUND].redraw(range,nonFirstMargin,restack);util.forEach(this.groups,function(group){var groupMargin=group==firstGroup?firstMargin:nonFirstMargin;var groupResized=group.redraw(range,groupMargin,restack);resized=groupResized||resized;height+=group.height});height=Math.max(height,minHeight);this.stackDirty=false;frame.style.height=asSize(height);this.props.width=frame.offsetWidth;this.props.height=height;this.dom.axis.style.top=asSize(orientation=="top"?this.body.domProps.top.height+this.body.domProps.border.top:this.body.domProps.top.height+this.body.domProps.centerContainer.height);if(this.options.rtl){this.dom.axis.style.right="0"}else{this.dom.axis.style.left="0"}this.initialItemSetDrawn=true;resized=this._isResized()||resized;return resized};ItemSet.prototype._firstGroup=function(){var firstGroupIndex=this.options.orientation.item=="top"?0:this.groupIds.length-1;var firstGroupId=this.groupIds[firstGroupIndex];var firstGroup=this.groups[firstGroupId]||this.groups[UNGROUPED];return firstGroup||null};ItemSet.prototype._updateUngrouped=function(){var ungrouped=this.groups[UNGROUPED];var background=this.groups[BACKGROUND];var item,itemId;if(this.groupsData){if(ungrouped){ungrouped.hide();delete this.groups[UNGROUPED];for(itemId in this.items){if(this.items.hasOwnProperty(itemId)){item=this.items[itemId];item.parent&&item.parent.remove(item);var groupId=this._getGroupId(item.data);var group=this.groups[groupId];group&&group.add(item)||item.hide()}}}}else{if(!ungrouped){var id=null;var data=null;ungrouped=new Group(id,data,this);this.groups[UNGROUPED]=ungrouped;for(itemId in this.items){if(this.items.hasOwnProperty(itemId)){item=this.items[itemId];ungrouped.add(item)}}ungrouped.show()}}};ItemSet.prototype.getLabelSet=function(){return this.dom.labelSet};ItemSet.prototype.setItems=function(items){var me=this,ids,oldItemsData=this.itemsData;if(!items){this.itemsData=null}else if(items instanceof DataSet||items instanceof DataView){this.itemsData=items}else{throw new TypeError("Data must be an instance of DataSet or DataView")}if(oldItemsData){util.forEach(this.itemListeners,function(callback,event){oldItemsData.off(event,callback)});ids=oldItemsData.getIds();this._onRemove(ids)}if(this.itemsData){var id=this.id;util.forEach(this.itemListeners,function(callback,event){me.itemsData.on(event,callback,id)});ids=this.itemsData.getIds();this._onAdd(ids);this._updateUngrouped()}this.body.emitter.emit("_change",{queue:true})};ItemSet.prototype.getItems=function(){return this.itemsData};ItemSet.prototype.setGroups=function(groups){var me=this,ids;if(this.groupsData){util.forEach(this.groupListeners,function(callback,event){me.groupsData.off(event,callback)});ids=this.groupsData.getIds();this.groupsData=null;this._onRemoveGroups(ids)}if(!groups){this.groupsData=null}else if(groups instanceof DataSet||groups instanceof DataView){this.groupsData=groups}else{throw new TypeError("Data must be an instance of DataSet or DataView")}if(this.groupsData){var groupsData=this.groupsData;if(this.groupsData instanceof DataView){groupsData=this.groupsData.getDataSet()}groupsData.get().forEach(function(group){if(group.nestedGroups){group.nestedGroups.forEach(function(nestedGroupId){var updatedNestedGroup=groupsData.get(nestedGroupId);updatedNestedGroup.nestedInGroup=group.id;if(group.showNested==false){updatedNestedGroup.visible=false}groupsData.update(updatedNestedGroup)})}});var id=this.id;util.forEach(this.groupListeners,function(callback,event){me.groupsData.on(event,callback,id)});ids=this.groupsData.getIds();this._onAddGroups(ids)}this._updateUngrouped();this._order();this.body.emitter.emit("_change",{queue:true})};ItemSet.prototype.getGroups=function(){return this.groupsData};ItemSet.prototype.removeItem=function(id){var item=this.itemsData.get(id),dataset=this.itemsData.getDataSet(),itemObj=this.items[id];if(item){this.options.onRemove(item,function(item){if(item){dataset.remove(id);if(itemObj.popup){itemObj.popup.destroy();itemObj.popup=null}}})}};ItemSet.prototype._getType=function(itemData){return itemData.type||this.options.type||(itemData.end?"range":"box")};ItemSet.prototype._getGroupId=function(itemData){var type=this._getType(itemData);if(type=="background"&&itemData.group==undefined){return BACKGROUND}else{return this.groupsData?itemData.group:UNGROUPED}};ItemSet.prototype._onUpdate=function(ids){var me=this;ids.forEach(function(id){var itemData=me.itemsData.get(id,me.itemOptions);var item=me.items[id];var type=itemData?me._getType(itemData):null;var constructor=ItemSet.types[type];var selected;if(item){if(!constructor||!(item instanceof constructor)){selected=item.selected;me._removeItem(item);item=null}else{me._updateItem(item,itemData)}}if(!item&&itemData){if(constructor){item=new constructor(itemData,me.conversion,me.options);item.id=id;me._addItem(item);if(selected){this.selection.push(id);item.select()}}else if(type=="rangeoverflow"){throw new TypeError('Item type "rangeoverflow" is deprecated. Use css styling instead: '+".vis-item.vis-range .vis-item-content {overflow: visible;}")}else{throw new TypeError('Unknown item type "'+type+'"')}}}.bind(this));this._order();this.stackDirty=true;this.body.emitter.emit("_change",{queue:true})};ItemSet.prototype._onAdd=ItemSet.prototype._onUpdate;ItemSet.prototype._onRemove=function(ids){var count=0;var me=this;ids.forEach(function(id){var item=me.items[id];if(item){count++;me._removeItem(item)}});if(count){this._order();this.stackDirty=true;this.body.emitter.emit("_change",{queue:true})}};ItemSet.prototype._order=function(){util.forEach(this.groups,function(group){group.order()})};ItemSet.prototype._onUpdateGroups=function(ids){this._onAddGroups(ids)};ItemSet.prototype._onAddGroups=function(ids){var me=this;ids.forEach(function(id){var groupData=me.groupsData.get(id);var group=me.groups[id];if(!group){if(id==UNGROUPED||id==BACKGROUND){throw new Error("Illegal group id. "+id+" is a reserved id.")}var groupOptions=(0,_create2["default"])(me.options);util.extend(groupOptions,{height:null});group=new Group(id,groupData,me);me.groups[id]=group;for(var itemId in me.items){if(me.items.hasOwnProperty(itemId)){var item=me.items[itemId];if(item.data.group==id){group.add(item)}}}group.order();group.show()}else{group.setData(groupData)}});this.body.emitter.emit("_change",{queue:true})};ItemSet.prototype._onRemoveGroups=function(ids){var groups=this.groups;ids.forEach(function(id){var group=groups[id];if(group){group.hide();delete groups[id]}});this.markDirty();this.body.emitter.emit("_change",{queue:true})};ItemSet.prototype._orderGroups=function(){if(this.groupsData){var groupIds=this.groupsData.getIds({order:this.options.groupOrder});groupIds=this._orderNestedGroups(groupIds);var changed=!util.equalArray(groupIds,this.groupIds);if(changed){var groups=this.groups;groupIds.forEach(function(groupId){groups[groupId].hide()});groupIds.forEach(function(groupId){groups[groupId].show()});this.groupIds=groupIds}return changed}else{return false}};ItemSet.prototype._orderNestedGroups=function(groupIds){var newGroupIdsOrder=[];groupIds.forEach(function(groupId){var groupData=this.groupsData.get(groupId);if(!groupData.nestedInGroup){newGroupIdsOrder.push(groupId)}if(groupData.nestedGroups){var nestedGroups=this.groupsData.get({filter:function filter(nestedGroup){return nestedGroup.nestedInGroup==groupId}});var nestedGroupIds=nestedGroups.map(function(nestedGroup){return nestedGroup.id});newGroupIdsOrder=newGroupIdsOrder.concat(nestedGroupIds)}},this);return newGroupIdsOrder};ItemSet.prototype._addItem=function(item){this.items[item.id]=item;var groupId=this._getGroupId(item.data);var group=this.groups[groupId];if(!group){item.groupShowing=false}else if(group&&group.data&&group.data.showNested){item.groupShowing=true}if(group)group.add(item)};ItemSet.prototype._updateItem=function(item,itemData){var oldGroupId=item.data.group;var oldSubGroupId=item.data.subgroup;item.setData(itemData);var groupId=this._getGroupId(item.data);var group=this.groups[groupId];if(!group){item.groupShowing=false}else if(group&&group.data&&group.data.showNested){item.groupShowing=true}if(oldGroupId!=item.data.group||oldSubGroupId!=item.data.subgroup){var oldGroup=this.groups[oldGroupId];if(oldGroup)oldGroup.remove(item);if(group)group.add(item)}};ItemSet.prototype._removeItem=function(item){item.hide();delete this.items[item.id];var index=this.selection.indexOf(item.id);if(index!=-1)this.selection.splice(index,1);item.parent&&item.parent.remove(item)};ItemSet.prototype._constructByEndArray=function(array){var endArray=[];for(var i=0;i<array.length;i++){if(array[i]instanceof RangeItem){endArray.push(array[i])}}return endArray};ItemSet.prototype._onTouch=function(event){this.touchParams.item=this.itemFromTarget(event);this.touchParams.dragLeftItem=event.target.dragLeftItem||false;this.touchParams.dragRightItem=event.target.dragRightItem||false;this.touchParams.itemProps=null};ItemSet.prototype._getGroupIndex=function(groupId){for(var i=0;i<this.groupIds.length;i++){if(groupId==this.groupIds[i])return i}};ItemSet.prototype._onDragStart=function(event){if(this.touchParams.itemIsDragging){return}var item=this.touchParams.item||null;var me=this;var props;if(item&&(item.selected||this.options.itemsAlwaysDraggable)){if(this.options.editable.overrideItems&&!this.options.editable.updateTime&&!this.options.editable.updateGroup){return}if(item.editable!=null&&!item.editable.updateTime&&!item.editable.updateGroup&&!this.options.editable.overrideItems){return}var dragLeftItem=this.touchParams.dragLeftItem;var dragRightItem=this.touchParams.dragRightItem;this.touchParams.itemIsDragging=true;this.touchParams.selectedItem=item;if(dragLeftItem){props={item:dragLeftItem,initialX:event.center.x,dragLeft:true,data:this._cloneItemData(item.data)};this.touchParams.itemProps=[props]}else if(dragRightItem){props={item:dragRightItem,initialX:event.center.x,dragRight:true,data:this._cloneItemData(item.data)};this.touchParams.itemProps=[props]}else{var baseGroupIndex=this._getGroupIndex(item.data.group);var itemsToDrag=this.options.itemsAlwaysDraggable&&!item.selected?[item.id]:this.getSelection();this.touchParams.itemProps=itemsToDrag.map(function(id){var item=me.items[id];var groupIndex=me._getGroupIndex(item.data.group);return{item:item,initialX:event.center.x,groupOffset:baseGroupIndex-groupIndex,data:this._cloneItemData(item.data)}}.bind(this))}event.stopPropagation()}else if(this.options.editable.add&&(event.srcEvent.ctrlKey||event.srcEvent.metaKey)){this._onDragStartAddItem(event)}};ItemSet.prototype._onDragStartAddItem=function(event){var snap=this.options.snap||null;if(this.options.rtl){var xAbs=util.getAbsoluteRight(this.dom.frame);var x=xAbs-event.center.x+10}else{var xAbs=util.getAbsoluteLeft(this.dom.frame);var x=event.center.x-xAbs-10}var time=this.body.util.toTime(x);var scale=this.body.util.getScale();var step=this.body.util.getStep();var start=snap?snap(time,scale,step):time;var end=start;var itemData={type:"range",start:start,end:end,content:"new item"};var id=util.randomUUID();itemData[this.itemsData._fieldId]=id;var group=this.groupFromTarget(event);if(group){itemData.group=group.groupId}var newItem=new RangeItem(itemData,this.conversion,this.options);newItem.id=id;newItem.data=this._cloneItemData(itemData);this._addItem(newItem);this.touchParams.selectedItem=newItem;var props={item:newItem,initialX:event.center.x,data:newItem.data};if(this.options.rtl){props.dragLeft=true}else{props.dragRight=true}this.touchParams.itemProps=[props];event.stopPropagation()};ItemSet.prototype._onDrag=function(event){if(this.touchParams.itemProps){event.stopPropagation();var me=this;var snap=this.options.snap||null;if(this.options.rtl){var xOffset=this.body.dom.root.offsetLeft+this.body.domProps.right.width}else{var xOffset=this.body.dom.root.offsetLeft+this.body.domProps.left.width}var scale=this.body.util.getScale();var step=this.body.util.getStep();var selectedItem=this.touchParams.selectedItem;var updateGroupAllowed=(this.options.editable.overrideItems||selectedItem.editable==null)&&this.options.editable.updateGroup||!this.options.editable.overrideItems&&selectedItem.editable!=null&&selectedItem.editable.updateGroup;var newGroupBase=null;if(updateGroupAllowed&&selectedItem){if(selectedItem.data.group!=undefined){var group=me.groupFromTarget(event);if(group){newGroupBase=this._getGroupIndex(group.groupId)}}}this.touchParams.itemProps.forEach(function(props){var current=me.body.util.toTime(event.center.x-xOffset);var initial=me.body.util.toTime(props.initialX-xOffset);if(this.options.rtl){var offset=-(current-initial)}else{var offset=current-initial}var itemData=this._cloneItemData(props.item.data);if(props.item.editable!=null&&!props.item.editable.updateTime&&!props.item.editable.updateGroup&&!me.options.editable.overrideItems){return}var updateTimeAllowed=(this.options.editable.overrideItems||selectedItem.editable==null)&&this.options.editable.updateTime||!this.options.editable.overrideItems&&selectedItem.editable!=null&&selectedItem.editable.updateTime;if(updateTimeAllowed){if(props.dragLeft){if(this.options.rtl){if(itemData.end!=undefined){var initialEnd=util.convert(props.data.end,"Date");var end=new Date(initialEnd.valueOf()+offset);itemData.end=snap?snap(end,scale,step):end}}else{if(itemData.start!=undefined){var initialStart=util.convert(props.data.start,"Date");var start=new Date(initialStart.valueOf()+offset);itemData.start=snap?snap(start,scale,step):start}}}else if(props.dragRight){if(this.options.rtl){if(itemData.start!=undefined){var initialStart=util.convert(props.data.start,"Date");var start=new Date(initialStart.valueOf()+offset);itemData.start=snap?snap(start,scale,step):start}}else{if(itemData.end!=undefined){var initialEnd=util.convert(props.data.end,"Date");var end=new Date(initialEnd.valueOf()+offset);itemData.end=snap?snap(end,scale,step):end}}}else{if(itemData.start!=undefined){var initialStart=util.convert(props.data.start,"Date").valueOf();var start=new Date(initialStart+offset);if(itemData.end!=undefined){var initialEnd=util.convert(props.data.end,"Date");var duration=initialEnd.valueOf()-initialStart.valueOf();itemData.start=snap?snap(start,scale,step):start;itemData.end=new Date(itemData.start.valueOf()+duration)}else{itemData.start=snap?snap(start,scale,step):start}}}}if(updateGroupAllowed&&!props.dragLeft&&!props.dragRight&&newGroupBase!=null){if(itemData.group!=undefined){var newOffset=newGroupBase-props.groupOffset;newOffset=Math.max(0,newOffset);newOffset=Math.min(me.groupIds.length-1,newOffset);itemData.group=me.groupIds[newOffset]}}itemData=this._cloneItemData(itemData);me.options.onMoving(itemData,function(itemData){if(itemData){props.item.setData(this._cloneItemData(itemData,"Date"))}}.bind(this))}.bind(this));this.stackDirty=true;this.body.emitter.emit("_change")}};ItemSet.prototype._moveToGroup=function(item,groupId){var group=this.groups[groupId];if(group&&group.groupId!=item.data.group){var oldGroup=item.parent;oldGroup.remove(item);oldGroup.order();group.add(item);group.order();item.data.group=group.groupId}};ItemSet.prototype._onDragEnd=function(event){this.touchParams.itemIsDragging=false;if(this.touchParams.itemProps){event.stopPropagation();var me=this;var dataset=this.itemsData.getDataSet();var itemProps=this.touchParams.itemProps;this.touchParams.itemProps=null;itemProps.forEach(function(props){var id=props.item.id;var exists=me.itemsData.get(id,me.itemOptions)!=null;if(!exists){me.options.onAdd(props.item.data,function(itemData){me._removeItem(props.item);if(itemData){me.itemsData.getDataSet().add(itemData)}me.stackDirty=true;me.body.emitter.emit("_change")})}else{var itemData=this._cloneItemData(props.item.data);me.options.onMove(itemData,function(itemData){if(itemData){itemData[dataset._fieldId]=id;dataset.update(itemData)}else{props.item.setData(props.data);me.stackDirty=true;me.body.emitter.emit("_change")}})}}.bind(this))}};ItemSet.prototype._onGroupClick=function(event){var group=this.groupFromTarget(event);if(!group.nestedGroups)return;var groupsData=this.groupsData;if(this.groupsData instanceof DataView){groupsData=this.groupsData.getDataSet()}group.showNested=!group.showNested;var nestedGroups=groupsData.get(group.nestedGroups).map(function(nestedGroup){if(nestedGroup.visible==undefined){nestedGroup.visible=true}nestedGroup.visible=!!group.showNested;return nestedGroup});groupsData.update(nestedGroups);if(group.showNested){util.removeClassName(group.dom.label,"collapsed");util.addClassName(group.dom.label,"expanded")}else{util.removeClassName(group.dom.label,"expanded");var collapsedDirClassName=this.options.rtl?"collapsed-rtl":"collapsed";util.addClassName(group.dom.label,collapsedDirClassName)}};ItemSet.prototype._onGroupDragStart=function(event){if(this.options.groupEditable.order){this.groupTouchParams.group=this.groupFromTarget(event);if(this.groupTouchParams.group){event.stopPropagation();this.groupTouchParams.originalOrder=this.groupsData.getIds({order:this.options.groupOrder})}}};ItemSet.prototype._onGroupDrag=function(event){if(this.options.groupEditable.order&&this.groupTouchParams.group){event.stopPropagation();var groupsData=this.groupsData;if(this.groupsData instanceof DataView){groupsData=this.groupsData.getDataSet()}var group=this.groupFromTarget(event);if(group&&group.height!=this.groupTouchParams.group.height){var movingUp=group.top<this.groupTouchParams.group.top;var clientY=event.center?event.center.y:event.clientY;var targetGroupTop=util.getAbsoluteTop(group.dom.foreground);var draggedGroupHeight=this.groupTouchParams.group.height;if(movingUp){if(targetGroupTop+draggedGroupHeight<clientY){return}}else{var targetGroupHeight=group.height;if(targetGroupTop+targetGroupHeight-draggedGroupHeight>clientY){return}}}if(group&&group!=this.groupTouchParams.group){var targetGroup=groupsData.get(group.groupId);var draggedGroup=groupsData.get(this.groupTouchParams.group.groupId);if(draggedGroup&&targetGroup){this.options.groupOrderSwap(draggedGroup,targetGroup,groupsData);groupsData.update(draggedGroup);groupsData.update(targetGroup)}var newOrder=groupsData.getIds({order:this.options.groupOrder});if(!util.equalArray(newOrder,this.groupTouchParams.originalOrder)){var origOrder=this.groupTouchParams.originalOrder;var draggedId=this.groupTouchParams.group.groupId;var numGroups=Math.min(origOrder.length,newOrder.length);var curPos=0;var newOffset=0;var orgOffset=0;while(curPos<numGroups){while(curPos+newOffset<numGroups&&curPos+orgOffset<numGroups&&newOrder[curPos+newOffset]==origOrder[curPos+orgOffset]){curPos++}if(curPos+newOffset>=numGroups){break}if(newOrder[curPos+newOffset]==draggedId){newOffset=1;continue}else if(origOrder[curPos+orgOffset]==draggedId){orgOffset=1;continue}else{var slippedPosition=newOrder.indexOf(origOrder[curPos+orgOffset]);var switchGroup=groupsData.get(newOrder[curPos+newOffset]);var shouldBeGroup=groupsData.get(origOrder[curPos+orgOffset]);this.options.groupOrderSwap(switchGroup,shouldBeGroup,groupsData);groupsData.update(switchGroup);groupsData.update(shouldBeGroup);var switchGroupId=newOrder[curPos+newOffset];newOrder[curPos+newOffset]=origOrder[curPos+orgOffset];newOrder[slippedPosition]=switchGroupId;curPos++}}}}}};ItemSet.prototype._onGroupDragEnd=function(event){if(this.options.groupEditable.order&&this.groupTouchParams.group){event.stopPropagation();var me=this;var id=me.groupTouchParams.group.groupId;var dataset=me.groupsData.getDataSet();var groupData=util.extend({},dataset.get(id));me.options.onMoveGroup(groupData,function(groupData){if(groupData){groupData[dataset._fieldId]=id;dataset.update(groupData)}else{var newOrder=dataset.getIds({order:me.options.groupOrder});if(!util.equalArray(newOrder,me.groupTouchParams.originalOrder)){var origOrder=me.groupTouchParams.originalOrder;var numGroups=Math.min(origOrder.length,newOrder.length);var curPos=0;while(curPos<numGroups){while(curPos<numGroups&&newOrder[curPos]==origOrder[curPos]){curPos++}if(curPos>=numGroups){break}var slippedPosition=newOrder.indexOf(origOrder[curPos]);var switchGroup=dataset.get(newOrder[curPos]);var shouldBeGroup=dataset.get(origOrder[curPos]);me.options.groupOrderSwap(switchGroup,shouldBeGroup,dataset);groupsData.update(switchGroup);groupsData.update(shouldBeGroup);var switchGroupId=newOrder[curPos];newOrder[curPos]=origOrder[curPos];newOrder[slippedPosition]=switchGroupId;curPos++}}}});me.body.emitter.emit("groupDragged",{groupId:id})}};ItemSet.prototype._onSelectItem=function(event){if(!this.options.selectable)return;var ctrlKey=event.srcEvent&&(event.srcEvent.ctrlKey||event.srcEvent.metaKey);var shiftKey=event.srcEvent&&event.srcEvent.shiftKey;if(ctrlKey||shiftKey){this._onMultiSelectItem(event);return}var oldSelection=this.getSelection();var item=this.itemFromTarget(event);var selection=item?[item.id]:[];this.setSelection(selection);var newSelection=this.getSelection();if(newSelection.length>0||oldSelection.length>0){this.body.emitter.emit("select",{items:newSelection,event:util.elementsCensor(event)})}};ItemSet.prototype._onMouseOver=function(event){var item=this.itemFromTarget(event);if(!item)return;var related=this.itemFromRelatedTarget(event);if(item===related){return}if(item.getTitle()){if(item.popup==null){item.setPopup(new _Popup2["default"](this.body.dom.root,this.options.tooltip.overflowMethod||"flip"))}var container=this.body.dom.centerContainer;item.popup.setPosition(event.clientX-util.getAbsoluteLeft(container)+container.offsetLeft,event.clientY-util.getAbsoluteTop(container)+container.offsetTop);item.popup.show()}this.body.emitter.emit("itemover",{item:item.id,event:util.elementsCensor(event)})};ItemSet.prototype._onMouseOut=function(event){var item=this.itemFromTarget(event);if(!item)return;var related=this.itemFromRelatedTarget(event);if(item===related){return}if(item.popup!=null){item.popup.hide()}this.body.emitter.emit("itemout",{item:item.id,event:util.elementsCensor(event)})};ItemSet.prototype._onMouseMove=function(event){var item=this.itemFromTarget(event);if(!item)return;if(this.options.tooltip.followMouse){if(item.popup){if(!item.popup.hidden){var container=this.body.dom.centerContainer;item.popup.setPosition(event.clientX-util.getAbsoluteLeft(container)+container.offsetLeft,event.clientY-util.getAbsoluteTop(container)+container.offsetTop);item.popup.show()}}}};ItemSet.prototype._onUpdateItem=function(item){if(!this.options.selectable)return;if(!this.options.editable.add)return;var me=this;if(item){var itemData=me.itemsData.get(item.id);this.options.onUpdate(itemData,function(itemData){if(itemData){me.itemsData.getDataSet().update(itemData)}})}};ItemSet.prototype._onAddItem=function(event){if(!this.options.selectable)return;if(!this.options.editable.add)return;var me=this;var snap=this.options.snap||null;var item=this.itemFromTarget(event);if(!item){if(this.options.rtl){var xAbs=util.getAbsoluteRight(this.dom.frame);var x=xAbs-event.center.x}else{var xAbs=util.getAbsoluteLeft(this.dom.frame);var x=event.center.x-xAbs}var start=this.body.util.toTime(x);var scale=this.body.util.getScale();var step=this.body.util.getStep();var newItemData={start:snap?snap(start,scale,step):start,content:"new item"};if(event.type=="drop"){var itemData=JSON.parse(event.dataTransfer.getData("text"));newItemData.content=itemData.content;newItemData.type=itemData.type||"box";newItemData[this.itemsData._fieldId]=itemData.id||util.randomUUID();if(itemData.type=="range"||itemData.end&&itemData.start){if(!itemData.end){var end=this.body.util.toTime(x+this.props.width/5);newItemData.end=snap?snap(end,scale,step):end}else{newItemData.end=itemData.end;newItemData.start=itemData.start}}}else{newItemData[this.itemsData._fieldId]=util.randomUUID();if(this.options.type==="range"){var end=this.body.util.toTime(x+this.props.width/5);newItemData.end=snap?snap(end,scale,step):end}}var group=this.groupFromTarget(event);if(group){newItemData.group=group.groupId}newItemData=this._cloneItemData(newItemData);this.options.onAdd(newItemData,function(item){if(item){me.itemsData.getDataSet().add(item);if(event.type=="drop"){me.setSelection([item.id])}}})}};ItemSet.prototype._onMultiSelectItem=function(event){if(!this.options.selectable)return;var item=this.itemFromTarget(event);if(item){var selection=this.options.multiselect?this.getSelection():[];var shiftKey=event.srcEvent&&event.srcEvent.shiftKey||false;if(shiftKey&&this.options.multiselect){var itemGroup=this.itemsData.get(item.id).group;var lastSelectedGroup=undefined;if(this.options.multiselectPerGroup){if(selection.length>0){lastSelectedGroup=this.itemsData.get(selection[0]).group}}if(!this.options.multiselectPerGroup||lastSelectedGroup==undefined||lastSelectedGroup==itemGroup){selection.push(item.id)}var range=ItemSet._getItemRange(this.itemsData.get(selection,this.itemOptions));
if(!this.options.multiselectPerGroup||lastSelectedGroup==itemGroup){selection=[];for(var id in this.items){if(this.items.hasOwnProperty(id)){var _item=this.items[id];var start=_item.data.start;var end=_item.data.end!==undefined?_item.data.end:start;if(start>=range.min&&end<=range.max&&(!this.options.multiselectPerGroup||lastSelectedGroup==this.itemsData.get(_item.id).group)&&!(_item instanceof BackgroundItem)){selection.push(_item.id)}}}}}else{var index=selection.indexOf(item.id);if(index==-1){selection.push(item.id)}else{selection.splice(index,1)}}this.setSelection(selection);this.body.emitter.emit("select",{items:this.getSelection(),event:util.elementsCensor(event)})}};ItemSet._getItemRange=function(itemsData){var max=null;var min=null;itemsData.forEach(function(data){if(min==null||data.start<min){min=data.start}if(data.end!=undefined){if(max==null||data.end>max){max=data.end}}else{if(max==null||data.start>max){max=data.start}}});return{min:min,max:max}};ItemSet.prototype.itemFromElement=function(element){var cur=element;while(cur){if(cur.hasOwnProperty("timeline-item")){return cur["timeline-item"]}cur=cur.parentNode}return null};ItemSet.prototype.itemFromTarget=function(event){return this.itemFromElement(event.target)};ItemSet.prototype.itemFromRelatedTarget=function(event){return this.itemFromElement(event.relatedTarget)};ItemSet.prototype.groupFromTarget=function(event){var clientY=event.center?event.center.y:event.clientY;for(var i=0;i<this.groupIds.length;i++){var groupId=this.groupIds[i];var group=this.groups[groupId];var foreground=group.dom.foreground;var top=util.getAbsoluteTop(foreground);if(clientY>top&&clientY<top+foreground.offsetHeight){return group}if(this.options.orientation.item==="top"){if(i===this.groupIds.length-1&&clientY>top){return group}}else{if(i===0&&clientY<top+foreground.offset){return group}}}return null};ItemSet.itemSetFromTarget=function(event){var target=event.target;while(target){if(target.hasOwnProperty("timeline-itemset")){return target["timeline-itemset"]}target=target.parentNode}return null};ItemSet.prototype._cloneItemData=function(itemData,type){var clone=util.extend({},itemData);if(!type){type=this.itemsData.getDataSet()._options.type}if(clone.start!=undefined){clone.start=util.convert(clone.start,type&&type.start||"Date")}if(clone.end!=undefined){clone.end=util.convert(clone.end,type&&type.end||"Date")}return clone};module.exports=ItemSet},{"../../DataSet":6,"../../DataView":7,"../../module/hammer":19,"../../shared/Popup":84,"../../util":116,"../TimeStep":91,"./BackgroundGroup":93,"./Component":94,"./Group":100,"./item/BackgroundItem":108,"./item/BoxItem":109,"./item/PointItem":111,"./item/RangeItem":112,"babel-runtime/core-js/object/create":121,"babel-runtime/helpers/typeof":133}],102:[function(require,module,exports){"use strict";var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var DOMutil=require("../../DOMutil");var Component=require("./Component");function Legend(body,options,side,linegraphOptions){this.body=body;this.defaultOptions={enabled:false,icons:true,iconSize:20,iconSpacing:6,left:{visible:true,position:"top-left"},right:{visible:true,position:"top-right"}};this.side=side;this.options=util.extend({},this.defaultOptions);this.linegraphOptions=linegraphOptions;this.svgElements={};this.dom={};this.groups={};this.amountOfGroups=0;this._create();this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups};this.setOptions(options)}Legend.prototype=new Component;Legend.prototype.clear=function(){this.groups={};this.amountOfGroups=0};Legend.prototype.addGroup=function(label,graphOptions){if(graphOptions.options.excludeFromLegend!=true){if(!this.groups.hasOwnProperty(label)){this.groups[label]=graphOptions}this.amountOfGroups+=1}};Legend.prototype.updateGroup=function(label,graphOptions){this.groups[label]=graphOptions};Legend.prototype.removeGroup=function(label){if(this.groups.hasOwnProperty(label)){delete this.groups[label];this.amountOfGroups-=1}};Legend.prototype._create=function(){this.dom.frame=document.createElement("div");this.dom.frame.className="vis-legend";this.dom.frame.style.position="absolute";this.dom.frame.style.top="10px";this.dom.frame.style.display="block";this.dom.textArea=document.createElement("div");this.dom.textArea.className="vis-legend-text";this.dom.textArea.style.position="relative";this.dom.textArea.style.top="0px";this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg");this.svg.style.position="absolute";this.svg.style.top=0+"px";this.svg.style.width=this.options.iconSize+5+"px";this.svg.style.height="100%";this.dom.frame.appendChild(this.svg);this.dom.frame.appendChild(this.dom.textArea)};Legend.prototype.hide=function(){if(this.dom.frame.parentNode){this.dom.frame.parentNode.removeChild(this.dom.frame)}};Legend.prototype.show=function(){if(!this.dom.frame.parentNode){this.body.dom.center.appendChild(this.dom.frame)}};Legend.prototype.setOptions=function(options){var fields=["enabled","orientation","icons","left","right"];util.selectiveDeepExtend(fields,this.options,options)};Legend.prototype.redraw=function(){var activeGroups=0;var groupArray=(0,_keys2["default"])(this.groups);groupArray.sort(function(a,b){return a<b?-1:1});for(var i=0;i<groupArray.length;i++){var groupId=groupArray[i];if(this.groups[groupId].visible==true&&(this.linegraphOptions.visibility[groupId]===undefined||this.linegraphOptions.visibility[groupId]==true)){activeGroups++}}if(this.options[this.side].visible==false||this.amountOfGroups==0||this.options.enabled==false||activeGroups==0){this.hide()}else{this.show();if(this.options[this.side].position=="top-left"||this.options[this.side].position=="bottom-left"){this.dom.frame.style.left="4px";this.dom.frame.style.textAlign="left";this.dom.textArea.style.textAlign="left";this.dom.textArea.style.left=this.options.iconSize+15+"px";this.dom.textArea.style.right="";this.svg.style.left=0+"px";this.svg.style.right=""}else{this.dom.frame.style.right="4px";this.dom.frame.style.textAlign="right";this.dom.textArea.style.textAlign="right";this.dom.textArea.style.right=this.options.iconSize+15+"px";this.dom.textArea.style.left="";this.svg.style.right=0+"px";this.svg.style.left=""}if(this.options[this.side].position=="top-left"||this.options[this.side].position=="top-right"){this.dom.frame.style.top=4-Number(this.body.dom.center.style.top.replace("px",""))+"px";this.dom.frame.style.bottom=""}else{var scrollableHeight=this.body.domProps.center.height-this.body.domProps.centerContainer.height;this.dom.frame.style.bottom=4+scrollableHeight+Number(this.body.dom.center.style.top.replace("px",""))+"px";this.dom.frame.style.top=""}if(this.options.icons==false){this.dom.frame.style.width=this.dom.textArea.offsetWidth+10+"px";this.dom.textArea.style.right="";this.dom.textArea.style.left="";this.svg.style.width="0px"}else{this.dom.frame.style.width=this.options.iconSize+15+this.dom.textArea.offsetWidth+10+"px";this.drawLegendIcons()}var content="";for(var i=0;i<groupArray.length;i++){var groupId=groupArray[i];if(this.groups[groupId].visible==true&&(this.linegraphOptions.visibility[groupId]===undefined||this.linegraphOptions.visibility[groupId]==true)){content+=this.groups[groupId].content+"<br />"}}this.dom.textArea.innerHTML=content;this.dom.textArea.style.lineHeight=.75*this.options.iconSize+this.options.iconSpacing+"px"}};Legend.prototype.drawLegendIcons=function(){if(this.dom.frame.parentNode){var groupArray=(0,_keys2["default"])(this.groups);groupArray.sort(function(a,b){return a<b?-1:1});DOMutil.resetElements(this.svgElements);var padding=window.getComputedStyle(this.dom.frame).paddingTop;var iconOffset=Number(padding.replace("px",""));var x=iconOffset;var iconWidth=this.options.iconSize;var iconHeight=.75*this.options.iconSize;var y=iconOffset+.5*iconHeight+3;this.svg.style.width=iconWidth+5+iconOffset+"px";for(var i=0;i<groupArray.length;i++){var groupId=groupArray[i];if(this.groups[groupId].visible==true&&(this.linegraphOptions.visibility[groupId]===undefined||this.linegraphOptions.visibility[groupId]==true)){this.groups[groupId].getLegend(iconWidth,iconHeight,this.framework,x,y);y+=iconHeight+this.options.iconSpacing}}}};module.exports=Legend},{"../../DOMutil":5,"../../util":116,"./Component":94,"babel-runtime/core-js/object/keys":124}],103:[function(require,module,exports){"use strict";var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var DOMutil=require("../../DOMutil");var DataSet=require("../../DataSet");var DataView=require("../../DataView");var Component=require("./Component");var DataAxis=require("./DataAxis");var GraphGroup=require("./GraphGroup");var Legend=require("./Legend");var Bars=require("./graph2d_types/bar");var Lines=require("./graph2d_types/line");var Points=require("./graph2d_types/points");var UNGROUPED="__ungrouped__";function LineGraph(body,options){this.id=util.randomUUID();this.body=body;this.defaultOptions={yAxisOrientation:"left",defaultGroup:"default",sort:true,sampling:true,stack:false,graphHeight:"400px",shaded:{enabled:false,orientation:"bottom"},style:"line",barChart:{width:50,sideBySide:false,align:"center"},interpolation:{enabled:true,parametrization:"centripetal",alpha:.5},drawPoints:{enabled:true,size:6,style:"square"},dataAxis:{},legend:{},groups:{visibility:{}}};this.options=util.extend({},this.defaultOptions);this.dom={};this.props={};this.hammer=null;this.groups={};this.abortedGraphUpdate=false;this.updateSVGheight=false;this.updateSVGheightOnResize=false;this.forceGraphUpdate=true;var me=this;this.itemsData=null;this.groupsData=null;this.itemListeners={add:function add(event,params,senderId){me._onAdd(params.items)},update:function update(event,params,senderId){me._onUpdate(params.items)},remove:function remove(event,params,senderId){me._onRemove(params.items)}};this.groupListeners={add:function add(event,params,senderId){me._onAddGroups(params.items)},update:function update(event,params,senderId){me._onUpdateGroups(params.items)},remove:function remove(event,params,senderId){me._onRemoveGroups(params.items)}};this.items={};this.selection=[];this.lastStart=this.body.range.start;this.touchParams={};this.svgElements={};this.setOptions(options);this.groupsUsingDefaultStyles=[0];this.body.emitter.on("rangechanged",function(){me.lastStart=me.body.range.start;me.svg.style.left=util.option.asSize(-me.props.width);me.forceGraphUpdate=true;me.redraw.call(me)});this._create();this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups}}LineGraph.prototype=new Component;LineGraph.prototype._create=function(){var frame=document.createElement("div");frame.className="vis-line-graph";this.dom.frame=frame;this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg");this.svg.style.position="relative";this.svg.style.height=(""+this.options.graphHeight).replace("px","")+"px";this.svg.style.display="block";frame.appendChild(this.svg);this.options.dataAxis.orientation="left";this.yAxisLeft=new DataAxis(this.body,this.options.dataAxis,this.svg,this.options.groups);this.options.dataAxis.orientation="right";this.yAxisRight=new DataAxis(this.body,this.options.dataAxis,this.svg,this.options.groups);delete this.options.dataAxis.orientation;this.legendLeft=new Legend(this.body,this.options.legend,"left",this.options.groups);this.legendRight=new Legend(this.body,this.options.legend,"right",this.options.groups);this.show()};LineGraph.prototype.setOptions=function(options){if(options){var fields=["sampling","defaultGroup","stack","height","graphHeight","yAxisOrientation","style","barChart","dataAxis","sort","groups"];if(options.graphHeight===undefined&&options.height!==undefined){this.updateSVGheight=true;this.updateSVGheightOnResize=true}else if(this.body.domProps.centerContainer.height!==undefined&&options.graphHeight!==undefined){if(parseInt((options.graphHeight+"").replace("px",""))<this.body.domProps.centerContainer.height){this.updateSVGheight=true}}util.selectiveDeepExtend(fields,this.options,options);util.mergeOptions(this.options,options,"interpolation");util.mergeOptions(this.options,options,"drawPoints");util.mergeOptions(this.options,options,"shaded");util.mergeOptions(this.options,options,"legend");if(options.interpolation){if((0,_typeof3["default"])(options.interpolation)=="object"){if(options.interpolation.parametrization){if(options.interpolation.parametrization=="uniform"){this.options.interpolation.alpha=0}else if(options.interpolation.parametrization=="chordal"){this.options.interpolation.alpha=1}else{this.options.interpolation.parametrization="centripetal";this.options.interpolation.alpha=.5}}}}if(this.yAxisLeft){if(options.dataAxis!==undefined){this.yAxisLeft.setOptions(this.options.dataAxis);this.yAxisRight.setOptions(this.options.dataAxis)}}if(this.legendLeft){if(options.legend!==undefined){this.legendLeft.setOptions(this.options.legend);this.legendRight.setOptions(this.options.legend)}}if(this.groups.hasOwnProperty(UNGROUPED)){this.groups[UNGROUPED].setOptions(options)}}if(this.dom.frame){this.forceGraphUpdate=true;this.body.emitter.emit("_change",{queue:true})}};LineGraph.prototype.hide=function(){if(this.dom.frame.parentNode){this.dom.frame.parentNode.removeChild(this.dom.frame)}};LineGraph.prototype.show=function(){if(!this.dom.frame.parentNode){this.body.dom.center.appendChild(this.dom.frame)}};LineGraph.prototype.setItems=function(items){var me=this,ids,oldItemsData=this.itemsData;if(!items){this.itemsData=null}else if(items instanceof DataSet||items instanceof DataView){this.itemsData=items}else{throw new TypeError("Data must be an instance of DataSet or DataView")}if(oldItemsData){util.forEach(this.itemListeners,function(callback,event){oldItemsData.off(event,callback)});ids=oldItemsData.getIds();this._onRemove(ids)}if(this.itemsData){var id=this.id;util.forEach(this.itemListeners,function(callback,event){me.itemsData.on(event,callback,id)});ids=this.itemsData.getIds();this._onAdd(ids)}};LineGraph.prototype.setGroups=function(groups){var me=this;var ids;if(this.groupsData){util.forEach(this.groupListeners,function(callback,event){me.groupsData.off(event,callback)});ids=this.groupsData.getIds();this.groupsData=null;for(var i=0;i<ids.length;i++){this._removeGroup(ids[i])}}if(!groups){this.groupsData=null}else if(groups instanceof DataSet||groups instanceof DataView){this.groupsData=groups}else{throw new TypeError("Data must be an instance of DataSet or DataView")}if(this.groupsData){var id=this.id;util.forEach(this.groupListeners,function(callback,event){me.groupsData.on(event,callback,id)});ids=this.groupsData.getIds();this._onAddGroups(ids)}};LineGraph.prototype._onUpdate=function(ids){this._updateAllGroupData(ids)};LineGraph.prototype._onAdd=function(ids){this._onUpdate(ids)};LineGraph.prototype._onRemove=function(ids){this._onUpdate(ids)};LineGraph.prototype._onUpdateGroups=function(groupIds){this._updateAllGroupData(null,groupIds)};LineGraph.prototype._onAddGroups=function(groupIds){this._onUpdateGroups(groupIds)};LineGraph.prototype._onRemoveGroups=function(groupIds){for(var i=0;i<groupIds.length;i++){this._removeGroup(groupIds[i])}this.forceGraphUpdate=true;this.body.emitter.emit("_change",{queue:true})};LineGraph.prototype._removeGroup=function(groupId){if(this.groups.hasOwnProperty(groupId)){if(this.groups[groupId].options.yAxisOrientation=="right"){this.yAxisRight.removeGroup(groupId);this.legendRight.removeGroup(groupId);this.legendRight.redraw()}else{this.yAxisLeft.removeGroup(groupId);this.legendLeft.removeGroup(groupId);this.legendLeft.redraw()}delete this.groups[groupId]}};LineGraph.prototype._updateGroup=function(group,groupId){if(!this.groups.hasOwnProperty(groupId)){this.groups[groupId]=new GraphGroup(group,groupId,this.options,this.groupsUsingDefaultStyles);if(this.groups[groupId].options.yAxisOrientation=="right"){this.yAxisRight.addGroup(groupId,this.groups[groupId]);this.legendRight.addGroup(groupId,this.groups[groupId])}else{this.yAxisLeft.addGroup(groupId,this.groups[groupId]);this.legendLeft.addGroup(groupId,this.groups[groupId])}}else{this.groups[groupId].update(group);if(this.groups[groupId].options.yAxisOrientation=="right"){this.yAxisRight.updateGroup(groupId,this.groups[groupId]);this.legendRight.updateGroup(groupId,this.groups[groupId]);this.yAxisLeft.removeGroup(groupId);this.legendLeft.removeGroup(groupId)}else{this.yAxisLeft.updateGroup(groupId,this.groups[groupId]);this.legendLeft.updateGroup(groupId,this.groups[groupId]);this.yAxisRight.removeGroup(groupId);this.legendRight.removeGroup(groupId)}}this.legendLeft.redraw();this.legendRight.redraw()};LineGraph.prototype._updateAllGroupData=function(ids,groupIds){if(this.itemsData!=null){var groupsContent={};var items=this.itemsData.get();var fieldId=this.itemsData._fieldId;var idMap={};if(ids){ids.map(function(id){idMap[id]=id})}var groupCounts={};for(var i=0;i<items.length;i++){var item=items[i];var groupId=item.group;if(groupId===null||groupId===undefined){groupId=UNGROUPED}groupCounts.hasOwnProperty(groupId)?groupCounts[groupId]++:groupCounts[groupId]=1}if(!groupIds&&ids){for(var groupId in this.groups){if(this.groups.hasOwnProperty(groupId)){var group=this.groups[groupId];var existing_items=group.getItems();groupsContent[groupId]=existing_items.filter(function(item){return item[fieldId]!==idMap[item[fieldId]]});var newLength=groupCounts[groupId];groupCounts[groupId]-=groupsContent[groupId].length;if(groupsContent[groupId].length<newLength){groupsContent[groupId][newLength-1]={}}}}}for(var i=0;i<items.length;i++){var item=items[i];var groupId=item.group;if(groupId===null||groupId===undefined){groupId=UNGROUPED}if(!groupIds&&ids&&item[fieldId]!==idMap[item[fieldId]]){continue}if(!groupsContent.hasOwnProperty(groupId)){groupsContent[groupId]=new Array(groupCounts[groupId])}var extended=util.bridgeObject(item);extended.x=util.convert(item.x,"Date");extended.orginalY=item.y;extended.y=Number(item.y);extended[fieldId]=item[fieldId];var index=groupsContent[groupId].length-groupCounts[groupId]--;groupsContent[groupId][index]=extended}for(var groupId in this.groups){if(this.groups.hasOwnProperty(groupId)){if(!groupsContent.hasOwnProperty(groupId)){groupsContent[groupId]=new Array(0)}}}for(var groupId in groupsContent){if(groupsContent.hasOwnProperty(groupId)){if(groupsContent[groupId].length==0){if(this.groups.hasOwnProperty(groupId)){this._removeGroup(groupId)}}else{var group=undefined;if(this.groupsData!=undefined){group=this.groupsData.get(groupId)}if(group==undefined){group={id:groupId,content:this.options.defaultGroup+groupId}}this._updateGroup(group,groupId);this.groups[groupId].setItems(groupsContent[groupId])}}}this.forceGraphUpdate=true;this.body.emitter.emit("_change",{queue:true})}};LineGraph.prototype.redraw=function(){var resized=false;this.props.width=this.dom.frame.offsetWidth;this.props.height=this.body.domProps.centerContainer.height-this.body.domProps.border.top-this.body.domProps.border.bottom;resized=this._isResized()||resized;var visibleInterval=this.body.range.end-this.body.range.start;var zoomed=visibleInterval!=this.lastVisibleInterval;this.lastVisibleInterval=visibleInterval;if(resized==true){this.svg.style.width=util.option.asSize(3*this.props.width);this.svg.style.left=util.option.asSize(-this.props.width);if((this.options.height+"").indexOf("%")!=-1||this.updateSVGheightOnResize==true){this.updateSVGheight=true}}if(this.updateSVGheight==true){if(this.options.graphHeight!=this.props.height+"px"){this.options.graphHeight=this.props.height+"px";this.svg.style.height=this.props.height+"px"}this.updateSVGheight=false}else{this.svg.style.height=(""+this.options.graphHeight).replace("px","")+"px"}if(resized==true||zoomed==true||this.abortedGraphUpdate==true||this.forceGraphUpdate==true){resized=this._updateGraph()||resized;this.forceGraphUpdate=false}else{if(this.lastStart!=0){var offset=this.body.range.start-this.lastStart;var range=this.body.range.end-this.body.range.start;if(this.props.width!=0){var rangePerPixelInv=this.props.width/range;var xOffset=offset*rangePerPixelInv;this.svg.style.left=-this.props.width-xOffset+"px"}}}this.legendLeft.redraw();this.legendRight.redraw();return resized};LineGraph.prototype._getSortedGroupIds=function(){var grouplist=[];for(var groupId in this.groups){if(this.groups.hasOwnProperty(groupId)){var group=this.groups[groupId];if(group.visible==true&&(this.options.groups.visibility[groupId]===undefined||this.options.groups.visibility[groupId]==true)){grouplist.push({id:groupId,zIndex:group.options.zIndex})}}}util.insertSort(grouplist,function(a,b){var az=a.zIndex;var bz=b.zIndex;if(az===undefined)az=0;if(bz===undefined)bz=0;return az==bz?0:az<bz?-1:1});var groupIds=new Array(grouplist.length);for(var i=0;i<grouplist.length;i++){groupIds[i]=grouplist[i].id}return groupIds};LineGraph.prototype._updateGraph=function(){DOMutil.prepareElements(this.svgElements);if(this.props.width!=0&&this.itemsData!=null){var group,i;var groupRanges={};var changeCalled=false;var minDate=this.body.util.toGlobalTime(-this.body.domProps.root.width);var maxDate=this.body.util.toGlobalTime(2*this.body.domProps.root.width);var groupIds=this._getSortedGroupIds();if(groupIds.length>0){var groupsData={};this._getRelevantData(groupIds,groupsData,minDate,maxDate);this._applySampling(groupIds,groupsData);for(i=0;i<groupIds.length;i++){this._convertXcoordinates(groupsData[groupIds[i]])}this._getYRanges(groupIds,groupsData,groupRanges);changeCalled=this._updateYAxis(groupIds,groupRanges);if(changeCalled==true){DOMutil.cleanupElements(this.svgElements);this.abortedGraphUpdate=true;return true}this.abortedGraphUpdate=false;var below=undefined;for(i=0;i<groupIds.length;i++){group=this.groups[groupIds[i]];if(this.options.stack===true&&this.options.style==="line"){if(group.options.excludeFromStacking==undefined||!group.options.excludeFromStacking){if(below!=undefined){this._stack(groupsData[group.id],groupsData[below.id]);if(group.options.shaded.enabled==true&&group.options.shaded.orientation!=="group"){if(group.options.shaded.orientation=="top"&&below.options.shaded.orientation!=="group"){below.options.shaded.orientation="group";below.options.shaded.groupId=group.id}else{group.options.shaded.orientation="group";group.options.shaded.groupId=below.id}}}below=group}}this._convertYcoordinates(groupsData[groupIds[i]],group)}var paths={};for(i=0;i<groupIds.length;i++){group=this.groups[groupIds[i]];if(group.options.style==="line"&&group.options.shaded.enabled==true){var dataset=groupsData[groupIds[i]];if(dataset==null||dataset.length==0){continue}if(!paths.hasOwnProperty(groupIds[i])){paths[groupIds[i]]=Lines.calcPath(dataset,group)}if(group.options.shaded.orientation==="group"){var subGroupId=group.options.shaded.groupId;if(groupIds.indexOf(subGroupId)===-1){console.log(group.id+": Unknown shading group target given:"+subGroupId);continue}if(!paths.hasOwnProperty(subGroupId)){paths[subGroupId]=Lines.calcPath(groupsData[subGroupId],this.groups[subGroupId])}Lines.drawShading(paths[groupIds[i]],group,paths[subGroupId],this.framework)}else{Lines.drawShading(paths[groupIds[i]],group,undefined,this.framework)}}}Bars.draw(groupIds,groupsData,this.framework);for(i=0;i<groupIds.length;i++){group=this.groups[groupIds[i]];if(groupsData[groupIds[i]].length>0){switch(group.options.style){case"line":if(!paths.hasOwnProperty(groupIds[i])){paths[groupIds[i]]=Lines.calcPath(groupsData[groupIds[i]],group)}Lines.draw(paths[groupIds[i]],group,this.framework);case"point":case"points":if(group.options.style=="point"||group.options.style=="points"||group.options.drawPoints.enabled==true){Points.draw(groupsData[groupIds[i]],group,this.framework)}break;case"bar":default:}}}}}DOMutil.cleanupElements(this.svgElements);return false};LineGraph.prototype._stack=function(data,subData){var index,dx,dy,subPrevPoint,subNextPoint;index=0;for(var j=0;j<data.length;j++){subPrevPoint=undefined;subNextPoint=undefined;for(var k=index;k<subData.length;k++){if(subData[k].x===data[j].x){subPrevPoint=subData[k];subNextPoint=subData[k];index=k;break}else if(subData[k].x>data[j].x){subNextPoint=subData[k];if(k==0){subPrevPoint=subNextPoint}else{subPrevPoint=subData[k-1]}index=k;break}}if(subNextPoint===undefined){subPrevPoint=subData[subData.length-1];subNextPoint=subData[subData.length-1]}dx=subNextPoint.x-subPrevPoint.x;dy=subNextPoint.y-subPrevPoint.y;if(dx==0){data[j].y=data[j].orginalY+subNextPoint.y}else{data[j].y=data[j].orginalY+dy/dx*(data[j].x-subPrevPoint.x)+subPrevPoint.y}}};LineGraph.prototype._getRelevantData=function(groupIds,groupsData,minDate,maxDate){var group,i,j,item;if(groupIds.length>0){for(i=0;i<groupIds.length;i++){group=this.groups[groupIds[i]];var itemsData=group.getItems();if(group.options.sort==true){var dateComparator=function dateComparator(a,b){return a.getTime()==b.getTime()?0:a<b?-1:1};var first=Math.max(0,util.binarySearchValue(itemsData,minDate,"x","before",dateComparator));var last=Math.min(itemsData.length,util.binarySearchValue(itemsData,maxDate,"x","after",dateComparator)+1);if(last<=0){last=itemsData.length}var dataContainer=new Array(last-first);for(j=first;j<last;j++){item=group.itemsData[j];dataContainer[j-first]=item}groupsData[groupIds[i]]=dataContainer}else{groupsData[groupIds[i]]=group.itemsData}}}};LineGraph.prototype._applySampling=function(groupIds,groupsData){var group;if(groupIds.length>0){for(var i=0;i<groupIds.length;i++){group=this.groups[groupIds[i]];if(group.options.sampling==true){var dataContainer=groupsData[groupIds[i]];if(dataContainer.length>0){var increment=1;var amountOfPoints=dataContainer.length;var xDistance=this.body.util.toGlobalScreen(dataContainer[dataContainer.length-1].x)-this.body.util.toGlobalScreen(dataContainer[0].x);var pointsPerPixel=amountOfPoints/xDistance;increment=Math.min(Math.ceil(.2*amountOfPoints),Math.max(1,Math.round(pointsPerPixel)));var sampledData=new Array(amountOfPoints);for(var j=0;j<amountOfPoints;j+=increment){var idx=Math.round(j/increment);sampledData[idx]=dataContainer[j]}groupsData[groupIds[i]]=sampledData.splice(0,Math.round(amountOfPoints/increment))}}}}};LineGraph.prototype._getYRanges=function(groupIds,groupsData,groupRanges){var groupData,group,i;var combinedDataLeft=[];var combinedDataRight=[];var options;if(groupIds.length>0){for(i=0;i<groupIds.length;i++){groupData=groupsData[groupIds[i]];options=this.groups[groupIds[i]].options;if(groupData.length>0){group=this.groups[groupIds[i]];if(options.stack===true&&options.style==="bar"){if(options.yAxisOrientation==="left"){combinedDataLeft=combinedDataLeft.concat(group.getItems())}else{combinedDataRight=combinedDataRight.concat(group.getItems())}}else{groupRanges[groupIds[i]]=group.getYRange(groupData,groupIds[i])}}}Bars.getStackedYRange(combinedDataLeft,groupRanges,groupIds,"__barStackLeft","left");Bars.getStackedYRange(combinedDataRight,groupRanges,groupIds,"__barStackRight","right")}};LineGraph.prototype._updateYAxis=function(groupIds,groupRanges){var resized=false;var yAxisLeftUsed=false;var yAxisRightUsed=false;var minLeft=1e9,minRight=1e9,maxLeft=-1e9,maxRight=-1e9,minVal,maxVal;if(groupIds.length>0){for(var i=0;i<groupIds.length;i++){var group=this.groups[groupIds[i]];if(group&&group.options.yAxisOrientation!="right"){yAxisLeftUsed=true;minLeft=1e9;maxLeft=-1e9}else if(group&&group.options.yAxisOrientation){yAxisRightUsed=true;minRight=1e9;maxRight=-1e9}}for(var i=0;i<groupIds.length;i++){if(groupRanges.hasOwnProperty(groupIds[i])){if(groupRanges[groupIds[i]].ignore!==true){minVal=groupRanges[groupIds[i]].min;maxVal=groupRanges[groupIds[i]].max;if(groupRanges[groupIds[i]].yAxisOrientation!="right"){yAxisLeftUsed=true;minLeft=minLeft>minVal?minVal:minLeft;maxLeft=maxLeft<maxVal?maxVal:maxLeft}else{yAxisRightUsed=true;minRight=minRight>minVal?minVal:minRight;maxRight=maxRight<maxVal?maxVal:maxRight}}}}if(yAxisLeftUsed==true){this.yAxisLeft.setRange(minLeft,maxLeft)}if(yAxisRightUsed==true){this.yAxisRight.setRange(minRight,maxRight)}}resized=this._toggleAxisVisiblity(yAxisLeftUsed,this.yAxisLeft)||resized;resized=this._toggleAxisVisiblity(yAxisRightUsed,this.yAxisRight)||resized;if(yAxisRightUsed==true&&yAxisLeftUsed==true){this.yAxisLeft.drawIcons=true;this.yAxisRight.drawIcons=true}else{this.yAxisLeft.drawIcons=false;this.yAxisRight.drawIcons=false}this.yAxisRight.master=!yAxisLeftUsed;this.yAxisRight.masterAxis=this.yAxisLeft;if(this.yAxisRight.master==false){if(yAxisRightUsed==true){this.yAxisLeft.lineOffset=this.yAxisRight.width}else{this.yAxisLeft.lineOffset=0}resized=this.yAxisLeft.redraw()||resized;resized=this.yAxisRight.redraw()||resized}else{resized=this.yAxisRight.redraw()||resized}var tempGroups=["__barStackLeft","__barStackRight","__lineStackLeft","__lineStackRight"];for(var i=0;i<tempGroups.length;i++){if(groupIds.indexOf(tempGroups[i])!=-1){groupIds.splice(groupIds.indexOf(tempGroups[i]),1)}}return resized};LineGraph.prototype._toggleAxisVisiblity=function(axisUsed,axis){var changed=false;if(axisUsed==false){if(axis.dom.frame.parentNode&&axis.hidden==false){axis.hide();changed=true}}else{if(!axis.dom.frame.parentNode&&axis.hidden==true){axis.show();changed=true}}return changed};LineGraph.prototype._convertXcoordinates=function(datapoints){var toScreen=this.body.util.toScreen;for(var i=0;i<datapoints.length;i++){datapoints[i].screen_x=toScreen(datapoints[i].x)+this.props.width;datapoints[i].screen_y=datapoints[i].y}};LineGraph.prototype._convertYcoordinates=function(datapoints,group){var axis=this.yAxisLeft;var svgHeight=Number(this.svg.style.height.replace("px",""));if(group.options.yAxisOrientation=="right"){axis=this.yAxisRight}for(var i=0;i<datapoints.length;i++){datapoints[i].screen_y=Math.round(axis.convertValue(datapoints[i].y))}group.setZeroPosition(Math.min(svgHeight,axis.convertValue(0)))};module.exports=LineGraph},{"../../DOMutil":5,"../../DataSet":6,"../../DataView":7,"../../util":116,"./Component":94,"./DataAxis":97,"./GraphGroup":99,"./Legend":102,"./graph2d_types/bar":105,"./graph2d_types/line":106,"./graph2d_types/points":107,"babel-runtime/helpers/typeof":133}],104:[function(require,module,exports){"use strict";var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var util=require("../../util");var Component=require("./Component");var TimeStep=require("../TimeStep");var DateUtil=require("../DateUtil");var moment=require("../../module/moment");function TimeAxis(body,options){this.dom={foreground:null,lines:[],majorTexts:[],minorTexts:[],redundant:{lines:[],majorTexts:[],minorTexts:[]}};this.props={range:{start:0,end:0,minimumStep:0},lineTop:0};this.defaultOptions={orientation:{axis:"bottom"},showMinorLabels:true,showMajorLabels:true,maxMinorChars:7,format:TimeStep.FORMAT,moment:moment,timeAxis:null};this.options=util.extend({},this.defaultOptions);this.body=body;this._create();this.setOptions(options)}TimeAxis.prototype=new Component;TimeAxis.prototype.setOptions=function(options){if(options){util.selectiveExtend(["showMinorLabels","showMajorLabels","maxMinorChars","hiddenDates","timeAxis","moment","rtl"],this.options,options);util.selectiveDeepExtend(["format"],this.options,options);if("orientation"in options){if(typeof options.orientation==="string"){this.options.orientation.axis=options.orientation}else if((0,_typeof3["default"])(options.orientation)==="object"&&"axis"in options.orientation){this.options.orientation.axis=options.orientation.axis}}if("locale"in options){if(typeof moment.locale==="function"){moment.locale(options.locale)}else{moment.lang(options.locale)}}}};TimeAxis.prototype._create=function(){
this.dom.foreground=document.createElement("div");this.dom.background=document.createElement("div");this.dom.foreground.className="vis-time-axis vis-foreground";this.dom.background.className="vis-time-axis vis-background"};TimeAxis.prototype.destroy=function(){if(this.dom.foreground.parentNode){this.dom.foreground.parentNode.removeChild(this.dom.foreground)}if(this.dom.background.parentNode){this.dom.background.parentNode.removeChild(this.dom.background)}this.body=null};TimeAxis.prototype.redraw=function(){var props=this.props;var foreground=this.dom.foreground;var background=this.dom.background;var parent=this.options.orientation.axis=="top"?this.body.dom.top:this.body.dom.bottom;var parentChanged=foreground.parentNode!==parent;this._calculateCharSize();var showMinorLabels=this.options.showMinorLabels&&this.options.orientation.axis!=="none";var showMajorLabels=this.options.showMajorLabels&&this.options.orientation.axis!=="none";props.minorLabelHeight=showMinorLabels?props.minorCharHeight:0;props.majorLabelHeight=showMajorLabels?props.majorCharHeight:0;props.height=props.minorLabelHeight+props.majorLabelHeight;props.width=foreground.offsetWidth;props.minorLineHeight=this.body.domProps.root.height-props.majorLabelHeight-(this.options.orientation.axis=="top"?this.body.domProps.bottom.height:this.body.domProps.top.height);props.minorLineWidth=1;props.majorLineHeight=props.minorLineHeight+props.majorLabelHeight;props.majorLineWidth=1;var foregroundNextSibling=foreground.nextSibling;var backgroundNextSibling=background.nextSibling;foreground.parentNode&&foreground.parentNode.removeChild(foreground);background.parentNode&&background.parentNode.removeChild(background);foreground.style.height=this.props.height+"px";this._repaintLabels();if(foregroundNextSibling){parent.insertBefore(foreground,foregroundNextSibling)}else{parent.appendChild(foreground)}if(backgroundNextSibling){this.body.dom.backgroundVertical.insertBefore(background,backgroundNextSibling)}else{this.body.dom.backgroundVertical.appendChild(background)}return this._isResized()||parentChanged};TimeAxis.prototype._repaintLabels=function(){var orientation=this.options.orientation.axis;var start=util.convert(this.body.range.start,"Number");var end=util.convert(this.body.range.end,"Number");var timeLabelsize=this.body.util.toTime((this.props.minorCharWidth||10)*this.options.maxMinorChars).valueOf();var minimumStep=timeLabelsize-DateUtil.getHiddenDurationBefore(this.options.moment,this.body.hiddenDates,this.body.range,timeLabelsize);minimumStep-=this.body.util.toTime(0).valueOf();var step=new TimeStep(new Date(start),new Date(end),minimumStep,this.body.hiddenDates);step.setMoment(this.options.moment);if(this.options.format){step.setFormat(this.options.format)}if(this.options.timeAxis){step.setScale(this.options.timeAxis)}this.step=step;var dom=this.dom;dom.redundant.lines=dom.lines;dom.redundant.majorTexts=dom.majorTexts;dom.redundant.minorTexts=dom.minorTexts;dom.lines=[];dom.majorTexts=[];dom.minorTexts=[];var current;var next;var x;var xNext;var isMajor,nextIsMajor;var width=0,prevWidth;var line;var labelMinor;var xFirstMajorLabel=undefined;var count=0;var MAX=1e3;var className;step.start();next=step.getCurrent();xNext=this.body.util.toScreen(next);while(step.hasNext()&&count<MAX){count++;isMajor=step.isMajor();className=step.getClassName();labelMinor=step.getLabelMinor();current=next;x=xNext;step.next();next=step.getCurrent();nextIsMajor=step.isMajor();xNext=this.body.util.toScreen(next);prevWidth=width;width=xNext-x;var showMinorGrid=width>=prevWidth*.4;if(this.options.showMinorLabels&&showMinorGrid){var label=this._repaintMinorText(x,labelMinor,orientation,className);label.style.width=width+"px"}if(isMajor&&this.options.showMajorLabels){if(x>0){if(xFirstMajorLabel==undefined){xFirstMajorLabel=x}label=this._repaintMajorText(x,step.getLabelMajor(),orientation,className)}line=this._repaintMajorLine(x,width,orientation,className)}else{if(showMinorGrid){line=this._repaintMinorLine(x,width,orientation,className)}else{if(line){line.style.width=parseInt(line.style.width)+width+"px"}}}}if(count===MAX&&!warnedForOverflow){console.warn("Something is wrong with the Timeline scale. Limited drawing of grid lines to "+MAX+" lines.");warnedForOverflow=true}if(this.options.showMajorLabels){var leftTime=this.body.util.toTime(0),leftText=step.getLabelMajor(leftTime),widthText=leftText.length*(this.props.majorCharWidth||10)+10;if(xFirstMajorLabel==undefined||widthText<xFirstMajorLabel){this._repaintMajorText(0,leftText,orientation,className)}}util.forEach(this.dom.redundant,function(arr){while(arr.length){var elem=arr.pop();if(elem&&elem.parentNode){elem.parentNode.removeChild(elem)}}})};TimeAxis.prototype._repaintMinorText=function(x,text,orientation,className){var label=this.dom.redundant.minorTexts.shift();if(!label){var content=document.createTextNode("");label=document.createElement("div");label.appendChild(content);this.dom.foreground.appendChild(label)}this.dom.minorTexts.push(label);label.innerHTML=text;label.style.top=orientation=="top"?this.props.majorLabelHeight+"px":"0";if(this.options.rtl){label.style.left="";label.style.right=x+"px"}else{label.style.left=x+"px"}label.className="vis-text vis-minor "+className;return label};TimeAxis.prototype._repaintMajorText=function(x,text,orientation,className){var label=this.dom.redundant.majorTexts.shift();if(!label){var content=document.createElement("div");label=document.createElement("div");label.appendChild(content);this.dom.foreground.appendChild(label)}label.childNodes[0].innerHTML=text;label.className="vis-text vis-major "+className;label.style.top=orientation=="top"?"0":this.props.minorLabelHeight+"px";if(this.options.rtl){label.style.left="";label.style.right=x+"px"}else{label.style.left=x+"px"}this.dom.majorTexts.push(label);return label};TimeAxis.prototype._repaintMinorLine=function(x,width,orientation,className){var line=this.dom.redundant.lines.shift();if(!line){line=document.createElement("div");this.dom.background.appendChild(line)}this.dom.lines.push(line);var props=this.props;if(orientation=="top"){line.style.top=props.majorLabelHeight+"px"}else{line.style.top=this.body.domProps.top.height+"px"}line.style.height=props.minorLineHeight+"px";if(this.options.rtl){line.style.left="";line.style.right=x-props.minorLineWidth/2+"px";line.className="vis-grid vis-vertical-rtl vis-minor "+className}else{line.style.left=x-props.minorLineWidth/2+"px";line.className="vis-grid vis-vertical vis-minor "+className}line.style.width=width+"px";return line};TimeAxis.prototype._repaintMajorLine=function(x,width,orientation,className){var line=this.dom.redundant.lines.shift();if(!line){line=document.createElement("div");this.dom.background.appendChild(line)}this.dom.lines.push(line);var props=this.props;if(orientation=="top"){line.style.top="0"}else{line.style.top=this.body.domProps.top.height+"px"}if(this.options.rtl){line.style.left="";line.style.right=x-props.majorLineWidth/2+"px";line.className="vis-grid vis-vertical-rtl vis-major "+className}else{line.style.left=x-props.majorLineWidth/2+"px";line.className="vis-grid vis-vertical vis-major "+className}line.style.height=props.majorLineHeight+"px";line.style.width=width+"px";return line};TimeAxis.prototype._calculateCharSize=function(){if(!this.dom.measureCharMinor){this.dom.measureCharMinor=document.createElement("DIV");this.dom.measureCharMinor.className="vis-text vis-minor vis-measure";this.dom.measureCharMinor.style.position="absolute";this.dom.measureCharMinor.appendChild(document.createTextNode("0"));this.dom.foreground.appendChild(this.dom.measureCharMinor)}this.props.minorCharHeight=this.dom.measureCharMinor.clientHeight;this.props.minorCharWidth=this.dom.measureCharMinor.clientWidth;if(!this.dom.measureCharMajor){this.dom.measureCharMajor=document.createElement("DIV");this.dom.measureCharMajor.className="vis-text vis-major vis-measure";this.dom.measureCharMajor.style.position="absolute";this.dom.measureCharMajor.appendChild(document.createTextNode("0"));this.dom.foreground.appendChild(this.dom.measureCharMajor)}this.props.majorCharHeight=this.dom.measureCharMajor.clientHeight;this.props.majorCharWidth=this.dom.measureCharMajor.clientWidth};var warnedForOverflow=false;module.exports=TimeAxis},{"../../module/moment":20,"../../util":116,"../DateUtil":87,"../TimeStep":91,"./Component":94,"babel-runtime/helpers/typeof":133}],105:[function(require,module,exports){"use strict";var DOMutil=require("../../../DOMutil");var Points=require("./points");function Bargraph(groupId,options){}Bargraph.drawIcon=function(group,x,y,iconWidth,iconHeight,framework){var fillHeight=iconHeight*.5;var path,fillPath;var outline=DOMutil.getSVGElement("rect",framework.svgElements,framework.svg);outline.setAttributeNS(null,"x",x);outline.setAttributeNS(null,"y",y-fillHeight);outline.setAttributeNS(null,"width",iconWidth);outline.setAttributeNS(null,"height",2*fillHeight);outline.setAttributeNS(null,"class","vis-outline");var barWidth=Math.round(.3*iconWidth);var originalWidth=group.options.barChart.width;var scale=originalWidth/barWidth;var bar1Height=Math.round(.4*iconHeight);var bar2Height=Math.round(.75*iconHeight);var offset=Math.round((iconWidth-2*barWidth)/3);DOMutil.drawBar(x+.5*barWidth+offset,y+fillHeight-bar1Height-1,barWidth,bar1Height,group.className+" vis-bar",framework.svgElements,framework.svg,group.style);DOMutil.drawBar(x+1.5*barWidth+offset+2,y+fillHeight-bar2Height-1,barWidth,bar2Height,group.className+" vis-bar",framework.svgElements,framework.svg,group.style);if(group.options.drawPoints.enabled==true){var groupTemplate={style:group.options.drawPoints.style,styles:group.options.drawPoints.styles,size:group.options.drawPoints.size/scale,className:group.className};DOMutil.drawPoint(x+.5*barWidth+offset,y+fillHeight-bar1Height-1,groupTemplate,framework.svgElements,framework.svg);DOMutil.drawPoint(x+1.5*barWidth+offset+2,y+fillHeight-bar2Height-1,groupTemplate,framework.svgElements,framework.svg)}};Bargraph.draw=function(groupIds,processedGroupData,framework){var combinedData=[];var intersections={};var coreDistance;var key,drawData;var group;var i,j;var barPoints=0;for(i=0;i<groupIds.length;i++){group=framework.groups[groupIds[i]];if(group.options.style==="bar"){if(group.visible===true&&(framework.options.groups.visibility[groupIds[i]]===undefined||framework.options.groups.visibility[groupIds[i]]===true)){for(j=0;j<processedGroupData[groupIds[i]].length;j++){combinedData.push({screen_x:processedGroupData[groupIds[i]][j].screen_x,screen_y:processedGroupData[groupIds[i]][j].screen_y,x:processedGroupData[groupIds[i]][j].x,y:processedGroupData[groupIds[i]][j].y,groupId:groupIds[i],label:processedGroupData[groupIds[i]][j].label});barPoints+=1}}}}if(barPoints===0){return}combinedData.sort(function(a,b){if(a.screen_x===b.screen_x){return a.groupId<b.groupId?-1:1}else{return a.screen_x-b.screen_x}});Bargraph._getDataIntersections(intersections,combinedData);for(i=0;i<combinedData.length;i++){group=framework.groups[combinedData[i].groupId];var minWidth=group.options.barChart.minWidth!=undefined?group.options.barChart.minWidth:.1*group.options.barChart.width;key=combinedData[i].screen_x;var heightOffset=0;if(intersections[key]===undefined){if(i+1<combinedData.length){coreDistance=Math.abs(combinedData[i+1].screen_x-key)}drawData=Bargraph._getSafeDrawData(coreDistance,group,minWidth)}else{var nextKey=i+(intersections[key].amount-intersections[key].resolved);var prevKey=i-(intersections[key].resolved+1);if(nextKey<combinedData.length){coreDistance=Math.abs(combinedData[nextKey].screen_x-key)}drawData=Bargraph._getSafeDrawData(coreDistance,group,minWidth);intersections[key].resolved+=1;if(group.options.stack===true&&group.options.excludeFromStacking!==true){if(combinedData[i].screen_y<group.zeroPosition){heightOffset=intersections[key].accumulatedNegative;intersections[key].accumulatedNegative+=group.zeroPosition-combinedData[i].screen_y}else{heightOffset=intersections[key].accumulatedPositive;intersections[key].accumulatedPositive+=group.zeroPosition-combinedData[i].screen_y}}else if(group.options.barChart.sideBySide===true){drawData.width=drawData.width/intersections[key].amount;drawData.offset+=intersections[key].resolved*drawData.width-.5*drawData.width*(intersections[key].amount+1)}}DOMutil.drawBar(combinedData[i].screen_x+drawData.offset,combinedData[i].screen_y-heightOffset,drawData.width,group.zeroPosition-combinedData[i].screen_y,group.className+" vis-bar",framework.svgElements,framework.svg,group.style);if(group.options.drawPoints.enabled===true){var pointData={screen_x:combinedData[i].screen_x,screen_y:combinedData[i].screen_y-heightOffset,x:combinedData[i].x,y:combinedData[i].y,groupId:combinedData[i].groupId,label:combinedData[i].label};Points.draw([pointData],group,framework,drawData.offset)}}};Bargraph._getDataIntersections=function(intersections,combinedData){var coreDistance;for(var i=0;i<combinedData.length;i++){if(i+1<combinedData.length){coreDistance=Math.abs(combinedData[i+1].screen_x-combinedData[i].screen_x)}if(i>0){coreDistance=Math.min(coreDistance,Math.abs(combinedData[i-1].screen_x-combinedData[i].screen_x))}if(coreDistance===0){if(intersections[combinedData[i].screen_x]===undefined){intersections[combinedData[i].screen_x]={amount:0,resolved:0,accumulatedPositive:0,accumulatedNegative:0}}intersections[combinedData[i].screen_x].amount+=1}}};Bargraph._getSafeDrawData=function(coreDistance,group,minWidth){var width,offset;if(coreDistance<group.options.barChart.width&&coreDistance>0){width=coreDistance<minWidth?minWidth:coreDistance;offset=0;if(group.options.barChart.align==="left"){offset-=.5*coreDistance}else if(group.options.barChart.align==="right"){offset+=.5*coreDistance}}else{width=group.options.barChart.width;offset=0;if(group.options.barChart.align==="left"){offset-=.5*group.options.barChart.width}else if(group.options.barChart.align==="right"){offset+=.5*group.options.barChart.width}}return{width:width,offset:offset}};Bargraph.getStackedYRange=function(combinedData,groupRanges,groupIds,groupLabel,orientation){if(combinedData.length>0){combinedData.sort(function(a,b){if(a.screen_x===b.screen_x){return a.groupId<b.groupId?-1:1}else{return a.screen_x-b.screen_x}});var intersections={};Bargraph._getDataIntersections(intersections,combinedData);groupRanges[groupLabel]=Bargraph._getStackedYRange(intersections,combinedData);groupRanges[groupLabel].yAxisOrientation=orientation;groupIds.push(groupLabel)}};Bargraph._getStackedYRange=function(intersections,combinedData){var key;var yMin=combinedData[0].screen_y;var yMax=combinedData[0].screen_y;for(var i=0;i<combinedData.length;i++){key=combinedData[i].screen_x;if(intersections[key]===undefined){yMin=yMin>combinedData[i].screen_y?combinedData[i].screen_y:yMin;yMax=yMax<combinedData[i].screen_y?combinedData[i].screen_y:yMax}else{if(combinedData[i].screen_y<0){intersections[key].accumulatedNegative+=combinedData[i].screen_y}else{intersections[key].accumulatedPositive+=combinedData[i].screen_y}}}for(var xpos in intersections){if(intersections.hasOwnProperty(xpos)){yMin=yMin>intersections[xpos].accumulatedNegative?intersections[xpos].accumulatedNegative:yMin;yMin=yMin>intersections[xpos].accumulatedPositive?intersections[xpos].accumulatedPositive:yMin;yMax=yMax<intersections[xpos].accumulatedNegative?intersections[xpos].accumulatedNegative:yMax;yMax=yMax<intersections[xpos].accumulatedPositive?intersections[xpos].accumulatedPositive:yMax}}return{min:yMin,max:yMax}};module.exports=Bargraph},{"../../../DOMutil":5,"./points":107}],106:[function(require,module,exports){"use strict";var DOMutil=require("../../../DOMutil");function Line(groupId,options){}Line.calcPath=function(dataset,group){if(dataset!=null){if(dataset.length>0){var d=[];if(group.options.interpolation.enabled==true){d=Line._catmullRom(dataset,group)}else{d=Line._linear(dataset)}return d}}};Line.drawIcon=function(group,x,y,iconWidth,iconHeight,framework){var fillHeight=iconHeight*.5;var path,fillPath;var outline=DOMutil.getSVGElement("rect",framework.svgElements,framework.svg);outline.setAttributeNS(null,"x",x);outline.setAttributeNS(null,"y",y-fillHeight);outline.setAttributeNS(null,"width",iconWidth);outline.setAttributeNS(null,"height",2*fillHeight);outline.setAttributeNS(null,"class","vis-outline");path=DOMutil.getSVGElement("path",framework.svgElements,framework.svg);path.setAttributeNS(null,"class",group.className);if(group.style!==undefined){path.setAttributeNS(null,"style",group.style)}path.setAttributeNS(null,"d","M"+x+","+y+" L"+(x+iconWidth)+","+y+"");if(group.options.shaded.enabled==true){fillPath=DOMutil.getSVGElement("path",framework.svgElements,framework.svg);if(group.options.shaded.orientation=="top"){fillPath.setAttributeNS(null,"d","M"+x+", "+(y-fillHeight)+"L"+x+","+y+" L"+(x+iconWidth)+","+y+" L"+(x+iconWidth)+","+(y-fillHeight))}else{fillPath.setAttributeNS(null,"d","M"+x+","+y+" "+"L"+x+","+(y+fillHeight)+" "+"L"+(x+iconWidth)+","+(y+fillHeight)+"L"+(x+iconWidth)+","+y)}fillPath.setAttributeNS(null,"class",group.className+" vis-icon-fill");if(group.options.shaded.style!==undefined&&group.options.shaded.style!==""){fillPath.setAttributeNS(null,"style",group.options.shaded.style)}}if(group.options.drawPoints.enabled==true){var groupTemplate={style:group.options.drawPoints.style,styles:group.options.drawPoints.styles,size:group.options.drawPoints.size,className:group.className};DOMutil.drawPoint(x+.5*iconWidth,y,groupTemplate,framework.svgElements,framework.svg)}};Line.drawShading=function(pathArray,group,subPathArray,framework){if(group.options.shaded.enabled==true){var svgHeight=Number(framework.svg.style.height.replace("px",""));var fillPath=DOMutil.getSVGElement("path",framework.svgElements,framework.svg);var type="L";if(group.options.interpolation.enabled==true){type="C"}var dFill;var zero=0;if(group.options.shaded.orientation=="top"){zero=0}else if(group.options.shaded.orientation=="bottom"){zero=svgHeight}else{zero=Math.min(Math.max(0,group.zeroPosition),svgHeight)}if(group.options.shaded.orientation=="group"&&subPathArray!=null&&subPathArray!=undefined){dFill="M"+pathArray[0][0]+","+pathArray[0][1]+" "+this.serializePath(pathArray,type,false)+" L"+subPathArray[subPathArray.length-1][0]+","+subPathArray[subPathArray.length-1][1]+" "+this.serializePath(subPathArray,type,true)+subPathArray[0][0]+","+subPathArray[0][1]+" Z"}else{dFill="M"+pathArray[0][0]+","+pathArray[0][1]+" "+this.serializePath(pathArray,type,false)+" V"+zero+" H"+pathArray[0][0]+" Z"}fillPath.setAttributeNS(null,"class",group.className+" vis-fill");if(group.options.shaded.style!==undefined){fillPath.setAttributeNS(null,"style",group.options.shaded.style)}fillPath.setAttributeNS(null,"d",dFill)}};Line.draw=function(pathArray,group,framework){if(pathArray!=null&&pathArray!=undefined){var path=DOMutil.getSVGElement("path",framework.svgElements,framework.svg);path.setAttributeNS(null,"class",group.className);if(group.style!==undefined){path.setAttributeNS(null,"style",group.style)}var type="L";if(group.options.interpolation.enabled==true){type="C"}path.setAttributeNS(null,"d","M"+pathArray[0][0]+","+pathArray[0][1]+" "+this.serializePath(pathArray,type,false))}};Line.serializePath=function(pathArray,type,inverse){if(pathArray.length<2){return""}var d=type;if(inverse){for(var i=pathArray.length-2;i>0;i--){d+=pathArray[i][0]+","+pathArray[i][1]+" "}}else{for(var i=1;i<pathArray.length;i++){d+=pathArray[i][0]+","+pathArray[i][1]+" "}}return d};Line._catmullRomUniform=function(data){var p0,p1,p2,p3,bp1,bp2;var d=[];d.push([Math.round(data[0].screen_x),Math.round(data[0].screen_y)]);var normalization=1/6;var length=data.length;for(var i=0;i<length-1;i++){p0=i==0?data[0]:data[i-1];p1=data[i];p2=data[i+1];p3=i+2<length?data[i+2]:p2;bp1={screen_x:(-p0.screen_x+6*p1.screen_x+p2.screen_x)*normalization,screen_y:(-p0.screen_y+6*p1.screen_y+p2.screen_y)*normalization};bp2={screen_x:(p1.screen_x+6*p2.screen_x-p3.screen_x)*normalization,screen_y:(p1.screen_y+6*p2.screen_y-p3.screen_y)*normalization};d.push([bp1.screen_x,bp1.screen_y]);d.push([bp2.screen_x,bp2.screen_y]);d.push([p2.screen_x,p2.screen_y])}return d};Line._catmullRom=function(data,group){var alpha=group.options.interpolation.alpha;if(alpha==0||alpha===undefined){return this._catmullRomUniform(data)}else{var p0,p1,p2,p3,bp1,bp2,d1,d2,d3,A,B,N,M;var d3powA,d2powA,d3pow2A,d2pow2A,d1pow2A,d1powA;var d=[];d.push([Math.round(data[0].screen_x),Math.round(data[0].screen_y)]);var length=data.length;for(var i=0;i<length-1;i++){p0=i==0?data[0]:data[i-1];p1=data[i];p2=data[i+1];p3=i+2<length?data[i+2]:p2;d1=Math.sqrt(Math.pow(p0.screen_x-p1.screen_x,2)+Math.pow(p0.screen_y-p1.screen_y,2));d2=Math.sqrt(Math.pow(p1.screen_x-p2.screen_x,2)+Math.pow(p1.screen_y-p2.screen_y,2));d3=Math.sqrt(Math.pow(p2.screen_x-p3.screen_x,2)+Math.pow(p2.screen_y-p3.screen_y,2));d3powA=Math.pow(d3,alpha);d3pow2A=Math.pow(d3,2*alpha);d2powA=Math.pow(d2,alpha);d2pow2A=Math.pow(d2,2*alpha);d1powA=Math.pow(d1,alpha);d1pow2A=Math.pow(d1,2*alpha);A=2*d1pow2A+3*d1powA*d2powA+d2pow2A;B=2*d3pow2A+3*d3powA*d2powA+d2pow2A;N=3*d1powA*(d1powA+d2powA);if(N>0){N=1/N}M=3*d3powA*(d3powA+d2powA);if(M>0){M=1/M}bp1={screen_x:(-d2pow2A*p0.screen_x+A*p1.screen_x+d1pow2A*p2.screen_x)*N,screen_y:(-d2pow2A*p0.screen_y+A*p1.screen_y+d1pow2A*p2.screen_y)*N};bp2={screen_x:(d3pow2A*p1.screen_x+B*p2.screen_x-d2pow2A*p3.screen_x)*M,screen_y:(d3pow2A*p1.screen_y+B*p2.screen_y-d2pow2A*p3.screen_y)*M};if(bp1.screen_x==0&&bp1.screen_y==0){bp1=p1}if(bp2.screen_x==0&&bp2.screen_y==0){bp2=p2}d.push([bp1.screen_x,bp1.screen_y]);d.push([bp2.screen_x,bp2.screen_y]);d.push([p2.screen_x,p2.screen_y])}return d}};Line._linear=function(data){var d=[];for(var i=0;i<data.length;i++){d.push([data[i].screen_x,data[i].screen_y])}return d};module.exports=Line},{"../../../DOMutil":5}],107:[function(require,module,exports){"use strict";var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DOMutil=require("../../../DOMutil");function Points(groupId,options){}Points.draw=function(dataset,group,framework,offset){offset=offset||0;var callback=getCallback(framework,group);for(var i=0;i<dataset.length;i++){if(!callback){DOMutil.drawPoint(dataset[i].screen_x+offset,dataset[i].screen_y,getGroupTemplate(group),framework.svgElements,framework.svg,dataset[i].label)}else{var callbackResult=callback(dataset[i],group);if(callbackResult===true||(typeof callbackResult==="undefined"?"undefined":(0,_typeof3["default"])(callbackResult))==="object"){DOMutil.drawPoint(dataset[i].screen_x+offset,dataset[i].screen_y,getGroupTemplate(group,callbackResult),framework.svgElements,framework.svg,dataset[i].label)}}}};Points.drawIcon=function(group,x,y,iconWidth,iconHeight,framework){var fillHeight=iconHeight*.5;var path,fillPath;var outline=DOMutil.getSVGElement("rect",framework.svgElements,framework.svg);outline.setAttributeNS(null,"x",x);outline.setAttributeNS(null,"y",y-fillHeight);outline.setAttributeNS(null,"width",iconWidth);outline.setAttributeNS(null,"height",2*fillHeight);outline.setAttributeNS(null,"class","vis-outline");DOMutil.drawPoint(x+.5*iconWidth,y,getGroupTemplate(group),framework.svgElements,framework.svg)};function getGroupTemplate(group,callbackResult){callbackResult=typeof callbackResult==="undefined"?{}:callbackResult;return{style:callbackResult.style||group.options.drawPoints.style,styles:callbackResult.styles||group.options.drawPoints.styles,size:callbackResult.size||group.options.drawPoints.size,className:callbackResult.className||group.className}}function getCallback(framework,group){var callback=undefined;if(framework.options&&framework.options.drawPoints&&framework.options.drawPoints.onRender&&typeof framework.options.drawPoints.onRender=="function"){callback=framework.options.drawPoints.onRender}if(group.group.options&&group.group.options.drawPoints&&group.group.options.drawPoints.onRender&&typeof group.group.options.drawPoints.onRender=="function"){callback=group.group.options.drawPoints.onRender}return callback}module.exports=Points},{"../../../DOMutil":5,"babel-runtime/helpers/typeof":133}],108:[function(require,module,exports){"use strict";var Hammer=require("../../../module/hammer");var Item=require("./Item");var BackgroundGroup=require("../BackgroundGroup");var RangeItem=require("./RangeItem");function BackgroundItem(data,conversion,options){this.props={content:{width:0}};this.overflow=false;if(data){if(data.start==undefined){throw new Error('Property "start" missing in item '+data.id)}if(data.end==undefined){throw new Error('Property "end" missing in item '+data.id)}}Item.call(this,data,conversion,options)}BackgroundItem.prototype=new Item(null,null,null);BackgroundItem.prototype.baseClassName="vis-item vis-background";BackgroundItem.prototype.stack=false;BackgroundItem.prototype.isVisible=function(range){return this.data.start<range.end&&this.data.end>range.start};BackgroundItem.prototype.redraw=function(){var dom=this.dom;if(!dom){this.dom={};dom=this.dom;dom.box=document.createElement("div");dom.frame=document.createElement("div");dom.frame.className="vis-item-overflow";dom.box.appendChild(dom.frame);dom.content=document.createElement("div");dom.content.className="vis-item-content";dom.frame.appendChild(dom.content);this.dirty=true}if(!this.parent){throw new Error("Cannot redraw item: no parent attached")}if(!dom.box.parentNode){var background=this.parent.dom.background;if(!background){throw new Error("Cannot redraw item: parent has no background container element")}background.appendChild(dom.box)}this.displayed=true;if(this.dirty){this._updateContents(this.dom.content);this._updateTitle();this._updateDataAttributes(this.dom.content);this._updateStyle(this.dom.box);var className=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"");dom.box.className=this.baseClassName+className;this.overflow=window.getComputedStyle(dom.content).overflow!=="hidden";this.props.content.width=this.dom.content.offsetWidth;this.height=0;this.dirty=false}};BackgroundItem.prototype.show=RangeItem.prototype.show;BackgroundItem.prototype.hide=RangeItem.prototype.hide;BackgroundItem.prototype.repositionX=RangeItem.prototype.repositionX;BackgroundItem.prototype.repositionY=function(margin){var height;if(this.data.subgroup!==undefined){var itemSubgroup=this.data.subgroup;var subgroups=this.parent.subgroups;var subgroupIndex=subgroups[itemSubgroup].index;this.dom.box.style.height=this.parent.subgroups[itemSubgroup].height+"px";var orientation=this.options.orientation.item;if(orientation=="top"){this.dom.box.style.top=this.parent.top+this.parent.subgroups[itemSubgroup].top+"px"}else{this.dom.box.style.top=this.parent.top+this.parent.height-this.parent.subgroups[itemSubgroup].top-this.parent.subgroups[itemSubgroup].height+"px"}this.dom.box.style.bottom=""}else{if(this.parent instanceof BackgroundGroup){height=Math.max(this.parent.height,this.parent.itemSet.body.domProps.center.height,this.parent.itemSet.body.domProps.centerContainer.height);this.dom.box.style.top=orientation=="top"?"0":"";this.dom.box.style.bottom=orientation=="top"?"":"0"}else{height=this.parent.height;this.dom.box.style.top=this.parent.top+"px";this.dom.box.style.bottom=""}}this.dom.box.style.height=height+"px"};module.exports=BackgroundItem},{"../../../module/hammer":19,"../BackgroundGroup":93,"./Item":110,"./RangeItem":112}],109:[function(require,module,exports){"use strict";var Item=require("./Item");var util=require("../../../util");function BoxItem(data,conversion,options){this.props={dot:{width:0,height:0},line:{width:0,height:0}};this.options=options;if(data){if(data.start==undefined){throw new Error('Property "start" missing in item '+data)}}Item.call(this,data,conversion,options)}BoxItem.prototype=new Item(null,null,null);BoxItem.prototype.isVisible=function(range){var isVisible;var align=this.options.align;var msPerPixel=(range.end-range.start)/range.body.dom.center.clientWidth;var widthInMs=this.width*msPerPixel;if(align=="right"){isVisible=this.data.start.getTime()>range.start&&this.data.start.getTime()-widthInMs<range.end}else if(align=="left"){isVisible=this.data.start.getTime()+widthInMs>range.start&&this.data.start.getTime()<range.end}else{isVisible=this.data.start.getTime()+widthInMs/2>range.start&&this.data.start.getTime()-widthInMs/2<range.end}return isVisible};BoxItem.prototype.redraw=function(){var dom=this.dom;if(!dom){this.dom={};dom=this.dom;dom.box=document.createElement("DIV");dom.content=document.createElement("DIV");dom.content.className="vis-item-content";dom.box.appendChild(dom.content);dom.line=document.createElement("DIV");dom.line.className="vis-line";dom.dot=document.createElement("DIV");dom.dot.className="vis-dot";dom.box["timeline-item"]=this;this.dirty=true}if(!this.parent){throw new Error("Cannot redraw item: no parent attached")}if(!dom.box.parentNode){var foreground=this.parent.dom.foreground;if(!foreground)throw new Error("Cannot redraw item: parent has no foreground container element");foreground.appendChild(dom.box)}if(!dom.line.parentNode){var background=this.parent.dom.background;if(!background)throw new Error("Cannot redraw item: parent has no background container element");background.appendChild(dom.line)}if(!dom.dot.parentNode){var axis=this.parent.dom.axis;if(!background)throw new Error("Cannot redraw item: parent has no axis container element");axis.appendChild(dom.dot)}this.displayed=true;if(this.dirty){this._updateContents(this.dom.content);this._updateTitle();this._updateDataAttributes(this.dom.box);this._updateStyle(this.dom.box);var editable=(this.options.editable.updateTime||this.options.editable.updateGroup||this.editable===true)&&this.editable!==false;var className=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(editable?" vis-editable":" vis-readonly");dom.box.className="vis-item vis-box"+className;dom.line.className="vis-item vis-line"+className;dom.dot.className="vis-item vis-dot"+className;var previousRight=dom.box.style.right;var previousLeft=dom.box.style.left;if(this.options.rtl){dom.box.style.right="0px"}else{dom.box.style.left="0px"}this.props.dot.height=dom.dot.offsetHeight;this.props.dot.width=dom.dot.offsetWidth;this.props.line.width=dom.line.offsetWidth;this.width=dom.box.offsetWidth;this.height=dom.box.offsetHeight;if(this.options.rtl){dom.box.style.right=previousRight}else{dom.box.style.left=previousLeft}this.dirty=false}this._repaintOnItemUpdateTimeTooltip(dom.box);this._repaintDragCenter();this._repaintDeleteButton(dom.box)};BoxItem.prototype.show=function(){if(!this.displayed){this.redraw()}};BoxItem.prototype.hide=function(){if(this.displayed){var dom=this.dom;if(dom.box.parentNode)dom.box.parentNode.removeChild(dom.box);if(dom.line.parentNode)dom.line.parentNode.removeChild(dom.line);if(dom.dot.parentNode)dom.dot.parentNode.removeChild(dom.dot);this.displayed=false}};BoxItem.prototype.repositionX=function(){var start=this.conversion.toScreen(this.data.start);var align=this.options.align;if(align=="right"){if(this.options.rtl){this.right=start-this.width;this.dom.box.style.right=this.right+"px";this.dom.line.style.right=start-this.props.line.width+"px";this.dom.dot.style.right=start-this.props.line.width/2-this.props.dot.width/2+"px"}else{this.left=start-this.width;this.dom.box.style.left=this.left+"px";this.dom.line.style.left=start-this.props.line.width+"px";this.dom.dot.style.left=start-this.props.line.width/2-this.props.dot.width/2+"px"}}else if(align=="left"){if(this.options.rtl){this.right=start;this.dom.box.style.right=this.right+"px";this.dom.line.style.right=start+"px";this.dom.dot.style.right=start+this.props.line.width/2-this.props.dot.width/2+"px"}else{this.left=start;this.dom.box.style.left=this.left+"px";this.dom.line.style.left=start+"px";this.dom.dot.style.left=start+this.props.line.width/2-this.props.dot.width/2+"px";
}}else{if(this.options.rtl){this.right=start-this.width/2;this.dom.box.style.right=this.right+"px";this.dom.line.style.right=start-this.props.line.width+"px";this.dom.dot.style.right=start-this.props.dot.width/2+"px"}else{this.left=start-this.width/2;this.dom.box.style.left=this.left+"px";this.dom.line.style.left=start-this.props.line.width/2+"px";this.dom.dot.style.left=start-this.props.dot.width/2+"px"}}};BoxItem.prototype.repositionY=function(){var orientation=this.options.orientation.item;var box=this.dom.box;var line=this.dom.line;var dot=this.dom.dot;if(orientation=="top"){box.style.top=(this.top||0)+"px";line.style.top="0";line.style.height=this.parent.top+this.top+1+"px";line.style.bottom=""}else{var itemSetHeight=this.parent.itemSet.props.height;var lineHeight=itemSetHeight-this.parent.top-this.parent.height+this.top;box.style.top=(this.parent.height-this.top-this.height||0)+"px";line.style.top=itemSetHeight-lineHeight+"px";line.style.bottom="0"}dot.style.top=-this.props.dot.height/2+"px"};BoxItem.prototype.getWidthLeft=function(){return this.width/2};BoxItem.prototype.getWidthRight=function(){return this.width/2};module.exports=BoxItem},{"../../../util":116,"./Item":110}],110:[function(require,module,exports){"use strict";var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Hammer=require("../../../module/hammer");var util=require("../../../util");var moment=require("../../../module/moment");function Item(data,conversion,options){this.id=null;this.parent=null;this.data=data;this.dom=null;this.conversion=conversion||{};this.options=options||{};this.selected=false;this.displayed=false;this.groupShowing=true;this.dirty=true;this.popup=null;this.top=null;this.right=null;this.left=null;this.width=null;this.height=null;this.editable=null;if(this.data&&this.data.hasOwnProperty("editable")){if(typeof this.data.editable==="boolean"){this.editable={updateTime:this.data.editable,updateGroup:this.data.editable,remove:this.data.editable}}else if((0,_typeof3["default"])(options.editable)==="object"){this.editable={};util.selectiveExtend(["updateTime","updateGroup","remove"],this.editable,data.editable)}}}Item.prototype.stack=true;Item.prototype.select=function(){this.selected=true;this.dirty=true;if(this.displayed)this.redraw()};Item.prototype.unselect=function(){this.selected=false;this.dirty=true;if(this.displayed)this.redraw()};Item.prototype.setData=function(data){var groupChanged=data.group!=undefined&&this.data.group!=data.group;if(groupChanged){this.parent.itemSet._moveToGroup(this,data.group)}if(data.hasOwnProperty("editable")){if(typeof data.editable==="boolean"){this.editable={updateTime:this.data.editable,updateGroup:this.data.editable,remove:this.data.editable}}else if((0,_typeof3["default"])(options.editable)==="object"){this.editable={};util.selectiveExtend(["updateTime","updateGroup","remove"],this.editable,data.editable)}}this.data=data;this.dirty=true;if(this.displayed)this.redraw()};Item.prototype.setParent=function(parent){if(this.displayed){this.hide();this.parent=parent;if(this.parent){this.show()}}else{this.parent=parent}};Item.prototype.isVisible=function(range){return false};Item.prototype.show=function(){return false};Item.prototype.hide=function(){return false};Item.prototype.redraw=function(){};Item.prototype.repositionX=function(){};Item.prototype.repositionY=function(){};Item.prototype._repaintDragCenter=function(){if(this.selected&&this.options.editable.updateTime&&!this.dom.dragCenter){var me=this;var dragCenter=document.createElement("div");dragCenter.className="vis-drag-center";dragCenter.dragCenterItem=this;new Hammer(dragCenter).on("doubletap",function(event){event.stopPropagation();me.parent.itemSet._onUpdateItem(me)});if(this.dom.box){this.dom.box.appendChild(dragCenter)}else if(this.dom.point){this.dom.point.appendChild(dragCenter)}this.dom.dragCenter=dragCenter}else if(!this.selected&&this.dom.dragCenter){if(this.dom.dragCenter.parentNode){this.dom.dragCenter.parentNode.removeChild(this.dom.dragCenter)}this.dom.dragCenter=null}};Item.prototype._repaintDeleteButton=function(anchor){var editable=(this.options.editable.overrideItems||this.editable==null)&&this.options.editable.remove||!this.options.editable.overrideItems&&this.editable!=null&&this.editable.remove;if(this.selected&&editable&&!this.dom.deleteButton){var me=this;var deleteButton=document.createElement("div");if(this.options.rtl){deleteButton.className="vis-delete-rtl"}else{deleteButton.className="vis-delete"}deleteButton.title="Delete this item";new Hammer(deleteButton).on("tap",function(event){event.stopPropagation();me.parent.removeFromDataSet(me)});anchor.appendChild(deleteButton);this.dom.deleteButton=deleteButton}else if(!this.selected&&this.dom.deleteButton){if(this.dom.deleteButton.parentNode){this.dom.deleteButton.parentNode.removeChild(this.dom.deleteButton)}this.dom.deleteButton=null}};Item.prototype._repaintOnItemUpdateTimeTooltip=function(anchor){if(!this.options.tooltipOnItemUpdateTime)return;var editable=(this.options.editable.updateTime||this.data.editable===true)&&this.data.editable!==false;if(this.selected&&editable&&!this.dom.onItemUpdateTimeTooltip){var me=this;var onItemUpdateTimeTooltip=document.createElement("div");onItemUpdateTimeTooltip.className="vis-onUpdateTime-tooltip";anchor.appendChild(onItemUpdateTimeTooltip);this.dom.onItemUpdateTimeTooltip=onItemUpdateTimeTooltip}else if(!this.selected&&this.dom.onItemUpdateTimeTooltip){if(this.dom.onItemUpdateTimeTooltip.parentNode){this.dom.onItemUpdateTimeTooltip.parentNode.removeChild(this.dom.onItemUpdateTimeTooltip)}this.dom.onItemUpdateTimeTooltip=null}if(this.dom.onItemUpdateTimeTooltip){this.dom.onItemUpdateTimeTooltip.style.visibility=this.parent.itemSet.touchParams.itemIsDragging?"visible":"hidden";if(this.options.rtl){this.dom.onItemUpdateTimeTooltip.style.right=this.dom.content.style.right}else{this.dom.onItemUpdateTimeTooltip.style.left=this.dom.content.style.left}var tooltipOffset=50;var scrollTop=this.parent.itemSet.body.domProps.scrollTop;var itemDistanceFromTop;if(this.options.orientation.item=="top"){itemDistanceFromTop=this.top}else{itemDistanceFromTop=this.parent.height-this.top-this.height}var isCloseToTop=itemDistanceFromTop+this.parent.top-tooltipOffset<-scrollTop;if(isCloseToTop){this.dom.onItemUpdateTimeTooltip.style.bottom="";this.dom.onItemUpdateTimeTooltip.style.top=this.height+2+"px"}else{this.dom.onItemUpdateTimeTooltip.style.top="";this.dom.onItemUpdateTimeTooltip.style.bottom=this.height+2+"px"}var content;var templateFunction;if(this.options.tooltipOnItemUpdateTime&&this.options.tooltipOnItemUpdateTime.template){templateFunction=this.options.tooltipOnItemUpdateTime.template.bind(this);content=templateFunction(this.data)}else{content="start: "+moment(this.data.start).format("MM/DD/YYYY hh:mm");if(this.data.end){content+="<br> end: "+moment(this.data.end).format("MM/DD/YYYY hh:mm")}}this.dom.onItemUpdateTimeTooltip.innerHTML=content}};Item.prototype._updateContents=function(element){var content;var templateFunction;var itemVisibleFrameContent;var visibleFrameTemplateFunction;var itemData=this.parent.itemSet.itemsData.get(this.id);var frameElement=this.dom.box||this.dom.point;var itemVisibleFrameContentElement=frameElement.getElementsByClassName("vis-item-visible-frame")[0];if(this.options.visibleFrameTemplate){visibleFrameTemplateFunction=this.options.visibleFrameTemplate.bind(this);itemVisibleFrameContent=visibleFrameTemplateFunction(itemData,frameElement)}else{itemVisibleFrameContent=""}if(itemVisibleFrameContentElement){if(itemVisibleFrameContent instanceof Object&&!(itemVisibleFrameContent instanceof Element)){visibleFrameTemplateFunction(itemData,itemVisibleFrameContentElement)}else{var changed=this._contentToString(this.itemVisibleFrameContent)!==this._contentToString(itemVisibleFrameContent);if(changed){if(itemVisibleFrameContent instanceof Element){itemVisibleFrameContentElement.innerHTML="";itemVisibleFrameContentElement.appendChild(itemVisibleFrameContent)}else if(itemVisibleFrameContent!=undefined){itemVisibleFrameContentElement.innerHTML=itemVisibleFrameContent}else{if(!(this.data.type=="background"&&this.data.content===undefined)){throw new Error('Property "content" missing in item '+this.id)}}this.itemVisibleFrameContent=itemVisibleFrameContent}}}if(this.options.template){templateFunction=this.options.template.bind(this);content=templateFunction(itemData,element)}else{content=this.data.content}if(content instanceof Object&&!(content instanceof Element)){templateFunction(itemData,element)}else{var changed=this._contentToString(this.content)!==this._contentToString(content);if(changed){if(content instanceof Element){element.innerHTML="";element.appendChild(content)}else if(content!=undefined){element.innerHTML=content}else{if(!(this.data.type=="background"&&this.data.content===undefined)){throw new Error('Property "content" missing in item '+this.id)}}this.content=content}}};Item.prototype._updateTitle=function(){if(this.data.title!=null){if(this.popup!=null){this.popup.setText(this.data.title||"")}}};Item.prototype._updateDataAttributes=function(element){if(this.options.dataAttributes&&this.options.dataAttributes.length>0){var attributes=[];if(Array.isArray(this.options.dataAttributes)){attributes=this.options.dataAttributes}else if(this.options.dataAttributes=="all"){attributes=(0,_keys2["default"])(this.data)}else{return}for(var i=0;i<attributes.length;i++){var name=attributes[i];var value=this.data[name];if(value!=null){element.setAttribute("data-"+name,value)}else{element.removeAttribute("data-"+name)}}}};Item.prototype._updateStyle=function(element){if(this.style){util.removeCssText(element,this.style);this.style=null}if(this.data.style){util.addCssText(element,this.data.style);this.style=this.data.style}};Item.prototype._contentToString=function(content){if(typeof content==="string")return content;if(content&&"outerHTML"in content)return content.outerHTML;return content};Item.prototype.getWidthLeft=function(){return 0};Item.prototype.getWidthRight=function(){return 0};Item.prototype.getTitle=function(){return this.data.title};Item.prototype.setPopup=function(popup){this.popup=popup;this._updateTitle()};module.exports=Item},{"../../../module/hammer":19,"../../../module/moment":20,"../../../util":116,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/typeof":133}],111:[function(require,module,exports){"use strict";var Item=require("./Item");function PointItem(data,conversion,options){this.props={dot:{top:0,width:0,height:0},content:{height:0,marginLeft:0,marginRight:0}};this.options=options;if(data){if(data.start==undefined){throw new Error('Property "start" missing in item '+data)}}Item.call(this,data,conversion,options)}PointItem.prototype=new Item(null,null,null);PointItem.prototype.isVisible=function(range){var msPerPixel=(range.end-range.start)/range.body.dom.center.clientWidth;var widthInMs=this.width*msPerPixel;return this.data.start.getTime()+widthInMs>range.start&&this.data.start<range.end};PointItem.prototype.redraw=function(){var dom=this.dom;if(!dom){this.dom={};dom=this.dom;dom.point=document.createElement("div");dom.content=document.createElement("div");dom.content.className="vis-item-content";dom.point.appendChild(dom.content);dom.dot=document.createElement("div");dom.point.appendChild(dom.dot);dom.point["timeline-item"]=this;this.dirty=true}if(!this.parent){throw new Error("Cannot redraw item: no parent attached")}if(!dom.point.parentNode){var foreground=this.parent.dom.foreground;if(!foreground){throw new Error("Cannot redraw item: parent has no foreground container element")}foreground.appendChild(dom.point)}this.displayed=true;if(this.dirty){this._updateContents(this.dom.content);this._updateTitle();this._updateDataAttributes(this.dom.point);this._updateStyle(this.dom.point);var editable=(this.options.editable.updateTime||this.options.editable.updateGroup||this.editable===true)&&this.editable!==false;var className=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(editable?" vis-editable":" vis-readonly");dom.point.className="vis-item vis-point"+className;dom.dot.className="vis-item vis-dot"+className;this.props.dot.width=dom.dot.offsetWidth;this.props.dot.height=dom.dot.offsetHeight;this.props.content.height=dom.content.offsetHeight;if(this.options.rtl){dom.content.style.marginRight=2*this.props.dot.width+"px"}else{dom.content.style.marginLeft=2*this.props.dot.width+"px"}this.width=dom.point.offsetWidth;this.height=dom.point.offsetHeight;dom.dot.style.top=(this.height-this.props.dot.height)/2+"px";if(this.options.rtl){dom.dot.style.right=this.props.dot.width/2+"px"}else{dom.dot.style.left=this.props.dot.width/2+"px"}this.dirty=false}this._repaintOnItemUpdateTimeTooltip(dom.point);this._repaintDragCenter();this._repaintDeleteButton(dom.point)};PointItem.prototype.show=function(){if(!this.displayed){this.redraw()}};PointItem.prototype.hide=function(){if(this.displayed){if(this.dom.point.parentNode){this.dom.point.parentNode.removeChild(this.dom.point)}this.displayed=false}};PointItem.prototype.repositionX=function(){var start=this.conversion.toScreen(this.data.start);if(this.options.rtl){this.right=start-this.props.dot.width;this.dom.point.style.right=this.right+"px"}else{this.left=start-this.props.dot.width;this.dom.point.style.left=this.left+"px"}};PointItem.prototype.repositionY=function(){var orientation=this.options.orientation.item;var point=this.dom.point;if(orientation=="top"){point.style.top=this.top+"px"}else{point.style.top=this.parent.height-this.top-this.height+"px"}};PointItem.prototype.getWidthLeft=function(){return this.props.dot.width};PointItem.prototype.getWidthRight=function(){return this.props.dot.width};module.exports=PointItem},{"./Item":110}],112:[function(require,module,exports){"use strict";var Hammer=require("../../../module/hammer");var Item=require("./Item");function RangeItem(data,conversion,options){this.props={content:{width:0}};this.overflow=false;this.options=options;if(data){if(data.start==undefined){throw new Error('Property "start" missing in item '+data.id)}if(data.end==undefined){throw new Error('Property "end" missing in item '+data.id)}}Item.call(this,data,conversion,options)}RangeItem.prototype=new Item(null,null,null);RangeItem.prototype.baseClassName="vis-item vis-range";RangeItem.prototype.isVisible=function(range){return this.data.start<range.end&&this.data.end>range.start};RangeItem.prototype.redraw=function(){var dom=this.dom;if(!dom){this.dom={};dom=this.dom;dom.box=document.createElement("div");dom.frame=document.createElement("div");dom.frame.className="vis-item-overflow";dom.box.appendChild(dom.frame);dom.visibleFrame=document.createElement("div");dom.visibleFrame.className="vis-item-visible-frame";dom.box.appendChild(dom.visibleFrame);dom.content=document.createElement("div");dom.content.className="vis-item-content";dom.frame.appendChild(dom.content);dom.box["timeline-item"]=this;this.dirty=true}if(!this.parent){throw new Error("Cannot redraw item: no parent attached")}if(!dom.box.parentNode){var foreground=this.parent.dom.foreground;if(!foreground){throw new Error("Cannot redraw item: parent has no foreground container element")}foreground.appendChild(dom.box)}this.displayed=true;if(this.dirty){this._updateContents(this.dom.content);this._updateTitle();this._updateDataAttributes(this.dom.box);this._updateStyle(this.dom.box);var editable=(this.options.editable.updateTime||this.options.editable.updateGroup||this.editable===true)&&this.editable!==false;var className=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(editable?" vis-editable":" vis-readonly");dom.box.className=this.baseClassName+className;this.overflow=window.getComputedStyle(dom.frame).overflow!=="hidden";this.dom.content.style.maxWidth="none";this.props.content.width=this.dom.content.offsetWidth;this.height=this.dom.box.offsetHeight;this.dom.content.style.maxWidth="";this.dirty=false}this._repaintOnItemUpdateTimeTooltip(dom.box);this._repaintDeleteButton(dom.box);this._repaintDragCenter();this._repaintDragLeft();this._repaintDragRight()};RangeItem.prototype.show=function(){if(!this.displayed){this.redraw()}};RangeItem.prototype.hide=function(){if(this.displayed){var box=this.dom.box;if(box.parentNode){box.parentNode.removeChild(box)}this.displayed=false}};RangeItem.prototype.repositionX=function(limitSize){var parentWidth=this.parent.width;var start=this.conversion.toScreen(this.data.start);var end=this.conversion.toScreen(this.data.end);var contentStartPosition;var contentWidth;if(limitSize===undefined||limitSize===true){if(start<-parentWidth){start=-parentWidth}if(end>2*parentWidth){end=2*parentWidth}}var boxWidth=Math.max(end-start+.5,1);if(this.overflow){if(this.options.rtl){this.right=start}else{this.left=start}this.width=boxWidth+this.props.content.width;contentWidth=this.props.content.width}else{if(this.options.rtl){this.right=start}else{this.left=start}this.width=boxWidth;contentWidth=Math.min(end-start,this.props.content.width)}if(this.options.rtl){this.dom.box.style.right=this.right+"px"}else{this.dom.box.style.left=this.left+"px"}this.dom.box.style.width=boxWidth+"px";switch(this.options.align){case"left":if(this.options.rtl){this.dom.content.style.right="0"}else{this.dom.content.style.left="0"}break;case"right":if(this.options.rtl){this.dom.content.style.right=Math.max(boxWidth-contentWidth,0)+"px"}else{this.dom.content.style.left=Math.max(boxWidth-contentWidth,0)+"px"}break;case"center":if(this.options.rtl){this.dom.content.style.right=Math.max((boxWidth-contentWidth)/2,0)+"px"}else{this.dom.content.style.left=Math.max((boxWidth-contentWidth)/2,0)+"px"}break;default:if(this.overflow){if(end>0){contentStartPosition=Math.max(-start,0)}else{contentStartPosition=-contentWidth}}else{if(start<0){contentStartPosition=-start}else{contentStartPosition=0}}if(this.options.rtl){this.dom.content.style.right=contentStartPosition+"px"}else{this.dom.content.style.left=contentStartPosition+"px";this.dom.content.style.width="calc(100% - "+contentStartPosition+"px)"}}};RangeItem.prototype.repositionY=function(){var orientation=this.options.orientation.item;var box=this.dom.box;if(orientation=="top"){box.style.top=this.top+"px"}else{box.style.top=this.parent.height-this.top-this.height+"px"}};RangeItem.prototype._repaintDragLeft=function(){if(this.selected&&this.options.editable.updateTime&&!this.dom.dragLeft){var dragLeft=document.createElement("div");dragLeft.className="vis-drag-left";dragLeft.dragLeftItem=this;this.dom.box.appendChild(dragLeft);this.dom.dragLeft=dragLeft}else if(!this.selected&&this.dom.dragLeft){if(this.dom.dragLeft.parentNode){this.dom.dragLeft.parentNode.removeChild(this.dom.dragLeft)}this.dom.dragLeft=null}};RangeItem.prototype._repaintDragRight=function(){if(this.selected&&this.options.editable.updateTime&&!this.dom.dragRight){var dragRight=document.createElement("div");dragRight.className="vis-drag-right";dragRight.dragRightItem=this;this.dom.box.appendChild(dragRight);this.dom.dragRight=dragRight}else if(!this.selected&&this.dom.dragRight){if(this.dom.dragRight.parentNode){this.dom.dragRight.parentNode.removeChild(this.dom.dragRight)}this.dom.dragRight=null}};module.exports=RangeItem},{"../../../module/hammer":19,"./Item":110}],113:[function(require,module,exports){"use strict";exports["en"]={current:"current",time:"time"};exports["en_EN"]=exports["en"];exports["en_US"]=exports["en"];exports["it"]={current:"attuale",time:"tempo"};exports["it_IT"]=exports["it"];exports["it_CH"]=exports["it"];exports["nl"]={current:"huidige",time:"tijd"};exports["nl_NL"]=exports["nl"];exports["nl_BE"]=exports["nl"];exports["de"]={current:"Aktuelle",time:"Zeit"};exports["de_DE"]=exports["de"]},{}],114:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var string="string";var bool="boolean";var number="number";var array="array";var date="date";var object="object";var dom="dom";var moment="moment";var any="any";var allOptions={configure:{enabled:{boolean:bool},filter:{boolean:bool,function:"function"},container:{dom:dom},__type__:{object:object,boolean:bool,function:"function"}},yAxisOrientation:{string:["left","right"]},defaultGroup:{string:string},sort:{boolean:bool},sampling:{boolean:bool},stack:{boolean:bool},graphHeight:{string:string,number:number},shaded:{enabled:{boolean:bool},orientation:{string:["bottom","top","zero","group"]},groupId:{object:object},__type__:{boolean:bool,object:object}},style:{string:["line","bar","points"]},barChart:{width:{number:number},minWidth:{number:number},sideBySide:{boolean:bool},align:{string:["left","center","right"]},__type__:{object:object}},interpolation:{enabled:{boolean:bool},parametrization:{string:["centripetal","chordal","uniform"]},alpha:{number:number},__type__:{object:object,boolean:bool}},drawPoints:{enabled:{boolean:bool},onRender:{function:"function"},size:{number:number},style:{string:["square","circle"]},__type__:{object:object,boolean:bool,function:"function"}},dataAxis:{showMinorLabels:{boolean:bool},showMajorLabels:{boolean:bool},icons:{boolean:bool},width:{string:string,number:number},visible:{boolean:bool},alignZeros:{boolean:bool},left:{range:{min:{number:number},max:{number:number},__type__:{object:object}},format:{function:"function"},title:{text:{string:string,number:number},style:{string:string},__type__:{object:object}},__type__:{object:object}},right:{range:{min:{number:number},max:{number:number},__type__:{object:object}},format:{function:"function"},title:{text:{string:string,number:number},style:{string:string},__type__:{object:object}},__type__:{object:object}},__type__:{object:object}},legend:{enabled:{boolean:bool},icons:{boolean:bool},left:{visible:{boolean:bool},position:{string:["top-right","bottom-right","top-left","bottom-left"]},__type__:{object:object}},right:{visible:{boolean:bool},position:{string:["top-right","bottom-right","top-left","bottom-left"]},__type__:{object:object}},__type__:{object:object,boolean:bool}},groups:{visibility:{any:any},__type__:{object:object}},autoResize:{boolean:bool},throttleRedraw:{number:number},clickToUse:{boolean:bool},end:{number:number,date:date,string:string,moment:moment},format:{minorLabels:{millisecond:{string:string,undefined:"undefined"},second:{string:string,undefined:"undefined"},minute:{string:string,undefined:"undefined"},hour:{string:string,undefined:"undefined"},weekday:{string:string,undefined:"undefined"},day:{string:string,undefined:"undefined"},month:{string:string,undefined:"undefined"},year:{string:string,undefined:"undefined"},__type__:{object:object}},majorLabels:{millisecond:{string:string,undefined:"undefined"},second:{string:string,undefined:"undefined"},minute:{string:string,undefined:"undefined"},hour:{string:string,undefined:"undefined"},weekday:{string:string,undefined:"undefined"},day:{string:string,undefined:"undefined"},month:{string:string,undefined:"undefined"},year:{string:string,undefined:"undefined"},__type__:{object:object}},__type__:{object:object}},moment:{function:"function"},height:{string:string,number:number},hiddenDates:{start:{date:date,number:number,string:string,moment:moment},end:{date:date,number:number,string:string,moment:moment},repeat:{string:string},__type__:{object:object,array:array}},locale:{string:string},locales:{__any__:{any:any},__type__:{object:object}},max:{date:date,number:number,string:string,moment:moment},maxHeight:{number:number,string:string},maxMinorChars:{number:number},min:{date:date,number:number,string:string,moment:moment},minHeight:{number:number,string:string},moveable:{boolean:bool},multiselect:{boolean:bool},orientation:{string:string},showCurrentTime:{boolean:bool},showMajorLabels:{boolean:bool},showMinorLabels:{boolean:bool},start:{date:date,number:number,string:string,moment:moment},timeAxis:{scale:{string:string,undefined:"undefined"},step:{number:number,undefined:"undefined"},__type__:{object:object}},width:{string:string,number:number},zoomable:{boolean:bool},zoomKey:{string:["ctrlKey","altKey","metaKey",""]},zoomMax:{number:number},zoomMin:{number:number},zIndex:{number:number},__type__:{object:object}};var configureOptions={global:{sort:true,sampling:true,stack:false,shaded:{enabled:false,orientation:["zero","top","bottom","group"]},style:["line","bar","points"],barChart:{width:[50,5,100,5],minWidth:[50,5,100,5],sideBySide:false,align:["left","center","right"]},interpolation:{enabled:true,parametrization:["centripetal","chordal","uniform"]},drawPoints:{enabled:true,size:[6,2,30,1],style:["square","circle"]},dataAxis:{showMinorLabels:true,showMajorLabels:true,icons:false,width:[40,0,200,1],visible:true,alignZeros:true,left:{title:{text:"",style:""}},right:{title:{text:"",style:""}}},legend:{enabled:false,icons:true,left:{visible:true,position:["top-right","bottom-right","top-left","bottom-left"]},right:{visible:true,position:["top-right","bottom-right","top-left","bottom-left"]}},autoResize:true,clickToUse:false,end:"",format:{minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",month:"YYYY",year:""}},height:"",locale:"",max:"",maxHeight:"",maxMinorChars:[7,0,20,1],min:"",minHeight:"",moveable:true,orientation:["both","bottom","top"],showCurrentTime:false,showMajorLabels:true,showMinorLabels:true,start:"",width:"100%",zoomable:true,zoomKey:["ctrlKey","altKey","metaKey",""],zoomMax:[31536e10,10,31536e10,1],zoomMin:[10,10,31536e10,1],zIndex:0}};exports.allOptions=allOptions;exports.configureOptions=configureOptions},{}],115:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var string="string";var bool="boolean";var number="number";var array="array";var date="date";var object="object";var dom="dom";var moment="moment";var any="any";var allOptions={configure:{enabled:{boolean:bool},filter:{boolean:bool,function:"function"},container:{dom:dom},__type__:{object:object,boolean:bool,function:"function"}},align:{string:string},rtl:{boolean:bool,undefined:"undefined"},rollingMode:{boolean:bool,undefined:"undefined"},verticalScroll:{boolean:bool,undefined:"undefined"},horizontalScroll:{boolean:bool,undefined:"undefined"},autoResize:{boolean:bool},throttleRedraw:{number:number},clickToUse:{boolean:bool},dataAttributes:{string:string,array:array},editable:{add:{boolean:bool,undefined:"undefined"},remove:{boolean:bool,undefined:"undefined"},updateGroup:{boolean:bool,undefined:"undefined"},updateTime:{boolean:bool,undefined:"undefined"},overrideItems:{boolean:bool,undefined:"undefined"},__type__:{boolean:bool,object:object}},end:{number:number,date:date,string:string,moment:moment},format:{minorLabels:{millisecond:{string:string,undefined:"undefined"},second:{string:string,undefined:"undefined"},minute:{string:string,undefined:"undefined"},hour:{string:string,undefined:"undefined"},weekday:{string:string,undefined:"undefined"},day:{string:string,undefined:"undefined"},month:{string:string,undefined:"undefined"},year:{string:string,undefined:"undefined"},__type__:{object:object,function:"function"}},majorLabels:{millisecond:{string:string,undefined:"undefined"},second:{string:string,undefined:"undefined"},minute:{string:string,undefined:"undefined"},hour:{string:string,undefined:"undefined"},weekday:{string:string,undefined:"undefined"},day:{string:string,undefined:"undefined"},month:{string:string,undefined:"undefined"},year:{string:string,undefined:"undefined"},__type__:{object:object,function:"function"}},__type__:{object:object}},moment:{function:"function"},groupOrder:{string:string,function:"function"},groupEditable:{add:{boolean:bool,undefined:"undefined"},remove:{boolean:bool,undefined:"undefined"},order:{boolean:bool,undefined:"undefined"},__type__:{boolean:bool,object:object}},groupOrderSwap:{function:"function"},height:{string:string,number:number},hiddenDates:{start:{date:date,number:number,string:string,moment:moment},end:{date:date,number:number,string:string,moment:moment},repeat:{string:string},__type__:{object:object,array:array}},itemsAlwaysDraggable:{boolean:bool},locale:{string:string},locales:{__any__:{any:any},__type__:{object:object}},margin:{axis:{number:number},item:{horizontal:{number:number,undefined:"undefined"},vertical:{number:number,undefined:"undefined"},__type__:{object:object,number:number}},__type__:{object:object,number:number}},max:{date:date,number:number,string:string,moment:moment},maxHeight:{number:number,string:string},maxMinorChars:{number:number},min:{date:date,number:number,string:string,moment:moment},minHeight:{number:number,string:string},moveable:{boolean:bool},multiselect:{boolean:bool},multiselectPerGroup:{boolean:bool},onAdd:{function:"function"},onUpdate:{function:"function"},onMove:{function:"function"},onMoving:{function:"function"},onRemove:{function:"function"},onAddGroup:{function:"function"},onMoveGroup:{function:"function"},onRemoveGroup:{function:"function"},order:{function:"function"},orientation:{axis:{string:string,undefined:"undefined"},item:{string:string,undefined:"undefined"},__type__:{string:string,object:object}},selectable:{boolean:bool},showCurrentTime:{boolean:bool},showMajorLabels:{boolean:bool},showMinorLabels:{boolean:bool},stack:{boolean:bool},stackSubgroups:{boolean:bool},snap:{function:"function",null:"null"},start:{date:date,number:number,string:string,moment:moment},template:{function:"function"},groupTemplate:{function:"function"},visibleFrameTemplate:{string:string,function:"function"},tooltip:{followMouse:{boolean:bool},overflowMethod:{string:["cap","flip"]},__type__:{object:object}},tooltipOnItemUpdateTime:{template:{function:"function"},__type__:{boolean:bool,object:object}},timeAxis:{scale:{string:string,undefined:"undefined"},step:{number:number,undefined:"undefined"},__type__:{object:object}},type:{string:string},width:{string:string,number:number},zoomable:{boolean:bool},zoomKey:{string:["ctrlKey","altKey","metaKey",""]},zoomMax:{number:number},zoomMin:{number:number},__type__:{object:object}};var configureOptions={global:{align:["center","left","right"],direction:false,autoResize:true,clickToUse:false,editable:{add:false,remove:false,updateGroup:false,updateTime:false},end:"",format:{minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",month:"YYYY",year:""}},groupsDraggable:false,height:"",locale:"",margin:{axis:[20,0,100,1],item:{horizontal:[10,0,100,1],vertical:[10,0,100,1]}},max:"",maxHeight:"",maxMinorChars:[7,0,20,1],min:"",minHeight:"",moveable:false,multiselect:false,multiselectPerGroup:false,orientation:{axis:["both","bottom","top"],item:["bottom","top"]},selectable:true,showCurrentTime:false,showMajorLabels:true,showMinorLabels:true,stack:true,stackSubgroups:true,start:"",tooltip:{followMouse:false,overflowMethod:"flip"},tooltipOnItemUpdateTime:false,type:["box","point","range","background"],width:"100%",zoomable:true,zoomKey:["ctrlKey","altKey","metaKey",""],zoomMax:[31536e10,10,31536e10,1],zoomMin:[10,10,31536e10,1]}};exports.allOptions=allOptions;exports.configureOptions=configureOptions},{}],116:[function(require,module,exports){"use strict";var _getIterator2=require("babel-runtime/core-js/get-iterator");var _getIterator3=_interopRequireDefault(_getIterator2);var _create=require("babel-runtime/core-js/object/create");var _create2=_interopRequireDefault(_create);
var _keys=require("babel-runtime/core-js/object/keys");var _keys2=_interopRequireDefault(_keys);var _typeof2=require("babel-runtime/helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);var _stringify=require("babel-runtime/core-js/json/stringify");var _stringify2=_interopRequireDefault(_stringify);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var moment=require("./module/moment");var uuid=require("./module/uuid");exports.isNumber=function(object){return object instanceof Number||typeof object=="number"};exports.elementsCensor=function(object){if(!object)return;var replacer=function replacer(key,value){if(value instanceof Element){return"DOM Element"}else{return value}};return JSON.parse((0,_stringify2["default"])(object,replacer))};exports.recursiveDOMDelete=function(DOMobject){if(DOMobject){while(DOMobject.hasChildNodes()===true){exports.recursiveDOMDelete(DOMobject.firstChild);DOMobject.removeChild(DOMobject.firstChild)}}};exports.giveRange=function(min,max,total,value){if(max==min){return.5}else{var scale=1/(max-min);return Math.max(0,(value-min)*scale)}};exports.isString=function(object){return object instanceof String||typeof object=="string"};exports.isDate=function(object){if(object instanceof Date){return true}else if(exports.isString(object)){var match=ASPDateRegex.exec(object);if(match){return true}else if(!isNaN(Date.parse(object))){return true}}return false};exports.randomUUID=function(){return uuid.v4()};exports.assignAllKeys=function(obj,value){for(var prop in obj){if(obj.hasOwnProperty(prop)){if((0,_typeof3["default"])(obj[prop])!=="object"){obj[prop]=value}}}};exports.fillIfDefined=function(a,b){var allowDeletion=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;for(var prop in a){if(b[prop]!==undefined){if((0,_typeof3["default"])(b[prop])!=="object"){if((b[prop]===undefined||b[prop]===null)&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}else{if((0,_typeof3["default"])(a[prop])==="object"){exports.fillIfDefined(a[prop],b[prop],allowDeletion)}}}}};exports.protoExtend=function(a,b){for(var i=1;i<arguments.length;i++){var other=arguments[i];for(var prop in other){a[prop]=other[prop]}}return a};exports.extend=function(a,b){for(var i=1;i<arguments.length;i++){var other=arguments[i];for(var prop in other){if(other.hasOwnProperty(prop)){a[prop]=other[prop]}}}return a};exports.selectiveExtend=function(props,a,b){if(!Array.isArray(props)){throw new Error("Array with property names expected as first argument")}for(var i=2;i<arguments.length;i++){var other=arguments[i];for(var p=0;p<props.length;p++){var prop=props[p];if(other.hasOwnProperty(prop)){a[prop]=other[prop]}}}return a};exports.selectiveDeepExtend=function(props,a,b){var allowDeletion=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(Array.isArray(b)){throw new TypeError("Arrays are not supported by deepExtend")}for(var i=2;i<arguments.length;i++){var other=arguments[i];for(var p=0;p<props.length;p++){var prop=props[p];if(other.hasOwnProperty(prop)){if(b[prop]&&b[prop].constructor===Object){if(a[prop]===undefined){a[prop]={}}if(a[prop].constructor===Object){exports.deepExtend(a[prop],b[prop],false,allowDeletion)}else{if(b[prop]===null&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}}else if(Array.isArray(b[prop])){throw new TypeError("Arrays are not supported by deepExtend")}else{if(b[prop]===null&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}}}}return a};exports.selectiveNotDeepExtend=function(props,a,b){var allowDeletion=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(Array.isArray(b)){throw new TypeError("Arrays are not supported by deepExtend")}for(var prop in b){if(b.hasOwnProperty(prop)){if(props.indexOf(prop)==-1){if(b[prop]&&b[prop].constructor===Object){if(a[prop]===undefined){a[prop]={}}if(a[prop].constructor===Object){exports.deepExtend(a[prop],b[prop])}else{if(b[prop]===null&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}}else if(Array.isArray(b[prop])){a[prop]=[];for(var i=0;i<b[prop].length;i++){a[prop].push(b[prop][i])}}else{if(b[prop]===null&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}}}}return a};exports.deepExtend=function(a,b,protoExtend,allowDeletion){for(var prop in b){if(b.hasOwnProperty(prop)||protoExtend===true){if(b[prop]&&b[prop].constructor===Object){if(a[prop]===undefined){a[prop]={}}if(a[prop].constructor===Object){exports.deepExtend(a[prop],b[prop],protoExtend)}else{if(b[prop]===null&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}}else if(Array.isArray(b[prop])){a[prop]=[];for(var i=0;i<b[prop].length;i++){a[prop].push(b[prop][i])}}else{if(b[prop]===null&&a[prop]!==undefined&&allowDeletion===true){delete a[prop]}else{a[prop]=b[prop]}}}}return a};exports.equalArray=function(a,b){if(a.length!=b.length)return false;for(var i=0,len=a.length;i<len;i++){if(a[i]!=b[i])return false}return true};exports.convert=function(object,type){var match;if(object===undefined){return undefined}if(object===null){return null}if(!type){return object}if(!(typeof type==="string")&&!(type instanceof String)){throw new Error("Type must be a string")}switch(type){case"boolean":case"Boolean":return Boolean(object);case"number":case"Number":if(exports.isString(object)&&!isNaN(Date.parse(object))){return moment(object).valueOf()}else{return Number(object.valueOf())}case"string":case"String":return String(object);case"Date":if(exports.isNumber(object)){return new Date(object)}if(object instanceof Date){return new Date(object.valueOf())}else if(moment.isMoment(object)){return new Date(object.valueOf())}if(exports.isString(object)){match=ASPDateRegex.exec(object);if(match){return new Date(Number(match[1]))}else{return moment(new Date(object)).toDate()}}else{throw new Error("Cannot convert object of type "+exports.getType(object)+" to type Date")}case"Moment":if(exports.isNumber(object)){return moment(object)}if(object instanceof Date){return moment(object.valueOf())}else if(moment.isMoment(object)){return moment(object)}if(exports.isString(object)){match=ASPDateRegex.exec(object);if(match){return moment(Number(match[1]))}else{return moment(object)}}else{throw new Error("Cannot convert object of type "+exports.getType(object)+" to type Date")}case"ISODate":if(exports.isNumber(object)){return new Date(object)}else if(object instanceof Date){return object.toISOString()}else if(moment.isMoment(object)){return object.toDate().toISOString()}else if(exports.isString(object)){match=ASPDateRegex.exec(object);if(match){return new Date(Number(match[1])).toISOString()}else{return moment(object).format()}}else{throw new Error("Cannot convert object of type "+exports.getType(object)+" to type ISODate")}case"ASPDate":if(exports.isNumber(object)){return"/Date("+object+")/"}else if(object instanceof Date){return"/Date("+object.valueOf()+")/"}else if(exports.isString(object)){match=ASPDateRegex.exec(object);var value;if(match){value=new Date(Number(match[1])).valueOf()}else{value=new Date(object).valueOf()}return"/Date("+value+")/"}else{throw new Error("Cannot convert object of type "+exports.getType(object)+" to type ASPDate")}default:throw new Error('Unknown type "'+type+'"')}};var ASPDateRegex=/^\/?Date\((\-?\d+)/i;exports.getType=function(object){var type=typeof object==="undefined"?"undefined":(0,_typeof3["default"])(object);if(type=="object"){if(object===null){return"null"}if(object instanceof Boolean){return"Boolean"}if(object instanceof Number){return"Number"}if(object instanceof String){return"String"}if(Array.isArray(object)){return"Array"}if(object instanceof Date){return"Date"}return"Object"}else if(type=="number"){return"Number"}else if(type=="boolean"){return"Boolean"}else if(type=="string"){return"String"}else if(type===undefined){return"undefined"}return type};exports.copyAndExtendArray=function(arr,newValue){var newArr=[];for(var i=0;i<arr.length;i++){newArr.push(arr[i])}newArr.push(newValue);return newArr};exports.copyArray=function(arr){var newArr=[];for(var i=0;i<arr.length;i++){newArr.push(arr[i])}return newArr};exports.getAbsoluteLeft=function(elem){return elem.getBoundingClientRect().left};exports.getAbsoluteRight=function(elem){return elem.getBoundingClientRect().right};exports.getAbsoluteTop=function(elem){return elem.getBoundingClientRect().top};exports.addClassName=function(elem,className){var classes=elem.className.split(" ");if(classes.indexOf(className)==-1){classes.push(className);elem.className=classes.join(" ")}};exports.removeClassName=function(elem,className){var classes=elem.className.split(" ");var index=classes.indexOf(className);if(index!=-1){classes.splice(index,1);elem.className=classes.join(" ")}};exports.forEach=function(object,callback){var i,len;if(Array.isArray(object)){for(i=0,len=object.length;i<len;i++){callback(object[i],i,object)}}else{for(i in object){if(object.hasOwnProperty(i)){callback(object[i],i,object)}}}};exports.toArray=function(object){var array=[];for(var prop in object){if(object.hasOwnProperty(prop))array.push(object[prop])}return array};exports.updateProperty=function(object,key,value){if(object[key]!==value){object[key]=value;return true}else{return false}};exports.throttle=function(fn){var scheduled=false;return function throttled(){if(!scheduled){scheduled=true;requestAnimationFrame(function(){scheduled=false;fn()})}}};exports.addEventListener=function(element,action,listener,useCapture){if(element.addEventListener){if(useCapture===undefined)useCapture=false;if(action==="mousewheel"&&navigator.userAgent.indexOf("Firefox")>=0){action="DOMMouseScroll"}element.addEventListener(action,listener,useCapture)}else{element.attachEvent("on"+action,listener)}};exports.removeEventListener=function(element,action,listener,useCapture){if(element.removeEventListener){if(useCapture===undefined)useCapture=false;if(action==="mousewheel"&&navigator.userAgent.indexOf("Firefox")>=0){action="DOMMouseScroll"}element.removeEventListener(action,listener,useCapture)}else{element.detachEvent("on"+action,listener)}};exports.preventDefault=function(event){if(!event)event=window.event;if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}};exports.getTarget=function(event){if(!event){event=window.event}var target;if(event.target){target=event.target}else if(event.srcElement){target=event.srcElement}if(target.nodeType!=undefined&&target.nodeType==3){target=target.parentNode}return target};exports.hasParent=function(element,parent){var e=element;while(e){if(e===parent){return true}e=e.parentNode}return false};exports.option={};exports.option.asBoolean=function(value,defaultValue){if(typeof value=="function"){value=value()}if(value!=null){return value!=false}return defaultValue||null};exports.option.asNumber=function(value,defaultValue){if(typeof value=="function"){value=value()}if(value!=null){return Number(value)||defaultValue||null}return defaultValue||null};exports.option.asString=function(value,defaultValue){if(typeof value=="function"){value=value()}if(value!=null){return String(value)}return defaultValue||null};exports.option.asSize=function(value,defaultValue){if(typeof value=="function"){value=value()}if(exports.isString(value)){return value}else if(exports.isNumber(value)){return value+"px"}else{return defaultValue||null}};exports.option.asElement=function(value,defaultValue){if(typeof value=="function"){value=value()}return value||defaultValue||null};exports.hexToRGB=function(hex){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;hex=hex.replace(shorthandRegex,function(m,r,g,b){return r+r+g+g+b+b});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null};exports.overrideOpacity=function(color,opacity){if(color.indexOf("rgba")!=-1){return color}else if(color.indexOf("rgb")!=-1){var rgb=color.substr(color.indexOf("(")+1).replace(")","").split(",");return"rgba("+rgb[0]+","+rgb[1]+","+rgb[2]+","+opacity+")"}else{var rgb=exports.hexToRGB(color);if(rgb==null){return color}else{return"rgba("+rgb.r+","+rgb.g+","+rgb.b+","+opacity+")"}}};exports.RGBToHex=function(red,green,blue){return"#"+((1<<24)+(red<<16)+(green<<8)+blue).toString(16).slice(1)};exports.parseColor=function(color){var c;if(exports.isString(color)===true){if(exports.isValidRGB(color)===true){var rgb=color.substr(4).substr(0,color.length-5).split(",").map(function(value){return parseInt(value)});color=exports.RGBToHex(rgb[0],rgb[1],rgb[2])}if(exports.isValidHex(color)===true){var hsv=exports.hexToHSV(color);var lighterColorHSV={h:hsv.h,s:hsv.s*.8,v:Math.min(1,hsv.v*1.02)};var darkerColorHSV={h:hsv.h,s:Math.min(1,hsv.s*1.25),v:hsv.v*.8};var darkerColorHex=exports.HSVToHex(darkerColorHSV.h,darkerColorHSV.s,darkerColorHSV.v);var lighterColorHex=exports.HSVToHex(lighterColorHSV.h,lighterColorHSV.s,lighterColorHSV.v);c={background:color,border:darkerColorHex,highlight:{background:lighterColorHex,border:darkerColorHex},hover:{background:lighterColorHex,border:darkerColorHex}}}else{c={background:color,border:color,highlight:{background:color,border:color},hover:{background:color,border:color}}}}else{c={};c.background=color.background||undefined;c.border=color.border||undefined;if(exports.isString(color.highlight)){c.highlight={border:color.highlight,background:color.highlight}}else{c.highlight={};c.highlight.background=color.highlight&&color.highlight.background||undefined;c.highlight.border=color.highlight&&color.highlight.border||undefined}if(exports.isString(color.hover)){c.hover={border:color.hover,background:color.hover}}else{c.hover={};c.hover.background=color.hover&&color.hover.background||undefined;c.hover.border=color.hover&&color.hover.border||undefined}}return c};exports.RGBToHSV=function(red,green,blue){red=red/255;green=green/255;blue=blue/255;var minRGB=Math.min(red,Math.min(green,blue));var maxRGB=Math.max(red,Math.max(green,blue));if(minRGB==maxRGB){return{h:0,s:0,v:minRGB}}var d=red==minRGB?green-blue:blue==minRGB?red-green:blue-red;var h=red==minRGB?3:blue==minRGB?1:5;var hue=60*(h-d/(maxRGB-minRGB))/360;var saturation=(maxRGB-minRGB)/maxRGB;var value=maxRGB;return{h:hue,s:saturation,v:value}};var cssUtil={split:function split(cssText){var styles={};cssText.split(";").forEach(function(style){if(style.trim()!=""){var parts=style.split(":");var key=parts[0].trim();var value=parts[1].trim();styles[key]=value}});return styles},join:function join(styles){return(0,_keys2["default"])(styles).map(function(key){return key+": "+styles[key]}).join("; ")}};exports.addCssText=function(element,cssText){var currentStyles=cssUtil.split(element.style.cssText);var newStyles=cssUtil.split(cssText);var styles=exports.extend(currentStyles,newStyles);element.style.cssText=cssUtil.join(styles)};exports.removeCssText=function(element,cssText){var styles=cssUtil.split(element.style.cssText);var removeStyles=cssUtil.split(cssText);for(var key in removeStyles){if(removeStyles.hasOwnProperty(key)){delete styles[key]}}element.style.cssText=cssUtil.join(styles)};exports.HSVToRGB=function(h,s,v){var r,g,b;var i=Math.floor(h*6);var f=h*6-i;var p=v*(1-s);var q=v*(1-f*s);var t=v*(1-(1-f)*s);switch(i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q;break}return{r:Math.floor(r*255),g:Math.floor(g*255),b:Math.floor(b*255)}};exports.HSVToHex=function(h,s,v){var rgb=exports.HSVToRGB(h,s,v);return exports.RGBToHex(rgb.r,rgb.g,rgb.b)};exports.hexToHSV=function(hex){var rgb=exports.hexToRGB(hex);return exports.RGBToHSV(rgb.r,rgb.g,rgb.b)};exports.isValidHex=function(hex){var isOk=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(hex);return isOk};exports.isValidRGB=function(rgb){rgb=rgb.replace(" ","");var isOk=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/i.test(rgb);return isOk};exports.isValidRGBA=function(rgba){rgba=rgba.replace(" ","");var isOk=/rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),(.{1,3})\)/i.test(rgba);return isOk};exports.selectiveBridgeObject=function(fields,referenceObject){if((typeof referenceObject==="undefined"?"undefined":(0,_typeof3["default"])(referenceObject))=="object"){var objectTo=(0,_create2["default"])(referenceObject);for(var i=0;i<fields.length;i++){if(referenceObject.hasOwnProperty(fields[i])){if((0,_typeof3["default"])(referenceObject[fields[i]])=="object"){objectTo[fields[i]]=exports.bridgeObject(referenceObject[fields[i]])}}}return objectTo}else{return null}};exports.bridgeObject=function(referenceObject){if((typeof referenceObject==="undefined"?"undefined":(0,_typeof3["default"])(referenceObject))=="object"){var objectTo=(0,_create2["default"])(referenceObject);for(var i in referenceObject){if(referenceObject.hasOwnProperty(i)){if((0,_typeof3["default"])(referenceObject[i])=="object"){objectTo[i]=exports.bridgeObject(referenceObject[i])}}}return objectTo}else{return null}};exports.insertSort=function(a,compare){for(var i=0;i<a.length;i++){var k=a[i];for(var j=i;j>0&&compare(k,a[j-1])<0;j--){a[j]=a[j-1]}a[j]=k}return a};exports.mergeOptions=function(mergeTarget,options,option){var allowDeletion=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var globalOptions=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};if(options[option]===null){mergeTarget[option]=(0,_create2["default"])(globalOptions[option])}else{if(options[option]!==undefined){if(typeof options[option]==="boolean"){mergeTarget[option].enabled=options[option]}else{if(options[option].enabled===undefined){mergeTarget[option].enabled=true}for(var prop in options[option]){if(options[option].hasOwnProperty(prop)){mergeTarget[option][prop]=options[option][prop]}}}}}};exports.binarySearchCustom=function(orderedItems,comparator,field,field2){var maxIterations=1e4;var iteration=0;var low=0;var high=orderedItems.length-1;while(low<=high&&iteration<maxIterations){var middle=Math.floor((low+high)/2);var item=orderedItems[middle];var value=field2===undefined?item[field]:item[field][field2];var searchResult=comparator(value);if(searchResult==0){return middle}else if(searchResult==-1){low=middle+1}else{high=middle-1}iteration++}return-1};exports.binarySearchValue=function(orderedItems,target,field,sidePreference,comparator){var maxIterations=1e4;var iteration=0;var low=0;var high=orderedItems.length-1;var prevValue,value,nextValue,middle;var comparator=comparator!=undefined?comparator:function(a,b){return a==b?0:a<b?-1:1};while(low<=high&&iteration<maxIterations){middle=Math.floor(.5*(high+low));prevValue=orderedItems[Math.max(0,middle-1)][field];value=orderedItems[middle][field];nextValue=orderedItems[Math.min(orderedItems.length-1,middle+1)][field];if(comparator(value,target)==0){return middle}else if(comparator(prevValue,target)<0&&comparator(value,target)>0){return sidePreference=="before"?Math.max(0,middle-1):middle}else if(comparator(value,target)<0&&comparator(nextValue,target)>0){return sidePreference=="before"?middle:Math.min(orderedItems.length-1,middle+1)}else{if(comparator(value,target)<0){low=middle+1}else{high=middle-1}}iteration++}return-1};exports.easingFunctions={linear:function linear(t){return t},easeInQuad:function easeInQuad(t){return t*t},easeOutQuad:function easeOutQuad(t){return t*(2-t)},easeInOutQuad:function easeInOutQuad(t){return t<.5?2*t*t:-1+(4-2*t)*t},easeInCubic:function easeInCubic(t){return t*t*t},easeOutCubic:function easeOutCubic(t){return--t*t*t+1},easeInOutCubic:function easeInOutCubic(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function easeInQuart(t){return t*t*t*t},easeOutQuart:function easeOutQuart(t){return 1- --t*t*t*t},easeInOutQuart:function easeInOutQuart(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function easeInQuint(t){return t*t*t*t*t},easeOutQuint:function easeOutQuint(t){return 1+--t*t*t*t*t},easeInOutQuint:function easeInOutQuint(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};exports.getScrollBarWidth=function(){var inner=document.createElement("p");inner.style.width="100%";inner.style.height="200px";var outer=document.createElement("div");outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="scroll";var w2=inner.offsetWidth;if(w1==w2)w2=outer.clientWidth;document.body.removeChild(outer);return w1-w2};exports.topMost=function(pile,accessors){var candidate=void 0;if(!Array.isArray(accessors)){accessors=[accessors]}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=(0,_getIterator3["default"])(pile),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var member=_step.value;if(member){candidate=member[accessors[0]];for(var i=1;i<accessors.length;i++){if(candidate){candidate=candidate[accessors[i]]}else{continue}}if(typeof candidate!="undefined"){break}}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator["return"]){_iterator["return"]()}}finally{if(_didIteratorError){throw _iteratorError}}}return candidate}},{"./module/moment":20,"./module/uuid":21,"babel-runtime/core-js/get-iterator":117,"babel-runtime/core-js/json/stringify":119,"babel-runtime/core-js/object/create":121,"babel-runtime/core-js/object/keys":124,"babel-runtime/helpers/typeof":133}],117:[function(require,module,exports){module.exports={default:require("core-js/library/fn/get-iterator"),__esModule:true}},{"core-js/library/fn/get-iterator":134}],118:[function(require,module,exports){module.exports={default:require("core-js/library/fn/is-iterable"),__esModule:true}},{"core-js/library/fn/is-iterable":135}],119:[function(require,module,exports){module.exports={default:require("core-js/library/fn/json/stringify"),__esModule:true}},{"core-js/library/fn/json/stringify":136}],120:[function(require,module,exports){module.exports={default:require("core-js/library/fn/math/sign"),__esModule:true}},{"core-js/library/fn/math/sign":137}],121:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/create"),__esModule:true}},{"core-js/library/fn/object/create":138}],122:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/define-property"),__esModule:true}},{"core-js/library/fn/object/define-property":139}],123:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/get-prototype-of"),__esModule:true}},{"core-js/library/fn/object/get-prototype-of":140}],124:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/keys"),__esModule:true}},{"core-js/library/fn/object/keys":141}],125:[function(require,module,exports){module.exports={default:require("core-js/library/fn/object/set-prototype-of"),__esModule:true}},{"core-js/library/fn/object/set-prototype-of":142}],126:[function(require,module,exports){module.exports={default:require("core-js/library/fn/symbol"),__esModule:true}},{"core-js/library/fn/symbol":143}],127:[function(require,module,exports){module.exports={default:require("core-js/library/fn/symbol/iterator"),__esModule:true}},{"core-js/library/fn/symbol/iterator":144}],128:[function(require,module,exports){"use strict";exports.__esModule=true;exports.default=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}},{}],129:[function(require,module,exports){"use strict";exports.__esModule=true;var _defineProperty=require("../core-js/object/define-property");var _defineProperty2=_interopRequireDefault(_defineProperty);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;(0,_defineProperty2.default)(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}()},{"../core-js/object/define-property":122}],130:[function(require,module,exports){"use strict";exports.__esModule=true;var _setPrototypeOf=require("../core-js/object/set-prototype-of");var _setPrototypeOf2=_interopRequireDefault(_setPrototypeOf);var _create=require("../core-js/object/create");var _create2=_interopRequireDefault(_create);var _typeof2=require("../helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof superClass==="undefined"?"undefined":(0,_typeof3.default)(superClass)))}subClass.prototype=(0,_create2.default)(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)_setPrototypeOf2.default?(0,_setPrototypeOf2.default)(subClass,superClass):subClass.__proto__=superClass}},{"../core-js/object/create":121,"../core-js/object/set-prototype-of":125,"../helpers/typeof":133}],131:[function(require,module,exports){"use strict";exports.__esModule=true;var _typeof2=require("../helpers/typeof");var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&((typeof call==="undefined"?"undefined":(0,_typeof3.default)(call))==="object"||typeof call==="function")?call:self}},{"../helpers/typeof":133}],132:[function(require,module,exports){"use strict";exports.__esModule=true;var _isIterable2=require("../core-js/is-iterable");var _isIterable3=_interopRequireDefault(_isIterable2);var _getIterator2=require("../core-js/get-iterator");var _getIterator3=_interopRequireDefault(_getIterator2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=(0,_getIterator3.default)(arr),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if((0,_isIterable3.default)(Object(arr))){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}()},{"../core-js/get-iterator":117,"../core-js/is-iterable":118}],133:[function(require,module,exports){"use strict";exports.__esModule=true;var _iterator=require("../core-js/symbol/iterator");var _iterator2=_interopRequireDefault(_iterator);var _symbol=require("../core-js/symbol");var _symbol2=_interopRequireDefault(_symbol);var _typeof=typeof _symbol2.default==="function"&&typeof _iterator2.default==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof _symbol2.default==="function"&&obj.constructor===_symbol2.default&&obj!==_symbol2.default.prototype?"symbol":typeof obj};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=typeof _symbol2.default==="function"&&_typeof(_iterator2.default)==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof(obj)}:function(obj){return obj&&typeof _symbol2.default==="function"&&obj.constructor===_symbol2.default&&obj!==_symbol2.default.prototype?"symbol":typeof obj==="undefined"?"undefined":_typeof(obj)}},{"../core-js/symbol":126,"../core-js/symbol/iterator":127}],134:[function(require,module,exports){require("../modules/web.dom.iterable");require("../modules/es6.string.iterator");module.exports=require("../modules/core.get-iterator")},{"../modules/core.get-iterator":206,"../modules/es6.string.iterator":216,"../modules/web.dom.iterable":220}],135:[function(require,module,exports){require("../modules/web.dom.iterable");require("../modules/es6.string.iterator");module.exports=require("../modules/core.is-iterable")},{"../modules/core.is-iterable":207,"../modules/es6.string.iterator":216,"../modules/web.dom.iterable":220}],136:[function(require,module,exports){var core=require("../../modules/_core"),$JSON=core.JSON||(core.JSON={stringify:JSON.stringify});module.exports=function stringify(it){return $JSON.stringify.apply($JSON,arguments)}},{"../../modules/_core":151}],137:[function(require,module,exports){require("../../modules/es6.math.sign");module.exports=require("../../modules/_core").Math.sign},{"../../modules/_core":151,"../../modules/es6.math.sign":209}],138:[function(require,module,exports){require("../../modules/es6.object.create");var $Object=require("../../modules/_core").Object;module.exports=function create(P,D){return $Object.create(P,D)}},{"../../modules/_core":151,"../../modules/es6.object.create":210}],139:[function(require,module,exports){require("../../modules/es6.object.define-property");var $Object=require("../../modules/_core").Object;module.exports=function defineProperty(it,key,desc){return $Object.defineProperty(it,key,desc)}},{"../../modules/_core":151,"../../modules/es6.object.define-property":211}],140:[function(require,module,exports){require("../../modules/es6.object.get-prototype-of");module.exports=require("../../modules/_core").Object.getPrototypeOf},{"../../modules/_core":151,"../../modules/es6.object.get-prototype-of":212}],141:[function(require,module,exports){require("../../modules/es6.object.keys");module.exports=require("../../modules/_core").Object.keys},{"../../modules/_core":151,"../../modules/es6.object.keys":213}],142:[function(require,module,exports){require("../../modules/es6.object.set-prototype-of");module.exports=require("../../modules/_core").Object.setPrototypeOf},{"../../modules/_core":151,"../../modules/es6.object.set-prototype-of":214}],143:[function(require,module,exports){require("../../modules/es6.symbol");require("../../modules/es6.object.to-string");require("../../modules/es7.symbol.async-iterator");require("../../modules/es7.symbol.observable");module.exports=require("../../modules/_core").Symbol},{"../../modules/_core":151,"../../modules/es6.object.to-string":215,"../../modules/es6.symbol":217,"../../modules/es7.symbol.async-iterator":218,"../../modules/es7.symbol.observable":219}],144:[function(require,module,exports){require("../../modules/es6.string.iterator");require("../../modules/web.dom.iterable");module.exports=require("../../modules/_wks-ext").f("iterator")},{"../../modules/_wks-ext":203,"../../modules/es6.string.iterator":216,"../../modules/web.dom.iterable":220}],145:[function(require,module,exports){module.exports=function(it){if(typeof it!="function")throw TypeError(it+" is not a function!");return it}},{}],146:[function(require,module,exports){module.exports=function(){}},{}],147:[function(require,module,exports){var isObject=require("./_is-object");module.exports=function(it){if(!isObject(it))throw TypeError(it+" is not an object!");return it}},{"./_is-object":167}],148:[function(require,module,exports){var toIObject=require("./_to-iobject"),toLength=require("./_to-length"),toIndex=require("./_to-index");module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIObject($this),length=toLength(O.length),index=toIndex(fromIndex,length),value;if(IS_INCLUDES&&el!=el)while(length>index){
value=O[index++];if(value!=value)return true}else for(;length>index;index++)if(IS_INCLUDES||index in O){if(O[index]===el)return IS_INCLUDES||index||0}return!IS_INCLUDES&&-1}}},{"./_to-index":195,"./_to-iobject":197,"./_to-length":198}],149:[function(require,module,exports){var cof=require("./_cof"),TAG=require("./_wks")("toStringTag"),ARG=cof(function(){return arguments}())=="Arguments";var tryGet=function(it,key){try{return it[key]}catch(e){}};module.exports=function(it){var O,T,B;return it===undefined?"Undefined":it===null?"Null":typeof(T=tryGet(O=Object(it),TAG))=="string"?T:ARG?cof(O):(B=cof(O))=="Object"&&typeof O.callee=="function"?"Arguments":B}},{"./_cof":150,"./_wks":204}],150:[function(require,module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},{}],151:[function(require,module,exports){var core=module.exports={version:"2.4.0"};if(typeof __e=="number")__e=core},{}],152:[function(require,module,exports){var aFunction=require("./_a-function");module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},{"./_a-function":145}],153:[function(require,module,exports){module.exports=function(it){if(it==undefined)throw TypeError("Can't call method on  "+it);return it}},{}],154:[function(require,module,exports){module.exports=!require("./_fails")(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},{"./_fails":159}],155:[function(require,module,exports){var isObject=require("./_is-object"),document=require("./_global").document,is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{}}},{"./_global":160,"./_is-object":167}],156:[function(require,module,exports){module.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],157:[function(require,module,exports){var getKeys=require("./_object-keys"),gOPS=require("./_object-gops"),pIE=require("./_object-pie");module.exports=function(it){var result=getKeys(it),getSymbols=gOPS.f;if(getSymbols){var symbols=getSymbols(it),isEnum=pIE.f,i=0,key;while(symbols.length>i)if(isEnum.call(it,key=symbols[i++]))result.push(key)}return result}},{"./_object-gops":182,"./_object-keys":185,"./_object-pie":186}],158:[function(require,module,exports){var global=require("./_global"),core=require("./_core"),ctx=require("./_ctx"),hide=require("./_hide"),PROTOTYPE="prototype";var $export=function(type,name,source){var IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,IS_WRAP=type&$export.W,exports=IS_GLOBAL?core:core[name]||(core[name]={}),expProto=exports[PROTOTYPE],target=IS_GLOBAL?global:IS_STATIC?global[name]:(global[name]||{})[PROTOTYPE],key,own,out;if(IS_GLOBAL)source=name;for(key in source){own=!IS_FORCED&&target&&target[key]!==undefined;if(own&&key in exports)continue;out=own?target[key]:source[key];exports[key]=IS_GLOBAL&&typeof target[key]!="function"?source[key]:IS_BIND&&own?ctx(out,global):IS_WRAP&&target[key]==out?function(C){var F=function(a,b,c){if(this instanceof C){switch(arguments.length){case 0:return new C;case 1:return new C(a);case 2:return new C(a,b)}return new C(a,b,c)}return C.apply(this,arguments)};F[PROTOTYPE]=C[PROTOTYPE];return F}(out):IS_PROTO&&typeof out=="function"?ctx(Function.call,out):out;if(IS_PROTO){(exports.virtual||(exports.virtual={}))[key]=out;if(type&$export.R&&expProto&&!expProto[key])hide(expProto,key,out)}}};$export.F=1;$export.G=2;$export.S=4;$export.P=8;$export.B=16;$export.W=32;$export.U=64;$export.R=128;module.exports=$export},{"./_core":151,"./_ctx":152,"./_global":160,"./_hide":162}],159:[function(require,module,exports){module.exports=function(exec){try{return!!exec()}catch(e){return true}}},{}],160:[function(require,module,exports){var global=module.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=global},{}],161:[function(require,module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},{}],162:[function(require,module,exports){var dP=require("./_object-dp"),createDesc=require("./_property-desc");module.exports=require("./_descriptors")?function(object,key,value){return dP.f(object,key,createDesc(1,value))}:function(object,key,value){object[key]=value;return object}},{"./_descriptors":154,"./_object-dp":177,"./_property-desc":188}],163:[function(require,module,exports){module.exports=require("./_global").document&&document.documentElement},{"./_global":160}],164:[function(require,module,exports){module.exports=!require("./_descriptors")&&!require("./_fails")(function(){return Object.defineProperty(require("./_dom-create")("div"),"a",{get:function(){return 7}}).a!=7})},{"./_descriptors":154,"./_dom-create":155,"./_fails":159}],165:[function(require,module,exports){var cof=require("./_cof");module.exports=Object("z").propertyIsEnumerable(0)?Object:function(it){return cof(it)=="String"?it.split(""):Object(it)}},{"./_cof":150}],166:[function(require,module,exports){var cof=require("./_cof");module.exports=Array.isArray||function isArray(arg){return cof(arg)=="Array"}},{"./_cof":150}],167:[function(require,module,exports){module.exports=function(it){return typeof it==="object"?it!==null:typeof it==="function"}},{}],168:[function(require,module,exports){"use strict";var create=require("./_object-create"),descriptor=require("./_property-desc"),setToStringTag=require("./_set-to-string-tag"),IteratorPrototype={};require("./_hide")(IteratorPrototype,require("./_wks")("iterator"),function(){return this});module.exports=function(Constructor,NAME,next){Constructor.prototype=create(IteratorPrototype,{next:descriptor(1,next)});setToStringTag(Constructor,NAME+" Iterator")}},{"./_hide":162,"./_object-create":176,"./_property-desc":188,"./_set-to-string-tag":191,"./_wks":204}],169:[function(require,module,exports){"use strict";var LIBRARY=require("./_library"),$export=require("./_export"),redefine=require("./_redefine"),hide=require("./_hide"),has=require("./_has"),Iterators=require("./_iterators"),$iterCreate=require("./_iter-create"),setToStringTag=require("./_set-to-string-tag"),getPrototypeOf=require("./_object-gpo"),ITERATOR=require("./_wks")("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values";var returnThis=function(){return this};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case KEYS:return function keys(){return new Constructor(this,kind)};case VALUES:return function values(){return new Constructor(this,kind)}}return function entries(){return new Constructor(this,kind)}};var TAG=NAME+" Iterator",DEF_VALUES=DEFAULT==VALUES,VALUES_BUG=false,proto=Base.prototype,$native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),$entries=DEFAULT?!DEF_VALUES?$default:getMethod("entries"):undefined,$anyNative=NAME=="Array"?proto.entries||$native:$native,methods,key,IteratorPrototype;if($anyNative){IteratorPrototype=getPrototypeOf($anyNative.call(new Base));if(IteratorPrototype!==Object.prototype){setToStringTag(IteratorPrototype,TAG,true);if(!LIBRARY&&!has(IteratorPrototype,ITERATOR))hide(IteratorPrototype,ITERATOR,returnThis)}}if(DEF_VALUES&&$native&&$native.name!==VALUES){VALUES_BUG=true;$default=function values(){return $native.call(this)}}if((!LIBRARY||FORCED)&&(BUGGY||VALUES_BUG||!proto[ITERATOR])){hide(proto,ITERATOR,$default)}Iterators[NAME]=$default;Iterators[TAG]=returnThis;if(DEFAULT){methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:$entries};if(FORCED)for(key in methods){if(!(key in proto))redefine(proto,key,methods[key])}else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods)}return methods}},{"./_export":158,"./_has":161,"./_hide":162,"./_iter-create":168,"./_iterators":171,"./_library":173,"./_object-gpo":183,"./_redefine":189,"./_set-to-string-tag":191,"./_wks":204}],170:[function(require,module,exports){module.exports=function(done,value){return{value:value,done:!!done}}},{}],171:[function(require,module,exports){module.exports={}},{}],172:[function(require,module,exports){var getKeys=require("./_object-keys"),toIObject=require("./_to-iobject");module.exports=function(object,el){var O=toIObject(object),keys=getKeys(O),length=keys.length,index=0,key;while(length>index)if(O[key=keys[index++]]===el)return key}},{"./_object-keys":185,"./_to-iobject":197}],173:[function(require,module,exports){module.exports=true},{}],174:[function(require,module,exports){module.exports=Math.sign||function sign(x){return(x=+x)==0||x!=x?x:x<0?-1:1}},{}],175:[function(require,module,exports){var META=require("./_uid")("meta"),isObject=require("./_is-object"),has=require("./_has"),setDesc=require("./_object-dp").f,id=0;var isExtensible=Object.isExtensible||function(){return true};var FREEZE=!require("./_fails")(function(){return isExtensible(Object.preventExtensions({}))});var setMeta=function(it){setDesc(it,META,{value:{i:"O"+ ++id,w:{}}})};var fastKey=function(it,create){if(!isObject(it))return typeof it=="symbol"?it:(typeof it=="string"?"S":"P")+it;if(!has(it,META)){if(!isExtensible(it))return"F";if(!create)return"E";setMeta(it)}return it[META].i};var getWeak=function(it,create){if(!has(it,META)){if(!isExtensible(it))return true;if(!create)return false;setMeta(it)}return it[META].w};var onFreeze=function(it){if(FREEZE&&meta.NEED&&isExtensible(it)&&!has(it,META))setMeta(it);return it};var meta=module.exports={KEY:META,NEED:false,fastKey:fastKey,getWeak:getWeak,onFreeze:onFreeze}},{"./_fails":159,"./_has":161,"./_is-object":167,"./_object-dp":177,"./_uid":201}],176:[function(require,module,exports){var anObject=require("./_an-object"),dPs=require("./_object-dps"),enumBugKeys=require("./_enum-bug-keys"),IE_PROTO=require("./_shared-key")("IE_PROTO"),Empty=function(){},PROTOTYPE="prototype";var createDict=function(){var iframe=require("./_dom-create")("iframe"),i=enumBugKeys.length,lt="<",gt=">",iframeDocument;iframe.style.display="none";require("./_html").appendChild(iframe);iframe.src="javascript:";iframeDocument=iframe.contentWindow.document;iframeDocument.open();iframeDocument.write(lt+"script"+gt+"document.F=Object"+lt+"/script"+gt);iframeDocument.close();createDict=iframeDocument.F;while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];return createDict()};module.exports=Object.create||function create(O,Properties){var result;if(O!==null){Empty[PROTOTYPE]=anObject(O);result=new Empty;Empty[PROTOTYPE]=null;result[IE_PROTO]=O}else result=createDict();return Properties===undefined?result:dPs(result,Properties)}},{"./_an-object":147,"./_dom-create":155,"./_enum-bug-keys":156,"./_html":163,"./_object-dps":178,"./_shared-key":192}],177:[function(require,module,exports){var anObject=require("./_an-object"),IE8_DOM_DEFINE=require("./_ie8-dom-define"),toPrimitive=require("./_to-primitive"),dP=Object.defineProperty;exports.f=require("./_descriptors")?Object.defineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(IE8_DOM_DEFINE)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");if("value"in Attributes)O[P]=Attributes.value;return O}},{"./_an-object":147,"./_descriptors":154,"./_ie8-dom-define":164,"./_to-primitive":200}],178:[function(require,module,exports){var dP=require("./_object-dp"),anObject=require("./_an-object"),getKeys=require("./_object-keys");module.exports=require("./_descriptors")?Object.defineProperties:function defineProperties(O,Properties){anObject(O);var keys=getKeys(Properties),length=keys.length,i=0,P;while(length>i)dP.f(O,P=keys[i++],Properties[P]);return O}},{"./_an-object":147,"./_descriptors":154,"./_object-dp":177,"./_object-keys":185}],179:[function(require,module,exports){var pIE=require("./_object-pie"),createDesc=require("./_property-desc"),toIObject=require("./_to-iobject"),toPrimitive=require("./_to-primitive"),has=require("./_has"),IE8_DOM_DEFINE=require("./_ie8-dom-define"),gOPD=Object.getOwnPropertyDescriptor;exports.f=require("./_descriptors")?gOPD:function getOwnPropertyDescriptor(O,P){O=toIObject(O);P=toPrimitive(P,true);if(IE8_DOM_DEFINE)try{return gOPD(O,P)}catch(e){}if(has(O,P))return createDesc(!pIE.f.call(O,P),O[P])}},{"./_descriptors":154,"./_has":161,"./_ie8-dom-define":164,"./_object-pie":186,"./_property-desc":188,"./_to-iobject":197,"./_to-primitive":200}],180:[function(require,module,exports){var toIObject=require("./_to-iobject"),gOPN=require("./_object-gopn").f,toString={}.toString;var windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var getWindowNames=function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}};module.exports.f=function getOwnPropertyNames(it){return windowNames&&toString.call(it)=="[object Window]"?getWindowNames(it):gOPN(toIObject(it))}},{"./_object-gopn":181,"./_to-iobject":197}],181:[function(require,module,exports){var $keys=require("./_object-keys-internal"),hiddenKeys=require("./_enum-bug-keys").concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return $keys(O,hiddenKeys)}},{"./_enum-bug-keys":156,"./_object-keys-internal":184}],182:[function(require,module,exports){exports.f=Object.getOwnPropertySymbols},{}],183:[function(require,module,exports){var has=require("./_has"),toObject=require("./_to-object"),IE_PROTO=require("./_shared-key")("IE_PROTO"),ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(O){O=toObject(O);if(has(O,IE_PROTO))return O[IE_PROTO];if(typeof O.constructor=="function"&&O instanceof O.constructor){return O.constructor.prototype}return O instanceof Object?ObjectProto:null}},{"./_has":161,"./_shared-key":192,"./_to-object":199}],184:[function(require,module,exports){var has=require("./_has"),toIObject=require("./_to-iobject"),arrayIndexOf=require("./_array-includes")(false),IE_PROTO=require("./_shared-key")("IE_PROTO");module.exports=function(object,names){var O=toIObject(object),i=0,result=[],key;for(key in O)if(key!=IE_PROTO)has(O,key)&&result.push(key);while(names.length>i)if(has(O,key=names[i++])){~arrayIndexOf(result,key)||result.push(key)}return result}},{"./_array-includes":148,"./_has":161,"./_shared-key":192,"./_to-iobject":197}],185:[function(require,module,exports){var $keys=require("./_object-keys-internal"),enumBugKeys=require("./_enum-bug-keys");module.exports=Object.keys||function keys(O){return $keys(O,enumBugKeys)}},{"./_enum-bug-keys":156,"./_object-keys-internal":184}],186:[function(require,module,exports){exports.f={}.propertyIsEnumerable},{}],187:[function(require,module,exports){var $export=require("./_export"),core=require("./_core"),fails=require("./_fails");module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY],exp={};exp[KEY]=exec(fn);$export($export.S+$export.F*fails(function(){fn(1)}),"Object",exp)}},{"./_core":151,"./_export":158,"./_fails":159}],188:[function(require,module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}},{}],189:[function(require,module,exports){module.exports=require("./_hide")},{"./_hide":162}],190:[function(require,module,exports){var isObject=require("./_is-object"),anObject=require("./_an-object");var check=function(O,proto){anObject(O);if(!isObject(proto)&&proto!==null)throw TypeError(proto+": can't set as prototype!")};module.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(test,buggy,set){try{set=require("./_ctx")(Function.call,require("./_object-gopd").f(Object.prototype,"__proto__").set,2);set(test,[]);buggy=!(test instanceof Array)}catch(e){buggy=true}return function setPrototypeOf(O,proto){check(O,proto);if(buggy)O.__proto__=proto;else set(O,proto);return O}}({},false):undefined),check:check}},{"./_an-object":147,"./_ctx":152,"./_is-object":167,"./_object-gopd":179}],191:[function(require,module,exports){var def=require("./_object-dp").f,has=require("./_has"),TAG=require("./_wks")("toStringTag");module.exports=function(it,tag,stat){if(it&&!has(it=stat?it:it.prototype,TAG))def(it,TAG,{configurable:true,value:tag})}},{"./_has":161,"./_object-dp":177,"./_wks":204}],192:[function(require,module,exports){var shared=require("./_shared")("keys"),uid=require("./_uid");module.exports=function(key){return shared[key]||(shared[key]=uid(key))}},{"./_shared":193,"./_uid":201}],193:[function(require,module,exports){var global=require("./_global"),SHARED="__core-js_shared__",store=global[SHARED]||(global[SHARED]={});module.exports=function(key){return store[key]||(store[key]={})}},{"./_global":160}],194:[function(require,module,exports){var toInteger=require("./_to-integer"),defined=require("./_defined");module.exports=function(TO_STRING){return function(that,pos){var s=String(defined(that)),i=toInteger(pos),l=s.length,a,b;if(i<0||i>=l)return TO_STRING?"":undefined;a=s.charCodeAt(i);return a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-55296<<10)+(b-56320)+65536}}},{"./_defined":153,"./_to-integer":196}],195:[function(require,module,exports){var toInteger=require("./_to-integer"),max=Math.max,min=Math.min;module.exports=function(index,length){index=toInteger(index);return index<0?max(index+length,0):min(index,length)}},{"./_to-integer":196}],196:[function(require,module,exports){var ceil=Math.ceil,floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)}},{}],197:[function(require,module,exports){var IObject=require("./_iobject"),defined=require("./_defined");module.exports=function(it){return IObject(defined(it))}},{"./_defined":153,"./_iobject":165}],198:[function(require,module,exports){var toInteger=require("./_to-integer"),min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),9007199254740991):0}},{"./_to-integer":196}],199:[function(require,module,exports){var defined=require("./_defined");module.exports=function(it){return Object(defined(it))}},{"./_defined":153}],200:[function(require,module,exports){var isObject=require("./_is-object");module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&typeof(fn=it.toString)=="function"&&!isObject(val=fn.call(it)))return val;if(typeof(fn=it.valueOf)=="function"&&!isObject(val=fn.call(it)))return val;if(!S&&typeof(fn=it.toString)=="function"&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":167}],201:[function(require,module,exports){var id=0,px=Math.random();module.exports=function(key){return"Symbol(".concat(key===undefined?"":key,")_",(++id+px).toString(36))}},{}],202:[function(require,module,exports){var global=require("./_global"),core=require("./_core"),LIBRARY=require("./_library"),wksExt=require("./_wks-ext"),defineProperty=require("./_object-dp").f;module.exports=function(name){var $Symbol=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});if(name.charAt(0)!="_"&&!(name in $Symbol))defineProperty($Symbol,name,{value:wksExt.f(name)})}},{"./_core":151,"./_global":160,"./_library":173,"./_object-dp":177,"./_wks-ext":203}],203:[function(require,module,exports){exports.f=require("./_wks")},{"./_wks":204}],204:[function(require,module,exports){var store=require("./_shared")("wks"),uid=require("./_uid"),Symbol=require("./_global").Symbol,USE_SYMBOL=typeof Symbol=="function";var $exports=module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:uid)("Symbol."+name))};$exports.store=store},{"./_global":160,"./_shared":193,"./_uid":201}],205:[function(require,module,exports){var classof=require("./_classof"),ITERATOR=require("./_wks")("iterator"),Iterators=require("./_iterators");module.exports=require("./_core").getIteratorMethod=function(it){if(it!=undefined)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},{"./_classof":149,"./_core":151,"./_iterators":171,"./_wks":204}],206:[function(require,module,exports){var anObject=require("./_an-object"),get=require("./core.get-iterator-method");module.exports=require("./_core").getIterator=function(it){var iterFn=get(it);if(typeof iterFn!="function")throw TypeError(it+" is not iterable!");return anObject(iterFn.call(it))}},{"./_an-object":147,"./_core":151,"./core.get-iterator-method":205}],207:[function(require,module,exports){var classof=require("./_classof"),ITERATOR=require("./_wks")("iterator"),Iterators=require("./_iterators");module.exports=require("./_core").isIterable=function(it){var O=Object(it);return O[ITERATOR]!==undefined||"@@iterator"in O||Iterators.hasOwnProperty(classof(O))}},{"./_classof":149,"./_core":151,"./_iterators":171,"./_wks":204}],208:[function(require,module,exports){"use strict";var addToUnscopables=require("./_add-to-unscopables"),step=require("./_iter-step"),Iterators=require("./_iterators"),toIObject=require("./_to-iobject");module.exports=require("./_iter-define")(Array,"Array",function(iterated,kind){this._t=toIObject(iterated);this._i=0;this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;if(!O||index>=O.length){this._t=undefined;return step(1)}if(kind=="keys")return step(0,index);if(kind=="values")return step(0,O[index]);return step(0,[index,O[index]])},"values");Iterators.Arguments=Iterators.Array;addToUnscopables("keys");addToUnscopables("values");addToUnscopables("entries")},{"./_add-to-unscopables":146,"./_iter-define":169,"./_iter-step":170,"./_iterators":171,"./_to-iobject":197}],209:[function(require,module,exports){var $export=require("./_export");$export($export.S,"Math",{sign:require("./_math-sign")})},{"./_export":158,"./_math-sign":174}],210:[function(require,module,exports){var $export=require("./_export");$export($export.S,"Object",{create:require("./_object-create")})},{"./_export":158,"./_object-create":176}],211:[function(require,module,exports){var $export=require("./_export");$export($export.S+$export.F*!require("./_descriptors"),"Object",{defineProperty:require("./_object-dp").f})},{"./_descriptors":154,"./_export":158,"./_object-dp":177}],212:[function(require,module,exports){var toObject=require("./_to-object"),$getPrototypeOf=require("./_object-gpo");require("./_object-sap")("getPrototypeOf",function(){return function getPrototypeOf(it){return $getPrototypeOf(toObject(it))}})},{"./_object-gpo":183,"./_object-sap":187,"./_to-object":199}],213:[function(require,module,exports){var toObject=require("./_to-object"),$keys=require("./_object-keys");require("./_object-sap")("keys",function(){return function keys(it){return $keys(toObject(it))}})},{"./_object-keys":185,"./_object-sap":187,"./_to-object":199}],214:[function(require,module,exports){var $export=require("./_export");$export($export.S,"Object",{setPrototypeOf:require("./_set-proto").set})},{"./_export":158,"./_set-proto":190}],215:[function(require,module,exports){},{}],216:[function(require,module,exports){"use strict";var $at=require("./_string-at")(true);require("./_iter-define")(String,"String",function(iterated){this._t=String(iterated);this._i=0},function(){var O=this._t,index=this._i,point;if(index>=O.length)return{value:undefined,done:true};point=$at(O,index);this._i+=point.length;return{value:point,done:false}})},{"./_iter-define":169,"./_string-at":194}],217:[function(require,module,exports){"use strict";var global=require("./_global"),has=require("./_has"),DESCRIPTORS=require("./_descriptors"),$export=require("./_export"),redefine=require("./_redefine"),META=require("./_meta").KEY,$fails=require("./_fails"),shared=require("./_shared"),setToStringTag=require("./_set-to-string-tag"),uid=require("./_uid"),wks=require("./_wks"),wksExt=require("./_wks-ext"),wksDefine=require("./_wks-define"),keyOf=require("./_keyof"),enumKeys=require("./_enum-keys"),isArray=require("./_is-array"),anObject=require("./_an-object"),toIObject=require("./_to-iobject"),toPrimitive=require("./_to-primitive"),createDesc=require("./_property-desc"),_create=require("./_object-create"),gOPNExt=require("./_object-gopn-ext"),$GOPD=require("./_object-gopd"),$DP=require("./_object-dp"),$keys=require("./_object-keys"),gOPD=$GOPD.f,dP=$DP.f,gOPN=gOPNExt.f,$Symbol=global.Symbol,$JSON=global.JSON,_stringify=$JSON&&$JSON.stringify,PROTOTYPE="prototype",HIDDEN=wks("_hidden"),TO_PRIMITIVE=wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=shared("symbol-registry"),AllSymbols=shared("symbols"),OPSymbols=shared("op-symbols"),ObjectProto=Object[PROTOTYPE],USE_NATIVE=typeof $Symbol=="function",QObject=global.QObject;var setter=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild;var setSymbolDesc=DESCRIPTORS&&$fails(function(){return _create(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a!=7})?function(it,key,D){var protoDesc=gOPD(ObjectProto,key);if(protoDesc)delete ObjectProto[key];dP(it,key,D);if(protoDesc&&it!==ObjectProto)dP(ObjectProto,key,protoDesc)}:dP;var wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol[PROTOTYPE]);sym._k=tag;return sym};var isSymbol=USE_NATIVE&&typeof $Symbol.iterator=="symbol"?function(it){return typeof it=="symbol"}:function(it){return it instanceof $Symbol};var $defineProperty=function defineProperty(it,key,D){if(it===ObjectProto)$defineProperty(OPSymbols,key,D);anObject(it);key=toPrimitive(key,true);anObject(D);if(has(AllSymbols,key)){if(!D.enumerable){if(!has(it,HIDDEN))dP(it,HIDDEN,createDesc(1,{}));it[HIDDEN][key]=true}else{if(has(it,HIDDEN)&&it[HIDDEN][key])it[HIDDEN][key]=false;D=_create(D,{enumerable:createDesc(0,false)})}return setSymbolDesc(it,key,D)}return dP(it,key,D)};var $defineProperties=function defineProperties(it,P){anObject(it);var keys=enumKeys(P=toIObject(P)),i=0,l=keys.length,key;while(l>i)$defineProperty(it,key=keys[i++],P[key]);return it};var $create=function create(it,P){return P===undefined?_create(it):$defineProperties(_create(it),P)};var $propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=toPrimitive(key,true));if(this===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))return false;return E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key]?E:true};var $getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){it=toIObject(it);key=toPrimitive(key,true);if(it===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))return;var D=gOPD(it,key);if(D&&has(AllSymbols,key)&&!(has(it,HIDDEN)&&it[HIDDEN][key]))D.enumerable=true;return D};var $getOwnPropertyNames=function getOwnPropertyNames(it){var names=gOPN(toIObject(it)),result=[],i=0,key;while(names.length>i){if(!has(AllSymbols,key=names[i++])&&key!=HIDDEN&&key!=META)result.push(key)}return result};var $getOwnPropertySymbols=function getOwnPropertySymbols(it){var IS_OP=it===ObjectProto,names=gOPN(IS_OP?OPSymbols:toIObject(it)),result=[],i=0,key;while(names.length>i){if(has(AllSymbols,key=names[i++])&&(IS_OP?has(ObjectProto,key):true))result.push(AllSymbols[key])}return result};if(!USE_NATIVE){$Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var tag=uid(arguments.length>0?arguments[0]:undefined);var $set=function(value){if(this===ObjectProto)$set.call(OPSymbols,value);if(has(this,HIDDEN)&&has(this[HIDDEN],tag))this[HIDDEN][tag]=false;setSymbolDesc(this,tag,createDesc(1,value))};if(DESCRIPTORS&&setter)setSymbolDesc(ObjectProto,tag,{configurable:true,set:$set});return wrap(tag)};redefine($Symbol[PROTOTYPE],"toString",function toString(){return this._k});$GOPD.f=$getOwnPropertyDescriptor;$DP.f=$defineProperty;require("./_object-gopn").f=gOPNExt.f=$getOwnPropertyNames;require("./_object-pie").f=$propertyIsEnumerable;require("./_object-gops").f=$getOwnPropertySymbols;if(DESCRIPTORS&&!require("./_library")){redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,true)}wksExt.f=function(name){return wrap(wks(name))}}$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),i=0;symbols.length>i;)wks(symbols[i++]);for(var symbols=$keys(wks.store),i=0;symbols.length>i;)wksDefine(symbols[i++]);$export($export.S+$export.F*!USE_NATIVE,"Symbol",{for:function(key){return has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function keyFor(key){if(isSymbol(key))return keyOf(SymbolRegistry,key);throw TypeError(key+" is not a symbol!")},useSetter:function(){setter=true},useSimple:function(){setter=false}});$export($export.S+$export.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var S=$Symbol();return _stringify([S])!="[null]"||_stringify({a:S})!="{}"||_stringify(Object(S))!="{}"})),"JSON",{stringify:function stringify(it){if(it===undefined||isSymbol(it))return;var args=[it],i=1,replacer,$replacer;while(arguments.length>i)args.push(arguments[i++]);replacer=args[1];if(typeof replacer=="function")$replacer=replacer;if($replacer||!isArray(replacer))replacer=function(key,value){if($replacer)value=$replacer.call(this,key,value);if(!isSymbol(value))return value};args[1]=replacer;return _stringify.apply($JSON,args)}});$Symbol[PROTOTYPE][TO_PRIMITIVE]||require("./_hide")($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf);setToStringTag($Symbol,"Symbol");setToStringTag(Math,"Math",true);setToStringTag(global.JSON,"JSON",true)},{"./_an-object":147,"./_descriptors":154,"./_enum-keys":157,"./_export":158,"./_fails":159,"./_global":160,"./_has":161,"./_hide":162,"./_is-array":166,"./_keyof":172,"./_library":173,"./_meta":175,"./_object-create":176,"./_object-dp":177,"./_object-gopd":179,"./_object-gopn":181,"./_object-gopn-ext":180,"./_object-gops":182,"./_object-keys":185,"./_object-pie":186,"./_property-desc":188,"./_redefine":189,"./_set-to-string-tag":191,"./_shared":193,"./_to-iobject":197,"./_to-primitive":200,"./_uid":201,"./_wks":204,"./_wks-define":202,"./_wks-ext":203}],218:[function(require,module,exports){require("./_wks-define")("asyncIterator")},{"./_wks-define":202}],219:[function(require,module,exports){require("./_wks-define")("observable")},{"./_wks-define":202}],220:[function(require,module,exports){require("./es6.array.iterator");var global=require("./_global"),hide=require("./_hide"),Iterators=require("./_iterators"),TO_STRING_TAG=require("./_wks")("toStringTag");for(var collections=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],i=0;i<5;i++){var NAME=collections[i],Collection=global[NAME],proto=Collection&&Collection.prototype;if(proto&&!proto[TO_STRING_TAG])hide(proto,TO_STRING_TAG,NAME);Iterators[NAME]=Iterators.Array}},{"./_global":160,"./_hide":162,"./_iterators":171,"./_wks":204,"./es6.array.iterator":208}],221:[function(require,module,exports){module.exports=Emitter;function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks[event]=this._callbacks[event]||[]).push(fn);
return this};Emitter.prototype.once=function(event,fn){var self=this;this._callbacks=this._callbacks||{};function on(){self.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks[event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks[event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],222:[function(require,module,exports){(function(window,document,exportName,undefined){"use strict";var VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"];var TEST_ELEMENT=document.createElement("div");var TYPE_FUNCTION="function";var round=Math.round;var abs=Math.abs;var now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){if(Array.isArray(arg)){each(arg,context[fn],context);return true}return false}function each(obj,iterator,context){var i;if(!obj){return}if(obj.forEach){obj.forEach(iterator,context)}else if(obj.length!==undefined){i=0;while(i<obj.length){iterator.call(context,obj[i],i,obj);i++}}else{for(i in obj){obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}}}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace");var stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace";var log=window.console&&(window.console.warn||window.console.log);if(log){log.call(window.console,deprecationMessage,stack)}return method.apply(this,arguments)}}var assign;if(typeof Object.assign!=="function"){assign=function assign(target){if(target===undefined||target===null){throw new TypeError("Cannot convert undefined or null to object")}var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null){for(var nextKey in source){if(source.hasOwnProperty(nextKey)){output[nextKey]=source[nextKey]}}}}return output}}else{assign=Object.assign}var extend=deprecate(function extend(dest,src,merge){var keys=Object.keys(src);var i=0;while(i<keys.length){if(!merge||merge&&dest[keys[i]]===undefined){dest[keys[i]]=src[keys[i]]}i++}return dest},"extend","Use `assign`.");var merge=deprecate(function merge(dest,src){return extend(dest,src,true)},"merge","Use `assign`.");function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP);childP.constructor=child;childP._super=baseP;if(properties){assign(childP,properties)}}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments)}}function boolOrFn(val,args){if(typeof val==TYPE_FUNCTION){return val.apply(args?args[0]||undefined:undefined,args)}return val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,false)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,false)})}function hasParent(node,parent){while(node){if(node==parent){return true}node=node.parentNode}return false}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey){return src.indexOf(find)}else{var i=0;while(i<src.length){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find){return i}i++}return-1}}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){var results=[];var values=[];var i=0;while(i<src.length){var val=key?src[i][key]:src[i];if(inArray(values,val)<0){results.push(src[i])}values[i]=val;i++}if(sort){if(!key){results=results.sort()}else{results=results.sort(function sortUniqueArray(a,b){return a[key]>b[key]})}}return results}function prefixed(obj,property){var prefix,prop;var camelProp=property[0].toUpperCase()+property.slice(1);var i=0;while(i<VENDOR_PREFIXES.length){prefix=VENDOR_PREFIXES[i];prop=prefix?prefix+camelProp:property;if(prop in obj){return prop}i++}return undefined}var _uniqueId=1;function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}var MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;var SUPPORT_TOUCH="ontouchstart"in window;var SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined;var SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent);var INPUT_TYPE_TOUCH="touch";var INPUT_TYPE_PEN="pen";var INPUT_TYPE_MOUSE="mouse";var INPUT_TYPE_KINECT="kinect";var COMPUTE_INTERVAL=25;var INPUT_START=1;var INPUT_MOVE=2;var INPUT_END=4;var INPUT_CANCEL=8;var DIRECTION_NONE=1;var DIRECTION_LEFT=2;var DIRECTION_RIGHT=4;var DIRECTION_UP=8;var DIRECTION_DOWN=16;var DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT;var DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN;var DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL;var PROPS_XY=["x","y"];var PROPS_CLIENT_XY=["clientX","clientY"];function Input(manager,callback){var self=this;this.manager=manager;this.callback=callback;this.element=manager.element;this.target=manager.options.inputTarget;this.domHandler=function(ev){if(boolOrFn(manager.options.enable,[manager])){self.handler(ev)}};this.init()}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};function createInputInstance(manager){var Type;var inputClass=manager.options.inputClass;if(inputClass){Type=inputClass}else if(SUPPORT_POINTER_EVENTS){Type=PointerEventInput}else if(SUPPORT_ONLY_TOUCH){Type=TouchInput}else if(!SUPPORT_TOUCH){Type=MouseInput}else{Type=TouchMouseInput}return new Type(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length;var changedPointersLen=input.changedPointers.length;var isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0;var isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst;input.isFinal=!!isFinal;if(isFirst){manager.session={}}input.eventType=eventType;computeInputData(manager,input);manager.emit("hammer.input",input);manager.recognize(input);manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session;var pointers=input.pointers;var pointersLength=pointers.length;if(!session.firstInput){session.firstInput=simpleCloneInputData(input)}if(pointersLength>1&&!session.firstMultiple){session.firstMultiple=simpleCloneInputData(input)}else if(pointersLength===1){session.firstMultiple=false}var firstInput=session.firstInput;var firstMultiple=session.firstMultiple;var offsetCenter=firstMultiple?firstMultiple.center:firstInput.center;var center=input.center=getCenter(pointers);input.timeStamp=now();input.deltaTime=input.timeStamp-firstInput.timeStamp;input.angle=getAngle(offsetCenter,center);input.distance=getDistance(offsetCenter,center);computeDeltaXY(session,input);input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x;input.overallVelocityY=overallVelocity.y;input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y;input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1;input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0;input.maxPointers=!session.prevInput?input.pointers.length:input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers;computeIntervalInputData(session,input);var target=manager.element;if(hasParent(input.srcEvent.target,target)){target=input.srcEvent.target}input.target=target}function computeDeltaXY(session,input){var center=input.center;var offset=session.offsetDelta||{};var prevDelta=session.prevDelta||{};var prevInput=session.prevInput||{};if(input.eventType===INPUT_START||prevInput.eventType===INPUT_END){prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0};offset=session.offsetDelta={x:center.x,y:center.y}}input.deltaX=prevDelta.x+(center.x-offset.x);input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX;var deltaY=input.deltaY-last.deltaY;var v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x;velocityY=v.y;velocity=abs(v.x)>abs(v.y)?v.x:v.y;direction=getDirection(deltaX,deltaY);session.lastInterval=input}else{velocity=last.velocity;velocityX=last.velocityX;velocityY=last.velocityY;direction=last.direction}input.velocity=velocity;input.velocityX=velocityX;input.velocityY=velocityY;input.direction=direction}function simpleCloneInputData(input){var pointers=[];var i=0;while(i<input.pointers.length){pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)};i++}return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1){return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)}}var x=0,y=0,i=0;while(i<pointersLength){x+=pointers[i].clientX;y+=pointers[i].clientY;i++}return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){if(x===y){return DIRECTION_NONE}if(abs(x)>=abs(y)){return x<0?DIRECTION_LEFT:DIRECTION_RIGHT}return y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){if(!props){props=PROPS_XY}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){if(!props){props=PROPS_XY}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END};var MOUSE_ELEMENT_EVENTS="mousedown";var MOUSE_WINDOW_EVENTS="mousemove mouseup";function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS;this.evWin=MOUSE_WINDOW_EVENTS;this.pressed=false;Input.apply(this,arguments)}inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];if(eventType&INPUT_START&&ev.button===0){this.pressed=true}if(eventType&INPUT_MOVE&&ev.which!==1){eventType=INPUT_END}if(!this.pressed){return}if(eventType&INPUT_END){this.pressed=false}this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev})}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL};var IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};var POINTER_ELEMENT_EVENTS="pointerdown";var POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";if(window.MSPointerEvent&&!window.PointerEvent){POINTER_ELEMENT_EVENTS="MSPointerDown";POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS;this.evWin=POINTER_WINDOW_EVENTS;Input.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store;var removePointer=false;var eventTypeNormalized=ev.type.toLowerCase().replace("ms","");var eventType=POINTER_INPUT_MAP[eventTypeNormalized];var pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType;var isTouch=pointerType==INPUT_TYPE_TOUCH;var storeIndex=inArray(store,ev.pointerId,"pointerId");if(eventType&INPUT_START&&(ev.button===0||isTouch)){if(storeIndex<0){store.push(ev);storeIndex=store.length-1}}else if(eventType&(INPUT_END|INPUT_CANCEL)){removePointer=true}if(storeIndex<0){return}store[storeIndex]=ev;this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev});if(removePointer){store.splice(storeIndex,1)}}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var SINGLE_TOUCH_TARGET_EVENTS="touchstart";var SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS;this.evWin=SINGLE_TOUCH_WINDOW_EVENTS;this.started=false;Input.apply(this,arguments)}inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START){this.started=true}if(!this.started){return}var touches=normalizeSingleTouches.call(this,ev,type);if(type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0){this.started=false}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function normalizeSingleTouches(ev,type){var all=toArray(ev.touches);var changed=toArray(ev.changedTouches);if(type&(INPUT_END|INPUT_CANCEL)){all=uniqueArray(all.concat(changed),"identifier",true)}return[all,changed]}var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};var TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS;this.targetIds={};Input.apply(this,arguments)}inherit(TouchInput,Input,{handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type];var touches=getTouches.call(this,ev,type);if(!touches){return}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function getTouches(ev,type){var allTouches=toArray(ev.touches);var targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1){targetIds[allTouches[0].identifier]=true;return[allTouches,allTouches]}var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)});if(type===INPUT_START){i=0;while(i<targetTouches.length){targetIds[targetTouches[i].identifier]=true;i++}}i=0;while(i<changedTouches.length){if(targetIds[changedTouches[i].identifier]){changedTargetTouches.push(changedTouches[i])}if(type&(INPUT_END|INPUT_CANCEL)){delete targetIds[changedTouches[i].identifier]}i++}if(!changedTargetTouches.length){return}return[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",true),changedTargetTouches]}var DEDUP_TIMEOUT=2500;var DEDUP_DISTANCE=25;function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler);this.mouse=new MouseInput(this.manager,handler);this.primaryTouch=null;this.lastTouches=[]}inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents){return}if(isTouch){recordTouches.call(this,inputEvent,inputData)}else if(isMouse&&isSyntheticEvent.call(this,inputData)){return}this.callback(manager,inputEvent,inputData)},destroy:function destroy(){this.touch.destroy();this.mouse.destroy()}});function recordTouches(eventType,eventData){if(eventType&INPUT_START){this.primaryTouch=eventData.changedPointers[0].identifier;setLastTouch.call(this,eventData)}else if(eventType&(INPUT_END|INPUT_CANCEL)){setLastTouch.call(this,eventData)}}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches;var removeLastTouch=function(){var i=lts.indexOf(lastTouch);if(i>-1){lts.splice(i,1)}};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY;for(var i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i];var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE){return true}}return false}var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction");var NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined;var TOUCH_ACTION_COMPUTE="compute";var TOUCH_ACTION_AUTO="auto";var TOUCH_ACTION_MANIPULATION="manipulation";var TOUCH_ACTION_NONE="none";var TOUCH_ACTION_PAN_X="pan-x";var TOUCH_ACTION_PAN_Y="pan-y";var TOUCH_ACTION_MAP=getTouchActionProps();function TouchAction(manager,value){this.manager=manager;this.set(value)}TouchAction.prototype={set:function(value){if(value==TOUCH_ACTION_COMPUTE){value=this.compute()}if(NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]){this.manager.element.style[PREFIXED_TOUCH_ACTION]=value}this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];each(this.manager.recognizers,function(recognizer){if(boolOrFn(recognizer.options.enable,[recognizer])){actions=actions.concat(recognizer.getTouchAction())}});return cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent;var direction=input.offsetDirection;if(this.manager.session.prevented){srcEvent.preventDefault();return}var actions=this.actions;var hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=input.pointers.length===1;var isTapMovement=input.distance<2;var isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime){return}}if(hasPanX&&hasPanY){return}if(hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL){return this.preventSrc(srcEvent)}},preventSrc:function(srcEvent){this.manager.session.prevented=true;srcEvent.preventDefault()}};function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE)){return TOUCH_ACTION_NONE}var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);if(hasPanX&&hasPanY){return TOUCH_ACTION_NONE}if(hasPanX||hasPanY){return hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y}if(inStr(actions,TOUCH_ACTION_MANIPULATION)){return TOUCH_ACTION_MANIPULATION}return TOUCH_ACTION_AUTO}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION){return false}var touchMap={};var cssSupports=window.CSS&&window.CSS.supports;["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=cssSupports?window.CSS.supports("touch-action",val):true});return touchMap}var STATE_POSSIBLE=1;var STATE_BEGAN=2;var STATE_CHANGED=4;var STATE_ENDED=8;var STATE_RECOGNIZED=STATE_ENDED;var STATE_CANCELLED=16;var STATE_FAILED=32;function Recognizer(options){this.options=assign({},this.defaults,options||{});this.id=uniqueId();this.manager=null;this.options.enable=ifUndefined(this.options.enable,true);this.state=STATE_POSSIBLE;this.simultaneous={};this.requireFail=[]}Recognizer.prototype={defaults:{},set:function(options){assign(this.options,options);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this)){return this}var simultaneous=this.simultaneous;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(!simultaneous[otherRecognizer.id]){simultaneous[otherRecognizer.id]=otherRecognizer;otherRecognizer.recognizeWith(this)}return this},dropRecognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)){return this}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);delete this.simultaneous[otherRecognizer.id];return this},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this)){return this}var requireFail=this.requireFail;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(inArray(requireFail,otherRecognizer)===-1){requireFail.push(otherRecognizer);otherRecognizer.requireFailure(this)}return this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this)){return this}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);if(index>-1){this.requireFail.splice(index,1)}return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){var self=this;var state=this.state;function emit(event){self.manager.emit(event,input)}if(state<STATE_ENDED){emit(self.options.event+stateStr(state))}emit(self.options.event);if(input.additionalEvent){emit(input.additionalEvent)}if(state>=STATE_ENDED){emit(self.options.event+stateStr(state))}},tryEmit:function(input){if(this.canEmit()){return this.emit(input)}this.state=STATE_FAILED},canEmit:function(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE))){return false}i++}return true},recognize:function(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset();this.state=STATE_FAILED;return}if(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)){this.state=STATE_POSSIBLE}this.state=this.process(inputDataClone);if(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)){this.tryEmit(inputDataClone)}},process:function(inputData){},getTouchAction:function(){},reset:function(){}};function stateStr(state){if(state&STATE_CANCELLED){return"cancel"}else if(state&STATE_ENDED){return"end"}else if(state&STATE_CHANGED){return"move"}else if(state&STATE_BEGAN){return"start"}return""}function directionStr(direction){if(direction==DIRECTION_DOWN){return"down"}else if(direction==DIRECTION_UP){return"up"}else if(direction==DIRECTION_LEFT){return"left"}else if(direction==DIRECTION_RIGHT){return"right"}return""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;if(manager){return manager.get(otherRecognizer)}return otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers},process:function(input){var state=this.state;var eventType=input.eventType;var isRecognized=state&(STATE_BEGAN|STATE_CHANGED);var isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL||!isValid)){return state|STATE_CANCELLED}else if(isRecognized||isValid){if(eventType&INPUT_END){return state|STATE_ENDED}else if(!(state&STATE_BEGAN)){return STATE_BEGAN}return state|STATE_CHANGED}return STATE_FAILED}});function PanRecognizer(){AttrRecognizer.apply(this,arguments);this.pX=null;this.pY=null}inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction;var actions=[];if(direction&DIRECTION_HORIZONTAL){actions.push(TOUCH_ACTION_PAN_Y)}if(direction&DIRECTION_VERTICAL){actions.push(TOUCH_ACTION_PAN_X)}return actions},directionTest:function(input){var options=this.options;var hasMoved=true;var distance=input.distance;var direction=input.direction;var x=input.deltaX;var y=input.deltaY;if(!(direction&options.direction)){if(options.direction&DIRECTION_HORIZONTAL){direction=x===0?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT;hasMoved=x!=this.pX;distance=Math.abs(input.deltaX)}else{direction=y===0?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN;hasMoved=y!=this.pY;distance=Math.abs(input.deltaY)}}input.direction=direction;return hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX;this.pY=input.deltaY;var direction=directionStr(input.direction);if(direction){input.additionalEvent=this.options.event+direction}this._super.emit.call(this,input)}});function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(input.scale!==1){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}});function PressRecognizer(){Recognizer.apply(this,arguments);this._timer=null;this._input=null}inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTime=input.deltaTime>options.time;this._input=input;if(!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime){this.reset()}else if(input.eventType&INPUT_START){this.reset();this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.time,this)}else if(input.eventType&INPUT_END){return STATE_RECOGNIZED}return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){if(this.state!==STATE_RECOGNIZED){return}if(input&&input.eventType&INPUT_END){this.manager.emit(this.options.event+"up",input)}else{this._input.timeStamp=now();this.manager.emit(this.options.event,this._input)}}});function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}});function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var direction=this.options.direction;var velocity;if(direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)){velocity=input.overallVelocity}else if(direction&DIRECTION_HORIZONTAL){velocity=input.overallVelocityX}else if(direction&DIRECTION_VERTICAL){velocity=input.overallVelocityY}return this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);if(direction){this.manager.emit(this.options.event+direction,input)}this.manager.emit(this.options.event,input)}});function TapRecognizer(){Recognizer.apply(this,arguments);this.pTime=false;this.pCenter=false;this._timer=null;this._input=null;this.count=0}inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTouchTime=input.deltaTime<options.time;this.reset();if(input.eventType&INPUT_START&&this.count===0){return this.failTimeout()}if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END){return this.failTimeout()}var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:true;var validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp;this.pCenter=input.center;if(!validMultiTap||!validInterval){this.count=1}else{this.count+=1}this._input=input;var tapCount=this.count%options.taps;if(tapCount===0){if(!this.hasRequireFailures()){return STATE_RECOGNIZED}else{this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.interval,this);return STATE_BEGAN}}}return STATE_FAILED},failTimeout:function(){this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this);return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){if(this.state==STATE_RECOGNIZED){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function Hammer(element,options){options=options||{};options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset);return new Manager(element,options)}Hammer.VERSION="2.0.7";Hammer.defaults={domEvents:false,touchAction:TOUCH_ACTION_COMPUTE,enable:true,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:false}],[PinchRecognizer,{enable:false},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1;var FORCED_STOP=2;function Manager(element,options){this.options=assign({},Hammer.defaults,options||{});this.options.inputTarget=this.options.inputTarget||element;this.handlers={};this.session={};this.recognizers=[];this.oldCssProps={};this.element=element;this.input=createInputInstance(this);this.touchAction=new TouchAction(this,this.options.touchAction);toggleCssProps(this,true);each(this.options.recognizers,function(item){
var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]);item[3]&&recognizer.requireFailure(item[3])},this)}Manager.prototype={set:function(options){assign(this.options,options);if(options.touchAction){this.touchAction.update()}if(options.inputTarget){this.input.destroy();this.input.target=options.inputTarget;this.input.init()}return this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(session.stopped){return}this.touchAction.preventDefaults(inputData);var recognizer;var recognizers=this.recognizers;var curRecognizer=session.curRecognizer;if(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED){curRecognizer=session.curRecognizer=null}var i=0;while(i<recognizers.length){recognizer=recognizers[i];if(session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer))){recognizer.recognize(inputData)}else{recognizer.reset()}if(!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)){curRecognizer=session.curRecognizer=recognizer}i++}},get:function(recognizer){if(recognizer instanceof Recognizer){return recognizer}var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++){if(recognizers[i].options.event==recognizer){return recognizers[i]}}return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this)){return this}var existing=this.get(recognizer.options.event);if(existing){this.remove(existing)}this.recognizers.push(recognizer);recognizer.manager=this;this.touchAction.update();return recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this)){return this}recognizer=this.get(recognizer);if(recognizer){var recognizers=this.recognizers;var index=inArray(recognizers,recognizer);if(index!==-1){recognizers.splice(index,1);this.touchAction.update()}}return this},on:function(events,handler){if(events===undefined){return}if(handler===undefined){return}var handlers=this.handlers;each(splitStr(events),function(event){handlers[event]=handlers[event]||[];handlers[event].push(handler)});return this},off:function(events,handler){if(events===undefined){return}var handlers=this.handlers;each(splitStr(events),function(event){if(!handler){delete handlers[event]}else{handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1)}});return this},emit:function(event,data){if(this.options.domEvents){triggerDomEvent(event,data)}var handlers=this.handlers[event]&&this.handlers[event].slice();if(!handlers||!handlers.length){return}data.type=event;data.preventDefault=function(){data.srcEvent.preventDefault()};var i=0;while(i<handlers.length){handlers[i](data);i++}},destroy:function(){this.element&&toggleCssProps(this,false);this.handlers={};this.session={};this.input.destroy();this.element=null}};function toggleCssProps(manager,add){var element=manager.element;if(!element.style){return}var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name);if(add){manager.oldCssProps[prop]=element.style[prop];element.style[prop]=value}else{element.style[prop]=manager.oldCssProps[prop]||""}});if(!add){manager.oldCssProps={}}}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,true,true);gestureEvent.gesture=data;data.target.dispatchEvent(gestureEvent)}assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};freeGlobal.Hammer=Hammer;if(typeof define==="function"&&define.amd){define(function(){return Hammer})}else if(typeof module!="undefined"&&module.exports){module.exports=Hammer}else{window[exportName]=Hammer}})(window,document,"Hammer")},{}],223:[function(require,module,exports){"use strict";(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else if(typeof exports==="object"){module.exports=factory()}else{root.keycharm=factory()}})(this,function(){function keycharm(options){var preventDefault=options&&options.preventDefault||false;var container=options&&options.container||window;var _exportFunctions={};var _bound={keydown:{},keyup:{}};var _keys={};var i;for(i=97;i<=122;i++){_keys[String.fromCharCode(i)]={code:65+(i-97),shift:false}}for(i=65;i<=90;i++){_keys[String.fromCharCode(i)]={code:i,shift:true}}for(i=0;i<=9;i++){_keys[""+i]={code:48+i,shift:false}}for(i=1;i<=12;i++){_keys["F"+i]={code:111+i,shift:false}}for(i=0;i<=9;i++){_keys["num"+i]={code:96+i,shift:false}}_keys["num*"]={code:106,shift:false};_keys["num+"]={code:107,shift:false};_keys["num-"]={code:109,shift:false};_keys["num/"]={code:111,shift:false};_keys["num."]={code:110,shift:false};_keys["left"]={code:37,shift:false};_keys["up"]={code:38,shift:false};_keys["right"]={code:39,shift:false};_keys["down"]={code:40,shift:false};_keys["space"]={code:32,shift:false};_keys["enter"]={code:13,shift:false};_keys["shift"]={code:16,shift:undefined};_keys["esc"]={code:27,shift:false};_keys["backspace"]={code:8,shift:false};_keys["tab"]={code:9,shift:false};_keys["ctrl"]={code:17,shift:false};_keys["alt"]={code:18,shift:false};_keys["delete"]={code:46,shift:false};_keys["pageup"]={code:33,shift:false};_keys["pagedown"]={code:34,shift:false};_keys["="]={code:187,shift:false};_keys["-"]={code:189,shift:false};_keys["]"]={code:221,shift:false};_keys["["]={code:219,shift:false};var down=function(event){handleEvent(event,"keydown")};var up=function(event){handleEvent(event,"keyup")};var handleEvent=function(event,type){if(_bound[type][event.keyCode]!==undefined){var bound=_bound[type][event.keyCode];for(var i=0;i<bound.length;i++){if(bound[i].shift===undefined){bound[i].fn(event)}else if(bound[i].shift==true&&event.shiftKey==true){bound[i].fn(event)}else if(bound[i].shift==false&&event.shiftKey==false){bound[i].fn(event)}}if(preventDefault==true){event.preventDefault()}}};_exportFunctions.bind=function(key,callback,type){if(type===undefined){type="keydown"}if(_keys[key]===undefined){throw new Error("unsupported key: "+key)}if(_bound[type][_keys[key].code]===undefined){_bound[type][_keys[key].code]=[]}_bound[type][_keys[key].code].push({fn:callback,shift:_keys[key].shift})};_exportFunctions.bindAll=function(callback,type){if(type===undefined){type="keydown"}for(var key in _keys){if(_keys.hasOwnProperty(key)){_exportFunctions.bind(key,callback,type)}}};_exportFunctions.getKey=function(event){for(var key in _keys){if(_keys.hasOwnProperty(key)){if(event.shiftKey==true&&_keys[key].shift==true&&event.keyCode==_keys[key].code){return key}else if(event.shiftKey==false&&_keys[key].shift==false&&event.keyCode==_keys[key].code){return key}else if(event.keyCode==_keys[key].code&&key=="shift"){return key}}}return"unknown key, currently not supported"};_exportFunctions.unbind=function(key,callback,type){if(type===undefined){type="keydown"}if(_keys[key]===undefined){throw new Error("unsupported key: "+key)}if(callback!==undefined){var newBindings=[];var bound=_bound[type][_keys[key].code];if(bound!==undefined){for(var i=0;i<bound.length;i++){if(!(bound[i].fn==callback&&bound[i].shift==_keys[key].shift)){newBindings.push(_bound[type][_keys[key].code][i])}}}_bound[type][_keys[key].code]=newBindings}else{_bound[type][_keys[key].code]=[]}};_exportFunctions.reset=function(){_bound={keydown:{},keyup:{}}};_exportFunctions.destroy=function(){_bound={keydown:{},keyup:{}};container.removeEventListener("keydown",down,true);container.removeEventListener("keyup",up,true)};container.addEventListener("keydown",down,true);container.addEventListener("keyup",up,true);return _exportFunctions}return keycharm})},{}],224:[function(require,module,exports){"use strict";(function(factory){if(typeof define==="function"&&define.amd){define([],factory)}else if(typeof exports==="object"){module.exports=factory()}else{window.propagating=factory()}})(function(){var _firstTarget=null;return function propagating(hammer,options){var _options=options||{preventDefault:false};if(hammer.Manager){var Hammer=hammer;var PropagatingHammer=function(element,options){var o=Object.create(_options);if(options)Hammer.assign(o,options);return propagating(new Hammer(element,o),o)};Hammer.assign(PropagatingHammer,Hammer);PropagatingHammer.Manager=function(element,options){var o=Object.create(_options);if(options)Hammer.assign(o,options);return propagating(new Hammer.Manager(element,o),o)};return PropagatingHammer}var wrapper=Object.create(hammer);var element=hammer.element;if(!element.hammer)element.hammer=[];element.hammer.push(wrapper);hammer.on("hammer.input",function(event){if(_options.preventDefault===true||_options.preventDefault===event.pointerType){event.preventDefault()}if(event.isFirst){_firstTarget=event.target}});wrapper._handlers={};wrapper.on=function(events,handler){split(events).forEach(function(event){var _handlers=wrapper._handlers[event];if(!_handlers){wrapper._handlers[event]=_handlers=[];hammer.on(event,propagatedHandler)}_handlers.push(handler)});return wrapper};wrapper.off=function(events,handler){split(events).forEach(function(event){var _handlers=wrapper._handlers[event];if(_handlers){_handlers=handler?_handlers.filter(function(h){return h!==handler}):[];if(_handlers.length>0){wrapper._handlers[event]=_handlers}else{hammer.off(event,propagatedHandler);delete wrapper._handlers[event]}}});return wrapper};wrapper.emit=function(eventType,event){_firstTarget=event.target;hammer.emit(eventType,event)};wrapper.destroy=function(){var hammers=hammer.element.hammer;var idx=hammers.indexOf(wrapper);if(idx!==-1)hammers.splice(idx,1);if(!hammers.length)delete hammer.element.hammer;wrapper._handlers={};hammer.destroy()};function split(events){return events.match(/[^ ]+/g)}function propagatedHandler(event){if(event.type!=="hammer.input"){if(!event.srcEvent._handled){event.srcEvent._handled={}}if(event.srcEvent._handled[event.type]){return}else{event.srcEvent._handled[event.type]=true}}var stopped=false;event.stopPropagation=function(){stopped=true};var srcStop=event.srcEvent.stopPropagation.bind(event.srcEvent);if(typeof srcStop=="function"){event.srcEvent.stopPropagation=function(){srcStop();event.stopPropagation()}}event.firstTarget=_firstTarget;var elem=_firstTarget;while(elem&&!stopped){var elemHammer=elem.hammer;if(elemHammer){var _handlers;for(var k=0;k<elemHammer.length;k++){_handlers=elemHammer[k]._handlers[event.type];if(_handlers)for(var i=0;i<_handlers.length&&!stopped;i++){_handlers[i](event)}}}elem=elem.parentNode}}return wrapper}})},{}]},{},[4])(4)});